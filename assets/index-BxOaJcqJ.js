function $R(e,t){for(var i=0;i<t.length;i++){const o=t[i];if(typeof o!="string"&&!Array.isArray(o)){for(const m in o)if(m!=="default"&&!(m in e)){const y=Object.getOwnPropertyDescriptor(o,m);y&&Object.defineProperty(e,m,y.get?y:{enumerable:!0,get:()=>o[m]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))o(m);new MutationObserver(m=>{for(const y of m)if(y.type==="childList")for(const _ of y.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function i(m){const y={};return m.integrity&&(y.integrity=m.integrity),m.referrerPolicy&&(y.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?y.credentials="include":m.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(m){if(m.ep)return;m.ep=!0;const y=i(m);fetch(m.href,y)}})();function uh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var e1={exports:{}},sv={};var ZT;function GR(){if(ZT)return sv;ZT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(o,m,y){var _=null;if(y!==void 0&&(_=""+y),m.key!==void 0&&(_=""+m.key),"key"in m){y={};for(var c in m)c!=="key"&&(y[c]=m[c])}else y=m;return m=y.ref,{$$typeof:e,type:o,key:_,ref:m!==void 0?m:null,props:y}}return sv.Fragment=t,sv.jsx=i,sv.jsxs=i,sv}var HT;function ZR(){return HT||(HT=1,e1.exports=GR()),e1.exports}var U=ZR(),t1={exports:{}},Or={};var WT;function HR(){if(WT)return Or;WT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),_=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),C=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),F=Symbol.iterator;function G(Ce){return Ce===null||typeof Ce!="object"?null:(Ce=F&&Ce[F]||Ce["@@iterator"],typeof Ce=="function"?Ce:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},W=Object.assign,q={};function ue(Ce,nt,Be){this.props=Ce,this.context=nt,this.refs=q,this.updater=Be||K}ue.prototype.isReactComponent={},ue.prototype.setState=function(Ce,nt){if(typeof Ce!="object"&&typeof Ce!="function"&&Ce!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ce,nt,"setState")},ue.prototype.forceUpdate=function(Ce){this.updater.enqueueForceUpdate(this,Ce,"forceUpdate")};function me(){}me.prototype=ue.prototype;function ge(Ce,nt,Be){this.props=Ce,this.context=nt,this.refs=q,this.updater=Be||K}var be=ge.prototype=new me;be.constructor=ge,W(be,ue.prototype),be.isPureReactComponent=!0;var ze=Array.isArray;function Ae(){}var Oe={H:null,A:null,T:null,S:null},rt=Object.prototype.hasOwnProperty;function gt(Ce,nt,Be){var lt=Be.ref;return{$$typeof:e,type:Ce,key:nt,ref:lt!==void 0?lt:null,props:Be}}function yt(Ce,nt){return gt(Ce.type,nt,Ce.props)}function tt(Ce){return typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===e}function Ge(Ce){var nt={"=":"=0",":":"=2"};return"$"+Ce.replace(/[=:]/g,function(Be){return nt[Be]})}var Rt=/\/+/g;function zt(Ce,nt){return typeof Ce=="object"&&Ce!==null&&Ce.key!=null?Ge(""+Ce.key):nt.toString(36)}function kt(Ce){switch(Ce.status){case"fulfilled":return Ce.value;case"rejected":throw Ce.reason;default:switch(typeof Ce.status=="string"?Ce.then(Ae,Ae):(Ce.status="pending",Ce.then(function(nt){Ce.status==="pending"&&(Ce.status="fulfilled",Ce.value=nt)},function(nt){Ce.status==="pending"&&(Ce.status="rejected",Ce.reason=nt)})),Ce.status){case"fulfilled":return Ce.value;case"rejected":throw Ce.reason}}throw Ce}function Ue(Ce,nt,Be,lt,Ft){var Lt=typeof Ce;(Lt==="undefined"||Lt==="boolean")&&(Ce=null);var Vt=!1;if(Ce===null)Vt=!0;else switch(Lt){case"bigint":case"string":case"number":Vt=!0;break;case"object":switch(Ce.$$typeof){case e:case t:Vt=!0;break;case D:return Vt=Ce._init,Ue(Vt(Ce._payload),nt,Be,lt,Ft)}}if(Vt)return Ft=Ft(Ce),Vt=lt===""?"."+zt(Ce,0):lt,ze(Ft)?(Be="",Vt!=null&&(Be=Vt.replace(Rt,"$&/")+"/"),Ue(Ft,nt,Be,"",function(tr){return tr})):Ft!=null&&(tt(Ft)&&(Ft=yt(Ft,Be+(Ft.key==null||Ce&&Ce.key===Ft.key?"":(""+Ft.key).replace(Rt,"$&/")+"/")+Vt)),nt.push(Ft)),1;Vt=0;var yr=lt===""?".":lt+":";if(ze(Ce))for(var ft=0;ft<Ce.length;ft++)lt=Ce[ft],Lt=yr+zt(lt,ft),Vt+=Ue(lt,nt,Be,Lt,Ft);else if(ft=G(Ce),typeof ft=="function")for(Ce=ft.call(Ce),ft=0;!(lt=Ce.next()).done;)lt=lt.value,Lt=yr+zt(lt,ft++),Vt+=Ue(lt,nt,Be,Lt,Ft);else if(Lt==="object"){if(typeof Ce.then=="function")return Ue(kt(Ce),nt,Be,lt,Ft);throw nt=String(Ce),Error("Objects are not valid as a React child (found: "+(nt==="[object Object]"?"object with keys {"+Object.keys(Ce).join(", ")+"}":nt)+"). If you meant to render a collection of children, use an array instead.")}return Vt}function at(Ce,nt,Be){if(Ce==null)return Ce;var lt=[],Ft=0;return Ue(Ce,lt,"","",function(Lt){return nt.call(Be,Lt,Ft++)}),lt}function pt(Ce){if(Ce._status===-1){var nt=Ce._result;nt=nt(),nt.then(function(Be){(Ce._status===0||Ce._status===-1)&&(Ce._status=1,Ce._result=Be)},function(Be){(Ce._status===0||Ce._status===-1)&&(Ce._status=2,Ce._result=Be)}),Ce._status===-1&&(Ce._status=0,Ce._result=nt)}if(Ce._status===1)return Ce._result.default;throw Ce._result}var bt=typeof reportError=="function"?reportError:function(Ce){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var nt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ce=="object"&&Ce!==null&&typeof Ce.message=="string"?String(Ce.message):String(Ce),error:Ce});if(!window.dispatchEvent(nt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ce);return}console.error(Ce)},Ut={map:at,forEach:function(Ce,nt,Be){at(Ce,function(){nt.apply(this,arguments)},Be)},count:function(Ce){var nt=0;return at(Ce,function(){nt++}),nt},toArray:function(Ce){return at(Ce,function(nt){return nt})||[]},only:function(Ce){if(!tt(Ce))throw Error("React.Children.only expected to receive a single React element child.");return Ce}};return Or.Activity=k,Or.Children=Ut,Or.Component=ue,Or.Fragment=i,Or.Profiler=m,Or.PureComponent=ge,Or.StrictMode=o,Or.Suspense=M,Or.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Oe,Or.__COMPILER_RUNTIME={__proto__:null,c:function(Ce){return Oe.H.useMemoCache(Ce)}},Or.cache=function(Ce){return function(){return Ce.apply(null,arguments)}},Or.cacheSignal=function(){return null},Or.cloneElement=function(Ce,nt,Be){if(Ce==null)throw Error("The argument must be a React element, but you passed "+Ce+".");var lt=W({},Ce.props),Ft=Ce.key;if(nt!=null)for(Lt in nt.key!==void 0&&(Ft=""+nt.key),nt)!rt.call(nt,Lt)||Lt==="key"||Lt==="__self"||Lt==="__source"||Lt==="ref"&&nt.ref===void 0||(lt[Lt]=nt[Lt]);var Lt=arguments.length-2;if(Lt===1)lt.children=Be;else if(1<Lt){for(var Vt=Array(Lt),yr=0;yr<Lt;yr++)Vt[yr]=arguments[yr+2];lt.children=Vt}return gt(Ce.type,Ft,lt)},Or.createContext=function(Ce){return Ce={$$typeof:_,_currentValue:Ce,_currentValue2:Ce,_threadCount:0,Provider:null,Consumer:null},Ce.Provider=Ce,Ce.Consumer={$$typeof:y,_context:Ce},Ce},Or.createElement=function(Ce,nt,Be){var lt,Ft={},Lt=null;if(nt!=null)for(lt in nt.key!==void 0&&(Lt=""+nt.key),nt)rt.call(nt,lt)&&lt!=="key"&&lt!=="__self"&&lt!=="__source"&&(Ft[lt]=nt[lt]);var Vt=arguments.length-2;if(Vt===1)Ft.children=Be;else if(1<Vt){for(var yr=Array(Vt),ft=0;ft<Vt;ft++)yr[ft]=arguments[ft+2];Ft.children=yr}if(Ce&&Ce.defaultProps)for(lt in Vt=Ce.defaultProps,Vt)Ft[lt]===void 0&&(Ft[lt]=Vt[lt]);return gt(Ce,Lt,Ft)},Or.createRef=function(){return{current:null}},Or.forwardRef=function(Ce){return{$$typeof:c,render:Ce}},Or.isValidElement=tt,Or.lazy=function(Ce){return{$$typeof:D,_payload:{_status:-1,_result:Ce},_init:pt}},Or.memo=function(Ce,nt){return{$$typeof:C,type:Ce,compare:nt===void 0?null:nt}},Or.startTransition=function(Ce){var nt=Oe.T,Be={};Oe.T=Be;try{var lt=Ce(),Ft=Oe.S;Ft!==null&&Ft(Be,lt),typeof lt=="object"&&lt!==null&&typeof lt.then=="function"&&lt.then(Ae,bt)}catch(Lt){bt(Lt)}finally{nt!==null&&Be.types!==null&&(nt.types=Be.types),Oe.T=nt}},Or.unstable_useCacheRefresh=function(){return Oe.H.useCacheRefresh()},Or.use=function(Ce){return Oe.H.use(Ce)},Or.useActionState=function(Ce,nt,Be){return Oe.H.useActionState(Ce,nt,Be)},Or.useCallback=function(Ce,nt){return Oe.H.useCallback(Ce,nt)},Or.useContext=function(Ce){return Oe.H.useContext(Ce)},Or.useDebugValue=function(){},Or.useDeferredValue=function(Ce,nt){return Oe.H.useDeferredValue(Ce,nt)},Or.useEffect=function(Ce,nt){return Oe.H.useEffect(Ce,nt)},Or.useEffectEvent=function(Ce){return Oe.H.useEffectEvent(Ce)},Or.useId=function(){return Oe.H.useId()},Or.useImperativeHandle=function(Ce,nt,Be){return Oe.H.useImperativeHandle(Ce,nt,Be)},Or.useInsertionEffect=function(Ce,nt){return Oe.H.useInsertionEffect(Ce,nt)},Or.useLayoutEffect=function(Ce,nt){return Oe.H.useLayoutEffect(Ce,nt)},Or.useMemo=function(Ce,nt){return Oe.H.useMemo(Ce,nt)},Or.useOptimistic=function(Ce,nt){return Oe.H.useOptimistic(Ce,nt)},Or.useReducer=function(Ce,nt,Be){return Oe.H.useReducer(Ce,nt,Be)},Or.useRef=function(Ce){return Oe.H.useRef(Ce)},Or.useState=function(Ce){return Oe.H.useState(Ce)},Or.useSyncExternalStore=function(Ce,nt,Be){return Oe.H.useSyncExternalStore(Ce,nt,Be)},Or.useTransition=function(){return Oe.H.useTransition()},Or.version="19.2.4",Or}var YT;function $g(){return YT||(YT=1,t1.exports=HR()),t1.exports}var Z=$g();const WR=uh(Z),YR=$R({__proto__:null,default:WR},[Z]);var r1={exports:{}},lv={},n1={exports:{}},i1={};var XT;function XR(){return XT||(XT=1,(function(e){function t(Ue,at){var pt=Ue.length;Ue.push(at);e:for(;0<pt;){var bt=pt-1>>>1,Ut=Ue[bt];if(0<m(Ut,at))Ue[bt]=at,Ue[pt]=Ut,pt=bt;else break e}}function i(Ue){return Ue.length===0?null:Ue[0]}function o(Ue){if(Ue.length===0)return null;var at=Ue[0],pt=Ue.pop();if(pt!==at){Ue[0]=pt;e:for(var bt=0,Ut=Ue.length,Ce=Ut>>>1;bt<Ce;){var nt=2*(bt+1)-1,Be=Ue[nt],lt=nt+1,Ft=Ue[lt];if(0>m(Be,pt))lt<Ut&&0>m(Ft,Be)?(Ue[bt]=Ft,Ue[lt]=pt,bt=lt):(Ue[bt]=Be,Ue[nt]=pt,bt=nt);else if(lt<Ut&&0>m(Ft,pt))Ue[bt]=Ft,Ue[lt]=pt,bt=lt;else break e}}return at}function m(Ue,at){var pt=Ue.sortIndex-at.sortIndex;return pt!==0?pt:Ue.id-at.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var _=Date,c=_.now();e.unstable_now=function(){return _.now()-c}}var M=[],C=[],D=1,k=null,F=3,G=!1,K=!1,W=!1,q=!1,ue=typeof setTimeout=="function"?setTimeout:null,me=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;function be(Ue){for(var at=i(C);at!==null;){if(at.callback===null)o(C);else if(at.startTime<=Ue)o(C),at.sortIndex=at.expirationTime,t(M,at);else break;at=i(C)}}function ze(Ue){if(W=!1,be(Ue),!K)if(i(M)!==null)K=!0,Ae||(Ae=!0,Ge());else{var at=i(C);at!==null&&kt(ze,at.startTime-Ue)}}var Ae=!1,Oe=-1,rt=5,gt=-1;function yt(){return q?!0:!(e.unstable_now()-gt<rt)}function tt(){if(q=!1,Ae){var Ue=e.unstable_now();gt=Ue;var at=!0;try{e:{K=!1,W&&(W=!1,me(Oe),Oe=-1),G=!0;var pt=F;try{t:{for(be(Ue),k=i(M);k!==null&&!(k.expirationTime>Ue&&yt());){var bt=k.callback;if(typeof bt=="function"){k.callback=null,F=k.priorityLevel;var Ut=bt(k.expirationTime<=Ue);if(Ue=e.unstable_now(),typeof Ut=="function"){k.callback=Ut,be(Ue),at=!0;break t}k===i(M)&&o(M),be(Ue)}else o(M);k=i(M)}if(k!==null)at=!0;else{var Ce=i(C);Ce!==null&&kt(ze,Ce.startTime-Ue),at=!1}}break e}finally{k=null,F=pt,G=!1}at=void 0}}finally{at?Ge():Ae=!1}}}var Ge;if(typeof ge=="function")Ge=function(){ge(tt)};else if(typeof MessageChannel<"u"){var Rt=new MessageChannel,zt=Rt.port2;Rt.port1.onmessage=tt,Ge=function(){zt.postMessage(null)}}else Ge=function(){ue(tt,0)};function kt(Ue,at){Oe=ue(function(){Ue(e.unstable_now())},at)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ue){Ue.callback=null},e.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):rt=0<Ue?Math.floor(1e3/Ue):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_next=function(Ue){switch(F){case 1:case 2:case 3:var at=3;break;default:at=F}var pt=F;F=at;try{return Ue()}finally{F=pt}},e.unstable_requestPaint=function(){q=!0},e.unstable_runWithPriority=function(Ue,at){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var pt=F;F=Ue;try{return at()}finally{F=pt}},e.unstable_scheduleCallback=function(Ue,at,pt){var bt=e.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?bt+pt:bt):pt=bt,Ue){case 1:var Ut=-1;break;case 2:Ut=250;break;case 5:Ut=1073741823;break;case 4:Ut=1e4;break;default:Ut=5e3}return Ut=pt+Ut,Ue={id:D++,callback:at,priorityLevel:Ue,startTime:pt,expirationTime:Ut,sortIndex:-1},pt>bt?(Ue.sortIndex=pt,t(C,Ue),i(M)===null&&Ue===i(C)&&(W?(me(Oe),Oe=-1):W=!0,kt(ze,pt-bt))):(Ue.sortIndex=Ut,t(M,Ue),K||G||(K=!0,Ae||(Ae=!0,Ge()))),Ue},e.unstable_shouldYield=yt,e.unstable_wrapCallback=function(Ue){var at=F;return function(){var pt=F;F=at;try{return Ue.apply(this,arguments)}finally{F=pt}}}})(i1)),i1}var KT;function KR(){return KT||(KT=1,n1.exports=XR()),n1.exports}var a1={exports:{}},Go={};var QT;function QR(){if(QT)return Go;QT=1;var e=$g();function t(M){var C="https://react.dev/errors/"+M;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var D=2;D<arguments.length;D++)C+="&args[]="+encodeURIComponent(arguments[D])}return"Minified React error #"+M+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var o={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},m=Symbol.for("react.portal");function y(M,C,D){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:k==null?null:""+k,children:M,containerInfo:C,implementation:D}}var _=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(M,C){if(M==="font")return"";if(typeof C=="string")return C==="use-credentials"?C:""}return Go.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Go.createPortal=function(M,C){var D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C||C.nodeType!==1&&C.nodeType!==9&&C.nodeType!==11)throw Error(t(299));return y(M,C,null,D)},Go.flushSync=function(M){var C=_.T,D=o.p;try{if(_.T=null,o.p=2,M)return M()}finally{_.T=C,o.p=D,o.d.f()}},Go.preconnect=function(M,C){typeof M=="string"&&(C?(C=C.crossOrigin,C=typeof C=="string"?C==="use-credentials"?C:"":void 0):C=null,o.d.C(M,C))},Go.prefetchDNS=function(M){typeof M=="string"&&o.d.D(M)},Go.preinit=function(M,C){if(typeof M=="string"&&C&&typeof C.as=="string"){var D=C.as,k=c(D,C.crossOrigin),F=typeof C.integrity=="string"?C.integrity:void 0,G=typeof C.fetchPriority=="string"?C.fetchPriority:void 0;D==="style"?o.d.S(M,typeof C.precedence=="string"?C.precedence:void 0,{crossOrigin:k,integrity:F,fetchPriority:G}):D==="script"&&o.d.X(M,{crossOrigin:k,integrity:F,fetchPriority:G,nonce:typeof C.nonce=="string"?C.nonce:void 0})}},Go.preinitModule=function(M,C){if(typeof M=="string")if(typeof C=="object"&&C!==null){if(C.as==null||C.as==="script"){var D=c(C.as,C.crossOrigin);o.d.M(M,{crossOrigin:D,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0})}}else C==null&&o.d.M(M)},Go.preload=function(M,C){if(typeof M=="string"&&typeof C=="object"&&C!==null&&typeof C.as=="string"){var D=C.as,k=c(D,C.crossOrigin);o.d.L(M,D,{crossOrigin:k,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0,type:typeof C.type=="string"?C.type:void 0,fetchPriority:typeof C.fetchPriority=="string"?C.fetchPriority:void 0,referrerPolicy:typeof C.referrerPolicy=="string"?C.referrerPolicy:void 0,imageSrcSet:typeof C.imageSrcSet=="string"?C.imageSrcSet:void 0,imageSizes:typeof C.imageSizes=="string"?C.imageSizes:void 0,media:typeof C.media=="string"?C.media:void 0})}},Go.preloadModule=function(M,C){if(typeof M=="string")if(C){var D=c(C.as,C.crossOrigin);o.d.m(M,{as:typeof C.as=="string"&&C.as!=="script"?C.as:void 0,crossOrigin:D,integrity:typeof C.integrity=="string"?C.integrity:void 0})}else o.d.m(M)},Go.requestFormReset=function(M){o.d.r(M)},Go.unstable_batchedUpdates=function(M,C){return M(C)},Go.useFormState=function(M,C,D){return _.H.useFormState(M,C,D)},Go.useFormStatus=function(){return _.H.useHostTransitionStatus()},Go.version="19.2.4",Go}var JT;function nD(){if(JT)return a1.exports;JT=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),a1.exports=QR(),a1.exports}var eE;function JR(){if(eE)return lv;eE=1;var e=KR(),t=$g(),i=nD();function o(l){var h="https://react.dev/errors/"+l;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+l+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function y(l){var h=l,g=l;if(l.alternate)for(;h.return;)h=h.return;else{l=h;do h=l,(h.flags&4098)!==0&&(g=h.return),l=h.return;while(l)}return h.tag===3?g:null}function _(l){if(l.tag===13){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function c(l){if(l.tag===31){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function M(l){if(y(l)!==l)throw Error(o(188))}function C(l){var h=l.alternate;if(!h){if(h=y(l),h===null)throw Error(o(188));return h!==l?null:l}for(var g=l,S=h;;){var I=g.return;if(I===null)break;var j=I.alternate;if(j===null){if(S=I.return,S!==null){g=S;continue}break}if(I.child===j.child){for(j=I.child;j;){if(j===g)return M(I),l;if(j===S)return M(I),h;j=j.sibling}throw Error(o(188))}if(g.return!==S.return)g=I,S=j;else{for(var Q=!1,ce=I.child;ce;){if(ce===g){Q=!0,g=I,S=j;break}if(ce===S){Q=!0,S=I,g=j;break}ce=ce.sibling}if(!Q){for(ce=j.child;ce;){if(ce===g){Q=!0,g=j,S=I;break}if(ce===S){Q=!0,S=j,g=I;break}ce=ce.sibling}if(!Q)throw Error(o(189))}}if(g.alternate!==S)throw Error(o(190))}if(g.tag!==3)throw Error(o(188));return g.stateNode.current===g?l:h}function D(l){var h=l.tag;if(h===5||h===26||h===27||h===6)return l;for(l=l.child;l!==null;){if(h=D(l),h!==null)return h;l=l.sibling}return null}var k=Object.assign,F=Symbol.for("react.element"),G=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),ue=Symbol.for("react.profiler"),me=Symbol.for("react.consumer"),ge=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),Oe=Symbol.for("react.memo"),rt=Symbol.for("react.lazy"),gt=Symbol.for("react.activity"),yt=Symbol.for("react.memo_cache_sentinel"),tt=Symbol.iterator;function Ge(l){return l===null||typeof l!="object"?null:(l=tt&&l[tt]||l["@@iterator"],typeof l=="function"?l:null)}var Rt=Symbol.for("react.client.reference");function zt(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===Rt?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case W:return"Fragment";case ue:return"Profiler";case q:return"StrictMode";case ze:return"Suspense";case Ae:return"SuspenseList";case gt:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case K:return"Portal";case ge:return l.displayName||"Context";case me:return(l._context.displayName||"Context")+".Consumer";case be:var h=l.render;return l=l.displayName,l||(l=h.displayName||h.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Oe:return h=l.displayName||null,h!==null?h:zt(l.type)||"Memo";case rt:h=l._payload,l=l._init;try{return zt(l(h))}catch{}}return null}var kt=Array.isArray,Ue=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,at=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pt={pending:!1,data:null,method:null,action:null},bt=[],Ut=-1;function Ce(l){return{current:l}}function nt(l){0>Ut||(l.current=bt[Ut],bt[Ut]=null,Ut--)}function Be(l,h){Ut++,bt[Ut]=l.current,l.current=h}var lt=Ce(null),Ft=Ce(null),Lt=Ce(null),Vt=Ce(null);function yr(l,h){switch(Be(Lt,h),Be(Ft,l),Be(lt,null),h.nodeType){case 9:case 11:l=(l=h.documentElement)&&(l=l.namespaceURI)?t0(l):0;break;default:if(l=h.tagName,h=h.namespaceURI)h=t0(h),l=Vy(h,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}nt(lt),Be(lt,l)}function ft(){nt(lt),nt(Ft),nt(Lt)}function tr(l){l.memoizedState!==null&&Be(Vt,l);var h=lt.current,g=Vy(h,l.type);h!==g&&(Be(Ft,l),Be(lt,g))}function pr(l){Ft.current===l&&(nt(lt),nt(Ft)),Vt.current===l&&(nt(Vt),Ed._currentValue=pt)}var Tt,gn;function fr(l){if(Tt===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);Tt=h&&h[1]||"",gn=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tt+l+gn}var Sr=!1;function rn(l,h){if(!l||Sr)return"";Sr=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(h){var At=function(){throw Error()};if(Object.defineProperty(At.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(At,[])}catch(ct){var it=ct}Reflect.construct(l,[],At)}else{try{At.call()}catch(ct){it=ct}l.call(At.prototype)}}else{try{throw Error()}catch(ct){it=ct}(At=l())&&typeof At.catch=="function"&&At.catch(function(){})}}catch(ct){if(ct&&it&&typeof ct.stack=="string")return[ct.stack,it.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=S.DetermineComponentFrameRoot(),Q=j[0],ce=j[1];if(Q&&ce){var ke=Q.split(`
`),Ke=ce.split(`
`);for(I=S=0;S<ke.length&&!ke[S].includes("DetermineComponentFrameRoot");)S++;for(;I<Ke.length&&!Ke[I].includes("DetermineComponentFrameRoot");)I++;if(S===ke.length||I===Ke.length)for(S=ke.length-1,I=Ke.length-1;1<=S&&0<=I&&ke[S]!==Ke[I];)I--;for(;1<=S&&0<=I;S--,I--)if(ke[S]!==Ke[I]){if(S!==1||I!==1)do if(S--,I--,0>I||ke[S]!==Ke[I]){var vt=`
`+ke[S].replace(" at new "," at ");return l.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",l.displayName)),vt}while(1<=S&&0<=I);break}}}finally{Sr=!1,Error.prepareStackTrace=g}return(g=l?l.displayName||l.name:"")?fr(g):""}function Tr(l,h){switch(l.tag){case 26:case 27:case 5:return fr(l.type);case 16:return fr("Lazy");case 13:return l.child!==h&&h!==null?fr("Suspense Fallback"):fr("Suspense");case 19:return fr("SuspenseList");case 0:case 15:return rn(l.type,!1);case 11:return rn(l.type.render,!1);case 1:return rn(l.type,!0);case 31:return fr("Activity");default:return""}}function za(l){try{var h="",g=null;do h+=Tr(l,g),g=l,l=l.return;while(l);return h}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}var bs=Object.prototype.hasOwnProperty,ka=e.unstable_scheduleCallback,pa=e.unstable_cancelCallback,uo=e.unstable_shouldYield,bn=e.unstable_requestPaint,kn=e.unstable_now,ma=e.unstable_getCurrentPriorityLevel,co=e.unstable_ImmediatePriority,ta=e.unstable_UserBlockingPriority,ga=e.unstable_NormalPriority,du=e.unstable_LowPriority,ws=e.unstable_IdlePriority,je=e.log,ee=e.unstable_setDisableYieldValue,ne=null,ae=null;function _e(l){if(typeof je=="function"&&ee(l),ae&&typeof ae.setStrictMode=="function")try{ae.setStrictMode(ne,l)}catch{}}var Te=Math.clz32?Math.clz32:Ne,qe=Math.log,Ze=Math.LN2;function Ne(l){return l>>>=0,l===0?32:31-(qe(l)/Ze|0)|0}var Ve=256,_t=262144,Xe=4194304;function Me(l){var h=l&42;if(h!==0)return h;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function qt(l,h,g){var S=l.pendingLanes;if(S===0)return 0;var I=0,j=l.suspendedLanes,Q=l.pingedLanes;l=l.warmLanes;var ce=S&134217727;return ce!==0?(S=ce&~j,S!==0?I=Me(S):(Q&=ce,Q!==0?I=Me(Q):g||(g=ce&~l,g!==0&&(I=Me(g))))):(ce=S&~j,ce!==0?I=Me(ce):Q!==0?I=Me(Q):g||(g=S&~l,g!==0&&(I=Me(g)))),I===0?0:h!==0&&h!==I&&(h&j)===0&&(j=I&-I,g=h&-h,j>=g||j===32&&(g&4194048)!==0)?h:I}function hr(l,h){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&h)===0}function Yt(l,h){switch(l){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lr(){var l=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),l}function rr(l){for(var h=[],g=0;31>g;g++)h.push(l);return h}function mr(l,h){l.pendingLanes|=h,h!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Bn(l,h,g,S,I,j){var Q=l.pendingLanes;l.pendingLanes=g,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=g,l.entangledLanes&=g,l.errorRecoveryDisabledLanes&=g,l.shellSuspendCounter=0;var ce=l.entanglements,ke=l.expirationTimes,Ke=l.hiddenUpdates;for(g=Q&~g;0<g;){var vt=31-Te(g),At=1<<vt;ce[vt]=0,ke[vt]=-1;var it=Ke[vt];if(it!==null)for(Ke[vt]=null,vt=0;vt<it.length;vt++){var ct=it[vt];ct!==null&&(ct.lane&=-536870913)}g&=~At}S!==0&&nn(l,S,0),j!==0&&I===0&&l.tag!==0&&(l.suspendedLanes|=j&~(Q&~h))}function nn(l,h,g){l.pendingLanes|=h,l.suspendedLanes&=~h;var S=31-Te(h);l.entangledLanes|=h,l.entanglements[S]=l.entanglements[S]|1073741824|g&261930}function hn(l,h){var g=l.entangledLanes|=h;for(l=l.entanglements;g;){var S=31-Te(g),I=1<<S;I&h|l[S]&h&&(l[S]|=h),g&=~I}}function ui(l,h){var g=h&-h;return g=(g&42)!==0?1:an(g),(g&(l.suspendedLanes|h))!==0?0:g}function an(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Et(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function jr(){var l=at.p;return l!==0?l:(l=window.event,l===void 0?32:ef(l.type))}function fn(l,h){var g=at.p;try{return at.p=l,h()}finally{at.p=g}}var ya=Math.random().toString(36).slice(2),Cn="__reactFiber$"+ya,xt="__reactProps$"+ya,ur="__reactContainer$"+ya,sr="__reactEvents$"+ya,Ra="__reactListeners$"+ya,Zs="__reactHandles$"+ya,Ss="__reactResources$"+ya,gr="__reactMarker$"+ya;function Ts(l){delete l[Cn],delete l[xt],delete l[sr],delete l[Ra],delete l[Zs]}function ja(l){var h=l[Cn];if(h)return h;for(var g=l.parentNode;g;){if(h=g[ur]||g[Cn]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(l=qo(l);l!==null;){if(g=l[Cn])return g;l=qo(l)}return h}l=g,g=l.parentNode}return null}function Xo(l){if(l=l[Cn]||l[ur]){var h=l.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return l}return null}function va(l){var h=l.tag;if(h===5||h===26||h===27||h===6)return l.stateNode;throw Error(o(33))}function Ir(l){var h=l[Ss];return h||(h=l[Ss]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Dn(l){l[gr]=!0}var Tl=new Set,Gr={};function Ur(l,h){zi(l,h),zi(l+"Capture",h)}function zi(l,h){for(Gr[l]=h,l=0;l<h.length;l++)Tl.add(h[l])}var Ko=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),El={},ho={};function Qo(l){return bs.call(ho,l)?!0:bs.call(El,l)?!1:Ko.test(l)?ho[l]=!0:(El[l]=!0,!1)}function Jo(l,h,g){if(Qo(h))if(g===null)l.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":l.removeAttribute(h);return;case"boolean":var S=h.toLowerCase().slice(0,5);if(S!=="data-"&&S!=="aria-"){l.removeAttribute(h);return}}l.setAttribute(h,""+g)}}function Al(l,h,g){if(g===null)l.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(h);return}l.setAttribute(h,""+g)}}function Zi(l,h,g,S){if(S===null)l.removeAttribute(g);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(g);return}l.setAttributeNS(h,g,""+S)}}function ei(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ti(l){var h=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Zd(l,h,g){var S=Object.getOwnPropertyDescriptor(l.constructor.prototype,h);if(!l.hasOwnProperty(h)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var I=S.get,j=S.set;return Object.defineProperty(l,h,{configurable:!0,get:function(){return I.call(this)},set:function(Q){g=""+Q,j.call(this,Q)}}),Object.defineProperty(l,h,{enumerable:S.enumerable}),{getValue:function(){return g},setValue:function(Q){g=""+Q},stopTracking:function(){l._valueTracker=null,delete l[h]}}}}function pu(l){if(!l._valueTracker){var h=ti(l)?"checked":"value";l._valueTracker=Zd(l,h,""+l[h])}}function Ml(l){if(!l)return!1;var h=l._valueTracker;if(!h)return!0;var g=h.getValue(),S="";return l&&(S=ti(l)?l.checked?"true":"false":l.value),l=S,l!==g?(h.setValue(l),!0):!1}function Hs(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var Af=/[\n"\\]/g;function Hi(l){return l.replace(Af,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Pl(l,h,g,S,I,j,Q,ce){l.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?l.type=Q:l.removeAttribute("type"),h!=null?Q==="number"?(h===0&&l.value===""||l.value!=h)&&(l.value=""+ei(h)):l.value!==""+ei(h)&&(l.value=""+ei(h)):Q!=="submit"&&Q!=="reset"||l.removeAttribute("value"),h!=null?jo(l,Q,ei(h)):g!=null?jo(l,Q,ei(g)):S!=null&&l.removeAttribute("value"),I==null&&j!=null&&(l.defaultChecked=!!j),I!=null&&(l.checked=I&&typeof I!="function"&&typeof I!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?l.name=""+ei(ce):l.removeAttribute("name")}function es(l,h,g,S,I,j,Q,ce){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(l.type=j),h!=null||g!=null){if(!(j!=="submit"&&j!=="reset"||h!=null)){pu(l);return}g=g!=null?""+ei(g):"",h=h!=null?""+ei(h):g,ce||h===l.value||(l.value=h),l.defaultValue=h}S=S??I,S=typeof S!="function"&&typeof S!="symbol"&&!!S,l.checked=ce?l.checked:!!S,l.defaultChecked=!!S,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(l.name=Q),pu(l)}function jo(l,h,g){h==="number"&&Hs(l.ownerDocument)===l||l.defaultValue===""+g||(l.defaultValue=""+g)}function ri(l,h,g,S){if(l=l.options,h){h={};for(var I=0;I<g.length;I++)h["$"+g[I]]=!0;for(g=0;g<l.length;g++)I=h.hasOwnProperty("$"+l[g].value),l[g].selected!==I&&(l[g].selected=I),I&&S&&(l[g].defaultSelected=!0)}else{for(g=""+ei(g),h=null,I=0;I<l.length;I++){if(l[I].value===g){l[I].selected=!0,S&&(l[I].defaultSelected=!0);return}h!==null||l[I].disabled||(h=l[I])}h!==null&&(h.selected=!0)}}function fh(l,h,g){if(h!=null&&(h=""+ei(h),h!==l.value&&(l.value=h),g==null)){l.defaultValue!==h&&(l.defaultValue=h);return}l.defaultValue=g!=null?""+ei(g):""}function Cl(l,h,g,S){if(h==null){if(S!=null){if(g!=null)throw Error(o(92));if(kt(S)){if(1<S.length)throw Error(o(93));S=S[0]}g=S}g==null&&(g=""),h=g}g=ei(h),l.defaultValue=g,S=l.textContent,S===g&&S!==""&&S!==null&&(l.value=S),pu(l)}function fo(l,h){if(h){var g=l.firstChild;if(g&&g===l.lastChild&&g.nodeType===3){g.nodeValue=h;return}}l.textContent=h}var Mf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ws(l,h,g){var S=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?S?l.setProperty(h,""):h==="float"?l.cssFloat="":l[h]="":S?l.setProperty(h,g):typeof g!="number"||g===0||Mf.has(h)?h==="float"?l.cssFloat=g:l[h]=(""+g).trim():l[h]=g+"px"}function Fe(l,h,g){if(h!=null&&typeof h!="object")throw Error(o(62));if(l=l.style,g!=null){for(var S in g)!g.hasOwnProperty(S)||h!=null&&h.hasOwnProperty(S)||(S.indexOf("--")===0?l.setProperty(S,""):S==="float"?l.cssFloat="":l[S]="");for(var I in h)S=h[I],h.hasOwnProperty(I)&&g[I]!==S&&Ws(l,I,S)}else for(var j in h)h.hasOwnProperty(j)&&Ws(l,j,h[j])}function Pt(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ot(l){return Qt.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function nr(){}var Gt=null;function Yr(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var xr=null,on=null;function Mr(l){var h=Xo(l);if(h&&(l=h.stateNode)){var g=l[xt]||null;e:switch(l=h.stateNode,h.type){case"input":if(Pl(l,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=l;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Hi(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var S=g[h];if(S!==l&&S.form===l.form){var I=S[xt]||null;if(!I)throw Error(o(90));Pl(S,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(h=0;h<g.length;h++)S=g[h],S.form===l.form&&Ml(S)}break e;case"textarea":fh(l,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&ri(l,!!g.multiple,h,!1)}}}var Lr=!1;function Wt(l,h,g){if(Lr)return l(h,g);Lr=!0;try{var S=l(h);return S}finally{if(Lr=!1,(xr!==null||on!==null)&&(Gm(),xr&&(h=xr,l=on,on=xr=null,Mr(h),l)))for(h=0;h<l.length;h++)Mr(l[h])}}function Zn(l,h){var g=l.stateNode;if(g===null)return null;var S=g[xt]||null;if(S===null)return null;g=S[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(l=l.type,S=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!S;break e;default:l=!1}if(l)return null;if(g&&typeof g!="function")throw Error(o(231,h,typeof g));return g}var Nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ki=!1;if(Nr)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){ki=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{ki=!1}var La=null,wn=null,Zr=null;function Na(){if(Zr)return Zr;var l,h=wn,g=h.length,S,I="value"in La?La.value:La.textContent,j=I.length;for(l=0;l<g&&h[l]===I[l];l++);var Q=g-l;for(S=1;S<=Q&&h[g-S]===I[j-S];S++);return Zr=I.slice(l,1<S?1-S:void 0)}function gi(l){var h=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&h===13&&(l=13)):l=h,l===10&&(l=13),32<=l||l===13?l:0}function ci(){return!0}function Ai(){return!1}function Jr(l){function h(g,S,I,j,Q){this._reactName=g,this._targetInst=I,this.type=S,this.nativeEvent=j,this.target=Q,this.currentTarget=null;for(var ce in l)l.hasOwnProperty(ce)&&(g=l[ce],this[ce]=g?g(j):j[ce]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?ci:Ai,this.isPropagationStopped=Ai,this}return k(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=ci)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=ci)},persist:function(){},isPersistent:ci}),h}var kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ri=Jr(kr),Es=k({},kr,{view:0,detail:0}),dh=Jr(Es),Ys,sn,Xs,Dr=k({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gu,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Xs&&(Xs&&l.type==="mousemove"?(Ys=l.screenX-Xs.screenX,sn=l.screenY-Xs.screenY):sn=Ys=0,Xs=l),Ys)},movementY:function(l){return"movementY"in l?l.movementY:sn}}),br=Jr(Dr),ph=k({},Dr,{dataTransfer:0}),Br=Jr(ph),fc=k({},Es,{relatedTarget:0}),Ba=Jr(fc),mu=k({},kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Pf=Jr(mu),Cf=k({},kr,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Df=Jr(Cf),um=k({},kr,{data:0}),cm=Jr(um),_a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Of={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mi(l){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(l):(l=Wi[l])?!!h[l]:!1}function gu(){return Mi}var Hd=k({},Es,{key:function(l){if(l.key){var h=_a[l.key]||l.key;if(h!=="Unidentified")return h}return l.type==="keypress"?(l=gi(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?Of[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gu,charCode:function(l){return l.type==="keypress"?gi(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?gi(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Ks=Jr(Hd),ji=k({},Dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wd=Jr(ji),Yd=k({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gu}),hm=Jr(Yd),ty=k({},kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),dc=Jr(ty),yu=k({},Dr,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),mh=Jr(yu),If=k({},kr,{newState:0,oldState:0}),zf=Jr(If),pc=[9,13,27,32],xa=Nr&&"CompositionEvent"in window,ba=null;Nr&&"documentMode"in document&&(ba=document.documentMode);var kf=Nr&&"TextEvent"in window&&!ba,Qs=Nr&&(!xa||ba&&8<ba&&11>=ba),mc=" ",Rf=!1;function gh(l,h){switch(l){case"keyup":return pc.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fm(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var ts=!1;function ry(l,h){switch(l){case"compositionend":return fm(h);case"keypress":return h.which!==32?null:(Rf=!0,mc);case"textInput":return l=h.data,l===mc&&Rf?null:l;default:return null}}function yh(l,h){if(ts)return l==="compositionend"||!xa&&gh(l,h)?(l=Na(),Zr=wn=La=null,ts=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Qs&&h.locale!=="ko"?null:h.data;default:return null}}var ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jf(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h==="input"?!!ny[l.type]:h==="textarea"}function vh(l,h,g,S){xr?on?on.push(S):on=[S]:xr=S,h=dl(h,"onChange"),0<h.length&&(g=new Ri("onChange","change",null,g,S),l.push({event:g,listeners:h}))}var gc=null,vu=null;function dm(l){wp(l,0)}function _h(l){var h=va(l);if(Ml(h))return l}function Dl(l,h){if(l==="change")return h}var Xd=!1;if(Nr){var Lf;if(Nr){var Ol="oninput"in document;if(!Ol){var Kd=document.createElement("div");Kd.setAttribute("oninput","return;"),Ol=typeof Kd.oninput=="function"}Lf=Ol}else Lf=!1;Xd=Lf&&(!document.documentMode||9<document.documentMode)}function yc(){gc&&(gc.detachEvent("onpropertychange",pm),vu=gc=null)}function pm(l){if(l.propertyName==="value"&&_h(vu)){var h=[];vh(h,vu,l,Yr(l)),Wt(dm,h)}}function iy(l,h,g){l==="focusin"?(yc(),gc=h,vu=g,gc.attachEvent("onpropertychange",pm)):l==="focusout"&&yc()}function mm(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return _h(vu)}function gm(l,h){if(l==="click")return _h(h)}function xh(l,h){if(l==="input"||l==="change")return _h(h)}function Qd(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var Fa=typeof Object.is=="function"?Object.is:Qd;function Il(l,h){if(Fa(l,h))return!0;if(typeof l!="object"||l===null||typeof h!="object"||h===null)return!1;var g=Object.keys(l),S=Object.keys(h);if(g.length!==S.length)return!1;for(S=0;S<g.length;S++){var I=g[S];if(!bs.call(h,I)||!Fa(l[I],h[I]))return!1}return!0}function As(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function vc(l,h){var g=As(l);l=0;for(var S;g;){if(g.nodeType===3){if(S=l+g.textContent.length,l<=h&&S>=h)return{node:g,offset:h-l};l=S}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=As(g)}}function bh(l,h){return l&&h?l===h?!0:l&&l.nodeType===3?!1:h&&h.nodeType===3?bh(l,h.parentNode):"contains"in l?l.contains(h):l.compareDocumentPosition?!!(l.compareDocumentPosition(h)&16):!1:!1}function Nf(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var h=Hs(l.document);h instanceof l.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)l=h.contentWindow;else break;h=Hs(l.document)}return h}function Bf(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h&&(h==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||h==="textarea"||l.contentEditable==="true")}var Ff=Nr&&"documentMode"in document&&11>=document.documentMode,po=null,wh=null,Sh=null,Jd=!1;function ep(l,h,g){var S=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Jd||po==null||po!==Hs(S)||(S=po,"selectionStart"in S&&Bf(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),Sh&&Il(Sh,S)||(Sh=S,S=dl(wh,"onSelect"),0<S.length&&(h=new Ri("onSelect","select",null,h,g),l.push({event:h,listeners:S}),h.target=po)))}function _u(l,h){var g={};return g[l.toLowerCase()]=h.toLowerCase(),g["Webkit"+l]="webkit"+h,g["Moz"+l]="moz"+h,g}var xu={animationend:_u("Animation","AnimationEnd"),animationiteration:_u("Animation","AnimationIteration"),animationstart:_u("Animation","AnimationStart"),transitionrun:_u("Transition","TransitionRun"),transitionstart:_u("Transition","TransitionStart"),transitioncancel:_u("Transition","TransitionCancel"),transitionend:_u("Transition","TransitionEnd")},tp={},rp={};Nr&&(rp=document.createElement("div").style,"AnimationEvent"in window||(delete xu.animationend.animation,delete xu.animationiteration.animation,delete xu.animationstart.animation),"TransitionEvent"in window||delete xu.transitionend.transition);function Cr(l){if(tp[l])return tp[l];if(!xu[l])return l;var h=xu[l],g;for(g in h)if(h.hasOwnProperty(g)&&g in rp)return tp[l]=h[g];return l}var Th=Cr("animationend"),Eh=Cr("animationiteration"),Uf=Cr("animationstart"),bu=Cr("transitionrun"),Ah=Cr("transitionstart"),_c=Cr("transitioncancel"),mo=Cr("transitionend"),np=new Map,Vf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vf.push("scrollEnd");function go(l,h){np.set(l,h),Ur(h,[l])}var Ms=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},wa=[],Js=0,wu=0;function Su(){for(var l=Js,h=wu=Js=0;h<l;){var g=wa[h];wa[h++]=null;var S=wa[h];wa[h++]=null;var I=wa[h];wa[h++]=null;var j=wa[h];if(wa[h++]=null,S!==null&&I!==null){var Q=S.pending;Q===null?I.next=I:(I.next=Q.next,Q.next=I),S.pending=I}j!==0&&ip(g,I,j)}}function Mh(l,h,g,S){wa[Js++]=l,wa[Js++]=h,wa[Js++]=g,wa[Js++]=S,wu|=S,l.lanes|=S,l=l.alternate,l!==null&&(l.lanes|=S)}function zl(l,h,g,S){return Mh(l,h,g,S),xc(l)}function Lo(l,h){return Mh(l,null,null,h),xc(l)}function ip(l,h,g){l.lanes|=g;var S=l.alternate;S!==null&&(S.lanes|=g);for(var I=!1,j=l.return;j!==null;)j.childLanes|=g,S=j.alternate,S!==null&&(S.childLanes|=g),j.tag===22&&(l=j.stateNode,l===null||l._visibility&1||(I=!0)),l=j,j=j.return;return l.tag===3?(j=l.stateNode,I&&h!==null&&(I=31-Te(g),l=j.hiddenUpdates,S=l[I],S===null?l[I]=[h]:S.push(h),h.lane=g|536870912),j):null}function xc(l){if(50<yd)throw yd=0,Sy=null,Error(o(185));for(var h=l.return;h!==null;)l=h,h=l.return;return l.tag===3?l.stateNode:null}var wr={};function qf(l,h,g,S){this.tag=l,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(l,h,g,S){return new qf(l,h,g,S)}function $f(l){return l=l.prototype,!(!l||!l.isReactComponent)}function vo(l,h){var g=l.alternate;return g===null?(g=yo(l.tag,h,l.key,l.mode),g.elementType=l.elementType,g.type=l.type,g.stateNode=l.stateNode,g.alternate=l,l.alternate=g):(g.pendingProps=h,g.type=l.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=l.flags&65011712,g.childLanes=l.childLanes,g.lanes=l.lanes,g.child=l.child,g.memoizedProps=l.memoizedProps,g.memoizedState=l.memoizedState,g.updateQueue=l.updateQueue,h=l.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=l.sibling,g.index=l.index,g.ref=l.ref,g.refCleanup=l.refCleanup,g}function ym(l,h){l.flags&=65011714;var g=l.alternate;return g===null?(l.childLanes=0,l.lanes=h,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=g.childLanes,l.lanes=g.lanes,l.child=g.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=g.memoizedProps,l.memoizedState=g.memoizedState,l.updateQueue=g.updateQueue,l.type=g.type,h=g.dependencies,l.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),l}function Gf(l,h,g,S,I,j){var Q=0;if(S=l,typeof l=="function")$f(l)&&(Q=1);else if(typeof l=="string")Q=ug(l,g,lt.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case gt:return l=yo(31,g,h,I),l.elementType=gt,l.lanes=j,l;case W:return kl(g.children,I,j,h);case q:Q=8,I|=24;break;case ue:return l=yo(12,g,h,I|2),l.elementType=ue,l.lanes=j,l;case ze:return l=yo(13,g,h,I),l.elementType=ze,l.lanes=j,l;case Ae:return l=yo(19,g,h,I),l.elementType=Ae,l.lanes=j,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case ge:Q=10;break e;case me:Q=9;break e;case be:Q=11;break e;case Oe:Q=14;break e;case rt:Q=16,S=null;break e}Q=29,g=Error(o(130,l===null?"null":typeof l,"")),S=null}return h=yo(Q,g,h,I),h.elementType=l,h.type=S,h.lanes=j,h}function kl(l,h,g,S){return l=yo(7,l,S,h),l.lanes=g,l}function ap(l,h,g){return l=yo(6,l,null,h),l.lanes=g,l}function Zf(l){var h=yo(18,null,null,0);return h.stateNode=l,h}function bc(l,h,g){return h=yo(4,l.children!==null?l.children:[],l.key,h),h.lanes=g,h.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},h}var Rl=new WeakMap;function Sa(l,h){if(typeof l=="object"&&l!==null){var g=Rl.get(l);return g!==void 0?g:(h={value:l,source:h,stack:za(h)},Rl.set(l,h),h)}return{value:l,source:h,stack:za(h)}}var jl=[],Tu=0,Ll=null,Nl=0,ra=[],yi=0,rs=null,Ps=1,Ua="";function el(l,h){jl[Tu++]=Nl,jl[Tu++]=Ll,Ll=l,Nl=h}function op(l,h,g){ra[yi++]=Ps,ra[yi++]=Ua,ra[yi++]=rs,rs=l;var S=Ps;l=Ua;var I=32-Te(S)-1;S&=~(1<<I),g+=1;var j=32-Te(h)+I;if(30<j){var Q=I-I%5;j=(S&(1<<Q)-1).toString(32),S>>=Q,I-=Q,Ps=1<<32-Te(h)+I|g<<I|S,Ua=j+l}else Ps=1<<j|g<<I|S,Ua=l}function wc(l){l.return!==null&&(el(l,1),op(l,1,0))}function Sc(l){for(;l===Ll;)Ll=jl[--Tu],jl[Tu]=null,Nl=jl[--Tu],jl[Tu]=null;for(;l===rs;)rs=ra[--yi],ra[yi]=null,Ua=ra[--yi],ra[yi]=null,Ps=ra[--yi],ra[yi]=null}function Hf(l,h){ra[yi++]=Ps,ra[yi++]=Ua,ra[yi++]=rs,Ps=h.id,Ua=h.overflow,rs=l}var Li=null,yn=null,Rr=!1,tl=null,Va=!1,Fn=Error(o(519));function qa(l){var h=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nl(Sa(h,l)),Fn}function $a(l){var h=l.stateNode,g=l.type,S=l.memoizedProps;switch(h[Cn]=l,h[xt]=S,g){case"dialog":Fr("cancel",h),Fr("close",h);break;case"iframe":case"object":case"embed":Fr("load",h);break;case"video":case"audio":for(g=0;g<Wh.length;g++)Fr(Wh[g],h);break;case"source":Fr("error",h);break;case"img":case"image":case"link":Fr("error",h),Fr("load",h);break;case"details":Fr("toggle",h);break;case"input":Fr("invalid",h),es(h,S.value,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name,!0);break;case"select":Fr("invalid",h);break;case"textarea":Fr("invalid",h),Cl(h,S.value,S.defaultValue,S.children)}g=S.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||S.suppressHydrationWarning===!0||Uy(h.textContent,g)?(S.popover!=null&&(Fr("beforetoggle",h),Fr("toggle",h)),S.onScroll!=null&&Fr("scroll",h),S.onScrollEnd!=null&&Fr("scrollend",h),S.onClick!=null&&(h.onclick=nr),h=!0):h=!1,h||qa(l,!0)}function Wf(l){for(Li=l.return;Li;)switch(Li.tag){case 5:case 31:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:Li=Li.return}}function Cs(l){if(l!==Li)return!1;if(!Rr)return Wf(l),Rr=!0,!1;var h=l.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=l.type,g=!(g!=="form"&&g!=="button")||Yu(l.type,l.memoizedProps)),g=!g),g&&yn&&qa(l),Wf(l),h===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));yn=Gy(l)}else if(h===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));yn=Gy(l)}else h===27?(h=yn,nu(l.type)?(l=_i,_i=null,yn=l):yn=h):yn=Li?Kr(l.stateNode.nextSibling):null;return!0}function rl(){yn=Li=null,Rr=!1}function Ds(){var l=tl;return l!==null&&(Ao===null?Ao=l:Ao.push.apply(Ao,l),tl=null),l}function nl(l){tl===null?tl=[l]:tl.push(l)}var il=Ce(null),ns=null,_o=null;function al(l,h,g){Be(il,h._currentValue),h._currentValue=g}function Os(l){l._currentValue=il.current,nt(il)}function Yf(l,h,g){for(;l!==null;){var S=l.alternate;if((l.childLanes&h)!==h?(l.childLanes|=h,S!==null&&(S.childLanes|=h)):S!==null&&(S.childLanes&h)!==h&&(S.childLanes|=h),l===g)break;l=l.return}}function Xf(l,h,g,S){var I=l.child;for(I!==null&&(I.return=l);I!==null;){var j=I.dependencies;if(j!==null){var Q=I.child;j=j.firstContext;e:for(;j!==null;){var ce=j;j=I;for(var ke=0;ke<h.length;ke++)if(ce.context===h[ke]){j.lanes|=g,ce=j.alternate,ce!==null&&(ce.lanes|=g),Yf(j.return,g,l),S||(Q=null);break e}j=ce.next}}else if(I.tag===18){if(Q=I.return,Q===null)throw Error(o(341));Q.lanes|=g,j=Q.alternate,j!==null&&(j.lanes|=g),Yf(Q,g,l),Q=null}else Q=I.child;if(Q!==null)Q.return=I;else for(Q=I;Q!==null;){if(Q===l){Q=null;break}if(I=Q.sibling,I!==null){I.return=Q.return,Q=I;break}Q=Q.return}I=Q}}function xo(l,h,g,S){l=null;for(var I=h,j=!1;I!==null;){if(!j){if((I.flags&524288)!==0)j=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var Q=I.alternate;if(Q===null)throw Error(o(387));if(Q=Q.memoizedProps,Q!==null){var ce=I.type;Fa(I.pendingProps.value,Q.value)||(l!==null?l.push(ce):l=[ce])}}else if(I===Vt.current){if(Q=I.alternate,Q===null)throw Error(o(387));Q.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(l!==null?l.push(Ed):l=[Ed])}I=I.return}l!==null&&Xf(h,l,g,S),h.flags|=262144}function Ph(l){for(l=l.firstContext;l!==null;){if(!Fa(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function ol(l){ns=l,_o=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Pi(l){return sp(ns,l)}function Bl(l,h){return ns===null&&ol(l),sp(l,h)}function sp(l,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},_o===null){if(l===null)throw Error(o(308));_o=h,l.dependencies={lanes:0,firstContext:h},l.flags|=524288}else _o=_o.next=h;return g}var lp=typeof AbortController<"u"?AbortController:function(){var l=[],h=this.signal={aborted:!1,addEventListener:function(g,S){l.push(S)}};this.abort=function(){h.aborted=!0,l.forEach(function(g){return g()})}},up=e.unstable_scheduleCallback,vm=e.unstable_NormalPriority,ii={$$typeof:ge,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eu(){return{controller:new lp,data:new Map,refCount:0}}function Is(l){l.refCount--,l.refCount===0&&up(vm,function(){l.controller.abort()})}var na=null,bo=0,Au=0,ia=null;function ay(l,h){if(na===null){var g=na=[];bo=0,Au=xd(),ia={status:"pending",value:void 0,then:function(S){g.push(S)}}}return bo++,h.then(_m,_m),h}function _m(){if(--bo===0&&na!==null){ia!==null&&(ia.status="fulfilled");var l=na;na=null,Au=0,ia=null;for(var h=0;h<l.length;h++)(0,l[h])()}}function Ch(l,h){var g=[],S={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return l.then(function(){S.status="fulfilled",S.value=h;for(var I=0;I<g.length;I++)(0,g[I])(h)},function(I){for(S.status="rejected",S.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),S}var is=Ue.S;Ue.S=function(l,h){P_=kn(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&ay(l,h),is!==null&&is(l,h)};var Ci=Ce(null);function Mu(){var l=Ci.current;return l!==null?l:In.pooledCache}function Dh(l,h){h===null?Be(Ci,Ci.current):Be(Ci,h.pool)}function xm(){var l=Mu();return l===null?null:{parent:ii._currentValue,pool:l}}var Pu=Error(o(460)),as=Error(o(474)),wo=Error(o(542)),jt={then:function(){}};function cp(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Tc(l,h,g){switch(g=l[g],g===void 0?l.push(h):g!==h&&(h.then(nr,nr),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw l=h.reason,Kf(l),l;default:if(typeof h.status=="string")h.then(nr,nr);else{if(l=In,l!==null&&100<l.shellSuspendCounter)throw Error(o(482));l=h,l.status="pending",l.then(function(S){if(h.status==="pending"){var I=h;I.status="fulfilled",I.value=S}},function(S){if(h.status==="pending"){var I=h;I.status="rejected",I.reason=S}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw l=h.reason,Kf(l),l}throw Ta=h,Pu}}function Fl(l){try{var h=l._init;return h(l._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(Ta=g,Pu):g}}var Ta=null;function Ec(){if(Ta===null)throw Error(o(459));var l=Ta;return Ta=null,l}function Kf(l){if(l===Pu||l===wo)throw Error(o(483))}var Ac=null,os=0;function Oh(l){var h=os;return os+=1,Ac===null&&(Ac=[]),Tc(Ac,l,h)}function Cu(l,h){h=h.props.ref,l.ref=h!==void 0?h:null}function Du(l,h){throw h.$$typeof===F?Error(o(525)):(l=Object.prototype.toString.call(h),Error(o(31,l==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":l)))}function hp(l){function h($e,Le){if(l){var et=$e.deletions;et===null?($e.deletions=[Le],$e.flags|=16):et.push(Le)}}function g($e,Le){if(!l)return null;for(;Le!==null;)h($e,Le),Le=Le.sibling;return null}function S($e){for(var Le=new Map;$e!==null;)$e.key!==null?Le.set($e.key,$e):Le.set($e.index,$e),$e=$e.sibling;return Le}function I($e,Le){return $e=vo($e,Le),$e.index=0,$e.sibling=null,$e}function j($e,Le,et){return $e.index=et,l?(et=$e.alternate,et!==null?(et=et.index,et<Le?($e.flags|=67108866,Le):et):($e.flags|=67108866,Le)):($e.flags|=1048576,Le)}function Q($e){return l&&$e.alternate===null&&($e.flags|=67108866),$e}function ce($e,Le,et,wt){return Le===null||Le.tag!==6?(Le=ap(et,$e.mode,wt),Le.return=$e,Le):(Le=I(Le,et),Le.return=$e,Le)}function ke($e,Le,et,wt){var cr=et.type;return cr===W?vt($e,Le,et.props.children,wt,et.key):Le!==null&&(Le.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===rt&&Fl(cr)===Le.type)?(Le=I(Le,et.props),Cu(Le,et),Le.return=$e,Le):(Le=Gf(et.type,et.key,et.props,null,$e.mode,wt),Cu(Le,et),Le.return=$e,Le)}function Ke($e,Le,et,wt){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==et.containerInfo||Le.stateNode.implementation!==et.implementation?(Le=bc(et,$e.mode,wt),Le.return=$e,Le):(Le=I(Le,et.children||[]),Le.return=$e,Le)}function vt($e,Le,et,wt,cr){return Le===null||Le.tag!==7?(Le=kl(et,$e.mode,wt,cr),Le.return=$e,Le):(Le=I(Le,et),Le.return=$e,Le)}function At($e,Le,et){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Le=ap(""+Le,$e.mode,et),Le.return=$e,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case G:return et=Gf(Le.type,Le.key,Le.props,null,$e.mode,et),Cu(et,Le),et.return=$e,et;case K:return Le=bc(Le,$e.mode,et),Le.return=$e,Le;case rt:return Le=Fl(Le),At($e,Le,et)}if(kt(Le)||Ge(Le))return Le=kl(Le,$e.mode,et,null),Le.return=$e,Le;if(typeof Le.then=="function")return At($e,Oh(Le),et);if(Le.$$typeof===ge)return At($e,Bl($e,Le),et);Du($e,Le)}return null}function it($e,Le,et,wt){var cr=Le!==null?Le.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return cr!==null?null:ce($e,Le,""+et,wt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case G:return et.key===cr?ke($e,Le,et,wt):null;case K:return et.key===cr?Ke($e,Le,et,wt):null;case rt:return et=Fl(et),it($e,Le,et,wt)}if(kt(et)||Ge(et))return cr!==null?null:vt($e,Le,et,wt,null);if(typeof et.then=="function")return it($e,Le,Oh(et),wt);if(et.$$typeof===ge)return it($e,Le,Bl($e,et),wt);Du($e,et)}return null}function ct($e,Le,et,wt,cr){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return $e=$e.get(et)||null,ce(Le,$e,""+wt,cr);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case G:return $e=$e.get(wt.key===null?et:wt.key)||null,ke(Le,$e,wt,cr);case K:return $e=$e.get(wt.key===null?et:wt.key)||null,Ke(Le,$e,wt,cr);case rt:return wt=Fl(wt),ct($e,Le,et,wt,cr)}if(kt(wt)||Ge(wt))return $e=$e.get(et)||null,vt(Le,$e,wt,cr,null);if(typeof wt.then=="function")return ct($e,Le,et,Oh(wt),cr);if(wt.$$typeof===ge)return ct($e,Le,et,Bl(Le,wt),cr);Du(Le,wt)}return null}function er($e,Le,et,wt){for(var cr=null,Qr=null,or=Le,zr=Le=0,Wr=null;or!==null&&zr<et.length;zr++){or.index>zr?(Wr=or,or=null):Wr=or.sibling;var qr=it($e,or,et[zr],wt);if(qr===null){or===null&&(or=Wr);break}l&&or&&qr.alternate===null&&h($e,or),Le=j(qr,Le,zr),Qr===null?cr=qr:Qr.sibling=qr,Qr=qr,or=Wr}if(zr===et.length)return g($e,or),Rr&&el($e,zr),cr;if(or===null){for(;zr<et.length;zr++)or=At($e,et[zr],wt),or!==null&&(Le=j(or,Le,zr),Qr===null?cr=or:Qr.sibling=or,Qr=or);return Rr&&el($e,zr),cr}for(or=S(or);zr<et.length;zr++)Wr=ct(or,$e,zr,et[zr],wt),Wr!==null&&(l&&Wr.alternate!==null&&or.delete(Wr.key===null?zr:Wr.key),Le=j(Wr,Le,zr),Qr===null?cr=Wr:Qr.sibling=Wr,Qr=Wr);return l&&or.forEach(function(Kn){return h($e,Kn)}),Rr&&el($e,zr),cr}function _r($e,Le,et,wt){if(et==null)throw Error(o(151));for(var cr=null,Qr=null,or=Le,zr=Le=0,Wr=null,qr=et.next();or!==null&&!qr.done;zr++,qr=et.next()){or.index>zr?(Wr=or,or=null):Wr=or.sibling;var Kn=it($e,or,qr.value,wt);if(Kn===null){or===null&&(or=Wr);break}l&&or&&Kn.alternate===null&&h($e,or),Le=j(Kn,Le,zr),Qr===null?cr=Kn:Qr.sibling=Kn,Qr=Kn,or=Wr}if(qr.done)return g($e,or),Rr&&el($e,zr),cr;if(or===null){for(;!qr.done;zr++,qr=et.next())qr=At($e,qr.value,wt),qr!==null&&(Le=j(qr,Le,zr),Qr===null?cr=qr:Qr.sibling=qr,Qr=qr);return Rr&&el($e,zr),cr}for(or=S(or);!qr.done;zr++,qr=et.next())qr=ct(or,$e,zr,qr.value,wt),qr!==null&&(l&&qr.alternate!==null&&or.delete(qr.key===null?zr:qr.key),Le=j(qr,Le,zr),Qr===null?cr=qr:Qr.sibling=qr,Qr=qr);return l&&or.forEach(function(nv){return h($e,nv)}),Rr&&el($e,zr),cr}function Mn($e,Le,et,wt){if(typeof et=="object"&&et!==null&&et.type===W&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case G:e:{for(var cr=et.key;Le!==null;){if(Le.key===cr){if(cr=et.type,cr===W){if(Le.tag===7){g($e,Le.sibling),wt=I(Le,et.props.children),wt.return=$e,$e=wt;break e}}else if(Le.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===rt&&Fl(cr)===Le.type){g($e,Le.sibling),wt=I(Le,et.props),Cu(wt,et),wt.return=$e,$e=wt;break e}g($e,Le);break}else h($e,Le);Le=Le.sibling}et.type===W?(wt=kl(et.props.children,$e.mode,wt,et.key),wt.return=$e,$e=wt):(wt=Gf(et.type,et.key,et.props,null,$e.mode,wt),Cu(wt,et),wt.return=$e,$e=wt)}return Q($e);case K:e:{for(cr=et.key;Le!==null;){if(Le.key===cr)if(Le.tag===4&&Le.stateNode.containerInfo===et.containerInfo&&Le.stateNode.implementation===et.implementation){g($e,Le.sibling),wt=I(Le,et.children||[]),wt.return=$e,$e=wt;break e}else{g($e,Le);break}else h($e,Le);Le=Le.sibling}wt=bc(et,$e.mode,wt),wt.return=$e,$e=wt}return Q($e);case rt:return et=Fl(et),Mn($e,Le,et,wt)}if(kt(et))return er($e,Le,et,wt);if(Ge(et)){if(cr=Ge(et),typeof cr!="function")throw Error(o(150));return et=cr.call(et),_r($e,Le,et,wt)}if(typeof et.then=="function")return Mn($e,Le,Oh(et),wt);if(et.$$typeof===ge)return Mn($e,Le,Bl($e,et),wt);Du($e,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Le!==null&&Le.tag===6?(g($e,Le.sibling),wt=I(Le,et),wt.return=$e,$e=wt):(g($e,Le),wt=ap(et,$e.mode,wt),wt.return=$e,$e=wt),Q($e)):g($e,Le)}return function($e,Le,et,wt){try{os=0;var cr=Mn($e,Le,et,wt);return Ac=null,cr}catch(or){if(or===Pu||or===wo)throw or;var Qr=yo(29,or,null,$e.mode);return Qr.lanes=wt,Qr.return=$e,Qr}}}var sl=hp(!0),Ih=hp(!1),zs=!1;function Qf(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zh(l,h){l=l.updateQueue,h.updateQueue===l&&(h.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function ll(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function ks(l,h,g){var S=l.updateQueue;if(S===null)return null;if(S=S.shared,(pn&2)!==0){var I=S.pending;return I===null?h.next=h:(h.next=I.next,I.next=h),S.pending=h,h=xc(l),ip(l,null,g),h}return Mh(l,S,h,g),xc(l)}function So(l,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var S=h.lanes;S&=l.pendingLanes,g|=S,h.lanes=g,hn(l,g)}}function ln(l,h){var g=l.updateQueue,S=l.alternate;if(S!==null&&(S=S.updateQueue,g===S)){var I=null,j=null;if(g=g.firstBaseUpdate,g!==null){do{var Q={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};j===null?I=j=Q:j=j.next=Q,g=g.next}while(g!==null);j===null?I=j=h:j=j.next=h}else I=j=h;g={baseState:S.baseState,firstBaseUpdate:I,lastBaseUpdate:j,shared:S.shared,callbacks:S.callbacks},l.updateQueue=g;return}l=g.lastBaseUpdate,l===null?g.firstBaseUpdate=h:l.next=h,g.lastBaseUpdate=h}var Jf=!1;function Ul(){if(Jf){var l=ia;if(l!==null)throw l}}function ul(l,h,g,S){Jf=!1;var I=l.updateQueue;zs=!1;var j=I.firstBaseUpdate,Q=I.lastBaseUpdate,ce=I.shared.pending;if(ce!==null){I.shared.pending=null;var ke=ce,Ke=ke.next;ke.next=null,Q===null?j=Ke:Q.next=Ke,Q=ke;var vt=l.alternate;vt!==null&&(vt=vt.updateQueue,ce=vt.lastBaseUpdate,ce!==Q&&(ce===null?vt.firstBaseUpdate=Ke:ce.next=Ke,vt.lastBaseUpdate=ke))}if(j!==null){var At=I.baseState;Q=0,vt=Ke=ke=null,ce=j;do{var it=ce.lane&-536870913,ct=it!==ce.lane;if(ct?(Hr&it)===it:(S&it)===it){it!==0&&it===Au&&(Jf=!0),vt!==null&&(vt=vt.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var er=l,_r=ce;it=h;var Mn=g;switch(_r.tag){case 1:if(er=_r.payload,typeof er=="function"){At=er.call(Mn,At,it);break e}At=er;break e;case 3:er.flags=er.flags&-65537|128;case 0:if(er=_r.payload,it=typeof er=="function"?er.call(Mn,At,it):er,it==null)break e;At=k({},At,it);break e;case 2:zs=!0}}it=ce.callback,it!==null&&(l.flags|=64,ct&&(l.flags|=8192),ct=I.callbacks,ct===null?I.callbacks=[it]:ct.push(it))}else ct={lane:it,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},vt===null?(Ke=vt=ct,ke=At):vt=vt.next=ct,Q|=it;if(ce=ce.next,ce===null){if(ce=I.shared.pending,ce===null)break;ct=ce,ce=ct.next,ct.next=null,I.lastBaseUpdate=ct,I.shared.pending=null}}while(!0);vt===null&&(ke=At),I.baseState=ke,I.firstBaseUpdate=Ke,I.lastBaseUpdate=vt,j===null&&(I.shared.lanes=0),Lc|=Q,l.lanes=Q,l.memoizedState=At}}function ed(l,h){if(typeof l!="function")throw Error(o(191,l));l.call(h)}function td(l,h){var g=l.callbacks;if(g!==null)for(l.callbacks=null,l=0;l<g.length;l++)ed(g[l],h)}var Vl=Ce(null),kh=Ce(0);function bm(l,h){l=fl,Be(kh,l),Be(Vl,h),fl=l|h.baseLanes}function To(){Be(kh,fl),Be(Vl,Vl.current)}function Ou(){fl=kh.current,nt(Vl),nt(kh)}var Bt=Ce(null),Kt=null;function Ea(l){var h=l.alternate;Be(Wn,Wn.current&1),Be(Bt,l),Kt===null&&(h===null||Vl.current!==null||h.memoizedState!==null)&&(Kt=l)}function rd(l){Be(Wn,Wn.current),Be(Bt,l),Kt===null&&(Kt=l)}function Iu(l){l.tag===22?(Be(Wn,Wn.current),Be(Bt,l),Kt===null&&(Kt=l)):ai()}function ai(){Be(Wn,Wn.current),Be(Bt,Bt.current)}function Hn(l){nt(Bt),Kt===l&&(Kt=null),nt(Wn)}var Wn=Ce(0);function Rh(l){for(var h=l;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||ds(g)||Xu(g)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Rs=0,Pr=null,en=null,Er=null,Rn=!1,zu=!1,aa=!1,ku=0,Ru=0,ql=null,nd=0;function On(){throw Error(o(321))}function jh(l,h){if(h===null)return!1;for(var g=0;g<h.length&&g<l.length;g++)if(!Fa(l[g],h[g]))return!1;return!0}function ss(l,h,g,S,I,j){return Rs=j,Pr=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Ue.H=l===null||l.memoizedState===null?un:Tn,aa=!1,j=g(S,I),aa=!1,zu&&(j=Mc(h,g,S,I)),Lh(l),j}function Lh(l){Ue.H=Ki;var h=en!==null&&en.next!==null;if(Rs=0,Er=en=Pr=null,Rn=!1,Ru=0,ql=null,h)throw Error(o(300));l===null||Ni||(l=l.dependencies,l!==null&&Ph(l)&&(Ni=!0))}function Mc(l,h,g,S){Pr=l;var I=0;do{if(zu&&(ql=null),Ru=0,zu=!1,25<=I)throw Error(o(301));if(I+=1,Er=en=null,l.updateQueue!=null){var j=l.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}Ue.H=Za,j=h(g,S)}while(zu);return j}function id(){var l=Ue.H,h=l.useState()[0];return h=typeof h.then=="function"?ls(h):h,l=l.useState()[0],(en!==null?en.memoizedState:null)!==l&&(Pr.flags|=1024),h}function ju(){var l=ku!==0;return ku=0,l}function Nh(l,h,g){h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~g}function $l(l){if(Rn){for(l=l.memoizedState;l!==null;){var h=l.queue;h!==null&&(h.pending=null),l=l.next}Rn=!1}Rs=0,Er=en=Pr=null,zu=!1,Ru=ku=0,ql=null}function hi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Pr.memoizedState=Er=l:Er=Er.next=l,Er}function Un(){if(en===null){var l=Pr.alternate;l=l!==null?l.memoizedState:null}else l=en.next;var h=Er===null?Pr.memoizedState:Er.next;if(h!==null)Er=h,en=l;else{if(l===null)throw Pr.alternate===null?Error(o(467)):Error(o(310));en=l,l={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},Er===null?Pr.memoizedState=Er=l:Er=Er.next=l}return Er}function Lu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ls(l){var h=Ru;return Ru+=1,ql===null&&(ql=[]),l=Tc(ql,l,h),h=Pr,(Er===null?h.memoizedState:Er.next)===null&&(h=h.alternate,Ue.H=h===null||h.memoizedState===null?un:Tn),l}function Nu(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return ls(l);if(l.$$typeof===ge)return Pi(l)}throw Error(o(438,String(l)))}function Bh(l){var h=null,g=Pr.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var S=Pr.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(h={data:S.data.map(function(I){return I.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=Lu(),Pr.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(l),S=0;S<l;S++)g[S]=yt;return h.index++,g}function No(l,h){return typeof h=="function"?h(l):h}function Pc(l){var h=Un();return w(h,en,l)}function w(l,h,g){var S=l.queue;if(S===null)throw Error(o(311));S.lastRenderedReducer=g;var I=l.baseQueue,j=S.pending;if(j!==null){if(I!==null){var Q=I.next;I.next=j.next,j.next=Q}h.baseQueue=I=j,S.pending=null}if(j=l.baseState,I===null)l.memoizedState=j;else{h=I.next;var ce=Q=null,ke=null,Ke=h,vt=!1;do{var At=Ke.lane&-536870913;if(At!==Ke.lane?(Hr&At)===At:(Rs&At)===At){var it=Ke.revertLane;if(it===0)ke!==null&&(ke=ke.next={lane:0,revertLane:0,gesture:null,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null}),At===Au&&(vt=!0);else if((Rs&it)===it){Ke=Ke.next,it===Au&&(vt=!0);continue}else At={lane:0,revertLane:Ke.revertLane,gesture:null,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},ke===null?(ce=ke=At,Q=j):ke=ke.next=At,Pr.lanes|=it,Lc|=it;At=Ke.action,aa&&g(j,At),j=Ke.hasEagerState?Ke.eagerState:g(j,At)}else it={lane:At,revertLane:Ke.revertLane,gesture:Ke.gesture,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},ke===null?(ce=ke=it,Q=j):ke=ke.next=it,Pr.lanes|=At,Lc|=At;Ke=Ke.next}while(Ke!==null&&Ke!==h);if(ke===null?Q=j:ke.next=ce,!Fa(j,l.memoizedState)&&(Ni=!0,vt&&(g=ia,g!==null)))throw g;l.memoizedState=j,l.baseState=Q,l.baseQueue=ke,S.lastRenderedState=j}return I===null&&(S.lanes=0),[l.memoizedState,S.dispatch]}function n(l){var h=Un(),g=h.queue;if(g===null)throw Error(o(311));g.lastRenderedReducer=l;var S=g.dispatch,I=g.pending,j=h.memoizedState;if(I!==null){g.pending=null;var Q=I=I.next;do j=l(j,Q.action),Q=Q.next;while(Q!==I);Fa(j,h.memoizedState)||(Ni=!0),h.memoizedState=j,h.baseQueue===null&&(h.baseState=j),g.lastRenderedState=j}return[j,S]}function u(l,h,g){var S=Pr,I=Un(),j=Rr;if(j){if(g===void 0)throw Error(o(407));g=g()}else g=h();var Q=!Fa((en||I).memoizedState,g);if(Q&&(I.memoizedState=g,Ni=!0),I=I.queue,He(T.bind(null,S,I,l),[l]),I.getSnapshot!==h||Q||Er!==null&&Er.memoizedState.tag&1){if(S.flags|=2048,De(9,{destroy:void 0},v.bind(null,S,I,g,h),null),In===null)throw Error(o(349));j||(Rs&127)!==0||d(S,h,g)}return g}function d(l,h,g){l.flags|=16384,l={getSnapshot:h,value:g},h=Pr.updateQueue,h===null?(h=Lu(),Pr.updateQueue=h,h.stores=[l]):(g=h.stores,g===null?h.stores=[l]:g.push(l))}function v(l,h,g,S){h.value=g,h.getSnapshot=S,A(h)&&O(l)}function T(l,h,g){return g(function(){A(h)&&O(l)})}function A(l){var h=l.getSnapshot;l=l.value;try{var g=h();return!Fa(l,g)}catch{return!0}}function O(l){var h=Lo(l,2);h!==null&&Mo(h,l,2)}function R(l){var h=hi();if(typeof l=="function"){var g=l;if(l=g(),aa){_e(!0);try{g()}finally{_e(!1)}}}return h.memoizedState=h.baseState=l,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:l},h}function B(l,h,g,S){return l.baseState=g,w(l,en,typeof S=="function"?S:No)}function V(l,h,g,S,I){if(Xi(l))throw Error(o(485));if(l=h.action,l!==null){var j={payload:I,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){j.listeners.push(Q)}};Ue.T!==null?g(!0):j.isTransition=!1,S(j),g=h.pending,g===null?(j.next=h.pending=j,X(h,j)):(j.next=g.next,h.pending=g.next=j)}}function X(l,h){var g=h.action,S=h.payload,I=l.state;if(h.isTransition){var j=Ue.T,Q={};Ue.T=Q;try{var ce=g(I,S),ke=Ue.S;ke!==null&&ke(Q,ce),Y(l,h,ce)}catch(Ke){oe(l,h,Ke)}finally{j!==null&&Q.types!==null&&(j.types=Q.types),Ue.T=j}}else try{j=g(I,S),Y(l,h,j)}catch(Ke){oe(l,h,Ke)}}function Y(l,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(S){re(l,h,S)},function(S){return oe(l,h,S)}):re(l,h,g)}function re(l,h,g){h.status="fulfilled",h.value=g,he(h),l.state=g,h=l.pending,h!==null&&(g=h.next,g===h?l.pending=null:(g=g.next,h.next=g,X(l,g)))}function oe(l,h,g){var S=l.pending;if(l.pending=null,S!==null){S=S.next;do h.status="rejected",h.reason=g,he(h),h=h.next;while(h!==S)}l.action=null}function he(l){l=l.listeners;for(var h=0;h<l.length;h++)(0,l[h])()}function pe(l,h){return h}function de(l,h){if(Rr){var g=In.formState;if(g!==null){e:{var S=Pr;if(Rr){if(yn){t:{for(var I=yn,j=Va;I.nodeType!==8;){if(!j){I=null;break t}if(I=Kr(I.nextSibling),I===null){I=null;break t}}j=I.data,I=j==="F!"||j==="F"?I:null}if(I){yn=Kr(I.nextSibling),S=I.data==="F!";break e}}qa(S)}S=!1}S&&(h=g[0])}}return g=hi(),g.memoizedState=g.baseState=h,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pe,lastRenderedState:h},g.queue=S,g=Cc.bind(null,Pr,S),S.dispatch=g,S=R(!1),j=Gl.bind(null,Pr,!1,S.queue),S=hi(),I={state:h,dispatch:null,action:l,pending:null},S.queue=I,g=V.bind(null,Pr,I,j,g),I.dispatch=g,S.memoizedState=l,[h,g,!1]}function xe(l){var h=Un();return Ee(h,en,l)}function Ee(l,h,g){if(h=w(l,h,pe)[0],l=Pc(No)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var S=ls(h)}catch(Q){throw Q===Pu?wo:Q}else S=h;h=Un();var I=h.queue,j=I.dispatch;return g!==h.memoizedState&&(Pr.flags|=2048,De(9,{destroy:void 0},ve.bind(null,I,g),null)),[S,j,l]}function ve(l,h){l.action=h}function Pe(l){var h=Un(),g=en;if(g!==null)return Ee(h,g,l);Un(),h=h.memoizedState,g=Un();var S=g.queue.dispatch;return g.memoizedState=l,[h,S,!1]}function De(l,h,g,S){return l={tag:l,create:g,deps:S,inst:h,next:null},h=Pr.updateQueue,h===null&&(h=Lu(),Pr.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=l.next=l:(S=g.next,g.next=l,l.next=S,h.lastEffect=l),l}function we(){return Un().memoizedState}function Re(l,h,g,S){var I=hi();Pr.flags|=l,I.memoizedState=De(1|h,{destroy:void 0},g,S===void 0?null:S)}function Qe(l,h,g,S){var I=Un();S=S===void 0?null:S;var j=I.memoizedState.inst;en!==null&&S!==null&&jh(S,en.memoizedState.deps)?I.memoizedState=De(h,j,g,S):(Pr.flags|=l,I.memoizedState=De(1|h,j,g,S))}function Ye(l,h){Re(8390656,8,l,h)}function He(l,h){Qe(2048,8,l,h)}function Je(l){Pr.flags|=4;var h=Pr.updateQueue;if(h===null)h=Lu(),Pr.updateQueue=h,h.events=[l];else{var g=h.events;g===null?h.events=[l]:g.push(l)}}function Ct(l){var h=Un().memoizedState;return Je({ref:h,nextImpl:l}),function(){if((pn&2)!==0)throw Error(o(440));return h.impl.apply(void 0,arguments)}}function Dt(l,h){return Qe(4,2,l,h)}function ut(l,h){return Qe(4,4,l,h)}function Zt(l,h){if(typeof h=="function"){l=l();var g=h(l);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return l=l(),h.current=l,function(){h.current=null}}function vr(l,h,g){g=g!=null?g.concat([l]):null,Qe(4,4,Zt.bind(null,h,l),g)}function Xr(){}function vn(l,h){var g=Un();h=h===void 0?null:h;var S=g.memoizedState;return h!==null&&jh(h,S[1])?S[0]:(g.memoizedState=[l,h],l)}function dn(l,h){var g=Un();h=h===void 0?null:h;var S=g.memoizedState;if(h!==null&&jh(h,S[1]))return S[0];if(S=l(),aa){_e(!0);try{l()}finally{_e(!1)}}return g.memoizedState=[S,h],S}function Sn(l,h,g){return g===void 0||(Rs&1073741824)!==0&&(Hr&261930)===0?l.memoizedState=h:(l.memoizedState=g,l=D_(),Pr.lanes|=l,Lc|=l,g)}function tn(l,h,g,S){return Fa(g,h)?g:Vl.current!==null?(l=Sn(l,g,S),Fa(l,h)||(Ni=!0),l):(Rs&42)===0||(Rs&1073741824)!==0&&(Hr&261930)===0?(Ni=!0,l.memoizedState=g):(l=D_(),Pr.lanes|=l,Lc|=l,h)}function fi(l,h,g,S,I){var j=at.p;at.p=j!==0&&8>j?j:8;var Q=Ue.T,ce={};Ue.T=ce,Gl(l,!1,h,g);try{var ke=I(),Ke=Ue.S;if(Ke!==null&&Ke(ce,ke),ke!==null&&typeof ke=="object"&&typeof ke.then=="function"){var vt=Ch(ke,S);hl(l,h,vt,fs(l))}else hl(l,h,S,fs(l))}catch(At){hl(l,h,{then:function(){},status:"rejected",reason:At},fs())}finally{at.p=j,Q!==null&&ce.types!==null&&(Q.types=ce.types),Ue.T=Q}}function jn(){}function Di(l,h,g,S){if(l.tag!==5)throw Error(o(476));var I=Vn(l).queue;fi(l,I,h,pt,g===null?jn:function(){return qn(l),g(S)})}function Vn(l){var h=l.memoizedState;if(h!==null)return h;h={memoizedState:pt,baseState:pt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:pt},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:g},next:null},l.memoizedState=h,l=l.alternate,l!==null&&(l.memoizedState=h),h}function qn(l){var h=Vn(l);h.next===null&&(h=l.alternate.memoizedState),hl(l,h.next.queue,{},fs())}function Yi(){return Pi(Ed)}function js(){return Un().memoizedState}function us(){return Un().memoizedState}function Aa(l){for(var h=l.return;h!==null;){switch(h.tag){case 24:case 3:var g=fs();l=ll(g);var S=ks(h,l,g);S!==null&&(Mo(S,h,g),So(S,h,g)),h={cache:Eu()},l.payload=h;return}h=h.return}}function cl(l,h,g){var S=fs();g={lane:S,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Xi(l)?Eo(h,g):(g=zl(l,h,g,S),g!==null&&(Mo(g,l,S),Ga(g,h,S)))}function Cc(l,h,g){var S=fs();hl(l,h,g,S)}function hl(l,h,g,S){var I={lane:S,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Xi(l))Eo(h,I);else{var j=l.alternate;if(l.lanes===0&&(j===null||j.lanes===0)&&(j=h.lastRenderedReducer,j!==null))try{var Q=h.lastRenderedState,ce=j(Q,g);if(I.hasEagerState=!0,I.eagerState=ce,Fa(ce,Q))return Mh(l,h,I,0),In===null&&Su(),!1}catch{}if(g=zl(l,h,I,S),g!==null)return Mo(g,l,S),Ga(g,h,S),!0}return!1}function Gl(l,h,g,S){if(S={lane:2,revertLane:xd(),gesture:null,action:S,hasEagerState:!1,eagerState:null,next:null},Xi(l)){if(h)throw Error(o(479))}else h=zl(l,g,S,2),h!==null&&Mo(h,l,2)}function Xi(l){var h=l.alternate;return l===Pr||h!==null&&h===Pr}function Eo(l,h){zu=Rn=!0;var g=l.pending;g===null?h.next=h:(h.next=g.next,g.next=h),l.pending=h}function Ga(l,h,g){if((g&4194048)!==0){var S=h.lanes;S&=l.pendingLanes,g|=S,h.lanes=g,hn(l,g)}}var Ki={readContext:Pi,use:Nu,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useLayoutEffect:On,useInsertionEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useSyncExternalStore:On,useId:On,useHostTransitionStatus:On,useFormState:On,useActionState:On,useOptimistic:On,useMemoCache:On,useCacheRefresh:On};Ki.useEffectEvent=On;var un={readContext:Pi,use:Nu,useCallback:function(l,h){return hi().memoizedState=[l,h===void 0?null:h],l},useContext:Pi,useEffect:Ye,useImperativeHandle:function(l,h,g){g=g!=null?g.concat([l]):null,Re(4194308,4,Zt.bind(null,h,l),g)},useLayoutEffect:function(l,h){return Re(4194308,4,l,h)},useInsertionEffect:function(l,h){Re(4,2,l,h)},useMemo:function(l,h){var g=hi();h=h===void 0?null:h;var S=l();if(aa){_e(!0);try{l()}finally{_e(!1)}}return g.memoizedState=[S,h],S},useReducer:function(l,h,g){var S=hi();if(g!==void 0){var I=g(h);if(aa){_e(!0);try{g(h)}finally{_e(!1)}}}else I=h;return S.memoizedState=S.baseState=I,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:I},S.queue=l,l=l.dispatch=cl.bind(null,Pr,l),[S.memoizedState,l]},useRef:function(l){var h=hi();return l={current:l},h.memoizedState=l},useState:function(l){l=R(l);var h=l.queue,g=Cc.bind(null,Pr,h);return h.dispatch=g,[l.memoizedState,g]},useDebugValue:Xr,useDeferredValue:function(l,h){var g=hi();return Sn(g,l,h)},useTransition:function(){var l=R(!1);return l=fi.bind(null,Pr,l.queue,!0,!1),hi().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,h,g){var S=Pr,I=hi();if(Rr){if(g===void 0)throw Error(o(407));g=g()}else{if(g=h(),In===null)throw Error(o(349));(Hr&127)!==0||d(S,h,g)}I.memoizedState=g;var j={value:g,getSnapshot:h};return I.queue=j,Ye(T.bind(null,S,j,l),[l]),S.flags|=2048,De(9,{destroy:void 0},v.bind(null,S,j,g,h),null),g},useId:function(){var l=hi(),h=In.identifierPrefix;if(Rr){var g=Ua,S=Ps;g=(S&~(1<<32-Te(S)-1)).toString(32)+g,h="_"+h+"R_"+g,g=ku++,0<g&&(h+="H"+g.toString(32)),h+="_"}else g=nd++,h="_"+h+"r_"+g.toString(32)+"_";return l.memoizedState=h},useHostTransitionStatus:Yi,useFormState:de,useActionState:de,useOptimistic:function(l){var h=hi();h.memoizedState=h.baseState=l;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=Gl.bind(null,Pr,!0,g),g.dispatch=h,[l,h]},useMemoCache:Bh,useCacheRefresh:function(){return hi().memoizedState=Aa.bind(null,Pr)},useEffectEvent:function(l){var h=hi(),g={impl:l};return h.memoizedState=g,function(){if((pn&2)!==0)throw Error(o(440));return g.impl.apply(void 0,arguments)}}},Tn={readContext:Pi,use:Nu,useCallback:vn,useContext:Pi,useEffect:He,useImperativeHandle:vr,useInsertionEffect:Dt,useLayoutEffect:ut,useMemo:dn,useReducer:Pc,useRef:we,useState:function(){return Pc(No)},useDebugValue:Xr,useDeferredValue:function(l,h){var g=Un();return tn(g,en.memoizedState,l,h)},useTransition:function(){var l=Pc(No)[0],h=Un().memoizedState;return[typeof l=="boolean"?l:ls(l),h]},useSyncExternalStore:u,useId:js,useHostTransitionStatus:Yi,useFormState:xe,useActionState:xe,useOptimistic:function(l,h){var g=Un();return B(g,en,l,h)},useMemoCache:Bh,useCacheRefresh:us};Tn.useEffectEvent=Ct;var Za={readContext:Pi,use:Nu,useCallback:vn,useContext:Pi,useEffect:He,useImperativeHandle:vr,useInsertionEffect:Dt,useLayoutEffect:ut,useMemo:dn,useReducer:n,useRef:we,useState:function(){return n(No)},useDebugValue:Xr,useDeferredValue:function(l,h){var g=Un();return en===null?Sn(g,l,h):tn(g,en.memoizedState,l,h)},useTransition:function(){var l=n(No)[0],h=Un().memoizedState;return[typeof l=="boolean"?l:ls(l),h]},useSyncExternalStore:u,useId:js,useHostTransitionStatus:Yi,useFormState:Pe,useActionState:Pe,useOptimistic:function(l,h){var g=Un();return en!==null?B(g,en,l,h):(g.baseState=l,[l,g.queue.dispatch])},useMemoCache:Bh,useCacheRefresh:us};Za.useEffectEvent=Ct;function di(l,h,g,S){h=l.memoizedState,g=g(S,h),g=g==null?h:k({},h,g),l.memoizedState=g,l.lanes===0&&(l.updateQueue.baseState=g)}var ad={enqueueSetState:function(l,h,g){l=l._reactInternals;var S=fs(),I=ll(S);I.payload=h,g!=null&&(I.callback=g),h=ks(l,I,S),h!==null&&(Mo(h,l,S),So(h,l,S))},enqueueReplaceState:function(l,h,g){l=l._reactInternals;var S=fs(),I=ll(S);I.tag=1,I.payload=h,g!=null&&(I.callback=g),h=ks(l,I,S),h!==null&&(Mo(h,l,S),So(h,l,S))},enqueueForceUpdate:function(l,h){l=l._reactInternals;var g=fs(),S=ll(g);S.tag=2,h!=null&&(S.callback=h),h=ks(l,S,g),h!==null&&(Mo(h,l,g),So(h,l,g))}};function Zl(l,h,g,S,I,j,Q){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(S,j,Q):h.prototype&&h.prototype.isPureReactComponent?!Il(g,S)||!Il(I,j):!0}function wm(l,h,g,S){l=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,S),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,S),h.state!==l&&ad.enqueueReplaceState(h,h.state,null)}function Hl(l,h){var g=h;if("ref"in h){g={};for(var S in h)S!=="ref"&&(g[S]=h[S])}if(l=l.defaultProps){g===h&&(g=k({},g));for(var I in l)g[I]===void 0&&(g[I]=l[I])}return g}function od(l){Ms(l)}function fp(l){console.error(l)}function Ha(l){Ms(l)}function cs(l,h){try{var g=l.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(S){setTimeout(function(){throw S})}}function sd(l,h,g){try{var S=l.onCaughtError;S(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function ld(l,h,g){return g=ll(g),g.tag=3,g.payload={element:null},g.callback=function(){cs(l,h)},g}function Dc(l){return l=ll(l),l.tag=3,l}function ud(l,h,g,S){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var j=S.value;l.payload=function(){return I(j)},l.callback=function(){sd(h,g,S)}}var Q=g.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(l.callback=function(){sd(h,g,S),typeof I!="function"&&(Gu===null?Gu=new Set([this]):Gu.add(this));var ce=S.stack;this.componentDidCatch(S.value,{componentStack:ce!==null?ce:""})})}function Oc(l,h,g,S,I){if(g.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(h=g.alternate,h!==null&&xo(h,g,I,!0),g=Bt.current,g!==null){switch(g.tag){case 31:case 13:return Kt===null?Hu():g.alternate===null&&vi===0&&(vi=3),g.flags&=-257,g.flags|=65536,g.lanes=I,S===jt?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([S]):h.add(S),Ym(l,S,I)),!1;case 22:return g.flags|=65536,S===jt?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([S])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([S]):g.add(S)),Ym(l,S,I)),!1}throw Error(o(435,g.tag))}return Ym(l,S,I),Hu(),!1}if(Rr)return h=Bt.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=I,S!==Fn&&(l=Error(o(422),{cause:S}),nl(Sa(l,g)))):(S!==Fn&&(h=Error(o(423),{cause:S}),nl(Sa(h,g))),l=l.current.alternate,l.flags|=65536,I&=-I,l.lanes|=I,S=Sa(S,g),I=ld(l.stateNode,S,I),ln(l,I),vi!==4&&(vi=2)),!1;var j=Error(o(520),{cause:S});if(j=Sa(j,g),$u===null?$u=[j]:$u.push(j),vi!==4&&(vi=2),h===null)return!0;S=Sa(S,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,l=I&-I,g.lanes|=l,l=ld(g.stateNode,S,l),ln(g,l),!1;case 1:if(h=g.type,j=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Gu===null||!Gu.has(j))))return g.flags|=65536,I&=-I,g.lanes|=I,I=Dc(I),ud(I,l,g,S),ln(g,I),!1}g=g.return}while(g!==null);return!1}var Sm=Error(o(461)),Ni=!1;function Qi(l,h,g,S){h.child=l===null?Ih(h,null,g,S):sl(h,l.child,g,S)}function m_(l,h,g,S,I){g=g.render;var j=h.ref;if("ref"in S){var Q={};for(var ce in S)ce!=="ref"&&(Q[ce]=S[ce])}else Q=S;return ol(h),S=ss(l,h,g,Q,j,I),ce=ju(),l!==null&&!Ni?(Nh(l,h,I),Yl(l,h,I)):(Rr&&ce&&wc(h),h.flags|=1,Qi(l,h,S,I),h.child)}function Tm(l,h,g,S,I){if(l===null){var j=g.type;return typeof j=="function"&&!$f(j)&&j.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=j,oy(l,h,j,S,I)):(l=Gf(g.type,null,S,h,h.mode,I),l.ref=h.ref,l.return=h,h.child=l)}if(j=l.child,!mp(l,I)){var Q=j.memoizedProps;if(g=g.compare,g=g!==null?g:Il,g(Q,S)&&l.ref===h.ref)return Yl(l,h,I)}return h.flags|=1,l=vo(j,S),l.ref=h.ref,l.return=h,h.child=l}function oy(l,h,g,S,I){if(l!==null){var j=l.memoizedProps;if(Il(j,S)&&l.ref===h.ref)if(Ni=!1,h.pendingProps=S=j,mp(l,I))(l.flags&131072)!==0&&(Ni=!0);else return h.lanes=l.lanes,Yl(l,h,I)}return ly(l,h,g,S,I)}function sy(l,h,g,S){var I=S.children,j=l!==null?l.memoizedState:null;if(l===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),S.mode==="hidden"){if((h.flags&128)!==0){if(j=j!==null?j.baseLanes|g:g,l!==null){for(S=h.child=l.child,I=0;S!==null;)I=I|S.lanes|S.childLanes,S=S.sibling;S=I&~j}else S=0,h.child=null;return g_(l,h,j,g,S)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},l!==null&&Dh(h,j!==null?j.cachePool:null),j!==null?bm(h,j):To(),Iu(h);else return S=h.lanes=536870912,g_(l,h,j!==null?j.baseLanes|g:g,g,S)}else j!==null?(Dh(h,j.cachePool),bm(h,j),ai(),h.memoizedState=null):(l!==null&&Dh(h,null),To(),ai());return Qi(l,h,I,g),h.child}function Wl(l,h){return l!==null&&l.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function g_(l,h,g,S,I){var j=Mu();return j=j===null?null:{parent:ii._currentValue,pool:j},h.memoizedState={baseLanes:g,cachePool:j},l!==null&&Dh(h,null),To(),Iu(h),l!==null&&xo(l,h,S,!0),h.childLanes=I,null}function Bu(l,h){return h=Cm({mode:h.mode,children:h.children},l.mode),h.ref=l.ref,l.child=h,h.return=l,h}function dp(l,h,g){return sl(h,l.child,null,g),l=Bu(h,h.pendingProps),l.flags|=2,Hn(h),h.memoizedState=null,l}function Em(l,h,g){var S=h.pendingProps,I=(h.flags&128)!==0;if(h.flags&=-129,l===null){if(Rr){if(S.mode==="hidden")return l=Bu(h,S),h.lanes=536870912,Wl(null,l);if(rd(h),(l=yn)?(l=Ji(l,Va),l=l!==null&&l.data==="&"?l:null,l!==null&&(h.memoizedState={dehydrated:l,treeContext:rs!==null?{id:Ps,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},g=Zf(l),g.return=h,h.child=g,Li=h,yn=null)):l=null,l===null)throw qa(h);return h.lanes=536870912,null}return Bu(h,S)}var j=l.memoizedState;if(j!==null){var Q=j.dehydrated;if(rd(h),I)if(h.flags&256)h.flags&=-257,h=dp(l,h,g);else if(h.memoizedState!==null)h.child=l.child,h.flags|=128,h=null;else throw Error(o(558));else if(Ni||xo(l,h,g,!1),I=(g&l.childLanes)!==0,Ni||I){if(S=In,S!==null&&(Q=ui(S,g),Q!==0&&Q!==j.retryLane))throw j.retryLane=Q,Lo(l,Q),Mo(S,l,Q),Sm;Hu(),h=dp(l,h,g)}else l=j.treeContext,yn=Kr(Q.nextSibling),Li=h,Rr=!0,tl=null,Va=!1,l!==null&&Hf(h,l),h=Bu(h,S),h.flags|=4096;return h}return l=vo(l.child,{mode:S.mode,children:S.children}),l.ref=h.ref,h.child=l,l.return=h,l}function Am(l,h){var g=h.ref;if(g===null)l!==null&&l.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(o(284));(l===null||l.ref!==g)&&(h.flags|=4194816)}}function ly(l,h,g,S,I){return ol(h),g=ss(l,h,g,S,void 0,I),S=ju(),l!==null&&!Ni?(Nh(l,h,I),Yl(l,h,I)):(Rr&&S&&wc(h),h.flags|=1,Qi(l,h,g,I),h.child)}function y_(l,h,g,S,I,j){return ol(h),h.updateQueue=null,g=Mc(h,S,g,I),Lh(l),S=ju(),l!==null&&!Ni?(Nh(l,h,j),Yl(l,h,j)):(Rr&&S&&wc(h),h.flags|=1,Qi(l,h,g,j),h.child)}function v_(l,h,g,S,I){if(ol(h),h.stateNode===null){var j=wr,Q=g.contextType;typeof Q=="object"&&Q!==null&&(j=Pi(Q)),j=new g(S,j),h.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=ad,h.stateNode=j,j._reactInternals=h,j=h.stateNode,j.props=S,j.state=h.memoizedState,j.refs={},Qf(h),Q=g.contextType,j.context=typeof Q=="object"&&Q!==null?Pi(Q):wr,j.state=h.memoizedState,Q=g.getDerivedStateFromProps,typeof Q=="function"&&(di(h,g,Q,S),j.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(Q=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),Q!==j.state&&ad.enqueueReplaceState(j,j.state,null),ul(h,S,j,I),Ul(),j.state=h.memoizedState),typeof j.componentDidMount=="function"&&(h.flags|=4194308),S=!0}else if(l===null){j=h.stateNode;var ce=h.memoizedProps,ke=Hl(g,ce);j.props=ke;var Ke=j.context,vt=g.contextType;Q=wr,typeof vt=="object"&&vt!==null&&(Q=Pi(vt));var At=g.getDerivedStateFromProps;vt=typeof At=="function"||typeof j.getSnapshotBeforeUpdate=="function",ce=h.pendingProps!==ce,vt||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(ce||Ke!==Q)&&wm(h,j,S,Q),zs=!1;var it=h.memoizedState;j.state=it,ul(h,S,j,I),Ul(),Ke=h.memoizedState,ce||it!==Ke||zs?(typeof At=="function"&&(di(h,g,At,S),Ke=h.memoizedState),(ke=zs||Zl(h,g,ke,S,it,Ke,Q))?(vt||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(h.flags|=4194308)):(typeof j.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=S,h.memoizedState=Ke),j.props=S,j.state=Ke,j.context=Q,S=ke):(typeof j.componentDidMount=="function"&&(h.flags|=4194308),S=!1)}else{j=h.stateNode,zh(l,h),Q=h.memoizedProps,vt=Hl(g,Q),j.props=vt,At=h.pendingProps,it=j.context,Ke=g.contextType,ke=wr,typeof Ke=="object"&&Ke!==null&&(ke=Pi(Ke)),ce=g.getDerivedStateFromProps,(Ke=typeof ce=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(Q!==At||it!==ke)&&wm(h,j,S,ke),zs=!1,it=h.memoizedState,j.state=it,ul(h,S,j,I),Ul();var ct=h.memoizedState;Q!==At||it!==ct||zs||l!==null&&l.dependencies!==null&&Ph(l.dependencies)?(typeof ce=="function"&&(di(h,g,ce,S),ct=h.memoizedState),(vt=zs||Zl(h,g,vt,S,it,ct,ke)||l!==null&&l.dependencies!==null&&Ph(l.dependencies))?(Ke||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(S,ct,ke),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(S,ct,ke)),typeof j.componentDidUpdate=="function"&&(h.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof j.componentDidUpdate!="function"||Q===l.memoizedProps&&it===l.memoizedState||(h.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||Q===l.memoizedProps&&it===l.memoizedState||(h.flags|=1024),h.memoizedProps=S,h.memoizedState=ct),j.props=S,j.state=ct,j.context=ke,S=vt):(typeof j.componentDidUpdate!="function"||Q===l.memoizedProps&&it===l.memoizedState||(h.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||Q===l.memoizedProps&&it===l.memoizedState||(h.flags|=1024),S=!1)}return j=S,Am(l,h),S=(h.flags&128)!==0,j||S?(j=h.stateNode,g=S&&typeof g.getDerivedStateFromError!="function"?null:j.render(),h.flags|=1,l!==null&&S?(h.child=sl(h,l.child,null,I),h.child=sl(h,null,g,I)):Qi(l,h,g,I),h.memoizedState=j.state,l=h.child):l=Yl(l,h,I),l}function __(l,h,g,S){return rl(),h.flags|=256,Qi(l,h,g,S),h.child}var Mm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pp(l){return{baseLanes:l,cachePool:xm()}}function Pm(l,h,g){return l=l!==null?l.childLanes&~g:0,h&&(l|=hs),l}function uy(l,h,g){var S=h.pendingProps,I=!1,j=(h.flags&128)!==0,Q;if((Q=j)||(Q=l!==null&&l.memoizedState===null?!1:(Wn.current&2)!==0),Q&&(I=!0,h.flags&=-129),Q=(h.flags&32)!==0,h.flags&=-33,l===null){if(Rr){if(I?Ea(h):ai(),(l=yn)?(l=Ji(l,Va),l=l!==null&&l.data!=="&"?l:null,l!==null&&(h.memoizedState={dehydrated:l,treeContext:rs!==null?{id:Ps,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},g=Zf(l),g.return=h,h.child=g,Li=h,yn=null)):l=null,l===null)throw qa(h);return Xu(l)?h.lanes=32:h.lanes=536870912,null}var ce=S.children;return S=S.fallback,I?(ai(),I=h.mode,ce=Cm({mode:"hidden",children:ce},I),S=kl(S,I,g,null),ce.return=h,S.return=h,ce.sibling=S,h.child=ce,S=h.child,S.memoizedState=pp(g),S.childLanes=Pm(l,Q,g),h.memoizedState=Mm,Wl(null,S)):(Ea(h),cy(h,ce))}var ke=l.memoizedState;if(ke!==null&&(ce=ke.dehydrated,ce!==null)){if(j)h.flags&256?(Ea(h),h.flags&=-257,h=Dm(l,h,g)):h.memoizedState!==null?(ai(),h.child=l.child,h.flags|=128,h=null):(ai(),ce=S.fallback,I=h.mode,S=Cm({mode:"visible",children:S.children},I),ce=kl(ce,I,g,null),ce.flags|=2,S.return=h,ce.return=h,S.sibling=ce,h.child=S,sl(h,l.child,null,g),S=h.child,S.memoizedState=pp(g),S.childLanes=Pm(l,Q,g),h.memoizedState=Mm,h=Wl(null,S));else if(Ea(h),Xu(ce)){if(Q=ce.nextSibling&&ce.nextSibling.dataset,Q)var Ke=Q.dgst;Q=Ke,S=Error(o(419)),S.stack="",S.digest=Q,nl({value:S,source:null,stack:null}),h=Dm(l,h,g)}else if(Ni||xo(l,h,g,!1),Q=(g&l.childLanes)!==0,Ni||Q){if(Q=In,Q!==null&&(S=ui(Q,g),S!==0&&S!==ke.retryLane))throw ke.retryLane=S,Lo(l,S),Mo(Q,l,S),Sm;ds(ce)||Hu(),h=Dm(l,h,g)}else ds(ce)?(h.flags|=192,h.child=l.child,h=null):(l=ke.treeContext,yn=Kr(ce.nextSibling),Li=h,Rr=!0,tl=null,Va=!1,l!==null&&Hf(h,l),h=cy(h,S.children),h.flags|=4096);return h}return I?(ai(),ce=S.fallback,I=h.mode,ke=l.child,Ke=ke.sibling,S=vo(ke,{mode:"hidden",children:S.children}),S.subtreeFlags=ke.subtreeFlags&65011712,Ke!==null?ce=vo(Ke,ce):(ce=kl(ce,I,g,null),ce.flags|=2),ce.return=h,S.return=h,S.sibling=ce,h.child=S,Wl(null,S),S=h.child,ce=l.child.memoizedState,ce===null?ce=pp(g):(I=ce.cachePool,I!==null?(ke=ii._currentValue,I=I.parent!==ke?{parent:ke,pool:ke}:I):I=xm(),ce={baseLanes:ce.baseLanes|g,cachePool:I}),S.memoizedState=ce,S.childLanes=Pm(l,Q,g),h.memoizedState=Mm,Wl(l.child,S)):(Ea(h),g=l.child,l=g.sibling,g=vo(g,{mode:"visible",children:S.children}),g.return=h,g.sibling=null,l!==null&&(Q=h.deletions,Q===null?(h.deletions=[l],h.flags|=16):Q.push(l)),h.child=g,h.memoizedState=null,g)}function cy(l,h){return h=Cm({mode:"visible",children:h},l.mode),h.return=l,l.child=h}function Cm(l,h){return l=yo(22,l,null,h),l.lanes=0,l}function Dm(l,h,g){return sl(h,l.child,null,g),l=cy(h,h.pendingProps.children),l.flags|=2,h.memoizedState=null,l}function hy(l,h,g){l.lanes|=h;var S=l.alternate;S!==null&&(S.lanes|=h),Yf(l.return,h,g)}function fy(l,h,g,S,I,j){var Q=l.memoizedState;Q===null?l.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:S,tail:g,tailMode:I,treeForkCount:j}:(Q.isBackwards=h,Q.rendering=null,Q.renderingStartTime=0,Q.last=S,Q.tail=g,Q.tailMode=I,Q.treeForkCount=j)}function Om(l,h,g){var S=h.pendingProps,I=S.revealOrder,j=S.tail;S=S.children;var Q=Wn.current,ce=(Q&2)!==0;if(ce?(Q=Q&1|2,h.flags|=128):Q&=1,Be(Wn,Q),Qi(l,h,S,g),S=Rr?Nl:0,!ce&&l!==null&&(l.flags&128)!==0)e:for(l=h.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&hy(l,g,h);else if(l.tag===19)hy(l,g,h);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===h)break e;for(;l.sibling===null;){if(l.return===null||l.return===h)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(I){case"forwards":for(g=h.child,I=null;g!==null;)l=g.alternate,l!==null&&Rh(l)===null&&(I=g),g=g.sibling;g=I,g===null?(I=h.child,h.child=null):(I=g.sibling,g.sibling=null),fy(h,!1,I,g,j,S);break;case"backwards":case"unstable_legacy-backwards":for(g=null,I=h.child,h.child=null;I!==null;){if(l=I.alternate,l!==null&&Rh(l)===null){h.child=I;break}l=I.sibling,I.sibling=g,g=I,I=l}fy(h,!0,g,null,j,S);break;case"together":fy(h,!1,null,null,void 0,S);break;default:h.memoizedState=null}return h.child}function Yl(l,h,g){if(l!==null&&(h.dependencies=l.dependencies),Lc|=h.lanes,(g&h.childLanes)===0)if(l!==null){if(xo(l,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(l!==null&&h.child!==l.child)throw Error(o(153));if(h.child!==null){for(l=h.child,g=vo(l,l.pendingProps),h.child=g,g.return=h;l.sibling!==null;)l=l.sibling,g=g.sibling=vo(l,l.pendingProps),g.return=h;g.sibling=null}return h.child}function mp(l,h){return(l.lanes&h)!==0?!0:(l=l.dependencies,!!(l!==null&&Ph(l)))}function gp(l,h,g){switch(h.tag){case 3:yr(h,h.stateNode.containerInfo),al(h,ii,l.memoizedState.cache),rl();break;case 27:case 5:tr(h);break;case 4:yr(h,h.stateNode.containerInfo);break;case 10:al(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,rd(h),null;break;case 13:var S=h.memoizedState;if(S!==null)return S.dehydrated!==null?(Ea(h),h.flags|=128,null):(g&h.child.childLanes)!==0?uy(l,h,g):(Ea(h),l=Yl(l,h,g),l!==null?l.sibling:null);Ea(h);break;case 19:var I=(l.flags&128)!==0;if(S=(g&h.childLanes)!==0,S||(xo(l,h,g,!1),S=(g&h.childLanes)!==0),I){if(S)return Om(l,h,g);h.flags|=128}if(I=h.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Be(Wn,Wn.current),S)break;return null;case 22:return h.lanes=0,sy(l,h,g,h.pendingProps);case 24:al(h,ii,l.memoizedState.cache)}return Yl(l,h,g)}function Wa(l,h,g){if(l!==null)if(l.memoizedProps!==h.pendingProps)Ni=!0;else{if(!mp(l,g)&&(h.flags&128)===0)return Ni=!1,gp(l,h,g);Ni=(l.flags&131072)!==0}else Ni=!1,Rr&&(h.flags&1048576)!==0&&op(h,Nl,h.index);switch(h.lanes=0,h.tag){case 16:e:{var S=h.pendingProps;if(l=Fl(h.elementType),h.type=l,typeof l=="function")$f(l)?(S=Hl(l,S),h.tag=1,h=v_(null,h,l,S,g)):(h.tag=0,h=ly(null,h,l,S,g));else{if(l!=null){var I=l.$$typeof;if(I===be){h.tag=11,h=m_(null,h,l,S,g);break e}else if(I===Oe){h.tag=14,h=Tm(null,h,l,S,g);break e}}throw h=zt(l)||l,Error(o(306,h,""))}}return h;case 0:return ly(l,h,h.type,h.pendingProps,g);case 1:return S=h.type,I=Hl(S,h.pendingProps),v_(l,h,S,I,g);case 3:e:{if(yr(h,h.stateNode.containerInfo),l===null)throw Error(o(387));S=h.pendingProps;var j=h.memoizedState;I=j.element,zh(l,h),ul(h,S,null,g);var Q=h.memoizedState;if(S=Q.cache,al(h,ii,S),S!==j.cache&&Xf(h,[ii],g,!0),Ul(),S=Q.element,j.isDehydrated)if(j={element:S,isDehydrated:!1,cache:Q.cache},h.updateQueue.baseState=j,h.memoizedState=j,h.flags&256){h=__(l,h,S,g);break e}else if(S!==I){I=Sa(Error(o(424)),h),nl(I),h=__(l,h,S,g);break e}else for(l=h.stateNode.containerInfo,l.nodeType===9?l=l.body:l=l.nodeName==="HTML"?l.ownerDocument.body:l,yn=Kr(l.firstChild),Li=h,Rr=!0,tl=null,Va=!0,g=Ih(h,null,S,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(rl(),S===I){h=Yl(l,h,g);break e}Qi(l,h,S,g)}h=h.child}return h;case 26:return Am(l,h),l===null?(g=Sp(h.type,null,h.pendingProps,null))?h.memoizedState=g:Rr||(g=h.type,l=h.pendingProps,S=bd(Lt.current).createElement(g),S[Cn]=h,S[xt]=l,Ii(S,g,l),Dn(S),h.stateNode=S):h.memoizedState=Sp(h.type,l.memoizedProps,h.pendingProps,l.memoizedState),null;case 27:return tr(h),l===null&&Rr&&(S=h.stateNode=ca(h.type,h.pendingProps,Lt.current),Li=h,Va=!0,I=yn,nu(h.type)?(_i=I,yn=Kr(S.firstChild)):yn=I),Qi(l,h,h.pendingProps.children,g),Am(l,h),l===null&&(h.flags|=4194304),h.child;case 5:return l===null&&Rr&&((I=S=yn)&&(S=cn(S,h.type,h.pendingProps,Va),S!==null?(h.stateNode=S,Li=h,yn=Kr(S.firstChild),Va=!1,I=!0):I=!1),I||qa(h)),tr(h),I=h.type,j=h.pendingProps,Q=l!==null?l.memoizedProps:null,S=j.children,Yu(I,j)?S=null:Q!==null&&Yu(I,Q)&&(h.flags|=32),h.memoizedState!==null&&(I=ss(l,h,id,null,null,g),Ed._currentValue=I),Am(l,h),Qi(l,h,S,g),h.child;case 6:return l===null&&Rr&&((l=g=yn)&&(g=qc(g,h.pendingProps,Va),g!==null?(h.stateNode=g,Li=h,yn=null,l=!0):l=!1),l||qa(h)),null;case 13:return uy(l,h,g);case 4:return yr(h,h.stateNode.containerInfo),S=h.pendingProps,l===null?h.child=sl(h,null,S,g):Qi(l,h,S,g),h.child;case 11:return m_(l,h,h.type,h.pendingProps,g);case 7:return Qi(l,h,h.pendingProps,g),h.child;case 8:return Qi(l,h,h.pendingProps.children,g),h.child;case 12:return Qi(l,h,h.pendingProps.children,g),h.child;case 10:return S=h.pendingProps,al(h,h.type,S.value),Qi(l,h,S.children,g),h.child;case 9:return I=h.type._context,S=h.pendingProps.children,ol(h),I=Pi(I),S=S(I),h.flags|=1,Qi(l,h,S,g),h.child;case 14:return Tm(l,h,h.type,h.pendingProps,g);case 15:return oy(l,h,h.type,h.pendingProps,g);case 19:return Om(l,h,g);case 31:return Em(l,h,g);case 22:return sy(l,h,g,h.pendingProps);case 24:return ol(h),S=Pi(ii),l===null?(I=Mu(),I===null&&(I=In,j=Eu(),I.pooledCache=j,j.refCount++,j!==null&&(I.pooledCacheLanes|=g),I=j),h.memoizedState={parent:S,cache:I},Qf(h),al(h,ii,I)):((l.lanes&g)!==0&&(zh(l,h),ul(h,null,null,g),Ul()),I=l.memoizedState,j=h.memoizedState,I.parent!==S?(I={parent:S,cache:S},h.memoizedState=I,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=I),al(h,ii,S)):(S=j.cache,al(h,ii,S),S!==I.cache&&Xf(h,[ii],g,!0))),Qi(l,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(o(156,h.tag))}function Xl(l){l.flags|=4}function Im(l,h,g,S,I){if((h=(l.mode&32)!==0)&&(h=!1),h){if(l.flags|=16777216,(I&335544128)===I)if(l.stateNode.complete)l.flags|=8192;else if(z_())l.flags|=8192;else throw Ta=jt,as}else l.flags&=-16777217}function zm(l,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!Mp(h))if(z_())l.flags|=8192;else throw Ta=jt,as}function km(l,h){h!==null&&(l.flags|=4),l.flags&16384&&(h=l.tag!==22?lr():536870912,l.lanes|=h,md|=h)}function cd(l,h){if(!Rr)switch(l.tailMode){case"hidden":h=l.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?l.tail=null:g.sibling=null;break;case"collapsed":g=l.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?h||l.tail===null?l.tail=null:l.tail.sibling=null:S.sibling=null}}function Yn(l){var h=l.alternate!==null&&l.alternate.child===l.child,g=0,S=0;if(h)for(var I=l.child;I!==null;)g|=I.lanes|I.childLanes,S|=I.subtreeFlags&65011712,S|=I.flags&65011712,I.return=l,I=I.sibling;else for(I=l.child;I!==null;)g|=I.lanes|I.childLanes,S|=I.subtreeFlags,S|=I.flags,I.return=l,I=I.sibling;return l.subtreeFlags|=S,l.childLanes=g,h}function jb(l,h,g){var S=h.pendingProps;switch(Sc(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(h),null;case 1:return Yn(h),null;case 3:return g=h.stateNode,S=null,l!==null&&(S=l.memoizedState.cache),h.memoizedState.cache!==S&&(h.flags|=2048),Os(ii),ft(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(l===null||l.child===null)&&(Cs(h)?Xl(h):l===null||l.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ds())),Yn(h),null;case 26:var I=h.type,j=h.memoizedState;return l===null?(Xl(h),j!==null?(Yn(h),zm(h,j)):(Yn(h),Im(h,I,null,S,g))):j?j!==l.memoizedState?(Xl(h),Yn(h),zm(h,j)):(Yn(h),h.flags&=-16777217):(l=l.memoizedProps,l!==S&&Xl(h),Yn(h),Im(h,I,l,S,g)),null;case 27:if(pr(h),g=Lt.current,I=h.type,l!==null&&h.stateNode!=null)l.memoizedProps!==S&&Xl(h);else{if(!S){if(h.stateNode===null)throw Error(o(166));return Yn(h),null}l=lt.current,Cs(h)?$a(h):(l=ca(I,S,g),h.stateNode=l,Xl(h))}return Yn(h),null;case 5:if(pr(h),I=h.type,l!==null&&h.stateNode!=null)l.memoizedProps!==S&&Xl(h);else{if(!S){if(h.stateNode===null)throw Error(o(166));return Yn(h),null}if(j=lt.current,Cs(h))$a(h);else{var Q=bd(Lt.current);switch(j){case 1:j=Q.createElementNS("http://www.w3.org/2000/svg",I);break;case 2:j=Q.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;default:switch(I){case"svg":j=Q.createElementNS("http://www.w3.org/2000/svg",I);break;case"math":j=Q.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;case"script":j=Q.createElement("div"),j.innerHTML="<script><\/script>",j=j.removeChild(j.firstChild);break;case"select":j=typeof S.is=="string"?Q.createElement("select",{is:S.is}):Q.createElement("select"),S.multiple?j.multiple=!0:S.size&&(j.size=S.size);break;default:j=typeof S.is=="string"?Q.createElement(I,{is:S.is}):Q.createElement(I)}}j[Cn]=h,j[xt]=S;e:for(Q=h.child;Q!==null;){if(Q.tag===5||Q.tag===6)j.appendChild(Q.stateNode);else if(Q.tag!==4&&Q.tag!==27&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===h)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===h)break e;Q=Q.return}Q.sibling.return=Q.return,Q=Q.sibling}h.stateNode=j;e:switch(Ii(j,I,S),I){case"button":case"input":case"select":case"textarea":S=!!S.autoFocus;break e;case"img":S=!0;break e;default:S=!1}S&&Xl(h)}}return Yn(h),Im(h,h.type,l===null?null:l.memoizedProps,h.pendingProps,g),null;case 6:if(l&&h.stateNode!=null)l.memoizedProps!==S&&Xl(h);else{if(typeof S!="string"&&h.stateNode===null)throw Error(o(166));if(l=Lt.current,Cs(h)){if(l=h.stateNode,g=h.memoizedProps,S=null,I=Li,I!==null)switch(I.tag){case 27:case 5:S=I.memoizedProps}l[Cn]=h,l=!!(l.nodeValue===g||S!==null&&S.suppressHydrationWarning===!0||Uy(l.nodeValue,g)),l||qa(h,!0)}else l=bd(l).createTextNode(S),l[Cn]=h,h.stateNode=l}return Yn(h),null;case 31:if(g=h.memoizedState,l===null||l.memoizedState!==null){if(S=Cs(h),g!==null){if(l===null){if(!S)throw Error(o(318));if(l=h.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(557));l[Cn]=h}else rl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Yn(h),l=!1}else g=Ds(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=g),l=!0;if(!l)return h.flags&256?(Hn(h),h):(Hn(h),null);if((h.flags&128)!==0)throw Error(o(558))}return Yn(h),null;case 13:if(S=h.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(I=Cs(h),S!==null&&S.dehydrated!==null){if(l===null){if(!I)throw Error(o(318));if(I=h.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(o(317));I[Cn]=h}else rl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Yn(h),I=!1}else I=Ds(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=I),I=!0;if(!I)return h.flags&256?(Hn(h),h):(Hn(h),null)}return Hn(h),(h.flags&128)!==0?(h.lanes=g,h):(g=S!==null,l=l!==null&&l.memoizedState!==null,g&&(S=h.child,I=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(I=S.alternate.memoizedState.cachePool.pool),j=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(j=S.memoizedState.cachePool.pool),j!==I&&(S.flags|=2048)),g!==l&&g&&(h.child.flags|=8192),km(h,h.updateQueue),Yn(h),null);case 4:return ft(),l===null&&Ly(h.stateNode.containerInfo),Yn(h),null;case 10:return Os(h.type),Yn(h),null;case 19:if(nt(Wn),S=h.memoizedState,S===null)return Yn(h),null;if(I=(h.flags&128)!==0,j=S.rendering,j===null)if(I)cd(S,!1);else{if(vi!==0||l!==null&&(l.flags&128)!==0)for(l=h.child;l!==null;){if(j=Rh(l),j!==null){for(h.flags|=128,cd(S,!1),l=j.updateQueue,h.updateQueue=l,km(h,l),h.subtreeFlags=0,l=g,g=h.child;g!==null;)ym(g,l),g=g.sibling;return Be(Wn,Wn.current&1|2),Rr&&el(h,S.treeForkCount),h.child}l=l.sibling}S.tail!==null&&kn()>qm&&(h.flags|=128,I=!0,cd(S,!1),h.lanes=4194304)}else{if(!I)if(l=Rh(j),l!==null){if(h.flags|=128,I=!0,l=l.updateQueue,h.updateQueue=l,km(h,l),cd(S,!0),S.tail===null&&S.tailMode==="hidden"&&!j.alternate&&!Rr)return Yn(h),null}else 2*kn()-S.renderingStartTime>qm&&g!==536870912&&(h.flags|=128,I=!0,cd(S,!1),h.lanes=4194304);S.isBackwards?(j.sibling=h.child,h.child=j):(l=S.last,l!==null?l.sibling=j:h.child=j,S.last=j)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=kn(),l.sibling=null,g=Wn.current,Be(Wn,I?g&1|2:g&1),Rr&&el(h,S.treeForkCount),l):(Yn(h),null);case 22:case 23:return Hn(h),Ou(),S=h.memoizedState!==null,l!==null?l.memoizedState!==null!==S&&(h.flags|=8192):S&&(h.flags|=8192),S?(g&536870912)!==0&&(h.flags&128)===0&&(Yn(h),h.subtreeFlags&6&&(h.flags|=8192)):Yn(h),g=h.updateQueue,g!==null&&km(h,g.retryQueue),g=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),S=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),S!==g&&(h.flags|=2048),l!==null&&nt(Ci),null;case 24:return g=null,l!==null&&(g=l.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),Os(ii),Yn(h),null;case 25:return null;case 30:return null}throw Error(o(156,h.tag))}function x_(l,h){switch(Sc(h),h.tag){case 1:return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 3:return Os(ii),ft(),l=h.flags,(l&65536)!==0&&(l&128)===0?(h.flags=l&-65537|128,h):null;case 26:case 27:case 5:return pr(h),null;case 31:if(h.memoizedState!==null){if(Hn(h),h.alternate===null)throw Error(o(340));rl()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 13:if(Hn(h),l=h.memoizedState,l!==null&&l.dehydrated!==null){if(h.alternate===null)throw Error(o(340));rl()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 19:return nt(Wn),null;case 4:return ft(),null;case 10:return Os(h.type),null;case 22:case 23:return Hn(h),Ou(),l!==null&&nt(Ci),l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 24:return Os(ii),null;case 25:return null;default:return null}}function b_(l,h){switch(Sc(h),h.tag){case 3:Os(ii),ft();break;case 26:case 27:case 5:pr(h);break;case 4:ft();break;case 31:h.memoizedState!==null&&Hn(h);break;case 13:Hn(h);break;case 19:nt(Wn);break;case 10:Os(h.type);break;case 22:case 23:Hn(h),Ou(),l!==null&&nt(Ci);break;case 24:Os(ii)}}function hd(l,h){try{var g=h.updateQueue,S=g!==null?g.lastEffect:null;if(S!==null){var I=S.next;g=I;do{if((g.tag&l)===l){S=void 0;var j=g.create,Q=g.inst;S=j(),Q.destroy=S}g=g.next}while(g!==I)}}catch(ce){An(h,h.return,ce)}}function Kl(l,h,g){try{var S=h.updateQueue,I=S!==null?S.lastEffect:null;if(I!==null){var j=I.next;S=j;do{if((S.tag&l)===l){var Q=S.inst,ce=Q.destroy;if(ce!==void 0){Q.destroy=void 0,I=h;var ke=g,Ke=ce;try{Ke()}catch(vt){An(I,ke,vt)}}}S=S.next}while(S!==j)}}catch(vt){An(h,h.return,vt)}}function dy(l){var h=l.updateQueue;if(h!==null){var g=l.stateNode;try{td(h,g)}catch(S){An(l,l.return,S)}}}function py(l,h,g){g.props=Hl(l.type,l.memoizedProps),g.state=l.memoizedState;try{g.componentWillUnmount()}catch(S){An(l,h,S)}}function yp(l,h){try{var g=l.ref;if(g!==null){switch(l.tag){case 26:case 27:case 5:var S=l.stateNode;break;case 30:S=l.stateNode;break;default:S=l.stateNode}typeof g=="function"?l.refCleanup=g(S):g.current=S}}catch(I){An(l,h,I)}}function Ql(l,h){var g=l.ref,S=l.refCleanup;if(g!==null)if(typeof S=="function")try{S()}catch(I){An(l,h,I)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){An(l,h,I)}else g.current=null}function w_(l){var h=l.type,g=l.memoizedProps,S=l.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&S.focus();break e;case"img":g.src?S.src=g.src:g.srcSet&&(S.srcset=g.srcSet)}}catch(I){An(l,l.return,I)}}function fd(l,h,g){try{var S=l.stateNode;J_(S,l.type,g,h),S[xt]=h}catch(I){An(l,l.return,I)}}function Rm(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&nu(l.type)||l.tag===4}function jm(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Rm(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&nu(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Fu(l,h,g){var S=l.tag;if(S===5||S===6)l=l.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(l,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(l),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=nr));else if(S!==4&&(S===27&&nu(l.type)&&(g=l.stateNode,h=null),l=l.child,l!==null))for(Fu(l,h,g),l=l.sibling;l!==null;)Fu(l,h,g),l=l.sibling}function Ic(l,h,g){var S=l.tag;if(S===5||S===6)l=l.stateNode,h?g.insertBefore(l,h):g.appendChild(l);else if(S!==4&&(S===27&&nu(l.type)&&(g=l.stateNode),l=l.child,l!==null))for(Ic(l,h,g),l=l.sibling;l!==null;)Ic(l,h,g),l=l.sibling}function S_(l){var h=l.stateNode,g=l.memoizedProps;try{for(var S=l.type,I=h.attributes;I.length;)h.removeAttributeNode(I[0]);Ii(h,S,g),h[Cn]=l,h[xt]=g}catch(j){An(l,l.return,j)}}var Uu=!1,Bi=!1,my=!1,T_=typeof WeakSet=="function"?WeakSet:Set,oa=null;function Lb(l,h){if(l=l.containerInfo,Ya=hg,l=Nf(l),Bf(l)){if("selectionStart"in l)var g={start:l.selectionStart,end:l.selectionEnd};else e:{g=(g=l.ownerDocument)&&g.defaultView||window;var S=g.getSelection&&g.getSelection();if(S&&S.rangeCount!==0){g=S.anchorNode;var I=S.anchorOffset,j=S.focusNode;S=S.focusOffset;try{g.nodeType,j.nodeType}catch{g=null;break e}var Q=0,ce=-1,ke=-1,Ke=0,vt=0,At=l,it=null;t:for(;;){for(var ct;At!==g||I!==0&&At.nodeType!==3||(ce=Q+I),At!==j||S!==0&&At.nodeType!==3||(ke=Q+S),At.nodeType===3&&(Q+=At.nodeValue.length),(ct=At.firstChild)!==null;)it=At,At=ct;for(;;){if(At===l)break t;if(it===g&&++Ke===I&&(ce=Q),it===j&&++vt===S&&(ke=Q),(ct=At.nextSibling)!==null)break;At=it,it=At.parentNode}At=ct}g=ce===-1||ke===-1?null:{start:ce,end:ke}}else g=null}g=g||{start:0,end:0}}else g=null;for(Vc={focusedElem:l,selectionRange:g},hg=!1,oa=h;oa!==null;)if(h=oa,l=h.child,(h.subtreeFlags&1028)!==0&&l!==null)l.return=h,oa=l;else for(;oa!==null;){switch(h=oa,j=h.alternate,l=h.flags,h.tag){case 0:if((l&4)!==0&&(l=h.updateQueue,l=l!==null?l.events:null,l!==null))for(g=0;g<l.length;g++)I=l[g],I.ref.impl=I.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&j!==null){l=void 0,g=h,I=j.memoizedProps,j=j.memoizedState,S=g.stateNode;try{var er=Hl(g.type,I);l=S.getSnapshotBeforeUpdate(er,j),S.__reactInternalSnapshotBeforeUpdate=l}catch(_r){An(g,g.return,_r)}}break;case 3:if((l&1024)!==0){if(l=h.stateNode.containerInfo,g=l.nodeType,g===9)$y(l);else if(g===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":$y(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(o(163))}if(l=h.sibling,l!==null){l.return=h.return,oa=l;break}oa=h.return}}function Lm(l,h,g){var S=g.flags;switch(g.tag){case 0:case 11:case 15:Bo(l,g),S&4&&hd(5,g);break;case 1:if(Bo(l,g),S&4)if(l=g.stateNode,h===null)try{l.componentDidMount()}catch(Q){An(g,g.return,Q)}else{var I=Hl(g.type,h.memoizedProps);h=h.memoizedState;try{l.componentDidUpdate(I,h,l.__reactInternalSnapshotBeforeUpdate)}catch(Q){An(g,g.return,Q)}}S&64&&dy(g),S&512&&yp(g,g.return);break;case 3:if(Bo(l,g),S&64&&(l=g.updateQueue,l!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{td(l,h)}catch(Q){An(g,g.return,Q)}}break;case 27:h===null&&S&4&&S_(g);case 26:case 5:Bo(l,g),h===null&&S&4&&w_(g),S&512&&yp(g,g.return);break;case 12:Bo(l,g);break;case 31:Bo(l,g),S&4&&Fh(l,g);break;case 13:Bo(l,g),S&4&&gy(l,g),S&64&&(l=g.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(g=Bc.bind(null,g),Vo(l,g))));break;case 22:if(S=g.memoizedState!==null||Uu,!S){h=h!==null&&h.memoizedState!==null||Bi,I=Uu;var j=Bi;Uu=S,(Bi=h)&&!j?Fo(l,g,(g.subtreeFlags&8772)!==0):Bo(l,g),Uu=I,Bi=j}break;case 30:break;default:Bo(l,g)}}function E_(l){var h=l.alternate;h!==null&&(l.alternate=null,E_(h)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(h=l.stateNode,h!==null&&Ts(h)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Xn=null,sa=!1;function Vu(l,h,g){for(g=g.child;g!==null;)oi(l,h,g),g=g.sibling}function oi(l,h,g){if(ae&&typeof ae.onCommitFiberUnmount=="function")try{ae.onCommitFiberUnmount(ne,g)}catch{}switch(g.tag){case 26:Bi||Ql(g,h),Vu(l,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Bi||Ql(g,h);var S=Xn,I=sa;nu(g.type)&&(Xn=g.stateNode,sa=!1),Vu(l,h,g),Kh(g.stateNode),Xn=S,sa=I;break;case 5:Bi||Ql(g,h);case 6:if(S=Xn,I=sa,Xn=null,Vu(l,h,g),Xn=S,sa=I,Xn!==null)if(sa)try{(Xn.nodeType===9?Xn.body:Xn.nodeName==="HTML"?Xn.ownerDocument.body:Xn).removeChild(g.stateNode)}catch(j){An(g,h,j)}else try{Xn.removeChild(g.stateNode)}catch(j){An(g,h,j)}break;case 18:Xn!==null&&(sa?(l=Xn,sg(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,g.stateNode),Od(l)):sg(Xn,g.stateNode));break;case 4:S=Xn,I=sa,Xn=g.stateNode.containerInfo,sa=!0,Vu(l,h,g),Xn=S,sa=I;break;case 0:case 11:case 14:case 15:Kl(2,g,h),Bi||Kl(4,g,h),Vu(l,h,g);break;case 1:Bi||(Ql(g,h),S=g.stateNode,typeof S.componentWillUnmount=="function"&&py(g,h,S)),Vu(l,h,g);break;case 21:Vu(l,h,g);break;case 22:Bi=(S=Bi)||g.memoizedState!==null,Vu(l,h,g),Bi=S;break;default:Vu(l,h,g)}}function Fh(l,h){if(h.memoizedState===null&&(l=h.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Od(l)}catch(g){An(h,h.return,g)}}}function gy(l,h){if(h.memoizedState===null&&(l=h.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Od(l)}catch(g){An(h,h.return,g)}}function Nm(l){switch(l.tag){case 31:case 13:case 19:var h=l.stateNode;return h===null&&(h=l.stateNode=new T_),h;case 22:return l=l.stateNode,h=l._retryCache,h===null&&(h=l._retryCache=new T_),h;default:throw Error(o(435,l.tag))}}function Uh(l,h){var g=Nm(l);h.forEach(function(S){if(!g.has(S)){g.add(S);var I=Xm.bind(null,l,S);S.then(I,I)}})}function la(l,h){var g=h.deletions;if(g!==null)for(var S=0;S<g.length;S++){var I=g[S],j=l,Q=h,ce=Q;e:for(;ce!==null;){switch(ce.tag){case 27:if(nu(ce.type)){Xn=ce.stateNode,sa=!1;break e}break;case 5:Xn=ce.stateNode,sa=!1;break e;case 3:case 4:Xn=ce.stateNode.containerInfo,sa=!0;break e}ce=ce.return}if(Xn===null)throw Error(o(160));oi(j,Q,I),Xn=null,sa=!1,j=I.alternate,j!==null&&(j.return=null),I.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)yy(h,l),h=h.sibling}var Ls=null;function yy(l,h){var g=l.alternate,S=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:la(h,l),ua(l),S&4&&(Kl(3,l,l.return),hd(3,l),Kl(5,l,l.return));break;case 1:la(h,l),ua(l),S&512&&(Bi||g===null||Ql(g,g.return)),S&64&&Uu&&(l=l.updateQueue,l!==null&&(S=l.callbacks,S!==null&&(g=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=g===null?S:g.concat(S))));break;case 26:var I=Ls;if(la(h,l),ua(l),S&512&&(Bi||g===null||Ql(g,g.return)),S&4){var j=g!==null?g.memoizedState:null;if(S=l.memoizedState,g===null)if(S===null)if(l.stateNode===null){e:{S=l.type,g=l.memoizedProps,I=I.ownerDocument||I;t:switch(S){case"title":j=I.getElementsByTagName("title")[0],(!j||j[gr]||j[Cn]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=I.createElement(S),I.head.insertBefore(j,I.querySelector("head > title"))),Ii(j,S,g),j[Cn]=l,Dn(j),S=j;break e;case"link":var Q=u0("link","href",I).get(S+(g.href||""));if(Q){for(var ce=0;ce<Q.length;ce++)if(j=Q[ce],j.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&j.getAttribute("rel")===(g.rel==null?null:g.rel)&&j.getAttribute("title")===(g.title==null?null:g.title)&&j.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){Q.splice(ce,1);break t}}j=I.createElement(S),Ii(j,S,g),I.head.appendChild(j);break;case"meta":if(Q=u0("meta","content",I).get(S+(g.content||""))){for(ce=0;ce<Q.length;ce++)if(j=Q[ce],j.getAttribute("content")===(g.content==null?null:""+g.content)&&j.getAttribute("name")===(g.name==null?null:g.name)&&j.getAttribute("property")===(g.property==null?null:g.property)&&j.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&j.getAttribute("charset")===(g.charSet==null?null:g.charSet)){Q.splice(ce,1);break t}}j=I.createElement(S),Ii(j,S,g),I.head.appendChild(j);break;default:throw Error(o(468,S))}j[Cn]=l,Dn(j),S=j}l.stateNode=S}else Xy(I,l.type,l.stateNode);else l.stateNode=Yy(I,S,l.memoizedProps);else j!==S?(j===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):j.count--,S===null?Xy(I,l.type,l.stateNode):Yy(I,S,l.memoizedProps)):S===null&&l.stateNode!==null&&fd(l,l.memoizedProps,g.memoizedProps)}break;case 27:la(h,l),ua(l),S&512&&(Bi||g===null||Ql(g,g.return)),g!==null&&S&4&&fd(l,l.memoizedProps,g.memoizedProps);break;case 5:if(la(h,l),ua(l),S&512&&(Bi||g===null||Ql(g,g.return)),l.flags&32){I=l.stateNode;try{fo(I,"")}catch(er){An(l,l.return,er)}}S&4&&l.stateNode!=null&&(I=l.memoizedProps,fd(l,I,g!==null?g.memoizedProps:I)),S&1024&&(my=!0);break;case 6:if(la(h,l),ua(l),S&4){if(l.stateNode===null)throw Error(o(162));S=l.memoizedProps,g=l.stateNode;try{g.nodeValue=S}catch(er){An(l,l.return,er)}}break;case 3:if(Ap=null,I=Ls,Ls=zn(h.containerInfo),la(h,l),Ls=I,ua(l),S&4&&g!==null&&g.memoizedState.isDehydrated)try{Od(h.containerInfo)}catch(er){An(l,l.return,er)}my&&(my=!1,Bm(l));break;case 4:S=Ls,Ls=zn(l.stateNode.containerInfo),la(h,l),ua(l),Ls=S;break;case 12:la(h,l),ua(l);break;case 31:la(h,l),ua(l),S&4&&(S=l.updateQueue,S!==null&&(l.updateQueue=null,Uh(l,S)));break;case 13:la(h,l),ua(l),l.child.flags&8192&&l.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Vm=kn()),S&4&&(S=l.updateQueue,S!==null&&(l.updateQueue=null,Uh(l,S)));break;case 22:I=l.memoizedState!==null;var ke=g!==null&&g.memoizedState!==null,Ke=Uu,vt=Bi;if(Uu=Ke||I,Bi=vt||ke,la(h,l),Bi=vt,Uu=Ke,ua(l),S&8192)e:for(h=l.stateNode,h._visibility=I?h._visibility&-2:h._visibility|1,I&&(g===null||ke||Uu||Bi||Jl(l)),g=null,h=l;;){if(h.tag===5||h.tag===26){if(g===null){ke=g=h;try{if(j=ke.stateNode,I)Q=j.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{ce=ke.stateNode;var At=ke.memoizedProps.style,it=At!=null&&At.hasOwnProperty("display")?At.display:null;ce.style.display=it==null||typeof it=="boolean"?"":(""+it).trim()}}catch(er){An(ke,ke.return,er)}}}else if(h.tag===6){if(g===null){ke=h;try{ke.stateNode.nodeValue=I?"":ke.memoizedProps}catch(er){An(ke,ke.return,er)}}}else if(h.tag===18){if(g===null){ke=h;try{var ct=ke.stateNode;I?i0(ct,!0):i0(ke.stateNode,!1)}catch(er){An(ke,ke.return,er)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===l)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break e;for(;h.sibling===null;){if(h.return===null||h.return===l)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}S&4&&(S=l.updateQueue,S!==null&&(g=S.retryQueue,g!==null&&(S.retryQueue=null,Uh(l,g))));break;case 19:la(h,l),ua(l),S&4&&(S=l.updateQueue,S!==null&&(l.updateQueue=null,Uh(l,S)));break;case 30:break;case 21:break;default:la(h,l),ua(l)}}function ua(l){var h=l.flags;if(h&2){try{for(var g,S=l.return;S!==null;){if(Rm(S)){g=S;break}S=S.return}if(g==null)throw Error(o(160));switch(g.tag){case 27:var I=g.stateNode,j=jm(l);Ic(l,j,I);break;case 5:var Q=g.stateNode;g.flags&32&&(fo(Q,""),g.flags&=-33);var ce=jm(l);Ic(l,ce,Q);break;case 3:case 4:var ke=g.stateNode.containerInfo,Ke=jm(l);Fu(l,Ke,ke);break;default:throw Error(o(161))}}catch(vt){An(l,l.return,vt)}l.flags&=-3}h&4096&&(l.flags&=-4097)}function Bm(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var h=l;Bm(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),l=l.sibling}}function Bo(l,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Lm(l,h.alternate,h),h=h.sibling}function Jl(l){for(l=l.child;l!==null;){var h=l;switch(h.tag){case 0:case 11:case 14:case 15:Kl(4,h,h.return),Jl(h);break;case 1:Ql(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&py(h,h.return,g),Jl(h);break;case 27:Kh(h.stateNode);case 26:case 5:Ql(h,h.return),Jl(h);break;case 22:h.memoizedState===null&&Jl(h);break;case 30:Jl(h);break;default:Jl(h)}l=l.sibling}}function Fo(l,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var S=h.alternate,I=l,j=h,Q=j.flags;switch(j.tag){case 0:case 11:case 15:Fo(I,j,g),hd(4,j);break;case 1:if(Fo(I,j,g),S=j,I=S.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(Ke){An(S,S.return,Ke)}if(S=j,I=S.updateQueue,I!==null){var ce=S.stateNode;try{var ke=I.shared.hiddenCallbacks;if(ke!==null)for(I.shared.hiddenCallbacks=null,I=0;I<ke.length;I++)ed(ke[I],ce)}catch(Ke){An(S,S.return,Ke)}}g&&Q&64&&dy(j),yp(j,j.return);break;case 27:S_(j);case 26:case 5:Fo(I,j,g),g&&S===null&&Q&4&&w_(j),yp(j,j.return);break;case 12:Fo(I,j,g);break;case 31:Fo(I,j,g),g&&Q&4&&Fh(I,j);break;case 13:Fo(I,j,g),g&&Q&4&&gy(I,j);break;case 22:j.memoizedState===null&&Fo(I,j,g),yp(j,j.return);break;case 30:break;default:Fo(I,j,g)}h=h.sibling}}function Vh(l,h){var g=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),l=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(l=h.memoizedState.cachePool.pool),l!==g&&(l!=null&&l.refCount++,g!=null&&Is(g))}function vy(l,h){l=null,h.alternate!==null&&(l=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==l&&(h.refCount++,l!=null&&Is(l))}function Ns(l,h,g,S){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)zc(l,h,g,S),h=h.sibling}function zc(l,h,g,S){var I=h.flags;switch(h.tag){case 0:case 11:case 15:Ns(l,h,g,S),I&2048&&hd(9,h);break;case 1:Ns(l,h,g,S);break;case 3:Ns(l,h,g,S),I&2048&&(l=null,h.alternate!==null&&(l=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==l&&(h.refCount++,l!=null&&Is(l)));break;case 12:if(I&2048){Ns(l,h,g,S),l=h.stateNode;try{var j=h.memoizedProps,Q=j.id,ce=j.onPostCommit;typeof ce=="function"&&ce(Q,h.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(ke){An(h,h.return,ke)}}else Ns(l,h,g,S);break;case 31:Ns(l,h,g,S);break;case 13:Ns(l,h,g,S);break;case 23:break;case 22:j=h.stateNode,Q=h.alternate,h.memoizedState!==null?j._visibility&2?Ns(l,h,g,S):pd(l,h):j._visibility&2?Ns(l,h,g,S):(j._visibility|=2,dd(l,h,g,S,(h.subtreeFlags&10256)!==0||!1)),I&2048&&Vh(Q,h);break;case 24:Ns(l,h,g,S),I&2048&&vy(h.alternate,h);break;default:Ns(l,h,g,S)}}function dd(l,h,g,S,I){for(I=I&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var j=l,Q=h,ce=g,ke=S,Ke=Q.flags;switch(Q.tag){case 0:case 11:case 15:dd(j,Q,ce,ke,I),hd(8,Q);break;case 23:break;case 22:var vt=Q.stateNode;Q.memoizedState!==null?vt._visibility&2?dd(j,Q,ce,ke,I):pd(j,Q):(vt._visibility|=2,dd(j,Q,ce,ke,I)),I&&Ke&2048&&Vh(Q.alternate,Q);break;case 24:dd(j,Q,ce,ke,I),I&&Ke&2048&&vy(Q.alternate,Q);break;default:dd(j,Q,ce,ke,I)}h=h.sibling}}function pd(l,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=l,S=h,I=S.flags;switch(S.tag){case 22:pd(g,S),I&2048&&Vh(S.alternate,S);break;case 24:pd(g,S),I&2048&&vy(S.alternate,S);break;default:pd(g,S)}h=h.sibling}}var qu=8192;function kc(l,h,g){if(l.subtreeFlags&qu)for(l=l.child;l!==null;)_y(l,h,g),l=l.sibling}function _y(l,h,g){switch(l.tag){case 26:kc(l,h,g),l.flags&qu&&l.memoizedState!==null&&cg(g,Ls,l.memoizedState,l.memoizedProps);break;case 5:kc(l,h,g);break;case 3:case 4:var S=Ls;Ls=zn(l.stateNode.containerInfo),kc(l,h,g),Ls=S;break;case 22:l.memoizedState===null&&(S=l.alternate,S!==null&&S.memoizedState!==null?(S=qu,qu=16777216,kc(l,h,g),qu=S):kc(l,h,g));break;default:kc(l,h,g)}}function xy(l){var h=l.alternate;if(h!==null&&(l=h.child,l!==null)){h.child=null;do h=l.sibling,l.sibling=null,l=h;while(l!==null)}}function vp(l){var h=l.deletions;if((l.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var S=h[g];oa=S,M_(S,l)}xy(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)A_(l),l=l.sibling}function A_(l){switch(l.tag){case 0:case 11:case 15:vp(l),l.flags&2048&&Kl(9,l,l.return);break;case 3:vp(l);break;case 12:vp(l);break;case 22:var h=l.stateNode;l.memoizedState!==null&&h._visibility&2&&(l.return===null||l.return.tag!==13)?(h._visibility&=-3,Fm(l)):vp(l);break;default:vp(l)}}function Fm(l){var h=l.deletions;if((l.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var S=h[g];oa=S,M_(S,l)}xy(l)}for(l=l.child;l!==null;){switch(h=l,h.tag){case 0:case 11:case 15:Kl(8,h,h.return),Fm(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,Fm(h));break;default:Fm(h)}l=l.sibling}}function M_(l,h){for(;oa!==null;){var g=oa;switch(g.tag){case 0:case 11:case 15:Kl(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var S=g.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Is(g.memoizedState.cache)}if(S=g.child,S!==null)S.return=g,oa=S;else e:for(g=l;oa!==null;){S=oa;var I=S.sibling,j=S.return;if(E_(S),S===g){oa=null;break e}if(I!==null){I.return=j,oa=I;break e}oa=j}}}var Nb={getCacheForType:function(l){var h=Pi(ii),g=h.data.get(l);return g===void 0&&(g=l(),h.data.set(l,g)),g},cacheSignal:function(){return Pi(ii).controller.signal}},_p=typeof WeakMap=="function"?WeakMap:Map,pn=0,In=null,Vr=null,Hr=0,En=0,Uo=null,Rc=!1,jc=!1,qh=!1,fl=0,vi=0,Lc=0,Nc=0,Um=0,hs=0,md=0,$u=null,Ao=null,by=!1,Vm=0,P_=0,qm=1/0,$m=null,Gu=null,Oi=0,Zu=null,$h=null,eu=0,wy=0,gd=null,C_=null,yd=0,Sy=null;function fs(){return(pn&2)!==0&&Hr!==0?Hr&-Hr:Ue.T!==null?xd():jr()}function D_(){if(hs===0)if((Hr&536870912)===0||Rr){var l=_t;_t<<=1,(_t&3932160)===0&&(_t=262144),hs=l}else hs=536870912;return l=Bt.current,l!==null&&(l.flags|=32),hs}function Mo(l,h,g){(l===In&&(En===2||En===9)||l.cancelPendingCommit!==null)&&(Gh(l,0),Bs(l,Hr,hs,!1)),mr(l,g),((pn&2)===0||l!==In)&&(l===In&&((pn&2)===0&&(Nc|=g),vi===4&&Bs(l,Hr,hs,!1)),tu(l))}function O_(l,h,g){if((pn&6)!==0)throw Error(o(327));var S=!g&&(h&127)===0&&(h&l.expiredLanes)===0||hr(l,h),I=S?R_(l,h):xp(l,h,!0),j=S;do{if(I===0){jc&&!S&&Bs(l,h,0,!1);break}else{if(g=l.current.alternate,j&&!Fi(g)){I=xp(l,h,!1),j=!1;continue}if(I===2){if(j=h,l.errorRecoveryDisabledLanes&j)var Q=0;else Q=l.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){h=Q;e:{var ce=l;I=$u;var ke=ce.current.memoizedState.isDehydrated;if(ke&&(Gh(ce,Q).flags|=256),Q=xp(ce,Q,!1),Q!==2){if(qh&&!ke){ce.errorRecoveryDisabledLanes|=j,Nc|=j,I=4;break e}j=Ao,Ao=I,j!==null&&(Ao===null?Ao=j:Ao.push.apply(Ao,j))}I=Q}if(j=!1,I!==2)continue}}if(I===1){Gh(l,0),Bs(l,h,0,!0);break}e:{switch(S=l,j=I,j){case 0:case 1:throw Error(o(345));case 4:if((h&4194048)!==h)break;case 6:Bs(S,h,hs,!Rc);break e;case 2:Ao=null;break;case 3:case 5:break;default:throw Error(o(329))}if((h&62914560)===h&&(I=Vm+300-kn(),10<I)){if(Bs(S,h,hs,!Rc),qt(S,0,!0)!==0)break e;eu=h,S.timeoutHandle=Xh(I_.bind(null,S,g,Ao,$m,by,h,hs,Nc,md,Rc,j,"Throttled",-0,0),I);break e}I_(S,g,Ao,$m,by,h,hs,Nc,md,Rc,j,null,-0,0)}}break}while(!0);tu(l)}function I_(l,h,g,S,I,j,Q,ce,ke,Ke,vt,At,it,ct){if(l.timeoutHandle=-1,At=h.subtreeFlags,At&8192||(At&16785408)===16785408){At={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:nr},_y(h,j,At);var er=(j&62914560)===j?Vm-kn():(j&4194048)===j?P_-kn():0;if(er=Ky(At,er),er!==null){eu=j,l.cancelPendingCommit=er(L_.bind(null,l,h,j,g,S,I,Q,ce,ke,vt,At,null,it,ct)),Bs(l,j,Q,!Ke);return}}L_(l,h,j,g,S,I,Q,ce,ke)}function Fi(l){for(var h=l;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var S=0;S<g.length;S++){var I=g[S],j=I.getSnapshot;I=I.value;try{if(!Fa(j(),I))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Bs(l,h,g,S){h&=~Um,h&=~Nc,l.suspendedLanes|=h,l.pingedLanes&=~h,S&&(l.warmLanes|=h),S=l.expirationTimes;for(var I=h;0<I;){var j=31-Te(I),Q=1<<j;S[j]=-1,I&=~Q}g!==0&&nn(l,g,h)}function Gm(){return(pn&6)===0?(_d(0),!1):!0}function Ty(){if(Vr!==null){if(En===0)var l=Vr.return;else l=Vr,_o=ns=null,$l(l),Ac=null,os=0,l=Vr;for(;l!==null;)b_(l.alternate,l),l=l.return;Vr=null}}function Gh(l,h){var g=l.timeoutHandle;g!==-1&&(l.timeoutHandle=-1,ag(g)),g=l.cancelPendingCommit,g!==null&&(l.cancelPendingCommit=null,g()),eu=0,Ty(),In=l,Vr=g=vo(l.current,null),Hr=h,En=0,Uo=null,Rc=!1,jc=hr(l,h),qh=!1,md=hs=Um=Nc=Lc=vi=0,Ao=$u=null,by=!1,(h&8)!==0&&(h|=h&32);var S=l.entangledLanes;if(S!==0)for(l=l.entanglements,S&=h;0<S;){var I=31-Te(S),j=1<<I;h|=l[I],S&=~j}return fl=h,Su(),g}function Ey(l,h){Pr=null,Ue.H=Ki,h===Pu||h===wo?(h=Ec(),En=3):h===as?(h=Ec(),En=4):En=h===Sm?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Uo=h,Vr===null&&(vi=1,cs(l,Sa(h,l.current)))}function z_(){var l=Bt.current;return l===null?!0:(Hr&4194048)===Hr?Kt===null:(Hr&62914560)===Hr||(Hr&536870912)!==0?l===Kt:!1}function Ay(){var l=Ue.H;return Ue.H=Ki,l===null?Ki:l}function My(){var l=Ue.A;return Ue.A=Nb,l}function Hu(){vi=4,Rc||(Hr&4194048)!==Hr&&Bt.current!==null||(jc=!0),(Lc&134217727)===0&&(Nc&134217727)===0||In===null||Bs(In,Hr,hs,!1)}function xp(l,h,g){var S=pn;pn|=2;var I=Ay(),j=My();(In!==l||Hr!==h)&&($m=null,Gh(l,h)),h=!1;var Q=vi;e:do try{if(En!==0&&Vr!==null){var ce=Vr,ke=Uo;switch(En){case 8:Ty(),Q=6;break e;case 3:case 2:case 9:case 6:Bt.current===null&&(h=!0);var Ke=En;if(En=0,Uo=null,vd(l,ce,ke,Ke),g&&jc){Q=0;break e}break;default:Ke=En,En=0,Uo=null,vd(l,ce,ke,Ke)}}k_(),Q=vi;break}catch(vt){Ey(l,vt)}while(!0);return h&&l.shellSuspendCounter++,_o=ns=null,pn=S,Ue.H=I,Ue.A=j,Vr===null&&(In=null,Hr=0,Su()),Q}function k_(){for(;Vr!==null;)Zh(Vr)}function R_(l,h){var g=pn;pn|=2;var S=Ay(),I=My();In!==l||Hr!==h?($m=null,qm=kn()+500,Gh(l,h)):jc=hr(l,h);e:do try{if(En!==0&&Vr!==null){h=Vr;var j=Uo;t:switch(En){case 1:En=0,Uo=null,vd(l,h,j,1);break;case 2:case 9:if(cp(j)){En=0,Uo=null,Py(h);break}h=function(){En!==2&&En!==9||In!==l||(En=7),tu(l)},j.then(h,h);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:cp(j)?(En=0,Uo=null,Py(h)):(En=0,Uo=null,vd(l,h,j,7));break;case 5:var Q=null;switch(Vr.tag){case 26:Q=Vr.memoizedState;case 5:case 27:var ce=Vr;if(Q?Mp(Q):ce.stateNode.complete){En=0,Uo=null;var ke=ce.sibling;if(ke!==null)Vr=ke;else{var Ke=ce.return;Ke!==null?(Vr=Ke,Hm(Ke)):Vr=null}break t}}En=0,Uo=null,vd(l,h,j,5);break;case 6:En=0,Uo=null,vd(l,h,j,6);break;case 8:Ty(),vi=6;break e;default:throw Error(o(462))}}Zm();break}catch(vt){Ey(l,vt)}while(!0);return _o=ns=null,Ue.H=S,Ue.A=I,pn=g,Vr!==null?0:(In=null,Hr=0,Su(),vi)}function Zm(){for(;Vr!==null&&!uo();)Zh(Vr)}function Zh(l){var h=Wa(l.alternate,l,fl);l.memoizedProps=l.pendingProps,h===null?Hm(l):Vr=h}function Py(l){var h=l,g=h.alternate;switch(h.tag){case 15:case 0:h=y_(g,h,h.pendingProps,h.type,void 0,Hr);break;case 11:h=y_(g,h,h.pendingProps,h.type.render,h.ref,Hr);break;case 5:$l(h);default:b_(g,h),h=Vr=ym(h,fl),h=Wa(g,h,fl)}l.memoizedProps=l.pendingProps,h===null?Hm(l):Vr=h}function vd(l,h,g,S){_o=ns=null,$l(h),Ac=null,os=0;var I=h.return;try{if(Oc(l,I,h,g,Hr)){vi=1,cs(l,Sa(g,l.current)),Vr=null;return}}catch(j){if(I!==null)throw Vr=I,j;vi=1,cs(l,Sa(g,l.current)),Vr=null;return}h.flags&32768?(Rr||S===1?l=!0:jc||(Hr&536870912)!==0?l=!1:(Rc=l=!0,(S===2||S===9||S===3||S===6)&&(S=Bt.current,S!==null&&S.tag===13&&(S.flags|=16384))),j_(h,l)):Hm(h)}function Hm(l){var h=l;do{if((h.flags&32768)!==0){j_(h,Rc);return}l=h.return;var g=jb(h.alternate,h,fl);if(g!==null){Vr=g;return}if(h=h.sibling,h!==null){Vr=h;return}Vr=h=l}while(h!==null);vi===0&&(vi=5)}function j_(l,h){do{var g=x_(l.alternate,l);if(g!==null){g.flags&=32767,Vr=g;return}if(g=l.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(l=l.sibling,l!==null)){Vr=l;return}Vr=l=g}while(l!==null);vi=6,Vr=null}function L_(l,h,g,S,I,j,Q,ce,ke){l.cancelPendingCommit=null;do Wm();while(Oi!==0);if((pn&6)!==0)throw Error(o(327));if(h!==null){if(h===l.current)throw Error(o(177));if(j=h.lanes|h.childLanes,j|=wu,Bn(l,g,j,Q,ce,ke),l===In&&(Vr=In=null,Hr=0),$h=h,Zu=l,eu=g,wy=j,gd=I,C_=S,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,Oy(ga,function(){return V_(),null})):(l.callbackNode=null,l.callbackPriority=0),S=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||S){S=Ue.T,Ue.T=null,I=at.p,at.p=2,Q=pn,pn|=4;try{Lb(l,h,g)}finally{pn=Q,at.p=I,Ue.T=S}}Oi=1,N_(),B_(),F_()}}function N_(){if(Oi===1){Oi=0;var l=Zu,h=$h,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=Ue.T,Ue.T=null;var S=at.p;at.p=2;var I=pn;pn|=4;try{yy(h,l);var j=Vc,Q=Nf(l.containerInfo),ce=j.focusedElem,ke=j.selectionRange;if(Q!==ce&&ce&&ce.ownerDocument&&bh(ce.ownerDocument.documentElement,ce)){if(ke!==null&&Bf(ce)){var Ke=ke.start,vt=ke.end;if(vt===void 0&&(vt=Ke),"selectionStart"in ce)ce.selectionStart=Ke,ce.selectionEnd=Math.min(vt,ce.value.length);else{var At=ce.ownerDocument||document,it=At&&At.defaultView||window;if(it.getSelection){var ct=it.getSelection(),er=ce.textContent.length,_r=Math.min(ke.start,er),Mn=ke.end===void 0?_r:Math.min(ke.end,er);!ct.extend&&_r>Mn&&(Q=Mn,Mn=_r,_r=Q);var $e=vc(ce,_r),Le=vc(ce,Mn);if($e&&Le&&(ct.rangeCount!==1||ct.anchorNode!==$e.node||ct.anchorOffset!==$e.offset||ct.focusNode!==Le.node||ct.focusOffset!==Le.offset)){var et=At.createRange();et.setStart($e.node,$e.offset),ct.removeAllRanges(),_r>Mn?(ct.addRange(et),ct.extend(Le.node,Le.offset)):(et.setEnd(Le.node,Le.offset),ct.addRange(et))}}}}for(At=[],ct=ce;ct=ct.parentNode;)ct.nodeType===1&&At.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<At.length;ce++){var wt=At[ce];wt.element.scrollLeft=wt.left,wt.element.scrollTop=wt.top}}hg=!!Ya,Vc=Ya=null}finally{pn=I,at.p=S,Ue.T=g}}l.current=h,Oi=2}}function B_(){if(Oi===2){Oi=0;var l=Zu,h=$h,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=Ue.T,Ue.T=null;var S=at.p;at.p=2;var I=pn;pn|=4;try{Lm(l,h.alternate,h)}finally{pn=I,at.p=S,Ue.T=g}}Oi=3}}function F_(){if(Oi===4||Oi===3){Oi=0,bn();var l=Zu,h=$h,g=eu,S=C_;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Oi=5:(Oi=0,$h=Zu=null,U_(l,l.pendingLanes));var I=l.pendingLanes;if(I===0&&(Gu=null),Et(g),h=h.stateNode,ae&&typeof ae.onCommitFiberRoot=="function")try{ae.onCommitFiberRoot(ne,h,void 0,(h.current.flags&128)===128)}catch{}if(S!==null){h=Ue.T,I=at.p,at.p=2,Ue.T=null;try{for(var j=l.onRecoverableError,Q=0;Q<S.length;Q++){var ce=S[Q];j(ce.value,{componentStack:ce.stack})}}finally{Ue.T=h,at.p=I}}(eu&3)!==0&&Wm(),tu(l),I=l.pendingLanes,(g&261930)!==0&&(I&42)!==0?l===Sy?yd++:(yd=0,Sy=l):yd=0,_d(0)}}function U_(l,h){(l.pooledCacheLanes&=h)===0&&(h=l.pooledCache,h!=null&&(l.pooledCache=null,Is(h)))}function Wm(){return N_(),B_(),F_(),V_()}function V_(){if(Oi!==5)return!1;var l=Zu,h=wy;wy=0;var g=Et(eu),S=Ue.T,I=at.p;try{at.p=32>g?32:g,Ue.T=null,g=gd,gd=null;var j=Zu,Q=eu;if(Oi=0,$h=Zu=null,eu=0,(pn&6)!==0)throw Error(o(331));var ce=pn;if(pn|=4,A_(j.current),zc(j,j.current,Q,g),pn=ce,_d(0,!1),ae&&typeof ae.onPostCommitFiberRoot=="function")try{ae.onPostCommitFiberRoot(ne,j)}catch{}return!0}finally{at.p=I,Ue.T=S,U_(l,h)}}function q_(l,h,g){h=Sa(g,h),h=ld(l.stateNode,h,2),l=ks(l,h,2),l!==null&&(mr(l,2),tu(l))}function An(l,h,g){if(l.tag===3)q_(l,l,g);else for(;h!==null;){if(h.tag===3){q_(h,l,g);break}else if(h.tag===1){var S=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Gu===null||!Gu.has(S))){l=Sa(g,l),g=Dc(2),S=ks(h,g,2),S!==null&&(ud(g,S,h,l),mr(S,2),tu(S));break}}h=h.return}}function Ym(l,h,g){var S=l.pingCache;if(S===null){S=l.pingCache=new _p;var I=new Set;S.set(h,I)}else I=S.get(h),I===void 0&&(I=new Set,S.set(h,I));I.has(g)||(qh=!0,I.add(g),l=Cy.bind(null,l,h,g),h.then(l,l))}function Cy(l,h,g){var S=l.pingCache;S!==null&&S.delete(h),l.pingedLanes|=l.suspendedLanes&g,l.warmLanes&=~g,In===l&&(Hr&g)===g&&(vi===4||vi===3&&(Hr&62914560)===Hr&&300>kn()-Vm?(pn&2)===0&&Gh(l,0):Um|=g,md===Hr&&(md=0)),tu(l)}function Dy(l,h){h===0&&(h=lr()),l=Lo(l,h),l!==null&&(mr(l,h),tu(l))}function Bc(l){var h=l.memoizedState,g=0;h!==null&&(g=h.retryLane),Dy(l,g)}function Xm(l,h){var g=0;switch(l.tag){case 31:case 13:var S=l.stateNode,I=l.memoizedState;I!==null&&(g=I.retryLane);break;case 19:S=l.stateNode;break;case 22:S=l.stateNode._retryCache;break;default:throw Error(o(314))}S!==null&&S.delete(h),Dy(l,g)}function Oy(l,h){return ka(l,h)}var Km=null,Hh=null,Iy=!1,Qm=!1,zy=!1,Fc=0;function tu(l){l!==Hh&&l.next===null&&(Hh===null?Km=Hh=l:Hh=Hh.next=l),Qm=!0,Iy||(Iy=!0,Bb())}function _d(l,h){if(!zy&&Qm){zy=!0;do for(var g=!1,S=Km;S!==null;){if(l!==0){var I=S.pendingLanes;if(I===0)var j=0;else{var Q=S.suspendedLanes,ce=S.pingedLanes;j=(1<<31-Te(42|l)+1)-1,j&=I&~(Q&~ce),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(g=!0,Jm(S,j))}else j=Hr,j=qt(S,S===In?j:0,S.cancelPendingCommit!==null||S.timeoutHandle!==-1),(j&3)===0||hr(S,j)||(g=!0,Jm(S,j));S=S.next}while(g);zy=!1}}function $_(){ru()}function ru(){Qm=Iy=!1;var l=0;Fc!==0&&r0()&&(l=Fc);for(var h=kn(),g=null,S=Km;S!==null;){var I=S.next,j=Wu(S,h);j===0?(S.next=null,g===null?Km=I:g.next=I,I===null&&(Hh=g)):(g=S,(l!==0||(j&3)!==0)&&(Qm=!0)),S=I}Oi!==0&&Oi!==5||_d(l),Fc!==0&&(Fc=0)}function Wu(l,h){for(var g=l.suspendedLanes,S=l.pingedLanes,I=l.expirationTimes,j=l.pendingLanes&-62914561;0<j;){var Q=31-Te(j),ce=1<<Q,ke=I[Q];ke===-1?((ce&g)===0||(ce&S)!==0)&&(I[Q]=Yt(ce,h)):ke<=h&&(l.expiredLanes|=ce),j&=~ce}if(h=In,g=Hr,g=qt(l,l===h?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),S=l.callbackNode,g===0||l===h&&(En===2||En===9)||l.cancelPendingCommit!==null)return S!==null&&S!==null&&pa(S),l.callbackNode=null,l.callbackPriority=0;if((g&3)===0||hr(l,g)){if(h=g&-g,h===l.callbackPriority)return h;switch(S!==null&&pa(S),Et(g)){case 2:case 8:g=ta;break;case 32:g=ga;break;case 268435456:g=ws;break;default:g=ga}return S=ky.bind(null,l),g=ka(g,S),l.callbackPriority=h,l.callbackNode=g,h}return S!==null&&S!==null&&pa(S),l.callbackPriority=2,l.callbackNode=null,2}function ky(l,h){if(Oi!==0&&Oi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var g=l.callbackNode;if(Wm()&&l.callbackNode!==g)return null;var S=Hr;return S=qt(l,l===In?S:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),S===0?null:(O_(l,S,h),Wu(l,kn()),l.callbackNode!=null&&l.callbackNode===g?ky.bind(null,l):null)}function Jm(l,h){if(Wm())return null;O_(l,h,!0)}function Bb(){qy(function(){(pn&6)!==0?ka(co,$_):ru()})}function xd(){if(Fc===0){var l=Au;l===0&&(l=Ve,Ve<<=1,(Ve&261888)===0&&(Ve=256)),Fc=l}return Fc}function eg(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Ot(""+l)}function G_(l,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,l.id&&g.setAttribute("form",l.id),h.parentNode.insertBefore(g,h),l=new FormData(l),g.parentNode.removeChild(g),l}function Ry(l,h,g,S,I){if(h==="submit"&&g&&g.stateNode===I){var j=eg((I[xt]||null).action),Q=S.submitter;Q&&(h=(h=Q[xt]||null)?eg(h.formAction):Q.getAttribute("formAction"),h!==null&&(j=h,Q=null));var ce=new Ri("action","action",null,S,I);l.push({event:ce,listeners:[{instance:null,listener:function(){if(S.defaultPrevented){if(Fc!==0){var ke=Q?G_(I,Q):new FormData(I);Di(g,{pending:!0,data:ke,method:I.method,action:j},null,ke)}}else typeof j=="function"&&(ce.preventDefault(),ke=Q?G_(I,Q):new FormData(I),Di(g,{pending:!0,data:ke,method:I.method,action:j},j,ke))},currentTarget:I}]})}}for(var bp=0;bp<Vf.length;bp++){var Uc=Vf[bp],Z_=Uc.toLowerCase(),H_=Uc[0].toUpperCase()+Uc.slice(1);go(Z_,"on"+H_)}go(Th,"onAnimationEnd"),go(Eh,"onAnimationIteration"),go(Uf,"onAnimationStart"),go("dblclick","onDoubleClick"),go("focusin","onFocus"),go("focusout","onBlur"),go(bu,"onTransitionRun"),go(Ah,"onTransitionStart"),go(_c,"onTransitionCancel"),go(mo,"onTransitionEnd"),zi("onMouseEnter",["mouseout","mouseover"]),zi("onMouseLeave",["mouseout","mouseover"]),zi("onPointerEnter",["pointerout","pointerover"]),zi("onPointerLeave",["pointerout","pointerover"]),Ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ur("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wh));function wp(l,h){h=(h&4)!==0;for(var g=0;g<l.length;g++){var S=l[g],I=S.event;S=S.listeners;e:{var j=void 0;if(h)for(var Q=S.length-1;0<=Q;Q--){var ce=S[Q],ke=ce.instance,Ke=ce.currentTarget;if(ce=ce.listener,ke!==j&&I.isPropagationStopped())break e;j=ce,I.currentTarget=Ke;try{j(I)}catch(vt){Ms(vt)}I.currentTarget=null,j=ke}else for(Q=0;Q<S.length;Q++){if(ce=S[Q],ke=ce.instance,Ke=ce.currentTarget,ce=ce.listener,ke!==j&&I.isPropagationStopped())break e;j=ce,I.currentTarget=Ke;try{j(I)}catch(vt){Ms(vt)}I.currentTarget=null,j=ke}}}}function Fr(l,h){var g=h[sr];g===void 0&&(g=h[sr]=new Set);var S=l+"__bubble";g.has(S)||(Y_(h,l,2,!1),g.add(S))}function jy(l,h,g){var S=0;h&&(S|=4),Y_(g,l,S,h)}var tg="_reactListening"+Math.random().toString(36).slice(2);function Ly(l){if(!l[tg]){l[tg]=!0,Tl.forEach(function(g){g!=="selectionchange"&&(W_.has(g)||jy(g,!1,l),jy(g,!0,l))});var h=l.nodeType===9?l:l.ownerDocument;h===null||h[tg]||(h[tg]=!0,jy("selectionchange",!1,h))}}function Y_(l,h,g,S){switch(ef(h)){case 2:var I=g0;break;case 8:I=Ip;break;default:I=ev}g=I.bind(null,h,g,l),I=void 0,!ki||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(I=!0),S?I!==void 0?l.addEventListener(h,g,{capture:!0,passive:I}):l.addEventListener(h,g,!0):I!==void 0?l.addEventListener(h,g,{passive:I}):l.addEventListener(h,g,!1)}function Ny(l,h,g,S,I){var j=S;if((h&1)===0&&(h&2)===0&&S!==null)e:for(;;){if(S===null)return;var Q=S.tag;if(Q===3||Q===4){var ce=S.stateNode.containerInfo;if(ce===I)break;if(Q===4)for(Q=S.return;Q!==null;){var ke=Q.tag;if((ke===3||ke===4)&&Q.stateNode.containerInfo===I)return;Q=Q.return}for(;ce!==null;){if(Q=ja(ce),Q===null)return;if(ke=Q.tag,ke===5||ke===6||ke===26||ke===27){S=j=Q;continue e}ce=ce.parentNode}}S=S.return}Wt(function(){var Ke=j,vt=Yr(g),At=[];e:{var it=np.get(l);if(it!==void 0){var ct=Ri,er=l;switch(l){case"keypress":if(gi(g)===0)break e;case"keydown":case"keyup":ct=Ks;break;case"focusin":er="focus",ct=Ba;break;case"focusout":er="blur",ct=Ba;break;case"beforeblur":case"afterblur":ct=Ba;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=br;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Br;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=hm;break;case Th:case Eh:case Uf:ct=Pf;break;case mo:ct=dc;break;case"scroll":case"scrollend":ct=dh;break;case"wheel":ct=mh;break;case"copy":case"cut":case"paste":ct=Df;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=Wd;break;case"toggle":case"beforetoggle":ct=zf}var _r=(h&4)!==0,Mn=!_r&&(l==="scroll"||l==="scrollend"),$e=_r?it!==null?it+"Capture":null:it;_r=[];for(var Le=Ke,et;Le!==null;){var wt=Le;if(et=wt.stateNode,wt=wt.tag,wt!==5&&wt!==26&&wt!==27||et===null||$e===null||(wt=Zn(Le,$e),wt!=null&&_r.push(Yh(Le,wt,et))),Mn)break;Le=Le.return}0<_r.length&&(it=new ct(it,er,null,g,vt),At.push({event:it,listeners:_r}))}}if((h&7)===0){e:{if(it=l==="mouseover"||l==="pointerover",ct=l==="mouseout"||l==="pointerout",it&&g!==Gt&&(er=g.relatedTarget||g.fromElement)&&(ja(er)||er[ur]))break e;if((ct||it)&&(it=vt.window===vt?vt:(it=vt.ownerDocument)?it.defaultView||it.parentWindow:window,ct?(er=g.relatedTarget||g.toElement,ct=Ke,er=er?ja(er):null,er!==null&&(Mn=y(er),_r=er.tag,er!==Mn||_r!==5&&_r!==27&&_r!==6)&&(er=null)):(ct=null,er=Ke),ct!==er)){if(_r=br,wt="onMouseLeave",$e="onMouseEnter",Le="mouse",(l==="pointerout"||l==="pointerover")&&(_r=Wd,wt="onPointerLeave",$e="onPointerEnter",Le="pointer"),Mn=ct==null?it:va(ct),et=er==null?it:va(er),it=new _r(wt,Le+"leave",ct,g,vt),it.target=Mn,it.relatedTarget=et,wt=null,ja(vt)===Ke&&(_r=new _r($e,Le+"enter",er,g,vt),_r.target=et,_r.relatedTarget=Mn,wt=_r),Mn=wt,ct&&er)t:{for(_r=X_,$e=ct,Le=er,et=0,wt=$e;wt;wt=_r(wt))et++;wt=0;for(var cr=Le;cr;cr=_r(cr))wt++;for(;0<et-wt;)$e=_r($e),et--;for(;0<wt-et;)Le=_r(Le),wt--;for(;et--;){if($e===Le||Le!==null&&$e===Le.alternate){_r=$e;break t}$e=_r($e),Le=_r(Le)}_r=null}else _r=null;ct!==null&&By(At,it,ct,_r,!1),er!==null&&Mn!==null&&By(At,Mn,er,_r,!0)}}e:{if(it=Ke?va(Ke):window,ct=it.nodeName&&it.nodeName.toLowerCase(),ct==="select"||ct==="input"&&it.type==="file")var Qr=Dl;else if(jf(it))if(Xd)Qr=xh;else{Qr=mm;var or=iy}else ct=it.nodeName,!ct||ct.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?Ke&&Pt(Ke.elementType)&&(Qr=Dl):Qr=gm;if(Qr&&(Qr=Qr(l,Ke))){vh(At,Qr,g,vt);break e}or&&or(l,it,Ke),l==="focusout"&&Ke&&it.type==="number"&&Ke.memoizedProps.value!=null&&jo(it,"number",it.value)}switch(or=Ke?va(Ke):window,l){case"focusin":(jf(or)||or.contentEditable==="true")&&(po=or,wh=Ke,Sh=null);break;case"focusout":Sh=wh=po=null;break;case"mousedown":Jd=!0;break;case"contextmenu":case"mouseup":case"dragend":Jd=!1,ep(At,g,vt);break;case"selectionchange":if(Ff)break;case"keydown":case"keyup":ep(At,g,vt)}var zr;if(xa)e:{switch(l){case"compositionstart":var Wr="onCompositionStart";break e;case"compositionend":Wr="onCompositionEnd";break e;case"compositionupdate":Wr="onCompositionUpdate";break e}Wr=void 0}else ts?gh(l,g)&&(Wr="onCompositionEnd"):l==="keydown"&&g.keyCode===229&&(Wr="onCompositionStart");Wr&&(Qs&&g.locale!=="ko"&&(ts||Wr!=="onCompositionStart"?Wr==="onCompositionEnd"&&ts&&(zr=Na()):(La=vt,wn="value"in La?La.value:La.textContent,ts=!0)),or=dl(Ke,Wr),0<or.length&&(Wr=new cm(Wr,l,null,g,vt),At.push({event:Wr,listeners:or}),zr?Wr.data=zr:(zr=fm(g),zr!==null&&(Wr.data=zr)))),(zr=kf?ry(l,g):yh(l,g))&&(Wr=dl(Ke,"onBeforeInput"),0<Wr.length&&(or=new cm("onBeforeInput","beforeinput",null,g,vt),At.push({event:or,listeners:Wr}),or.data=zr)),Ry(At,l,Ke,g,vt)}wp(At,h)})}function Yh(l,h,g){return{instance:l,listener:h,currentTarget:g}}function dl(l,h){for(var g=h+"Capture",S=[];l!==null;){var I=l,j=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||j===null||(I=Zn(l,g),I!=null&&S.unshift(Yh(l,I,j)),I=Zn(l,h),I!=null&&S.push(Yh(l,I,j))),l.tag===3)return S;l=l.return}return[]}function X_(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function By(l,h,g,S,I){for(var j=h._reactName,Q=[];g!==null&&g!==S;){var ce=g,ke=ce.alternate,Ke=ce.stateNode;if(ce=ce.tag,ke!==null&&ke===S)break;ce!==5&&ce!==26&&ce!==27||Ke===null||(ke=Ke,I?(Ke=Zn(g,j),Ke!=null&&Q.unshift(Yh(g,Ke,ke))):I||(Ke=Zn(g,j),Ke!=null&&Q.push(Yh(g,Ke,ke)))),g=g.return}Q.length!==0&&l.push({event:h,listeners:Q})}var K_=/\r\n?/g,Q_=/\u0000|\uFFFD/g;function Fy(l){return(typeof l=="string"?l:""+l).replace(K_,`
`).replace(Q_,"")}function Uy(l,h){return h=Fy(h),Fy(l)===h}function mn(l,h,g,S,I,j){switch(g){case"children":typeof S=="string"?h==="body"||h==="textarea"&&S===""||fo(l,S):(typeof S=="number"||typeof S=="bigint")&&h!=="body"&&fo(l,""+S);break;case"className":Al(l,"class",S);break;case"tabIndex":Al(l,"tabindex",S);break;case"dir":case"role":case"viewBox":case"width":case"height":Al(l,g,S);break;case"style":Fe(l,S,j);break;case"data":if(h!=="object"){Al(l,"data",S);break}case"src":case"href":if(S===""&&(h!=="a"||g!=="href")){l.removeAttribute(g);break}if(S==null||typeof S=="function"||typeof S=="symbol"||typeof S=="boolean"){l.removeAttribute(g);break}S=Ot(""+S),l.setAttribute(g,S);break;case"action":case"formAction":if(typeof S=="function"){l.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(g==="formAction"?(h!=="input"&&mn(l,h,"name",I.name,I,null),mn(l,h,"formEncType",I.formEncType,I,null),mn(l,h,"formMethod",I.formMethod,I,null),mn(l,h,"formTarget",I.formTarget,I,null)):(mn(l,h,"encType",I.encType,I,null),mn(l,h,"method",I.method,I,null),mn(l,h,"target",I.target,I,null)));if(S==null||typeof S=="symbol"||typeof S=="boolean"){l.removeAttribute(g);break}S=Ot(""+S),l.setAttribute(g,S);break;case"onClick":S!=null&&(l.onclick=nr);break;case"onScroll":S!=null&&Fr("scroll",l);break;case"onScrollEnd":S!=null&&Fr("scrollend",l);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(o(61));if(g=S.__html,g!=null){if(I.children!=null)throw Error(o(60));l.innerHTML=g}}break;case"multiple":l.multiple=S&&typeof S!="function"&&typeof S!="symbol";break;case"muted":l.muted=S&&typeof S!="function"&&typeof S!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(S==null||typeof S=="function"||typeof S=="boolean"||typeof S=="symbol"){l.removeAttribute("xlink:href");break}g=Ot(""+S),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":S!=null&&typeof S!="function"&&typeof S!="symbol"?l.setAttribute(g,""+S):l.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":S&&typeof S!="function"&&typeof S!="symbol"?l.setAttribute(g,""):l.removeAttribute(g);break;case"capture":case"download":S===!0?l.setAttribute(g,""):S!==!1&&S!=null&&typeof S!="function"&&typeof S!="symbol"?l.setAttribute(g,S):l.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":S!=null&&typeof S!="function"&&typeof S!="symbol"&&!isNaN(S)&&1<=S?l.setAttribute(g,S):l.removeAttribute(g);break;case"rowSpan":case"start":S==null||typeof S=="function"||typeof S=="symbol"||isNaN(S)?l.removeAttribute(g):l.setAttribute(g,S);break;case"popover":Fr("beforetoggle",l),Fr("toggle",l),Jo(l,"popover",S);break;case"xlinkActuate":Zi(l,"http://www.w3.org/1999/xlink","xlink:actuate",S);break;case"xlinkArcrole":Zi(l,"http://www.w3.org/1999/xlink","xlink:arcrole",S);break;case"xlinkRole":Zi(l,"http://www.w3.org/1999/xlink","xlink:role",S);break;case"xlinkShow":Zi(l,"http://www.w3.org/1999/xlink","xlink:show",S);break;case"xlinkTitle":Zi(l,"http://www.w3.org/1999/xlink","xlink:title",S);break;case"xlinkType":Zi(l,"http://www.w3.org/1999/xlink","xlink:type",S);break;case"xmlBase":Zi(l,"http://www.w3.org/XML/1998/namespace","xml:base",S);break;case"xmlLang":Zi(l,"http://www.w3.org/XML/1998/namespace","xml:lang",S);break;case"xmlSpace":Zi(l,"http://www.w3.org/XML/1998/namespace","xml:space",S);break;case"is":Jo(l,"is",S);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=Nt.get(g)||g,Jo(l,g,S))}}function rg(l,h,g,S,I,j){switch(g){case"style":Fe(l,S,j);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(o(61));if(g=S.__html,g!=null){if(I.children!=null)throw Error(o(60));l.innerHTML=g}}break;case"children":typeof S=="string"?fo(l,S):(typeof S=="number"||typeof S=="bigint")&&fo(l,""+S);break;case"onScroll":S!=null&&Fr("scroll",l);break;case"onScrollEnd":S!=null&&Fr("scrollend",l);break;case"onClick":S!=null&&(l.onclick=nr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gr.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),h=g.slice(2,I?g.length-7:void 0),j=l[xt]||null,j=j!=null?j[g]:null,typeof j=="function"&&l.removeEventListener(h,j,I),typeof S=="function")){typeof j!="function"&&j!==null&&(g in l?l[g]=null:l.hasAttribute(g)&&l.removeAttribute(g)),l.addEventListener(h,S,I);break e}g in l?l[g]=S:S===!0?l.setAttribute(g,""):Jo(l,g,S)}}}function Ii(l,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fr("error",l),Fr("load",l);var S=!1,I=!1,j;for(j in g)if(g.hasOwnProperty(j)){var Q=g[j];if(Q!=null)switch(j){case"src":S=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,h));default:mn(l,h,j,Q,g,null)}}I&&mn(l,h,"srcSet",g.srcSet,g,null),S&&mn(l,h,"src",g.src,g,null);return;case"input":Fr("invalid",l);var ce=j=Q=I=null,ke=null,Ke=null;for(S in g)if(g.hasOwnProperty(S)){var vt=g[S];if(vt!=null)switch(S){case"name":I=vt;break;case"type":Q=vt;break;case"checked":ke=vt;break;case"defaultChecked":Ke=vt;break;case"value":j=vt;break;case"defaultValue":ce=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(o(137,h));break;default:mn(l,h,S,vt,g,null)}}es(l,j,ce,ke,Ke,Q,I,!1);return;case"select":Fr("invalid",l),S=Q=j=null;for(I in g)if(g.hasOwnProperty(I)&&(ce=g[I],ce!=null))switch(I){case"value":j=ce;break;case"defaultValue":Q=ce;break;case"multiple":S=ce;default:mn(l,h,I,ce,g,null)}h=j,g=Q,l.multiple=!!S,h!=null?ri(l,!!S,h,!1):g!=null&&ri(l,!!S,g,!0);return;case"textarea":Fr("invalid",l),j=I=S=null;for(Q in g)if(g.hasOwnProperty(Q)&&(ce=g[Q],ce!=null))switch(Q){case"value":S=ce;break;case"defaultValue":I=ce;break;case"children":j=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(o(91));break;default:mn(l,h,Q,ce,g,null)}Cl(l,S,I,j);return;case"option":for(ke in g)g.hasOwnProperty(ke)&&(S=g[ke],S!=null)&&(ke==="selected"?l.selected=S&&typeof S!="function"&&typeof S!="symbol":mn(l,h,ke,S,g,null));return;case"dialog":Fr("beforetoggle",l),Fr("toggle",l),Fr("cancel",l),Fr("close",l);break;case"iframe":case"object":Fr("load",l);break;case"video":case"audio":for(S=0;S<Wh.length;S++)Fr(Wh[S],l);break;case"image":Fr("error",l),Fr("load",l);break;case"details":Fr("toggle",l);break;case"embed":case"source":case"link":Fr("error",l),Fr("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ke in g)if(g.hasOwnProperty(Ke)&&(S=g[Ke],S!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,h));default:mn(l,h,Ke,S,g,null)}return;default:if(Pt(h)){for(vt in g)g.hasOwnProperty(vt)&&(S=g[vt],S!==void 0&&rg(l,h,vt,S,g,void 0));return}}for(ce in g)g.hasOwnProperty(ce)&&(S=g[ce],S!=null&&mn(l,h,ce,S,g,null))}function J_(l,h,g,S){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,j=null,Q=null,ce=null,ke=null,Ke=null,vt=null;for(ct in g){var At=g[ct];if(g.hasOwnProperty(ct)&&At!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":ke=At;default:S.hasOwnProperty(ct)||mn(l,h,ct,null,S,At)}}for(var it in S){var ct=S[it];if(At=g[it],S.hasOwnProperty(it)&&(ct!=null||At!=null))switch(it){case"type":j=ct;break;case"name":I=ct;break;case"checked":Ke=ct;break;case"defaultChecked":vt=ct;break;case"value":Q=ct;break;case"defaultValue":ce=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(o(137,h));break;default:ct!==At&&mn(l,h,it,ct,S,At)}}Pl(l,Q,ce,ke,Ke,vt,j,I);return;case"select":ct=Q=ce=it=null;for(j in g)if(ke=g[j],g.hasOwnProperty(j)&&ke!=null)switch(j){case"value":break;case"multiple":ct=ke;default:S.hasOwnProperty(j)||mn(l,h,j,null,S,ke)}for(I in S)if(j=S[I],ke=g[I],S.hasOwnProperty(I)&&(j!=null||ke!=null))switch(I){case"value":it=j;break;case"defaultValue":ce=j;break;case"multiple":Q=j;default:j!==ke&&mn(l,h,I,j,S,ke)}h=ce,g=Q,S=ct,it!=null?ri(l,!!g,it,!1):!!S!=!!g&&(h!=null?ri(l,!!g,h,!0):ri(l,!!g,g?[]:"",!1));return;case"textarea":ct=it=null;for(ce in g)if(I=g[ce],g.hasOwnProperty(ce)&&I!=null&&!S.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:mn(l,h,ce,null,S,I)}for(Q in S)if(I=S[Q],j=g[Q],S.hasOwnProperty(Q)&&(I!=null||j!=null))switch(Q){case"value":it=I;break;case"defaultValue":ct=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(o(91));break;default:I!==j&&mn(l,h,Q,I,S,j)}fh(l,it,ct);return;case"option":for(var er in g)it=g[er],g.hasOwnProperty(er)&&it!=null&&!S.hasOwnProperty(er)&&(er==="selected"?l.selected=!1:mn(l,h,er,null,S,it));for(ke in S)it=S[ke],ct=g[ke],S.hasOwnProperty(ke)&&it!==ct&&(it!=null||ct!=null)&&(ke==="selected"?l.selected=it&&typeof it!="function"&&typeof it!="symbol":mn(l,h,ke,it,S,ct));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _r in g)it=g[_r],g.hasOwnProperty(_r)&&it!=null&&!S.hasOwnProperty(_r)&&mn(l,h,_r,null,S,it);for(Ke in S)if(it=S[Ke],ct=g[Ke],S.hasOwnProperty(Ke)&&it!==ct&&(it!=null||ct!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(o(137,h));break;default:mn(l,h,Ke,it,S,ct)}return;default:if(Pt(h)){for(var Mn in g)it=g[Mn],g.hasOwnProperty(Mn)&&it!==void 0&&!S.hasOwnProperty(Mn)&&rg(l,h,Mn,void 0,S,it);for(vt in S)it=S[vt],ct=g[vt],!S.hasOwnProperty(vt)||it===ct||it===void 0&&ct===void 0||rg(l,h,vt,it,S,ct);return}}for(var $e in g)it=g[$e],g.hasOwnProperty($e)&&it!=null&&!S.hasOwnProperty($e)&&mn(l,h,$e,null,S,it);for(At in S)it=S[At],ct=g[At],!S.hasOwnProperty(At)||it===ct||it==null&&ct==null||mn(l,h,At,it,S,ct)}function ng(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e0(){if(typeof performance.getEntriesByType=="function"){for(var l=0,h=0,g=performance.getEntriesByType("resource"),S=0;S<g.length;S++){var I=g[S],j=I.transferSize,Q=I.initiatorType,ce=I.duration;if(j&&ce&&ng(Q)){for(Q=0,ce=I.responseEnd,S+=1;S<g.length;S++){var ke=g[S],Ke=ke.startTime;if(Ke>ce)break;var vt=ke.transferSize,At=ke.initiatorType;vt&&ng(At)&&(ke=ke.responseEnd,Q+=vt*(ke<ce?1:(ce-Ke)/(ke-Ke)))}if(--S,h+=8*(j+Q)/(I.duration/1e3),l++,10<l)break}}if(0<l)return h/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Ya=null,Vc=null;function bd(l){return l.nodeType===9?l:l.ownerDocument}function t0(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vy(l,h){if(l===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&h==="foreignObject"?0:l}function Yu(l,h){return l==="textarea"||l==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var ig=null;function r0(){var l=window.event;return l&&l.type==="popstate"?l===ig?!1:(ig=l,!0):(ig=null,!1)}var Xh=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,og=typeof Promise=="function"?Promise:void 0,qy=typeof queueMicrotask=="function"?queueMicrotask:typeof og<"u"?function(l){return og.resolve(null).then(l).catch(n0)}:Xh;function n0(l){setTimeout(function(){throw l})}function nu(l){return l==="head"}function sg(l,h){var g=h,S=0;do{var I=g.nextSibling;if(l.removeChild(g),I&&I.nodeType===8)if(g=I.data,g==="/$"||g==="/&"){if(S===0){l.removeChild(I),Od(h);return}S--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")S++;else if(g==="html")Kh(l.ownerDocument.documentElement);else if(g==="head"){g=l.ownerDocument.head,Kh(g);for(var j=g.firstChild;j;){var Q=j.nextSibling,ce=j.nodeName;j[gr]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&j.rel.toLowerCase()==="stylesheet"||g.removeChild(j),j=Q}}else g==="body"&&Kh(l.ownerDocument.body);g=I}while(g);Od(h)}function i0(l,h){var g=l;l=0;do{var S=g.nextSibling;if(g.nodeType===1?h?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(h?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),S&&S.nodeType===8)if(g=S.data,g==="/$"){if(l===0)break;l--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||l++;g=S}while(g)}function $y(l){var h=l.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":$y(g),Ts(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}l.removeChild(g)}}function cn(l,h,g,S){for(;l.nodeType===1;){var I=g;if(l.nodeName.toLowerCase()!==h.toLowerCase()){if(!S&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(S){if(!l[gr])switch(h){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(j=l.getAttribute("rel"),j==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(j!==I.rel||l.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||l.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||l.getAttribute("title")!==(I.title==null?null:I.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(j=l.getAttribute("src"),(j!==(I.src==null?null:I.src)||l.getAttribute("type")!==(I.type==null?null:I.type)||l.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&j&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(h==="input"&&l.type==="hidden"){var j=I.name==null?null:""+I.name;if(I.type==="hidden"&&l.getAttribute("name")===j)return l}else return l;if(l=Kr(l.nextSibling),l===null)break}return null}function qc(l,h,g){if(h==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!g||(l=Kr(l.nextSibling),l===null))return null;return l}function Ji(l,h){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!h||(l=Kr(l.nextSibling),l===null))return null;return l}function ds(l){return l.data==="$?"||l.data==="$~"}function Xu(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function Vo(l,h){var g=l.ownerDocument;if(l.data==="$~")l._reactRetry=h;else if(l.data!=="$?"||g.readyState!=="loading")h();else{var S=function(){h(),g.removeEventListener("DOMContentLoaded",S)};g.addEventListener("DOMContentLoaded",S),l._reactRetry=S}}function Kr(l){for(;l!=null;l=l.nextSibling){var h=l.nodeType;if(h===1||h===3)break;if(h===8){if(h=l.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return l}var _i=null;function Gy(l){l=l.nextSibling;for(var h=0;l;){if(l.nodeType===8){var g=l.data;if(g==="/$"||g==="/&"){if(h===0)return Kr(l.nextSibling);h--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||h++}l=l.nextSibling}return null}function qo(l){l=l.previousSibling;for(var h=0;l;){if(l.nodeType===8){var g=l.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(h===0)return l;h--}else g!=="/$"&&g!=="/&"||h++}l=l.previousSibling}return null}function ca(l,h,g){switch(h=bd(g),l){case"html":if(l=h.documentElement,!l)throw Error(o(452));return l;case"head":if(l=h.head,!l)throw Error(o(453));return l;case"body":if(l=h.body,!l)throw Error(o(454));return l;default:throw Error(o(451))}}function Kh(l){for(var h=l.attributes;h.length;)l.removeAttributeNode(h[0]);Ts(l)}var Fs=new Map,a0=new Set;function zn(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var xi=at.d;at.d={f:wd,r:o0,D:s0,C:Hy,L:Xa,m:pl,X:Ka,S:lg,M:$c};function wd(){var l=xi.f(),h=Gm();return l||h}function o0(l){var h=Xo(l);h!==null&&h.tag===5&&h.type==="form"?qn(h):xi.r(l)}var Qh=typeof document>"u"?null:document;function Zy(l,h,g){var S=Qh;if(S&&typeof h=="string"&&h){var I=Hi(h);I='link[rel="'+l+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),a0.has(I)||(a0.add(I),l={rel:l,crossOrigin:g,href:h},S.querySelector(I)===null&&(h=S.createElement("link"),Ii(h,"link",l),Dn(h),S.head.appendChild(h)))}}function s0(l){xi.D(l),Zy("dns-prefetch",l,null)}function Hy(l,h){xi.C(l,h),Zy("preconnect",l,h)}function Xa(l,h,g){xi.L(l,h,g);var S=Qh;if(S&&l&&h){var I='link[rel="preload"][as="'+Hi(h)+'"]';h==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+Hi(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+Hi(g.imageSizes)+'"]')):I+='[href="'+Hi(l)+'"]';var j=I;switch(h){case"style":j=Gc(l);break;case"script":j=Jh(l)}Fs.has(j)||(l=k({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:l,as:h},g),Fs.set(j,l),S.querySelector(I)!==null||h==="style"&&S.querySelector(Sd(j))||h==="script"&&S.querySelector(Zc(j))||(h=S.createElement("link"),Ii(h,"link",l),Dn(h),S.head.appendChild(h)))}}function pl(l,h){xi.m(l,h);var g=Qh;if(g&&l){var S=h&&typeof h.as=="string"?h.as:"script",I='link[rel="modulepreload"][as="'+Hi(S)+'"][href="'+Hi(l)+'"]',j=I;switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=Jh(l)}if(!Fs.has(j)&&(l=k({rel:"modulepreload",href:l},h),Fs.set(j,l),g.querySelector(I)===null)){switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Zc(j)))return}S=g.createElement("link"),Ii(S,"link",l),Dn(S),g.head.appendChild(S)}}}function lg(l,h,g){xi.S(l,h,g);var S=Qh;if(S&&l){var I=Ir(S).hoistableStyles,j=Gc(l);h=h||"default";var Q=I.get(j);if(!Q){var ce={loading:0,preload:null};if(Q=S.querySelector(Sd(j)))ce.loading=5;else{l=k({rel:"stylesheet",href:l,"data-precedence":h},g),(g=Fs.get(j))&&Hc(l,g);var ke=Q=S.createElement("link");Dn(ke),Ii(ke,"link",l),ke._p=new Promise(function(Ke,vt){ke.onload=Ke,ke.onerror=vt}),ke.addEventListener("load",function(){ce.loading|=1}),ke.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,Tp(Q,h,S)}Q={type:"stylesheet",instance:Q,count:1,state:ce},I.set(j,Q)}}}function Ka(l,h){xi.X(l,h);var g=Qh;if(g&&l){var S=Ir(g).hoistableScripts,I=Jh(l),j=S.get(I);j||(j=g.querySelector(Zc(I)),j||(l=k({src:l,async:!0},h),(h=Fs.get(I))&&Ep(l,h),j=g.createElement("script"),Dn(j),Ii(j,"link",l),g.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},S.set(I,j))}}function $c(l,h){xi.M(l,h);var g=Qh;if(g&&l){var S=Ir(g).hoistableScripts,I=Jh(l),j=S.get(I);j||(j=g.querySelector(Zc(I)),j||(l=k({src:l,async:!0,type:"module"},h),(h=Fs.get(I))&&Ep(l,h),j=g.createElement("script"),Dn(j),Ii(j,"link",l),g.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},S.set(I,j))}}function Sp(l,h,g,S){var I=(I=Lt.current)?zn(I):null;if(!I)throw Error(o(446));switch(l){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=Gc(g.href),g=Ir(I).hoistableStyles,S=g.get(h),S||(S={type:"style",instance:null,count:0,state:null},g.set(h,S)),S):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){l=Gc(g.href);var j=Ir(I).hoistableStyles,Q=j.get(l);if(Q||(I=I.ownerDocument||I,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(l,Q),(j=I.querySelector(Sd(l)))&&!j._p&&(Q.instance=j,Q.state.loading=5),Fs.has(l)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Fs.set(l,g),j||l0(I,l,g,Q.state))),h&&S===null)throw Error(o(528,""));return Q}if(h&&S!==null)throw Error(o(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Jh(g),g=Ir(I).hoistableScripts,S=g.get(h),S||(S={type:"script",instance:null,count:0,state:null},g.set(h,S)),S):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,l))}}function Gc(l){return'href="'+Hi(l)+'"'}function Sd(l){return'link[rel="stylesheet"]['+l+"]"}function Wy(l){return k({},l,{"data-precedence":l.precedence,precedence:null})}function l0(l,h,g,S){l.querySelector('link[rel="preload"][as="style"]['+h+"]")?S.loading=1:(h=l.createElement("link"),S.preload=h,h.addEventListener("load",function(){return S.loading|=1}),h.addEventListener("error",function(){return S.loading|=2}),Ii(h,"link",g),Dn(h),l.head.appendChild(h))}function Jh(l){return'[src="'+Hi(l)+'"]'}function Zc(l){return"script[async]"+l}function Yy(l,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var S=l.querySelector('style[data-href~="'+Hi(g.href)+'"]');if(S)return h.instance=S,Dn(S),S;var I=k({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return S=(l.ownerDocument||l).createElement("style"),Dn(S),Ii(S,"style",I),Tp(S,g.precedence,l),h.instance=S;case"stylesheet":I=Gc(g.href);var j=l.querySelector(Sd(I));if(j)return h.state.loading|=4,h.instance=j,Dn(j),j;S=Wy(g),(I=Fs.get(I))&&Hc(S,I),j=(l.ownerDocument||l).createElement("link"),Dn(j);var Q=j;return Q._p=new Promise(function(ce,ke){Q.onload=ce,Q.onerror=ke}),Ii(j,"link",S),h.state.loading|=4,Tp(j,g.precedence,l),h.instance=j;case"script":return j=Jh(g.src),(I=l.querySelector(Zc(j)))?(h.instance=I,Dn(I),I):(S=g,(I=Fs.get(j))&&(S=k({},g),Ep(S,I)),l=l.ownerDocument||l,I=l.createElement("script"),Dn(I),Ii(I,"link",S),l.head.appendChild(I),h.instance=I);case"void":return null;default:throw Error(o(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(S=h.instance,h.state.loading|=4,Tp(S,g.precedence,l));return h.instance}function Tp(l,h,g){for(var S=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=S.length?S[S.length-1]:null,j=I,Q=0;Q<S.length;Q++){var ce=S[Q];if(ce.dataset.precedence===h)j=ce;else if(j!==I)break}j?j.parentNode.insertBefore(l,j.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(l,h.firstChild))}function Hc(l,h){l.crossOrigin==null&&(l.crossOrigin=h.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=h.referrerPolicy),l.title==null&&(l.title=h.title)}function Ep(l,h){l.crossOrigin==null&&(l.crossOrigin=h.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=h.referrerPolicy),l.integrity==null&&(l.integrity=h.integrity)}var Ap=null;function u0(l,h,g){if(Ap===null){var S=new Map,I=Ap=new Map;I.set(g,S)}else I=Ap,S=I.get(g),S||(S=new Map,I.set(g,S));if(S.has(l))return S;for(S.set(l,null),g=g.getElementsByTagName(l),I=0;I<g.length;I++){var j=g[I];if(!(j[gr]||j[Cn]||l==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=j.getAttribute(h)||"";Q=l+Q;var ce=S.get(Q);ce?ce.push(j):S.set(Q,[j])}}return S}function Xy(l,h,g){l=l.ownerDocument||l,l.head.insertBefore(g,h==="title"?l.querySelector("head > title"):null)}function ug(l,h,g){if(g===1||h.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;return h.rel==="stylesheet"?(l=h.disabled,typeof h.precedence=="string"&&l==null):!0;case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function Mp(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function cg(l,h,g,S){if(g.type==="stylesheet"&&(typeof S.media!="string"||matchMedia(S.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var I=Gc(S.href),j=h.querySelector(Sd(I));if(j){h=j._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(l.count++,l=Td.bind(l),h.then(l,l)),g.state.loading|=4,g.instance=j,Dn(j);return}j=h.ownerDocument||h,S=Wy(S),(I=Fs.get(I))&&Hc(S,I),j=j.createElement("link"),Dn(j);var Q=j;Q._p=new Promise(function(ce,ke){Q.onload=ce,Q.onerror=ke}),Ii(j,"link",S),g.instance=j}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(g,h),(h=g.state.preload)&&(g.state.loading&3)===0&&(l.count++,g=Td.bind(l),h.addEventListener("load",g),h.addEventListener("error",g))}}var Pp=0;function Ky(l,h){return l.stylesheets&&l.count===0&&Dp(l,l.stylesheets),0<l.count||0<l.imgCount?function(g){var S=setTimeout(function(){if(l.stylesheets&&Dp(l,l.stylesheets),l.unsuspend){var j=l.unsuspend;l.unsuspend=null,j()}},6e4+h);0<l.imgBytes&&Pp===0&&(Pp=62500*e0());var I=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&Dp(l,l.stylesheets),l.unsuspend)){var j=l.unsuspend;l.unsuspend=null,j()}},(l.imgBytes>Pp?50:800)+h);return l.unsuspend=g,function(){l.unsuspend=null,clearTimeout(S),clearTimeout(I)}}:null}function Td(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Dp(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Cp=null;function Dp(l,h){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Cp=new Map,h.forEach(c0,l),Cp=null,Td.call(l))}function c0(l,h){if(!(h.state.loading&4)){var g=Cp.get(l);if(g)var S=g.get(null);else{g=new Map,Cp.set(l,g);for(var I=l.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<I.length;j++){var Q=I[j];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(g.set(Q.dataset.precedence,Q),S=Q)}S&&g.set(null,S)}I=h.instance,Q=I.getAttribute("data-precedence"),j=g.get(Q)||S,j===S&&g.set(null,I),g.set(Q,I),this.count++,S=Td.bind(this),I.addEventListener("load",S),I.addEventListener("error",S),j?j.parentNode.insertBefore(I,j.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(I,l.firstChild)),h.state.loading|=4}}var Ed={$$typeof:ge,Provider:null,Consumer:null,_currentValue:pt,_currentValue2:pt,_threadCount:0};function h0(l,h,g,S,I,j,Q,ce,ke){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rr(0),this.hiddenUpdates=rr(null),this.identifierPrefix=S,this.onUncaughtError=I,this.onCaughtError=j,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ke,this.incompleteTransitions=new Map}function f0(l,h,g,S,I,j,Q,ce,ke,Ke,vt,At){return l=new h0(l,h,g,Q,ke,Ke,vt,At,ce),h=1,j===!0&&(h|=24),j=yo(3,null,null,h),l.current=j,j.stateNode=l,h=Eu(),h.refCount++,l.pooledCache=h,h.refCount++,j.memoizedState={element:S,isDehydrated:g,cache:h},Qf(j),l}function Qy(l){return l?(l=wr,l):wr}function d0(l,h,g,S,I,j){I=Qy(I),S.context===null?S.context=I:S.pendingContext=I,S=ll(h),S.payload={element:g},j=j===void 0?null:j,j!==null&&(S.callback=j),g=ks(l,S,h),g!==null&&(Mo(g,l,h),So(g,l,h))}function p0(l,h){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var g=l.retryLane;l.retryLane=g!==0&&g<h?g:h}}function Op(l,h){p0(l,h),(l=l.alternate)&&p0(l,h)}function Jy(l){if(l.tag===13||l.tag===31){var h=Lo(l,67108864);h!==null&&Mo(h,l,67108864),Op(l,67108864)}}function m0(l){if(l.tag===13||l.tag===31){var h=fs();h=an(h);var g=Lo(l,h);g!==null&&Mo(g,l,h),Op(l,h)}}var hg=!0;function g0(l,h,g,S){var I=Ue.T;Ue.T=null;var j=at.p;try{at.p=2,ev(l,h,g,S)}finally{at.p=j,Ue.T=I}}function Ip(l,h,g,S){var I=Ue.T;Ue.T=null;var j=at.p;try{at.p=8,ev(l,h,g,S)}finally{at.p=j,Ue.T=I}}function ev(l,h,g,S){if(hg){var I=zp(S);if(I===null)Ny(l,h,S,Ad,g),pg(l,S);else if(Ub(I,l,h,g,S))S.stopPropagation();else if(pg(l,S),h&4&&-1<Fb.indexOf(l)){for(;I!==null;){var j=Xo(I);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var Q=Me(j.pendingLanes);if(Q!==0){var ce=j;for(ce.pendingLanes|=2,ce.entangledLanes|=2;Q;){var ke=1<<31-Te(Q);ce.entanglements[1]|=ke,Q&=~ke}tu(j),(pn&6)===0&&(qm=kn()+500,_d(0))}}break;case 31:case 13:ce=Lo(j,2),ce!==null&&Mo(ce,j,2),Gm(),Op(j,2)}if(j=zp(S),j===null&&Ny(l,h,S,Ad,g),j===I)break;I=j}I!==null&&S.stopPropagation()}else Ny(l,h,S,null,g)}}function zp(l){return l=Yr(l),fg(l)}var Ad=null;function fg(l){if(Ad=null,l=ja(l),l!==null){var h=y(l);if(h===null)l=null;else{var g=h.tag;if(g===13){if(l=_(h),l!==null)return l;l=null}else if(g===31){if(l=c(h),l!==null)return l;l=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;l=null}else h!==l&&(l=null)}}return Ad=l,null}function ef(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ma()){case co:return 2;case ta:return 8;case ga:case du:return 32;case ws:return 268435456;default:return 32}default:return 32}}var dg=!1,Wc=null,Us=null,Ku=null,Md=new Map,Pd=new Map,Yc=[],Fb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pg(l,h){switch(l){case"focusin":case"focusout":Wc=null;break;case"dragenter":case"dragleave":Us=null;break;case"mouseover":case"mouseout":Ku=null;break;case"pointerover":case"pointerout":Md.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(h.pointerId)}}function Cd(l,h,g,S,I,j){return l===null||l.nativeEvent!==j?(l={blockedOn:h,domEventName:g,eventSystemFlags:S,nativeEvent:j,targetContainers:[I]},h!==null&&(h=Xo(h),h!==null&&Jy(h)),l):(l.eventSystemFlags|=S,h=l.targetContainers,I!==null&&h.indexOf(I)===-1&&h.push(I),l)}function Ub(l,h,g,S,I){switch(h){case"focusin":return Wc=Cd(Wc,l,h,g,S,I),!0;case"dragenter":return Us=Cd(Us,l,h,g,S,I),!0;case"mouseover":return Ku=Cd(Ku,l,h,g,S,I),!0;case"pointerover":var j=I.pointerId;return Md.set(j,Cd(Md.get(j)||null,l,h,g,S,I)),!0;case"gotpointercapture":return j=I.pointerId,Pd.set(j,Cd(Pd.get(j)||null,l,h,g,S,I)),!0}return!1}function y0(l){var h=ja(l.target);if(h!==null){var g=y(h);if(g!==null){if(h=g.tag,h===13){if(h=_(g),h!==null){l.blockedOn=h,fn(l.priority,function(){m0(g)});return}}else if(h===31){if(h=c(g),h!==null){l.blockedOn=h,fn(l.priority,function(){m0(g)});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){l.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}l.blockedOn=null}function mg(l){if(l.blockedOn!==null)return!1;for(var h=l.targetContainers;0<h.length;){var g=zp(l.nativeEvent);if(g===null){g=l.nativeEvent;var S=new g.constructor(g.type,g);Gt=S,g.target.dispatchEvent(S),Gt=null}else return h=Xo(g),h!==null&&Jy(h),l.blockedOn=g,!1;h.shift()}return!0}function v0(l,h,g){mg(l)&&g.delete(h)}function Vb(){dg=!1,Wc!==null&&mg(Wc)&&(Wc=null),Us!==null&&mg(Us)&&(Us=null),Ku!==null&&mg(Ku)&&(Ku=null),Md.forEach(v0),Pd.forEach(v0)}function kp(l,h){l.blockedOn===h&&(l.blockedOn=null,dg||(dg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Vb)))}var gg=null;function Dd(l){gg!==l&&(gg=l,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){gg===l&&(gg=null);for(var h=0;h<l.length;h+=3){var g=l[h],S=l[h+1],I=l[h+2];if(typeof S!="function"){if(fg(S||g)===null)continue;break}var j=Xo(g);j!==null&&(l.splice(h,3),h-=3,Di(j,{pending:!0,data:I,method:g.method,action:S},S,I))}}))}function Od(l){function h(ke){return kp(ke,l)}Wc!==null&&kp(Wc,l),Us!==null&&kp(Us,l),Ku!==null&&kp(Ku,l),Md.forEach(h),Pd.forEach(h);for(var g=0;g<Yc.length;g++){var S=Yc[g];S.blockedOn===l&&(S.blockedOn=null)}for(;0<Yc.length&&(g=Yc[0],g.blockedOn===null);)y0(g),g.blockedOn===null&&Yc.shift();if(g=(l.ownerDocument||l).$$reactFormReplay,g!=null)for(S=0;S<g.length;S+=3){var I=g[S],j=g[S+1],Q=I[xt]||null;if(typeof j=="function")Q||Dd(g);else if(Q){var ce=null;if(j&&j.hasAttribute("formAction")){if(I=j,Q=j[xt]||null)ce=Q.formAction;else if(fg(I)!==null)continue}else ce=Q.action;typeof ce=="function"?g[S+1]=ce:(g.splice(S,3),S-=3),Dd(g)}}}function _0(){function l(j){j.canIntercept&&j.info==="react-transition"&&j.intercept({handler:function(){return new Promise(function(Q){return I=Q})},focusReset:"manual",scroll:"manual"})}function h(){I!==null&&(I(),I=null),S||setTimeout(g,20)}function g(){if(!S&&!navigation.transition){var j=navigation.currentEntry;j&&j.url!=null&&navigation.navigate(j.url,{state:j.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var S=!1,I=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(g,100),function(){S=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),I!==null&&(I(),I=null)}}}function tv(l){this._internalRoot=l}Id.prototype.render=tv.prototype.render=function(l){var h=this._internalRoot;if(h===null)throw Error(o(409));var g=h.current,S=fs();d0(g,S,l,h,null,null)},Id.prototype.unmount=tv.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var h=l.containerInfo;d0(l.current,2,null,l,null,null),Gm(),h[ur]=null}};function Id(l){this._internalRoot=l}Id.prototype.unstable_scheduleHydration=function(l){if(l){var h=jr();l={blockedOn:null,target:l,priority:h};for(var g=0;g<Yc.length&&h!==0&&h<Yc[g].priority;g++);Yc.splice(g,0,l),g===0&&y0(l)}};var rv=t.version;if(rv!=="19.2.4")throw Error(o(527,rv,"19.2.4"));at.findDOMNode=function(l){var h=l._reactInternals;if(h===void 0)throw typeof l.render=="function"?Error(o(188)):(l=Object.keys(l).join(","),Error(o(268,l)));return l=C(h),l=l!==null?D(l):null,l=l===null?null:l.stateNode,l};var qb={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Ue,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yg.isDisabled&&yg.supportsFiber)try{ne=yg.inject(qb),ae=yg}catch{}}return lv.createRoot=function(l,h){if(!m(l))throw Error(o(299));var g=!1,S="",I=od,j=fp,Q=Ha;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(I=h.onUncaughtError),h.onCaughtError!==void 0&&(j=h.onCaughtError),h.onRecoverableError!==void 0&&(Q=h.onRecoverableError)),h=f0(l,1,!1,null,null,g,S,null,I,j,Q,_0),l[ur]=h.current,Ly(l),new tv(h)},lv.hydrateRoot=function(l,h,g){if(!m(l))throw Error(o(299));var S=!1,I="",j=od,Q=fp,ce=Ha,ke=null;return g!=null&&(g.unstable_strictMode===!0&&(S=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(Q=g.onCaughtError),g.onRecoverableError!==void 0&&(ce=g.onRecoverableError),g.formState!==void 0&&(ke=g.formState)),h=f0(l,1,!0,h,g??null,S,I,ke,j,Q,ce,_0),h.context=Qy(null),g=h.current,S=fs(),S=an(S),I=ll(S),I.callback=null,ks(g,I,S),g=S,h.current.lanes=g,mr(h,g),tu(h),l[ur]=h.current,Ly(l),new Id(h)},lv.version="19.2.4",lv}var tE;function e3(){if(tE)return r1.exports;tE=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),r1.exports=JR(),r1.exports}var t3=e3(),F0={exports:{}};var r3=F0.exports,rE;function n3(){return rE||(rE=1,(function(e,t){(function(i,o){e.exports=o()})(r3,(function(){var i={},o={};function m(_,c,M){if(o[_]=M,_==="index"){var C="var sharedModule = {}; ("+o.shared+")(sharedModule); ("+o.worker+")(sharedModule);",D={};return o.shared(D),o.index(i,D),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([C],{type:"text/javascript"}))),i}}m("shared",["exports"],(function(_){function c(s,r,a,f){return new(a||(a=Promise))((function(p,x){function b(z){try{P(f.next(z))}catch(L){x(L)}}function E(z){try{P(f.throw(z))}catch(L){x(L)}}function P(z){var L;z.done?p(z.value):(L=z.value,L instanceof a?L:new a((function(N){N(L)}))).then(b,E)}P((f=f.apply(s,r||[])).next())}))}function M(s,r){this.x=s,this.y=r}function C(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var D,k;typeof SuppressedError=="function"&&SuppressedError,M.prototype={clone(){return new M(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,r){return this.clone()._rotateAround(s,r)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const r=s.x-this.x,a=s.y-this.y;return r*r+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult(s){const r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const r=Math.cos(s),a=Math.sin(s),f=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=f,this},_rotateAround(s,r){const a=Math.cos(s),f=Math.sin(s),p=r.y+f*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-f*(this.y-r.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:M},M.convert=function(s){if(s instanceof M)return s;if(Array.isArray(s))return new M(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new M(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};var F=(function(){if(k)return D;function s(r,a,f,p){this.cx=3*r,this.bx=3*(f-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=a,this.p2x=f,this.p2y=p}return k=1,D=s,s.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,a){if(a===void 0&&(a=1e-6),r<0)return 0;if(r>1)return 1;for(var f=r,p=0;p<8;p++){var x=this.sampleCurveX(f)-r;if(Math.abs(x)<a)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=x/b}var E=0,P=1;for(f=r,p=0;p<20&&(x=this.sampleCurveX(f),!(Math.abs(x-r)<a));p++)r>x?E=f:P=f,f=.5*(P-E)+E;return f},solve:function(r,a){return this.sampleCurveY(this.solveCurveX(r,a))}},D})(),G=C(F);let K,W;function q(){return K==null&&(K=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),K}function ue(){if(W==null&&(W=!1,q())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let f=0;f<25;f++){const p=4*f;r.fillStyle=`rgb(${p},${p+1},${p+2})`,r.fillRect(f%5,Math.floor(f/5),1,1)}const a=r.getImageData(0,0,5,5).data;for(let f=0;f<100;f++)if(f%4!=3&&a[f]!==f){W=!0;break}}}return W||!1}var me=1e-6,ge=typeof Float32Array<"u"?Float32Array:Array;function be(){var s=new ge(9);return ge!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function ze(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ae(){var s=new ge(3);return ge!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Oe(s){var r=s[0],a=s[1],f=s[2];return Math.sqrt(r*r+a*a+f*f)}function rt(s,r,a){var f=new ge(3);return f[0]=s,f[1]=r,f[2]=a,f}function gt(s,r,a){return s[0]=r[0]+a[0],s[1]=r[1]+a[1],s[2]=r[2]+a[2],s}function yt(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s}function tt(s,r,a){var f=r[0],p=r[1],x=r[2],b=a[0],E=a[1],P=a[2];return s[0]=p*P-x*E,s[1]=x*b-f*P,s[2]=f*E-p*b,s}var Ge,Rt=Oe;function zt(s,r,a){var f=r[0],p=r[1],x=r[2],b=r[3];return s[0]=a[0]*f+a[4]*p+a[8]*x+a[12]*b,s[1]=a[1]*f+a[5]*p+a[9]*x+a[13]*b,s[2]=a[2]*f+a[6]*p+a[10]*x+a[14]*b,s[3]=a[3]*f+a[7]*p+a[11]*x+a[15]*b,s}function kt(){var s=new ge(4);return ge!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ue(s,r,a,f){var p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;r*=x,f*=x,a*=x;var b=Math.sin(r),E=Math.cos(r),P=Math.sin(a),z=Math.cos(a),L=Math.sin(f),N=Math.cos(f);switch(p){case"xyz":s[0]=b*z*N+E*P*L,s[1]=E*P*N-b*z*L,s[2]=E*z*L+b*P*N,s[3]=E*z*N-b*P*L;break;case"xzy":s[0]=b*z*N-E*P*L,s[1]=E*P*N-b*z*L,s[2]=E*z*L+b*P*N,s[3]=E*z*N+b*P*L;break;case"yxz":s[0]=b*z*N+E*P*L,s[1]=E*P*N-b*z*L,s[2]=E*z*L-b*P*N,s[3]=E*z*N+b*P*L;break;case"yzx":s[0]=b*z*N+E*P*L,s[1]=E*P*N+b*z*L,s[2]=E*z*L-b*P*N,s[3]=E*z*N-b*P*L;break;case"zxy":s[0]=b*z*N-E*P*L,s[1]=E*P*N+b*z*L,s[2]=E*z*L+b*P*N,s[3]=E*z*N-b*P*L;break;case"zyx":s[0]=b*z*N-E*P*L,s[1]=E*P*N+b*z*L,s[2]=E*z*L-b*P*N,s[3]=E*z*N+b*P*L;break;default:throw new Error("Unknown angle order "+p)}return s}function at(){var s=new ge(2);return ge!=Float32Array&&(s[0]=0,s[1]=0),s}function pt(s,r){var a=new ge(2);return a[0]=s,a[1]=r,a}Ae(),Ge=new ge(4),ge!=Float32Array&&(Ge[0]=0,Ge[1]=0,Ge[2]=0,Ge[3]=0),Ae(),rt(1,0,0),rt(0,1,0),kt(),kt(),be(),at();const bt=8192;function Ut(s,r,a){return r*(bt/(s.tileSize*Math.pow(2,a-s.tileID.overscaledZ)))}function Ce(s,r){return(s%r+r)%r}function nt(s,r,a){return s*(1-a)+r*a}function Be(s){if(s<=0)return 0;if(s>=1)return 1;const r=s*s,a=r*s;return 4*(s<.5?a:3*(s-r)+a-.75)}function lt(s,r,a,f){const p=new G(s,r,a,f);return x=>p.solve(x)}const Ft=lt(.25,.1,.25,1);function Lt(s,r,a){return Math.min(a,Math.max(r,s))}function Vt(s,r,a){const f=a-r,p=((s-r)%f+f)%f+r;return p===r?a:p}function yr(s,...r){for(const a of r)for(const f in a)s[f]=a[f];return s}let ft=1;function tr(s,r,a){const f={};for(const p in s)f[p]=r.call(this,s[p],p,s);return f}function pr(s,r,a){const f={};for(const p in s)r.call(this,s[p],p,s)&&(f[p]=s[p]);return f}function Tt(s){return Array.isArray(s)?s.map(Tt):typeof s=="object"&&s?tr(s,Tt):s}const gn={};function fr(s){gn[s]||(typeof console<"u"&&console.warn(s),gn[s]=!0)}function Sr(s,r,a){return(a.y-s.y)*(r.x-s.x)>(r.y-s.y)*(a.x-s.x)}function rn(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Tr=null;function za(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ka(s,r,a,f,p){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(s,{timestamp:0});try{const b=x?.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const E=b.startsWith("BGR"),P=new Uint8ClampedArray(f*p*4);if(yield x.copyTo(P,(function(z,L,N,$,H){const J=4*Math.max(-L,0),te=(Math.max(0,N)-N)*$*4+J,ie=4*$,le=Math.max(0,L),ye=Math.max(0,N);return{rect:{x:le,y:ye,width:Math.min(z.width,L+$)-le,height:Math.min(z.height,N+H)-ye},layout:[{offset:te,stride:ie}]}})(s,r,a,f,p)),E)for(let z=0;z<P.length;z+=4){const L=P[z];P[z]=P[z+2],P[z+2]=L}return P}finally{x.close()}}))}let pa,uo;function bn(s,r,a,f){return s.addEventListener(r,a,f),{unsubscribe:()=>{s.removeEventListener(r,a,f)}}}function kn(s){return s*Math.PI/180}function ma(s){return s/Math.PI*180}const co={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ta={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ga="AbortError";class du extends Error{constructor(r=ga){super(r instanceof Error?r.message:r),this.name=ga,r instanceof Error&&r.stack&&(this.stack=r.stack)}}function ws(s){return s.name===ga}const je={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ee(s){return je.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const ne="global-dispatcher";class ae extends Error{constructor(r,a,f,p){super(`AJAXError: ${a} (${r}): ${f}`),this.status=r,this.statusText=a,this.url=f,this.body=p}}const _e=()=>rn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Te=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const f=ee(s.url);if(f)return f(s,r);if(rn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:ne},r)}if(!(/^file:/.test(a=s.url)||/^file:/.test(_e())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(f,p){return c(this,void 0,void 0,(function*(){const x=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:_e(),signal:p.signal});let b,E;f.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{b=yield fetch(x)}catch(z){throw ws(z)?z:new ae(0,z.message,f.url,new Blob)}if(!b.ok){const z=yield b.blob();throw new ae(b.status,b.statusText,f.url,z)}E=f.type==="arrayBuffer"||f.type==="image"?b.arrayBuffer():f.type==="json"?b.json():b.text();const P=yield E;return p.signal.throwIfAborted(),{data:P,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}}))})(s,r);if(rn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:ne},r)}var a;return(function(f,p){return new Promise(((x,b)=>{var E;const P=new XMLHttpRequest;P.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(P.responseType="arraybuffer");for(const z in f.headers)P.setRequestHeader(z,f.headers[z]);f.type==="json"&&(P.responseType="text",!((E=f.headers)===null||E===void 0)&&E.Accept||P.setRequestHeader("Accept","application/json")),P.withCredentials=f.credentials==="include",P.onerror=()=>{b(new Error(P.statusText))},P.onload=()=>{if(!p.signal.aborted)if((P.status>=200&&P.status<300||P.status===0)&&P.response!==null){let z=P.response;if(f.type==="json")try{z=JSON.parse(P.response)}catch(L){return void b(L)}x({data:z,cacheControl:P.getResponseHeader("Cache-Control"),expires:P.getResponseHeader("Expires")})}else{const z=new Blob([P.response],{type:P.getResponseHeader("Content-Type")});b(new ae(P.status,P.statusText,f.url,z))}},p.signal.addEventListener("abort",(()=>{P.abort(),b(new du(p.signal.reason))})),P.send(f.body)}))})(s,r)};function qe(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),a=window.location;return r.protocol===a.protocol&&r.host===a.host}function Ze(s,r,a){a[s]&&a[s].indexOf(r)!==-1||(a[s]=a[s]||[],a[s].push(r))}function Ne(s,r,a){if(a&&a[s]){const f=a[s].indexOf(r);f!==-1&&a[s].splice(f,1)}}class Ve{constructor(r,a={}){yr(this,a),this.type=r}}class _t extends Ve{constructor(r,a={}){super("error",yr({error:r},a))}}class Xe{on(r,a){return this._listeners=this._listeners||{},Ze(r,a,this._listeners),{unsubscribe:()=>{this.off(r,a)}}}off(r,a){return Ne(r,a,this._listeners),Ne(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ze(r,a,this._oneTimeListeners),this):new Promise((f=>this.once(r,f)))}fire(r,a){typeof r=="string"&&(r=new Ve(r,a||{}));const f=r.type;if(this.listens(f)){r.target=this;const p=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const E of p)E.call(this,r);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const E of x)Ne(f,E,this._oneTimeListeners),E.call(this,r);const b=this._eventedParent;b&&(yr(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(r))}else r instanceof _t&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const qt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hr(s,r){const a={};for(const f in s)f!=="ref"&&(a[f]=s[f]);return qt.forEach((f=>{f in r&&(a[f]=r[f])})),a}function Yt(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let a=0;a<s.length;a++)if(!Yt(s[a],r[a]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const a in s)if(!Yt(s[a],r[a]))return!1;return!0}return s===r}function lr(s,r){s.push(r)}function rr(s,r,a){lr(a,{command:"addSource",args:[s,r[s]]})}function mr(s,r,a){lr(r,{command:"removeSource",args:[s]}),a[s]=!0}function Bn(s,r,a,f){mr(s,a,f),rr(s,r,a)}function nn(s,r,a){let f;for(f in s[a])if(Object.prototype.hasOwnProperty.call(s[a],f)&&f!=="data"&&!Yt(s[a][f],r[a][f]))return!1;for(f in r[a])if(Object.prototype.hasOwnProperty.call(r[a],f)&&f!=="data"&&!Yt(s[a][f],r[a][f]))return!1;return!0}function hn(s,r,a,f,p,x){s=s||{},r=r||{};for(const b in s)Object.prototype.hasOwnProperty.call(s,b)&&(Yt(s[b],r[b])||a.push({command:x,args:[f,b,r[b],p]}));for(const b in r)Object.prototype.hasOwnProperty.call(r,b)&&!Object.prototype.hasOwnProperty.call(s,b)&&(Yt(s[b],r[b])||a.push({command:x,args:[f,b,r[b],p]}))}function ui(s){return s.id}function an(s,r){return s[r.id]=r,s}class Et{constructor(r,a,f,p){this.message=(r?`${r}: `:"")+f,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function jr(s,...r){for(const a of r)for(const f in a)s[f]=a[f];return s}class fn extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}class ya{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[f,p]of a)this.bindings[f]=p}concat(r){return new ya(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Cn={kind:"null"},xt={kind:"number"},ur={kind:"string"},sr={kind:"boolean"},Ra={kind:"color"},Zs={kind:"projectionDefinition"},Ss={kind:"object"},gr={kind:"value"},Ts={kind:"collator"},ja={kind:"formatted"},Xo={kind:"padding"},va={kind:"colorArray"},Ir={kind:"numberArray"},Dn={kind:"resolvedImage"},Tl={kind:"variableAnchorOffsetCollection"};function Gr(s,r){return{kind:"array",itemType:s,N:r}}function Ur(s){if(s.kind==="array"){const r=Ur(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const zi=[Cn,xt,ur,sr,Ra,Zs,ja,Ss,Gr(gr),Xo,Ir,va,Dn,Tl];function Ko(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Ko(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const a of zi)if(!Ko(a,r))return null}}return`Expected ${Ur(s)} but found ${Ur(r)} instead.`}function El(s,r){return r.some((a=>a.kind===s.kind))}function ho(s,r){return r.some((a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s))}function Qo(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const Jo=.96422,Al=.82521,Zi=4/29,ei=6/29,ti=3*ei*ei,Zd=ei*ei*ei,pu=Math.PI/180,Ml=180/Math.PI;function Hs(s){return(s%=360)<0&&(s+=360),s}function Af([s,r,a,f]){let p,x;const b=Pl((.2225045*(s=Hi(s))+.7168786*(r=Hi(r))+.0606169*(a=Hi(a)))/1);s===r&&r===a?p=x=b:(p=Pl((.4360747*s+.3850649*r+.1430804*a)/Jo),x=Pl((.0139322*s+.0971045*r+.7141733*a)/Al));const E=116*b-16;return[E<0?0:E,500*(p-b),200*(b-x),f]}function Hi(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Pl(s){return s>Zd?Math.pow(s,1/3):s/ti+Zi}function es([s,r,a,f]){let p=(s+16)/116,x=isNaN(r)?p:p+r/500,b=isNaN(a)?p:p-a/200;return p=1*ri(p),x=Jo*ri(x),b=Al*ri(b),[jo(3.1338561*x-1.6168667*p-.4906146*b),jo(-.9787684*x+1.9161415*p+.033454*b),jo(.0719453*x-.2289914*p+1.4052427*b),f]}function jo(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function ri(s){return s>ei?s*s*s:ti*(s-Zi)}const fh=Object.hasOwn||function(s,r){return Object.prototype.hasOwnProperty.call(s,r)};function Cl(s,r){return fh(s,r)?s[r]:void 0}function fo(s){return parseInt(s.padEnd(2,s),16)/255}function Mf(s,r){return Ws(r?s/100:s,0,1)}function Ws(s,r,a){return Math.min(Math.max(r,s),a)}function Fe(s){return!s.some(Number.isNaN)}const Pt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Nt(s,r,a){return s+a*(r-s)}function Qt(s,r,a){return s.map(((f,p)=>Nt(f,r[p],a)))}class Ot{constructor(r,a,f,p=1,x=!0){this.r=r,this.g=a,this.b=f,this.a=p,x||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[r,a,f,p]))}static parse(r){if(r instanceof Ot)return r;if(typeof r!="string")return;const a=(function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=Cl(Pt,f);if(p){const[b,E,P]=p;return[b/255,E/255,P/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const b=f.length<6?1:2;let E=1;return[fo(f.slice(E,E+=b)),fo(f.slice(E,E+=b)),fo(f.slice(E,E+=b)),fo(f.slice(E,E+b)||"ff")]}if(f.startsWith("rgb")){const b=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[E,P,z,L,N,$,H,J,te,ie,le,ye]=b,se=[L||" ",H||" ",ie].join("");if(se==="  "||se==="  /"||se===",,"||se===",,,"){const fe=[z,$,te].join(""),Se=fe==="%%%"?100:fe===""?255:0;if(Se){const Ie=[Ws(+P/Se,0,1),Ws(+N/Se,0,1),Ws(+J/Se,0,1),le?Mf(+le,ye):1];if(Fe(Ie))return Ie}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,E,P,z,L,N,$,H,J]=x,te=[P||" ",L||" ",$].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const ie=[+E,Ws(+z,0,100),Ws(+N,0,100),H?Mf(+H,J):1];if(Fe(ie))return(function([le,ye,se,fe]){function Se(Ie){const We=(Ie+le/30)%12,ht=ye*Math.min(se,1-se);return se-ht*Math.max(-1,Math.min(We-3,9-We,1))}return le=Hs(le),ye/=100,se/=100,[Se(0),Se(8),Se(4),fe]})(ie)}}})(r);return a?new Ot(...a,!1):void 0}get rgb(){const{r,g:a,b:f,a:p}=this,x=p||1/0;return this.overwriteGetter("rgb",[r/x,a/x,f/x,p])}get hcl(){return this.overwriteGetter("hcl",(function(r){const[a,f,p,x]=Af(r),b=Math.sqrt(f*f+p*p);return[Math.round(1e4*b)?Hs(Math.atan2(p,f)*Ml):NaN,b,a,x]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Af(this.rgb))}overwriteGetter(r,a){return Object.defineProperty(this,r,{value:a}),a}toString(){const[r,a,f,p]=this.rgb;return`rgba(${[r,a,f].map((x=>Math.round(255*x))).join(",")},${p})`}static interpolate(r,a,f,p="rgb"){switch(p){case"rgb":{const[x,b,E,P]=Qt(r.rgb,a.rgb,f);return new Ot(x,b,E,P,!1)}case"hcl":{const[x,b,E,P]=r.hcl,[z,L,N,$]=a.hcl;let H,J;if(isNaN(x)||isNaN(z))isNaN(x)?isNaN(z)?H=NaN:(H=z,E!==1&&E!==0||(J=L)):(H=x,N!==1&&N!==0||(J=b));else{let se=z-x;z>x&&se>180?se-=360:z<x&&x-z>180&&(se+=360),H=x+f*se}const[te,ie,le,ye]=(function([se,fe,Se,Ie]){return se=isNaN(se)?0:se*pu,es([Se,Math.cos(se)*fe,Math.sin(se)*fe,Ie])})([H,J??Nt(b,L,f),Nt(E,N,f),Nt(P,$,f)]);return new Ot(te,ie,le,ye,!1)}case"lab":{const[x,b,E,P]=es(Qt(r.lab,a.lab,f));return new Ot(x,b,E,P,!1)}}}}Ot.black=new Ot(0,0,0,1),Ot.white=new Ot(1,1,1,1),Ot.transparent=new Ot(0,0,0,0),Ot.red=new Ot(1,0,0,1);class nr{constructor(r,a,f){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Gt=["bottom","center","top"];class Yr{constructor(r,a,f,p,x,b){this.text=r,this.image=a,this.scale=f,this.fontStack=p,this.textColor=x,this.verticalAlign=b}}class xr{constructor(r){this.sections=r}static fromString(r){return new xr([new Yr(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||r.image&&r.image.name.length!==0))}static factory(r){return r instanceof xr?r:xr.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}}class on{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof on)return r;if(typeof r=="number")return new on([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const a of r)if(typeof a!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new on(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,a,f){return new on(Qt(r.values,a.values,f))}}class Mr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Mr)return r;if(typeof r=="number")return new Mr([r]);if(Array.isArray(r)){for(const a of r)if(typeof a!="number")return;return new Mr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,a,f){return new Mr(Qt(r.values,a.values,f))}}class Lr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Lr)return r;if(typeof r=="string"){const f=Ot.parse(r);return f?new Lr([f]):void 0}if(!Array.isArray(r))return;const a=[];for(const f of r){if(typeof f!="string")return;const p=Ot.parse(f);if(!p)return;a.push(p)}return new Lr(a)}toString(){return JSON.stringify(this.values)}static interpolate(r,a,f,p="rgb"){const x=[];if(r.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${r.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let b=0;b<r.values.length;b++)x.push(Ot.interpolate(r.values[b],a.values[b],f,p));return new Lr(x)}}class Wt extends Error{constructor(r){super(r),this.name="RuntimeError"}toJSON(){return this.message}}const Zn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Nr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Nr)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let a=0;a<r.length;a+=2){const f=r[a],p=r[a+1];if(typeof f!="string"||!Zn.has(f)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Nr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,a,f){const p=r.values,x=a.values;if(p.length!==x.length)throw new Wt(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${a.toString()}`);const b=[];for(let E=0;E<p.length;E+=2){if(p[E]!==x[E])throw new Wt(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${p[E]}, to[${E}]: ${x[E]}`);b.push(p[E]);const[P,z]=p[E+1],[L,N]=x[E+1];b.push([Nt(P,L,f),Nt(z,N,f)])}return new Nr(b)}}class ki{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new ki({name:r,available:!1}):null}}class ni{constructor(r,a,f){this.from=r,this.to=a,this.transition=f}static interpolate(r,a,f){return new ni(r,a,f)}static parse(r){return r instanceof ni?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new ni(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new ni(r.from,r.to,r.transition):typeof r=="string"?new ni(r,r,1):void 0}}function La(s,r,a,f){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof a=="number"&&a>=0&&a<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[s,r,a,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[s,r,a,f]:[s,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wn(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof ni||s instanceof Ot||s instanceof nr||s instanceof xr||s instanceof on||s instanceof Mr||s instanceof Lr||s instanceof Nr||s instanceof ki)return!0;if(Array.isArray(s)){for(const r of s)if(!wn(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!wn(s[r]))return!1;return!0}return!1}function Zr(s){if(s===null)return Cn;if(typeof s=="string")return ur;if(typeof s=="boolean")return sr;if(typeof s=="number")return xt;if(s instanceof Ot)return Ra;if(s instanceof ni)return Zs;if(s instanceof nr)return Ts;if(s instanceof xr)return ja;if(s instanceof on)return Xo;if(s instanceof Mr)return Ir;if(s instanceof Lr)return va;if(s instanceof Nr)return Tl;if(s instanceof ki)return Dn;if(Array.isArray(s)){const r=s.length;let a;for(const f of s){const p=Zr(f);if(a){if(a===p)continue;a=gr;break}a=p}return Gr(a||gr,r)}return Ss}function Na(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof Ot||s instanceof ni||s instanceof xr||s instanceof on||s instanceof Mr||s instanceof Lr||s instanceof Nr||s instanceof ki?s.toString():JSON.stringify(s)}class gi{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(r.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!wn(r[1]))return a.error("invalid value");const f=r[1];let p=Zr(f);const x=a.expectedType;return p.kind!=="array"||p.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(p=x),new gi(p,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ci={string:ur,number:xt,boolean:sr,object:Ss};class Ai{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let f,p=1;const x=r[0];if(x==="array"){let E,P;if(r.length>2){const z=r[1];if(typeof z!="string"||!(z in ci)||z==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);E=ci[z],p++}else E=gr;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);P=r[2],p++}f=Gr(E,P)}else{if(!ci[x])throw new Error(`Types doesn't contain name = ${x}`);f=ci[x]}const b=[];for(;p<r.length;p++){const E=a.parse(r[p],p,gr);if(!E)return null;b.push(E)}return new Ai(f,b)}evaluate(r){for(let a=0;a<this.args.length;a++){const f=this.args[a].evaluate(r);if(!Ko(this.type,Zr(f)))return f;if(a===this.args.length-1)throw new Wt(`Expected value to be of type ${Ur(this.type)}, but found ${Ur(Zr(f))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const Jr={"to-boolean":sr,"to-color":Ra,"to-number":xt,"to-string":ur};class kr{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const f=r[0];if(!Jr[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&r.length!==2)return a.error("Expected one argument.");const p=Jr[f],x=[];for(let b=1;b<r.length;b++){const E=a.parse(r[b],b,gr);if(!E)return null;x.push(E)}return new kr(p,x)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let a,f;for(const p of this.args){if(a=p.evaluate(r),f=null,a instanceof Ot)return a;if(typeof a=="string"){const x=r.parseColor(a);if(x)return x}else if(Array.isArray(a)&&(f=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:La(a[0],a[1],a[2],a[3]),!f))return new Ot(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Wt(f||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const f of this.args){a=f.evaluate(r);const p=on.parse(a);if(p)return p}throw new Wt(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const f of this.args){a=f.evaluate(r);const p=Mr.parse(a);if(p)return p}throw new Wt(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const f of this.args){a=f.evaluate(r);const p=Lr.parse(a);if(p)return p}throw new Wt(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const f of this.args){a=f.evaluate(r);const p=Nr.parse(a);if(p)return p}throw new Wt(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const f of this.args){if(a=f.evaluate(r),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Wt(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return xr.fromString(Na(this.args[0].evaluate(r)));case"resolvedImage":return ki.fromString(Na(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return Na(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const Ri=["Unknown","Point","LineString","Polygon"];class Es{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ri[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let a=this._parseColorCache.get(r);return a||(a=Ot.parse(r),this._parseColorCache.set(r,a)),a}}class dh{constructor(r,a,f=[],p,x=new ya,b=[]){this.registry=r,this.path=f,this.key=f.map((E=>`[${E}]`)).join(""),this.scope=x,this.errors=b,this.expectedType=p,this._isConstant=a}parse(r,a,f,p,x={}){return a?this.concat(a,f,p)._parse(r,x):this._parse(r,x)}_parse(r,a){function f(p,x,b){return b==="assert"?new Ai(x,[p]):b==="coerce"?new kr(x,[p]):p}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=r[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[p];if(x){let b=x.parse(r,this);if(!b)return null;if(this.expectedType){const E=this.expectedType,P=b.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||P.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(P.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(P.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(P.kind)||E.kind==="colorArray"&&["value","string","array"].includes(P.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(P.kind))b=f(b,E,a.typeAnnotation||"coerce");else if(this.checkSubtype(E,P))return null}else b=f(b,E,a.typeAnnotation||"assert")}if(!(b instanceof gi)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const E=new Es;try{b=new gi(b.type,b.evaluate(E))}catch(P){return this.error(P.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,f){const p=typeof r=="number"?this.path.concat(r):this.path,x=f?this.scope.concat(f):this.scope;return new dh(this.registry,this._isConstant,p,a||null,x,this.errors)}error(r,...a){const f=`${this.key}${a.map((p=>`[${p}]`)).join("")}`;this.errors.push(new fn(f,r))}checkSubtype(r,a){const f=Ko(r,a);return f&&this.error(f),f}}class Ys{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const f=[];for(let x=1;x<r.length-1;x+=2){const b=r[x];if(typeof b!="string")return a.error(`Expected string, but found ${typeof b} instead.`,x);if(/[^a-zA-Z0-9_]/.test(b))return a.error("Variable names must contain only alphanumeric characters or '_'.",x);const E=a.parse(r[x+1],x+1);if(!E)return null;f.push([b,E])}const p=a.parse(r[r.length-1],r.length-1,a.expectedType,f);return p?new Ys(f,p):null}outputDefined(){return this.result.outputDefined()}}class sn{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(r.length!==2||typeof r[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const f=r[1];return a.scope.has(f)?new sn(f,a.scope.get(f)):a.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Xs{constructor(r,a,f){this.type=r,this.index=a,this.input=f}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const f=a.parse(r[1],1,xt),p=a.parse(r[2],2,Gr(a.expectedType||gr));return f&&p?new Xs(p.type.itemType,f,p):null}evaluate(r){const a=this.index.evaluate(r),f=this.input.evaluate(r);if(a<0)throw new Wt(`Array index out of bounds: ${a} < 0.`);if(a>=f.length)throw new Wt(`Array index out of bounds: ${a} > ${f.length-1}.`);if(a!==Math.floor(a))throw new Wt(`Array index must be an integer, but found ${a} instead.`);return f[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Dr{constructor(r,a){this.type=sr,this.needle=r,this.haystack=a}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const f=a.parse(r[1],1,gr),p=a.parse(r[2],2,gr);return f&&p?El(f.type,[sr,ur,xt,Cn,gr])?new Dr(f,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ur(f.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),f=this.haystack.evaluate(r);if(!f)return!1;if(!ho(a,["boolean","string","number","null"]))throw new Wt(`Expected first argument to be of type boolean, string, number or null, but found ${Ur(Zr(a))} instead.`);if(!ho(f,["string","array"]))throw new Wt(`Expected second argument to be of type array or string, but found ${Ur(Zr(f))} instead.`);return f.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class br{constructor(r,a,f){this.type=xt,this.needle=r,this.haystack=a,this.fromIndex=f}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const f=a.parse(r[1],1,gr),p=a.parse(r[2],2,gr);if(!f||!p)return null;if(!El(f.type,[sr,ur,xt,Cn,gr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ur(f.type)} instead`);if(r.length===4){const x=a.parse(r[3],3,xt);return x?new br(f,p,x):null}return new br(f,p)}evaluate(r){const a=this.needle.evaluate(r),f=this.haystack.evaluate(r);if(!ho(a,["boolean","string","number","null"]))throw new Wt(`Expected first argument to be of type boolean, string, number or null, but found ${Ur(Zr(a))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(r)),ho(f,["string"])){const x=f.indexOf(a,p);return x===-1?-1:[...f.slice(0,x)].length}if(ho(f,["array"]))return f.indexOf(a,p);throw new Wt(`Expected second argument to be of type array or string, but found ${Ur(Zr(f))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class ph{constructor(r,a,f,p,x,b){this.inputType=r,this.type=a,this.input=f,this.cases=p,this.outputs=x,this.otherwise=b}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let f,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const x={},b=[];for(let z=2;z<r.length-1;z+=2){let L=r[z];const N=r[z+1];Array.isArray(L)||(L=[L]);const $=a.concat(z);if(L.length===0)return $.error("Expected at least one branch label.");for(const J of L){if(typeof J!="number"&&typeof J!="string")return $.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return $.error("Numeric branch labels must be integer values.");if(f){if($.checkSubtype(f,Zr(J)))return null}else f=Zr(J);if(x[String(J)]!==void 0)return $.error("Branch labels must be unique.");x[String(J)]=b.length}const H=a.parse(N,z,p);if(!H)return null;p=p||H.type,b.push(H)}const E=a.parse(r[1],1,gr);if(!E)return null;const P=a.parse(r[r.length-1],r.length-1,p);return P?E.type.kind!=="value"&&a.concat(1).checkSubtype(f,E.type)?null:new ph(f,p,E,x,b,P):null}evaluate(r){const a=this.input.evaluate(r);return(Zr(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}}class Br{constructor(r,a,f){this.type=r,this.branches=a,this.otherwise=f}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const p=[];for(let b=1;b<r.length-1;b+=2){const E=a.parse(r[b],b,sr);if(!E)return null;const P=a.parse(r[b+1],b+1,f);if(!P)return null;p.push([E,P]),f=f||P.type}const x=a.parse(r[r.length-1],r.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new Br(f,p,x)}evaluate(r){for(const[a,f]of this.branches)if(a.evaluate(r))return f.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,f]of this.branches)r(a),r(f);r(this.otherwise)}outputDefined(){return this.branches.every((([r,a])=>a.outputDefined()))&&this.otherwise.outputDefined()}}class fc{constructor(r,a,f,p){this.type=r,this.input=a,this.beginIndex=f,this.endIndex=p}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const f=a.parse(r[1],1,gr),p=a.parse(r[2],2,xt);if(!f||!p)return null;if(!El(f.type,[Gr(gr),ur,gr]))return a.error(`Expected first argument to be of type array or string, but found ${Ur(f.type)} instead`);if(r.length===4){const x=a.parse(r[3],3,xt);return x?new fc(f.type,f,p,x):null}return new fc(f.type,f,p)}evaluate(r){const a=this.input.evaluate(r),f=this.beginIndex.evaluate(r);let p;if(this.endIndex&&(p=this.endIndex.evaluate(r)),ho(a,["string"]))return[...a].slice(f,p).join("");if(ho(a,["array"]))return a.slice(f,p);throw new Wt(`Expected first argument to be of type array or string, but found ${Ur(Zr(a))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Ba(s,r){const a=s.length-1;let f,p,x=0,b=a,E=0;for(;x<=b;)if(E=Math.floor((x+b)/2),f=s[E],p=s[E+1],f<=r){if(E===a||r<p)return E;x=E+1}else{if(!(f>r))throw new Wt("Input is not a number.");b=E-1}return 0}class mu{constructor(r,a,f){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[p,x]of f)this.labels.push(p),this.outputs.push(x)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const f=a.parse(r[1],1,xt);if(!f)return null;const p=[];let x=null;a.expectedType&&a.expectedType.kind!=="value"&&(x=a.expectedType);for(let b=1;b<r.length;b+=2){const E=b===1?-1/0:r[b],P=r[b+1],z=b,L=b+1;if(typeof E!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(p.length&&p[p.length-1][0]>=E)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const N=a.parse(P,L,x);if(!N)return null;x=x||N.type,p.push([E,N])}return new mu(x,f,p)}evaluate(r){const a=this.labels,f=this.outputs;if(a.length===1)return f[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return f[0].evaluate(r);const x=a.length;return p>=a[x-1]?f[x-1].evaluate(r):f[Ba(a,p)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function Pf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Cf,Df,um=(function(){if(Df)return Cf;function s(r,a,f,p){this.cx=3*r,this.bx=3*(f-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=a,this.p2x=f,this.p2y=p}return Df=1,Cf=s,s.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,a){if(a===void 0&&(a=1e-6),r<0)return 0;if(r>1)return 1;for(var f=r,p=0;p<8;p++){var x=this.sampleCurveX(f)-r;if(Math.abs(x)<a)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=x/b}var E=0,P=1;for(f=r,p=0;p<20&&(x=this.sampleCurveX(f),!(Math.abs(x-r)<a));p++)r>x?E=f:P=f,f=.5*(P-E)+E;return f},solve:function(r,a){return this.sampleCurveY(this.solveCurveX(r,a))}},Cf})(),cm=Pf(um);class _a{constructor(r,a,f,p,x){this.type=r,this.operator=a,this.interpolation=f,this.input=p,this.labels=[],this.outputs=[];for(const[b,E]of x)this.labels.push(b),this.outputs.push(E)}static interpolationFactor(r,a,f,p){let x=0;if(r.name==="exponential")x=Of(a,r.base,f,p);else if(r.name==="linear")x=Of(a,1,f,p);else if(r.name==="cubic-bezier"){const b=r.controlPoints;x=new cm(b[0],b[1],b[2],b[3]).solve(Of(a,1,f,p))}return x}static parse(r,a){let[f,p,x,...b]=r;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const z=p[1];if(typeof z!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:z}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const z=p.slice(1);if(z.length!==4||z.some((L=>typeof L!="number"||L<0||L>1)))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:z}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(x=a.parse(x,2,xt),!x)return null;const E=[];let P=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||a.expectedType==va?a.expectedType&&a.expectedType.kind!=="value"&&(P=a.expectedType):P=Ra;for(let z=0;z<b.length;z+=2){const L=b[z],N=b[z+1],$=z+3,H=z+4;if(typeof L!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(E.length&&E[E.length-1][0]>=L)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const J=a.parse(N,H,P);if(!J)return null;P=P||J.type,E.push([L,J])}return Qo(P,xt)||Qo(P,Zs)||Qo(P,Ra)||Qo(P,Xo)||Qo(P,Ir)||Qo(P,va)||Qo(P,Tl)||Qo(P,Gr(xt))?new _a(P,f,p,x,E):a.error(`Type ${Ur(P)} is not interpolatable.`)}evaluate(r){const a=this.labels,f=this.outputs;if(a.length===1)return f[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return f[0].evaluate(r);const x=a.length;if(p>=a[x-1])return f[x-1].evaluate(r);const b=Ba(a,p),E=_a.interpolationFactor(this.interpolation,p,a[b],a[b+1]),P=f[b].evaluate(r),z=f[b+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Nt(P,z,E);case"color":return Ot.interpolate(P,z,E);case"padding":return on.interpolate(P,z,E);case"colorArray":return Lr.interpolate(P,z,E);case"numberArray":return Mr.interpolate(P,z,E);case"variableAnchorOffsetCollection":return Nr.interpolate(P,z,E);case"array":return Qt(P,z,E);case"projectionDefinition":return ni.interpolate(P,z,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ot.interpolate(P,z,E,"hcl");case"colorArray":return Lr.interpolate(P,z,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ot.interpolate(P,z,E,"lab");case"colorArray":return Lr.interpolate(P,z,E,"lab")}}}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function Of(s,r,a,f){const p=f-a,x=s-a;return p===0?0:r===1?x/p:(Math.pow(r,x)-1)/(Math.pow(r,p)-1)}const Wi={color:Ot.interpolate,number:Nt,padding:on.interpolate,numberArray:Mr.interpolate,colorArray:Lr.interpolate,variableAnchorOffsetCollection:Nr.interpolate,array:Qt};class Mi{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let f=null;const p=a.expectedType;p&&p.kind!=="value"&&(f=p);const x=[];for(const E of r.slice(1)){const P=a.parse(E,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!P)return null;f=f||P.type,x.push(P)}if(!f)throw new Error("No output type");const b=p&&x.some((E=>Ko(p,E.type)));return new Mi(b?gr:f,x)}evaluate(r){let a,f=null,p=0;for(const x of this.args)if(p++,f=x.evaluate(r),f&&f instanceof ki&&!f.available&&(a||(a=f.name),f=null,p===this.args.length&&(f=a)),f!==null)break;return f}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}function gu(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Hd(s,r,a,f){return f.compare(r,a)===0}function Ks(s,r,a){const f=s!=="=="&&s!=="!=";return class iD{constructor(x,b,E){this.type=sr,this.lhs=x,this.rhs=b,this.collator=E,this.hasUntypedArgument=x.type.kind==="value"||b.type.kind==="value"}static parse(x,b){if(x.length!==3&&x.length!==4)return b.error("Expected two or three arguments.");const E=x[0];let P=b.parse(x[1],1,gr);if(!P)return null;if(!gu(E,P.type))return b.concat(1).error(`"${E}" comparisons are not supported for type '${Ur(P.type)}'.`);let z=b.parse(x[2],2,gr);if(!z)return null;if(!gu(E,z.type))return b.concat(2).error(`"${E}" comparisons are not supported for type '${Ur(z.type)}'.`);if(P.type.kind!==z.type.kind&&P.type.kind!=="value"&&z.type.kind!=="value")return b.error(`Cannot compare types '${Ur(P.type)}' and '${Ur(z.type)}'.`);f&&(P.type.kind==="value"&&z.type.kind!=="value"?P=new Ai(z.type,[P]):P.type.kind!=="value"&&z.type.kind==="value"&&(z=new Ai(P.type,[z])));let L=null;if(x.length===4){if(P.type.kind!=="string"&&z.type.kind!=="string"&&P.type.kind!=="value"&&z.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(L=b.parse(x[3],3,Ts),!L)return null}return new iD(P,z,L)}evaluate(x){const b=this.lhs.evaluate(x),E=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const P=Zr(b),z=Zr(E);if(P.kind!==z.kind||P.kind!=="string"&&P.kind!=="number")throw new Wt(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${P.kind}, ${z.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const P=Zr(b),z=Zr(E);if(P.kind!=="string"||z.kind!=="string")return r(x,b,E)}return this.collator?a(x,b,E,this.collator.evaluate(x)):r(x,b,E)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const ji=Ks("==",(function(s,r,a){return r===a}),Hd),Wd=Ks("!=",(function(s,r,a){return r!==a}),(function(s,r,a,f){return!Hd(0,r,a,f)})),Yd=Ks("<",(function(s,r,a){return r<a}),(function(s,r,a,f){return f.compare(r,a)<0})),hm=Ks(">",(function(s,r,a){return r>a}),(function(s,r,a,f){return f.compare(r,a)>0})),ty=Ks("<=",(function(s,r,a){return r<=a}),(function(s,r,a,f){return f.compare(r,a)<=0})),dc=Ks(">=",(function(s,r,a){return r>=a}),(function(s,r,a,f){return f.compare(r,a)>=0}));class yu{constructor(r,a,f){this.type=Ts,this.locale=f,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(r.length!==2)return a.error("Expected one argument.");const f=r[1];if(typeof f!="object"||Array.isArray(f))return a.error("Collator options argument must be an object.");const p=a.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,sr);if(!p)return null;const x=a.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,sr);if(!x)return null;let b=null;return f.locale&&(b=a.parse(f.locale,1,ur),!b)?null:new yu(p,x,b)}evaluate(r){return new nr(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class mh{constructor(r,a,f,p,x){this.type=ur,this.number=r,this.locale=a,this.currency=f,this.minFractionDigits=p,this.maxFractionDigits=x}static parse(r,a){if(r.length!==3)return a.error("Expected two arguments.");const f=a.parse(r[1],1,xt);if(!f)return null;const p=r[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let x=null;if(p.locale&&(x=a.parse(p.locale,1,ur),!x))return null;let b=null;if(p.currency&&(b=a.parse(p.currency,1,ur),!b))return null;let E=null;if(p["min-fraction-digits"]&&(E=a.parse(p["min-fraction-digits"],1,xt),!E))return null;let P=null;return p["max-fraction-digits"]&&(P=a.parse(p["max-fraction-digits"],1,xt),!P)?null:new mh(f,x,b,E,P)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class If{constructor(r){this.type=ja,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const f=r[1];if(!Array.isArray(f)&&typeof f=="object")return a.error("First argument must be an image or text section.");const p=[];let x=!1;for(let b=1;b<=r.length-1;++b){const E=r[b];if(x&&typeof E=="object"&&!Array.isArray(E)){x=!1;let P=null;if(E["font-scale"]&&(P=a.parse(E["font-scale"],1,xt),!P))return null;let z=null;if(E["text-font"]&&(z=a.parse(E["text-font"],1,Gr(ur)),!z))return null;let L=null;if(E["text-color"]&&(L=a.parse(E["text-color"],1,Ra),!L))return null;let N=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!Gt.includes(E["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(N=a.parse(E["vertical-align"],1,ur),!N)return null}const $=p[p.length-1];$.scale=P,$.font=z,$.textColor=L,$.verticalAlign=N}else{const P=a.parse(r[b],1,gr);if(!P)return null;const z=P.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,p.push({content:P,scale:null,font:null,textColor:null,verticalAlign:null})}}return new If(p)}evaluate(r){return new xr(this.sections.map((a=>{const f=a.content.evaluate(r);return Zr(f)===Dn?new Yr("",f,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(r):null):new Yr(Na(f),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null,a.verticalAlign?a.verticalAlign.evaluate(r):null)})))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor),a.verticalAlign&&r(a.verticalAlign)}outputDefined(){return!1}}class zf{constructor(r){this.type=Dn,this.input=r}static parse(r,a){if(r.length!==2)return a.error("Expected two arguments.");const f=a.parse(r[1],1,ur);return f?new zf(f):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),f=ki.fromString(a);return f&&r.availableImages&&(f.available=r.availableImages.indexOf(a)>-1),f}eachChild(r){r(this.input)}outputDefined(){return!1}}class pc{constructor(r){this.type=xt,this.input=r}static parse(r,a){if(r.length!==2)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const f=a.parse(r[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Ur(f.type)} instead.`):new pc(f):null}evaluate(r){const a=this.input.evaluate(r);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Wt(`Expected value to be of type string or array, but found ${Ur(Zr(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const xa=8192;function ba(s,r){const a=(180+s[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(a*p*xa),Math.round(f*p*xa)]}function kf(s,r){const a=Math.pow(2,r.z);return[(p=(s[0]/xa+r.x)/a,360*p-180),(f=(s[1]/xa+r.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,p}function Qs(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function mc(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Rf(s,r,a){const f=s[0]-r[0],p=s[1]-r[1],x=s[0]-a[0],b=s[1]-a[1];return f*b-x*p==0&&f*x<=0&&p*b<=0}function gh(s,r,a,f){return(p=[f[0]-a[0],f[1]-a[1]])[0]*(x=[r[0]-s[0],r[1]-s[1]])[1]-p[1]*x[0]!=0&&!(!jf(s,r,a,f)||!jf(a,f,s,r));var p,x}function fm(s,r,a){for(const f of a)for(let p=0;p<f.length-1;++p)if(gh(s,r,f[p],f[p+1]))return!0;return!1}function ts(s,r,a=!1){let f=!1;for(const E of r)for(let P=0;P<E.length-1;P++){if(Rf(s,E[P],E[P+1]))return a;(x=E[P])[1]>(p=s)[1]!=(b=E[P+1])[1]>p[1]&&p[0]<(b[0]-x[0])*(p[1]-x[1])/(b[1]-x[1])+x[0]&&(f=!f)}var p,x,b;return f}function ry(s,r){for(const a of r)if(ts(s,a))return!0;return!1}function yh(s,r){for(const a of s)if(!ts(a,r))return!1;for(let a=0;a<s.length-1;++a)if(fm(s[a],s[a+1],r))return!1;return!0}function ny(s,r){for(const a of r)if(yh(s,a))return!0;return!1}function jf(s,r,a,f){const p=f[0]-a[0],x=f[1]-a[1],b=(s[0]-a[0])*x-p*(s[1]-a[1]),E=(r[0]-a[0])*x-p*(r[1]-a[1]);return b>0&&E<0||b<0&&E>0}function vh(s,r,a){const f=[];for(let p=0;p<s.length;p++){const x=[];for(let b=0;b<s[p].length;b++){const E=ba(s[p][b],a);Qs(r,E),x.push(E)}f.push(x)}return f}function gc(s,r,a){const f=[];for(let p=0;p<s.length;p++){const x=vh(s[p],r,a);f.push(x)}return f}function vu(s,r,a,f){if(s[0]<a[0]||s[0]>a[2]){const p=.5*f;let x=s[0]-a[0]>p?-f:a[0]-s[0]>p?f:0;x===0&&(x=s[0]-a[2]>p?-f:a[2]-s[0]>p?f:0),s[0]+=x}Qs(r,s)}function dm(s,r,a,f){const p=Math.pow(2,f.z)*xa,x=[f.x*xa,f.y*xa],b=[];for(const E of s)for(const P of E){const z=[P.x+x[0],P.y+x[1]];vu(z,r,a,p),b.push(z)}return b}function _h(s,r,a,f){const p=Math.pow(2,f.z)*xa,x=[f.x*xa,f.y*xa],b=[];for(const P of s){const z=[];for(const L of P){const N=[L.x+x[0],L.y+x[1]];Qs(r,N),z.push(N)}b.push(z)}if(r[2]-r[0]<=p/2){(E=r)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const P of b)for(const z of P)vu(z,r,a,p)}var E;return b}class Dl{constructor(r,a){this.type=sr,this.geojson=r,this.geometries=a}static parse(r,a){if(r.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(wn(r[1])){const f=r[1];if(f.type==="FeatureCollection"){const p=[];for(const x of f.features){const{type:b,coordinates:E}=x.geometry;b==="Polygon"&&p.push(E),b==="MultiPolygon"&&p.push(...E)}if(p.length)return new Dl(f,{type:"MultiPolygon",coordinates:p})}else if(f.type==="Feature"){const p=f.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Dl(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Dl(f,f)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(a,f){const p=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(f.type==="Polygon"){const E=vh(f.coordinates,x,b),P=dm(a.geometry(),p,x,b);if(!mc(p,x))return!1;for(const z of P)if(!ts(z,E))return!1}if(f.type==="MultiPolygon"){const E=gc(f.coordinates,x,b),P=dm(a.geometry(),p,x,b);if(!mc(p,x))return!1;for(const z of P)if(!ry(z,E))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(a,f){const p=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(f.type==="Polygon"){const E=vh(f.coordinates,x,b),P=_h(a.geometry(),p,x,b);if(!mc(p,x))return!1;for(const z of P)if(!yh(z,E))return!1}if(f.type==="MultiPolygon"){const E=gc(f.coordinates,x,b),P=_h(a.geometry(),p,x,b);if(!mc(p,x))return!1;for(const z of P)if(!ny(z,E))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Xd=class{constructor(s=[],r=(a,f)=>a<f?-1:a>f?1:0){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:a}=this,f=r[s];for(;s>0;){const p=s-1>>1,x=r[p];if(a(f,x)>=0)break;r[s]=x,s=p}r[s]=f}_down(s){const{data:r,compare:a}=this,f=this.length>>1,p=r[s];for(;s<f;){let x=1+(s<<1);const b=x+1;if(b<this.length&&a(r[b],r[x])<0&&(x=b),a(r[x],p)>=0)break;r[s]=r[x],s=x}r[s]=p}};function Lf(s,r,a=0,f=s.length-1,p=Kd){for(;f>a;){if(f-a>600){const P=f-a+1,z=r-a+1,L=Math.log(P),N=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*N*(P-N)/P)*(z-P/2<0?-1:1);Lf(s,r,Math.max(a,Math.floor(r-z*N/P+$)),Math.min(f,Math.floor(r+(P-z)*N/P+$)),p)}const x=s[r];let b=a,E=f;for(Ol(s,a,r),p(s[f],x)>0&&Ol(s,a,f);b<E;){for(Ol(s,b,E),b++,E--;p(s[b],x)<0;)b++;for(;p(s[E],x)>0;)E--}p(s[a],x)===0?Ol(s,a,E):(E++,Ol(s,E,f)),E<=r&&(a=E+1),r<=E&&(f=E-1)}}function Ol(s,r,a){const f=s[r];s[r]=s[a],s[a]=f}function Kd(s,r){return s<r?-1:s>r?1:0}function yc(s,r){if(s.length<=1)return[s];const a=[];let f,p;for(const x of s){const b=iy(x);b!==0&&(x.area=Math.abs(b),p===void 0&&(p=b<0),p===b<0?(f&&a.push(f),f=[x]):f.push(x))}if(f&&a.push(f),r>1)for(let x=0;x<a.length;x++)a[x].length<=r||(Lf(a[x],r,1,a[x].length-1,pm),a[x]=a[x].slice(0,r));return a}function pm(s,r){return r.area-s.area}function iy(s){let r=0;for(let a,f,p=0,x=s.length,b=x-1;p<x;b=p++)a=s[p],f=s[b],r+=(f.x-a.x)*(a.y+f.y);return r}const mm=1/298.257223563,gm=mm*(2-mm),xh=Math.PI/180;class Qd{constructor(r){const a=6378.137*xh*1e3,f=Math.cos(r*xh),p=1/(1-gm*(1-f*f)),x=Math.sqrt(p);this.kx=a*x*f,this.ky=a*x*p*(1-gm)}distance(r,a){const f=this.wrap(r[0]-a[0])*this.kx,p=(r[1]-a[1])*this.ky;return Math.sqrt(f*f+p*p)}pointOnLine(r,a){let f,p,x,b,E=1/0;for(let P=0;P<r.length-1;P++){let z=r[P][0],L=r[P][1],N=this.wrap(r[P+1][0]-z)*this.kx,$=(r[P+1][1]-L)*this.ky,H=0;N===0&&$===0||(H=(this.wrap(a[0]-z)*this.kx*N+(a[1]-L)*this.ky*$)/(N*N+$*$),H>1?(z=r[P+1][0],L=r[P+1][1]):H>0&&(z+=N/this.kx*H,L+=$/this.ky*H)),N=this.wrap(a[0]-z)*this.kx,$=(a[1]-L)*this.ky;const J=N*N+$*$;J<E&&(E=J,f=z,p=L,x=P,b=H)}return{point:[f,p],index:x,t:Math.max(0,Math.min(1,b))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Fa(s,r){return r[0]-s[0]}function Il(s){return s[1]-s[0]+1}function As(s,r){return s[1]>=s[0]&&s[1]<r}function vc(s,r){if(s[0]>s[1])return[null,null];const a=Il(s);if(r){if(a===2)return[s,null];const p=Math.floor(a/2);return[[s[0],s[0]+p],[s[0]+p,s[1]]]}if(a===1)return[s,null];const f=Math.floor(a/2)-1;return[[s[0],s[0]+f],[s[0]+f+1,s[1]]]}function bh(s,r){if(!As(r,s.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let f=r[0];f<=r[1];++f)Qs(a,s[f]);return a}function Nf(s){const r=[1/0,1/0,-1/0,-1/0];for(const a of s)for(const f of a)Qs(r,f);return r}function Bf(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Ff(s,r,a){if(!Bf(s)||!Bf(r))return NaN;let f=0,p=0;return s[2]<r[0]&&(f=r[0]-s[2]),s[0]>r[2]&&(f=s[0]-r[2]),s[1]>r[3]&&(p=s[1]-r[3]),s[3]<r[1]&&(p=r[1]-s[3]),a.distance([0,0],[f,p])}function po(s,r,a){const f=a.pointOnLine(r,s);return a.distance(s,f.point)}function wh(s,r,a,f,p){const x=Math.min(po(s,[a,f],p),po(r,[a,f],p)),b=Math.min(po(a,[s,r],p),po(f,[s,r],p));return Math.min(x,b)}function Sh(s,r,a,f,p){if(!As(r,s.length)||!As(f,a.length))return 1/0;let x=1/0;for(let b=r[0];b<r[1];++b){const E=s[b],P=s[b+1];for(let z=f[0];z<f[1];++z){const L=a[z],N=a[z+1];if(gh(E,P,L,N))return 0;x=Math.min(x,wh(E,P,L,N,p))}}return x}function Jd(s,r,a,f,p){if(!As(r,s.length)||!As(f,a.length))return NaN;let x=1/0;for(let b=r[0];b<=r[1];++b)for(let E=f[0];E<=f[1];++E)if(x=Math.min(x,p.distance(s[b],a[E])),x===0)return x;return x}function ep(s,r,a){if(ts(s,r,!0))return 0;let f=1/0;for(const p of r){const x=p[0],b=p[p.length-1];if(x!==b&&(f=Math.min(f,po(s,[b,x],a)),f===0))return f;const E=a.pointOnLine(p,s);if(f=Math.min(f,a.distance(s,E.point)),f===0)return f}return f}function _u(s,r,a,f){if(!As(r,s.length))return NaN;for(let x=r[0];x<=r[1];++x)if(ts(s[x],a,!0))return 0;let p=1/0;for(let x=r[0];x<r[1];++x){const b=s[x],E=s[x+1];for(const P of a)for(let z=0,L=P.length,N=L-1;z<L;N=z++){const $=P[N],H=P[z];if(gh(b,E,$,H))return 0;p=Math.min(p,wh(b,E,$,H,f))}}return p}function xu(s,r){for(const a of s)for(const f of a)if(ts(f,r,!0))return!0;return!1}function tp(s,r,a,f=1/0){const p=Nf(s),x=Nf(r);if(f!==1/0&&Ff(p,x,a)>=f)return f;if(mc(p,x)){if(xu(s,r))return 0}else if(xu(r,s))return 0;let b=1/0;for(const E of s)for(let P=0,z=E.length,L=z-1;P<z;L=P++){const N=E[L],$=E[P];for(const H of r)for(let J=0,te=H.length,ie=te-1;J<te;ie=J++){const le=H[ie],ye=H[J];if(gh(N,$,le,ye))return 0;b=Math.min(b,wh(N,$,le,ye,a))}}return b}function rp(s,r,a,f,p,x){if(!x)return;const b=Ff(bh(f,x),p,a);b<r&&s.push([b,x,[0,0]])}function Cr(s,r,a,f,p,x,b){if(!x||!b)return;const E=Ff(bh(f,x),bh(p,b),a);E<r&&s.push([E,x,b])}function Th(s,r,a,f,p=1/0){let x=Math.min(f.distance(s[0],a[0][0]),p);if(x===0)return x;const b=new Xd([[0,[0,s.length-1],[0,0]]],Fa),E=Nf(a);for(;b.length>0;){const P=b.pop();if(P[0]>=x)continue;const z=P[1],L=r?50:100;if(Il(z)<=L){if(!As(z,s.length))return NaN;if(r){const N=_u(s,z,a,f);if(isNaN(N)||N===0)return N;x=Math.min(x,N)}else for(let N=z[0];N<=z[1];++N){const $=ep(s[N],a,f);if(x=Math.min(x,$),x===0)return 0}}else{const N=vc(z,r);rp(b,x,f,s,E,N[0]),rp(b,x,f,s,E,N[1])}}return x}function Eh(s,r,a,f,p,x=1/0){let b=Math.min(x,p.distance(s[0],a[0]));if(b===0)return b;const E=new Xd([[0,[0,s.length-1],[0,a.length-1]]],Fa);for(;E.length>0;){const P=E.pop();if(P[0]>=b)continue;const z=P[1],L=P[2],N=r?50:100,$=f?50:100;if(Il(z)<=N&&Il(L)<=$){if(!As(z,s.length)&&As(L,a.length))return NaN;let H;if(r&&f)H=Sh(s,z,a,L,p),b=Math.min(b,H);else if(r&&!f){const J=s.slice(z[0],z[1]+1);for(let te=L[0];te<=L[1];++te)if(H=po(a[te],J,p),b=Math.min(b,H),b===0)return b}else if(!r&&f){const J=a.slice(L[0],L[1]+1);for(let te=z[0];te<=z[1];++te)if(H=po(s[te],J,p),b=Math.min(b,H),b===0)return b}else H=Jd(s,z,a,L,p),b=Math.min(b,H)}else{const H=vc(z,r),J=vc(L,f);Cr(E,b,p,s,a,H[0],J[0]),Cr(E,b,p,s,a,H[0],J[1]),Cr(E,b,p,s,a,H[1],J[0]),Cr(E,b,p,s,a,H[1],J[1])}}return b}function Uf(s){return s.type==="MultiPolygon"?s.coordinates.map((r=>({type:"Polygon",coordinates:r}))):s.type==="MultiLineString"?s.coordinates.map((r=>({type:"LineString",coordinates:r}))):s.type==="MultiPoint"?s.coordinates.map((r=>({type:"Point",coordinates:r}))):[s]}class bu{constructor(r,a){this.type=xt,this.geojson=r,this.geometries=a}static parse(r,a){if(r.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(wn(r[1])){const f=r[1];if(f.type==="FeatureCollection")return new bu(f,f.features.map((p=>Uf(p.geometry))).flat());if(f.type==="Feature")return new bu(f,Uf(f.geometry));if("type"in f&&"coordinates"in f)return new bu(f,Uf(f))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(a,f){const p=a.geometry(),x=p.flat().map((P=>kf([P.x,P.y],a.canonical)));if(p.length===0)return NaN;const b=new Qd(x[0][1]);let E=1/0;for(const P of f){switch(P.type){case"Point":E=Math.min(E,Eh(x,!1,[P.coordinates],!1,b,E));break;case"LineString":E=Math.min(E,Eh(x,!1,P.coordinates,!0,b,E));break;case"Polygon":E=Math.min(E,Th(x,!1,P.coordinates,b,E))}if(E===0)return E}return E})(r,this.geometries);if(r.geometryType()==="LineString")return(function(a,f){const p=a.geometry(),x=p.flat().map((P=>kf([P.x,P.y],a.canonical)));if(p.length===0)return NaN;const b=new Qd(x[0][1]);let E=1/0;for(const P of f){switch(P.type){case"Point":E=Math.min(E,Eh(x,!0,[P.coordinates],!1,b,E));break;case"LineString":E=Math.min(E,Eh(x,!0,P.coordinates,!0,b,E));break;case"Polygon":E=Math.min(E,Th(x,!0,P.coordinates,b,E))}if(E===0)return E}return E})(r,this.geometries);if(r.geometryType()==="Polygon")return(function(a,f){const p=a.geometry();if(p.length===0||p[0].length===0)return NaN;const x=yc(p,0).map((P=>P.map((z=>z.map((L=>kf([L.x,L.y],a.canonical))))))),b=new Qd(x[0][0][0][1]);let E=1/0;for(const P of f)for(const z of x){switch(P.type){case"Point":E=Math.min(E,Th([P.coordinates],!1,z,b,E));break;case"LineString":E=Math.min(E,Th(P.coordinates,!0,z,b,E));break;case"Polygon":E=Math.min(E,tp(z,P.coordinates,b,E))}if(E===0)return E}return E})(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ah{constructor(r){this.type=gr,this.key=r}static parse(r,a){if(r.length!==2)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const f=r[1];return f==null?a.error("Global state property must be defined."):typeof f!="string"?a.error(`Global state property must be string, but found ${typeof r[1]} instead.`):new Ah(f)}evaluate(r){var a;const f=(a=r.globals)===null||a===void 0?void 0:a.globalState;return f&&Object.keys(f).length!==0?Cl(f,this.key):null}eachChild(){}outputDefined(){return!1}}const _c={"==":ji,"!=":Wd,">":hm,"<":Yd,">=":dc,"<=":ty,array:Ai,at:Xs,boolean:Ai,case:Br,coalesce:Mi,collator:yu,format:If,image:zf,in:Dr,"index-of":br,interpolate:_a,"interpolate-hcl":_a,"interpolate-lab":_a,length:pc,let:Ys,literal:gi,match:ph,number:Ai,"number-format":mh,object:Ai,slice:fc,step:mu,string:Ai,"to-boolean":kr,"to-color":kr,"to-number":kr,"to-string":kr,var:sn,within:Dl,distance:bu,"global-state":Ah};class mo{constructor(r,a,f,p){this.name=r,this.type=a,this._evaluate=f,this.args=p}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,a){const f=r[0],p=mo.definitions[f];if(!p)return a.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=b.filter((([z])=>!Array.isArray(z)||z.length===r.length-1));let P=null;for(const[z,L]of E){P=new dh(a.registry,wa,a.path,null,a.scope);const N=[];let $=!1;for(let H=1;H<r.length;H++){const J=r[H],te=Array.isArray(z)?z[H-1]:z.type,ie=P.parse(J,1+N.length,te);if(!ie){$=!0;break}N.push(ie)}if(!$)if(Array.isArray(z)&&z.length!==N.length)P.error(`Expected ${z.length} arguments, but found ${N.length} instead.`);else{for(let H=0;H<N.length;H++){const J=Array.isArray(z)?z[H]:z.type,te=N[H];P.concat(H+1).checkSubtype(J,te.type)}if(P.errors.length===0)return new mo(f,x,L,N)}}if(E.length===1)a.errors.push(...P.errors);else{const z=(E.length?E:b).map((([N])=>{return $=N,Array.isArray($)?`(${$.map(Ur).join(", ")})`:`(${Ur($.type)}...)`;var $})).join(" | "),L=[];for(let N=1;N<r.length;N++){const $=a.parse(r[N],1+L.length);if(!$)return null;L.push(Ur($.type))}a.error(`Expected arguments of type ${z}, but found (${L.join(", ")}) instead.`)}return null}static register(r,a){mo.definitions=a;for(const f in a)r[f]=mo}}function np(s,[r,a,f,p]){r=r.evaluate(s),a=a.evaluate(s),f=f.evaluate(s);const x=p?p.evaluate(s):1,b=La(r,a,f,x);if(b)throw new Wt(b);return new Ot(r/255,a/255,f/255,x,!1)}function Vf(s,r){return s in r}function go(s,r){const a=r[s];return a===void 0?null:a}function Ms(s){return{type:s}}function wa(s){if(s instanceof sn)return wa(s.boundExpression);if(s instanceof mo&&s.name==="error"||s instanceof yu||s instanceof Dl||s instanceof bu||s instanceof Ah)return!1;const r=s instanceof kr||s instanceof Ai;let a=!0;return s.eachChild((f=>{a=r?a&&wa(f):a&&f instanceof gi})),!!a&&Js(s)&&Su(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Js(s){if(s instanceof mo&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Dl||s instanceof bu)return!1;let r=!0;return s.eachChild((a=>{r&&!Js(a)&&(r=!1)})),r}function wu(s){if(s instanceof mo&&s.name==="feature-state")return!1;let r=!0;return s.eachChild((a=>{r&&!wu(a)&&(r=!1)})),r}function Su(s,r){if(s instanceof mo&&r.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild((f=>{a&&!Su(f,r)&&(a=!1)})),a}function Mh(s){return{result:"success",value:s}}function zl(s){return{result:"error",value:s}}function Lo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function ip(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function xc(s){return!!s.expression&&s.expression.interpolated}function wr(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function qf(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&Zr(s)===Ss}function yo(s){return s}function $f(s,r){const a=s.stops&&typeof s.stops[0][0]=="object",f=a||!(a||s.property!==void 0),p=s.type||(xc(r)?"exponential":"interval"),x=(function(L){switch(L.type){case"color":return Ot.parse;case"padding":return on.parse;case"numberArray":return Mr.parse;case"colorArray":return Lr.parse;default:return null}})(r);if(x&&((s=jr({},s)).stops&&(s.stops=s.stops.map((L=>[L[0],x(L[1])]))),s.default=x(s.default?s.default:r.default)),s.colorSpace&&(b=s.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var b;const E=(function(L){switch(L){case"exponential":return kl;case"interval":return Gf;case"categorical":return ym;case"identity":return ap;default:throw new Error(`Unknown function type "${L}"`)}})(p);let P,z;if(p==="categorical"){P=Object.create(null);for(const L of s.stops)P[L[0]]=L[1];z=typeof s.stops[0][0]}if(a){const L={},N=[];for(let J=0;J<s.stops.length;J++){const te=s.stops[J],ie=te[0].zoom;L[ie]===void 0&&(L[ie]={zoom:ie,type:s.type,property:s.property,default:s.default,stops:[]},N.push(ie)),L[ie].stops.push([te[0].value,te[1]])}const $=[];for(const J of N)$.push([L[J].zoom,$f(L[J],r)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:_a.interpolationFactor.bind(void 0,H),zoomStops:$.map((J=>J[0])),evaluate:({zoom:J},te)=>kl({stops:$,base:s.base},r,J).evaluate(J,te)}}if(f){const L=p==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:_a.interpolationFactor.bind(void 0,L),zoomStops:s.stops.map((N=>N[0])),evaluate:({zoom:N})=>E(s,r,N,P,z)}}return{kind:"source",evaluate(L,N){const $=N&&N.properties?N.properties[s.property]:void 0;return $===void 0?vo(s.default,r.default):E(s,r,$,P,z)}}}function vo(s,r,a){return s!==void 0?s:r!==void 0?r:a!==void 0?a:void 0}function ym(s,r,a,f,p){return vo(typeof a===p?f[a]:void 0,s.default,r.default)}function Gf(s,r,a){if(wr(a)!=="number")return vo(s.default,r.default);const f=s.stops.length;if(f===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[f-1][0])return s.stops[f-1][1];const p=Ba(s.stops.map((x=>x[0])),a);return s.stops[p][1]}function kl(s,r,a){const f=s.base!==void 0?s.base:1;if(wr(a)!=="number")return vo(s.default,r.default);const p=s.stops.length;if(p===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[p-1][0])return s.stops[p-1][1];const x=Ba(s.stops.map((L=>L[0])),a),b=(function(L,N,$,H){const J=H-$,te=L-$;return J===0?0:N===1?te/J:(Math.pow(N,te)-1)/(Math.pow(N,J)-1)})(a,f,s.stops[x][0],s.stops[x+1][0]),E=s.stops[x][1],P=s.stops[x+1][1],z=Wi[r.type]||yo;return typeof E.evaluate=="function"?{evaluate(...L){const N=E.evaluate.apply(void 0,L),$=P.evaluate.apply(void 0,L);if(N!==void 0&&$!==void 0)return z(N,$,b,s.colorSpace)}}:z(E,P,b,s.colorSpace)}function ap(s,r,a){switch(r.type){case"color":a=Ot.parse(a);break;case"formatted":a=xr.fromString(a.toString());break;case"resolvedImage":a=ki.fromString(a.toString());break;case"padding":a=on.parse(a);break;case"colorArray":a=Lr.parse(a);break;case"numberArray":a=Mr.parse(a);break;default:wr(a)===r.type||r.type==="enum"&&r.values[a]||(a=void 0)}return vo(a,s.default,r.default)}mo.register(_c,{error:[{kind:"error"},[ur],(s,[r])=>{throw new Wt(r.evaluate(s))}],typeof:[ur,[gr],(s,[r])=>Ur(Zr(r.evaluate(s)))],"to-rgba":[Gr(xt,4),[Ra],(s,[r])=>{const[a,f,p,x]=r.evaluate(s).rgb;return[255*a,255*f,255*p,x]}],rgb:[Ra,[xt,xt,xt],np],rgba:[Ra,[xt,xt,xt,xt],np],has:{type:sr,overloads:[[[ur],(s,[r])=>Vf(r.evaluate(s),s.properties())],[[ur,Ss],(s,[r,a])=>Vf(r.evaluate(s),a.evaluate(s))]]},get:{type:gr,overloads:[[[ur],(s,[r])=>go(r.evaluate(s),s.properties())],[[ur,Ss],(s,[r,a])=>go(r.evaluate(s),a.evaluate(s))]]},"feature-state":[gr,[ur],(s,[r])=>go(r.evaluate(s),s.featureState||{})],properties:[Ss,[],s=>s.properties()],"geometry-type":[ur,[],s=>s.geometryType()],id:[gr,[],s=>s.id()],zoom:[xt,[],s=>s.globals.zoom],"heatmap-density":[xt,[],s=>s.globals.heatmapDensity||0],elevation:[xt,[],s=>s.globals.elevation||0],"line-progress":[xt,[],s=>s.globals.lineProgress||0],accumulated:[gr,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[xt,Ms(xt),(s,r)=>{let a=0;for(const f of r)a+=f.evaluate(s);return a}],"*":[xt,Ms(xt),(s,r)=>{let a=1;for(const f of r)a*=f.evaluate(s);return a}],"-":{type:xt,overloads:[[[xt,xt],(s,[r,a])=>r.evaluate(s)-a.evaluate(s)],[[xt],(s,[r])=>-r.evaluate(s)]]},"/":[xt,[xt,xt],(s,[r,a])=>r.evaluate(s)/a.evaluate(s)],"%":[xt,[xt,xt],(s,[r,a])=>r.evaluate(s)%a.evaluate(s)],ln2:[xt,[],()=>Math.LN2],pi:[xt,[],()=>Math.PI],e:[xt,[],()=>Math.E],"^":[xt,[xt,xt],(s,[r,a])=>Math.pow(r.evaluate(s),a.evaluate(s))],sqrt:[xt,[xt],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[xt,[xt],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[xt,[xt],(s,[r])=>Math.log(r.evaluate(s))],log2:[xt,[xt],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[xt,[xt],(s,[r])=>Math.sin(r.evaluate(s))],cos:[xt,[xt],(s,[r])=>Math.cos(r.evaluate(s))],tan:[xt,[xt],(s,[r])=>Math.tan(r.evaluate(s))],asin:[xt,[xt],(s,[r])=>Math.asin(r.evaluate(s))],acos:[xt,[xt],(s,[r])=>Math.acos(r.evaluate(s))],atan:[xt,[xt],(s,[r])=>Math.atan(r.evaluate(s))],min:[xt,Ms(xt),(s,r)=>Math.min(...r.map((a=>a.evaluate(s))))],max:[xt,Ms(xt),(s,r)=>Math.max(...r.map((a=>a.evaluate(s))))],abs:[xt,[xt],(s,[r])=>Math.abs(r.evaluate(s))],round:[xt,[xt],(s,[r])=>{const a=r.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[xt,[xt],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[xt,[xt],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[sr,[ur,gr],(s,[r,a])=>s.properties()[r.value]===a.value],"filter-id-==":[sr,[gr],(s,[r])=>s.id()===r.value],"filter-type-==":[sr,[ur],(s,[r])=>s.geometryType()===r.value],"filter-<":[sr,[ur,gr],(s,[r,a])=>{const f=s.properties()[r.value],p=a.value;return typeof f==typeof p&&f<p}],"filter-id-<":[sr,[gr],(s,[r])=>{const a=s.id(),f=r.value;return typeof a==typeof f&&a<f}],"filter->":[sr,[ur,gr],(s,[r,a])=>{const f=s.properties()[r.value],p=a.value;return typeof f==typeof p&&f>p}],"filter-id->":[sr,[gr],(s,[r])=>{const a=s.id(),f=r.value;return typeof a==typeof f&&a>f}],"filter-<=":[sr,[ur,gr],(s,[r,a])=>{const f=s.properties()[r.value],p=a.value;return typeof f==typeof p&&f<=p}],"filter-id-<=":[sr,[gr],(s,[r])=>{const a=s.id(),f=r.value;return typeof a==typeof f&&a<=f}],"filter->=":[sr,[ur,gr],(s,[r,a])=>{const f=s.properties()[r.value],p=a.value;return typeof f==typeof p&&f>=p}],"filter-id->=":[sr,[gr],(s,[r])=>{const a=s.id(),f=r.value;return typeof a==typeof f&&a>=f}],"filter-has":[sr,[gr],(s,[r])=>r.value in s.properties()],"filter-has-id":[sr,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[sr,[Gr(ur)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[sr,[Gr(gr)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[sr,[ur,Gr(gr)],(s,[r,a])=>a.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[sr,[ur,Gr(gr)],(s,[r,a])=>(function(f,p,x,b){for(;x<=b;){const E=x+b>>1;if(p[E]===f)return!0;p[E]>f?b=E-1:x=E+1}return!1})(s.properties()[r.value],a.value,0,a.value.length-1)],all:{type:sr,overloads:[[[sr,sr],(s,[r,a])=>r.evaluate(s)&&a.evaluate(s)],[Ms(sr),(s,r)=>{for(const a of r)if(!a.evaluate(s))return!1;return!0}]]},any:{type:sr,overloads:[[[sr,sr],(s,[r,a])=>r.evaluate(s)||a.evaluate(s)],[Ms(sr),(s,r)=>{for(const a of r)if(a.evaluate(s))return!0;return!1}]]},"!":[sr,[sr],(s,[r])=>!r.evaluate(s)],"is-supported-script":[sr,[ur],(s,[r])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(r.evaluate(s))}],upcase:[ur,[ur],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[ur,[ur],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[ur,Ms(gr),(s,r)=>r.map((a=>Na(a.evaluate(s)))).join("")],"resolved-locale":[ur,[Ts],(s,[r])=>r.evaluate(s).resolvedLocale()]});class Zf{constructor(r,a,f){this.expression=r,this._warningHistory={},this._evaluator=new Es,this._defaultValue=a?(function(p){if(p.type==="color"&&qf(p.default))return new Ot(0,0,0,0);switch(p.type){case"color":return Ot.parse(p.default)||null;case"padding":return on.parse(p.default)||null;case"numberArray":return Mr.parse(p.default)||null;case"colorArray":return Lr.parse(p.default)||null;case"variableAnchorOffsetCollection":return Nr.parse(p.default)||null;case"projectionDefinition":return ni.parse(p.default)||null;default:return p.default===void 0?null:p.default}})(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this._globalState=f}evaluateWithoutErrorHandling(r,a,f,p,x,b){return this._globalState&&(r=yi(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=f,this._evaluator.canonical=p,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(r,a,f,p,x,b){this._globalState&&(r=yi(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=f||null,this._evaluator.canonical=p,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Wt(`Expected value to be one of ${Object.keys(this._enumValues).map((P=>JSON.stringify(P))).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function bc(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in _c}function Rl(s,r,a){const f=new dh(_c,wa,[],r?(function(x){const b={color:Ra,string:ur,number:xt,enum:ur,boolean:sr,formatted:ja,padding:Xo,numberArray:Ir,colorArray:va,projectionDefinition:Zs,resolvedImage:Dn,variableAnchorOffsetCollection:Tl};return x.type==="array"?Gr(b[x.value]||gr,x.length):b[x.type]})(r):void 0),p=f.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Mh(new Zf(p,r,a)):zl(f.errors)}class Sa{constructor(r,a,f){this.kind=r,this._styleExpression=a,this.isStateDependent=r!=="constant"&&!wu(a.expression),this.globalStateRefs=ra(a.expression),this._globalState=f}evaluateWithoutErrorHandling(r,a,f,p,x,b){return this._globalState&&(r=yi(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,a,f,p,x,b)}evaluate(r,a,f,p,x,b){return this._globalState&&(r=yi(r,this._globalState)),this._styleExpression.evaluate(r,a,f,p,x,b)}}class jl{constructor(r,a,f,p,x){this.kind=r,this.zoomStops=f,this._styleExpression=a,this.isStateDependent=r!=="camera"&&!wu(a.expression),this.globalStateRefs=ra(a.expression),this.interpolationType=p,this._globalState=x}evaluateWithoutErrorHandling(r,a,f,p,x,b){return this._globalState&&(r=yi(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,a,f,p,x,b)}evaluate(r,a,f,p,x,b){return this._globalState&&(r=yi(r,this._globalState)),this._styleExpression.evaluate(r,a,f,p,x,b)}interpolationFactor(r,a,f){return this.interpolationType?_a.interpolationFactor(this.interpolationType,r,a,f):0}}function Tu(s,r,a){const f=Rl(s,r,a);if(f.result==="error")return f;const p=f.value.expression,x=Js(p);if(!x&&!Lo(r))return zl([new fn("","data expressions not supported")]);const b=Su(p,["zoom"]);if(!b&&!ip(r))return zl([new fn("","zoom expressions not supported")]);const E=Nl(p);return E||b?E instanceof fn?zl([E]):E instanceof _a&&!xc(r)?zl([new fn("",'"interpolate" expressions cannot be used with this property')]):Mh(E?new jl(x?"camera":"composite",f.value,E.labels,E instanceof _a?E.interpolation:void 0,a):new Sa(x?"constant":"source",f.value,a)):zl([new fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ll{constructor(r,a){this._parameters=r,this._specification=a,jr(this,$f(this._parameters,this._specification))}static deserialize(r){return new Ll(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Nl(s){let r=null;if(s instanceof Ys)r=Nl(s.result);else if(s instanceof Mi){for(const a of s.args)if(r=Nl(a),r)break}else(s instanceof mu||s instanceof _a)&&s.input instanceof mo&&s.input.name==="zoom"&&(r=s);return r instanceof fn||s.eachChild((a=>{const f=Nl(a);f instanceof fn?r=f:!r&&f?r=new fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&f&&r!==f&&(r=new fn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}function ra(s,r=new Set){return s instanceof Ah&&r.add(s.key),s.eachChild((a=>{ra(a,r)})),r}function yi(s,r){const{zoom:a,heatmapDensity:f,elevation:p,lineProgress:x,isSupportedScript:b,accumulated:E}=s??{};return{zoom:a,heatmapDensity:f,elevation:p,lineProgress:x,isSupportedScript:b,accumulated:E,globalState:r}}function rs(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!rs(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Ps={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ua(s,r){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};rs(s)||(s=wc(s));const a=Rl(s,Ps,r);if(a.result==="error")throw new Error(a.value.map((f=>`${f.key}: ${f.message}`)).join(", "));return{filter:(f,p,x)=>a.value.evaluate(f,p,{},x),needGeometry:op(s),getGlobalStateRefs:()=>ra(a.value.expression)}}function el(s,r){return s<r?-1:s>r?1:0}function op(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(op(s[r]))return!0;return!1}function wc(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?Sc(s[1],s[2],"=="):r==="!="?yn(Sc(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Sc(s[1],s[2],r):r==="any"?(a=s.slice(1),["any"].concat(a.map(wc))):r==="all"?["all"].concat(s.slice(1).map(wc)):r==="none"?["all"].concat(s.slice(1).map(wc).map(yn)):r==="in"?Hf(s[1],s.slice(2)):r==="!in"?yn(Hf(s[1],s.slice(2))):r==="has"?Li(s[1]):r!=="!has"||yn(Li(s[1]));var a}function Sc(s,r,a){switch(s){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,s,r]}}function Hf(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((a=>typeof a!=typeof r[0]))?["filter-in-large",s,["literal",r.sort(el)]]:["filter-in-small",s,["literal",r]]}}function Li(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function yn(s){return["!",s]}function Rr(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let p="[";for(const x of s)p+=`${Rr(x)},`;return`${p}]`}const a=Object.keys(s).sort();let f="{";for(let p=0;p<a.length;p++)f+=`${JSON.stringify(a[p])}:${Rr(s[a[p]])},`;return`${f}}`}function tl(s){let r="";for(const a of qt)r+=`/${Rr(s[a])}`;return r}function Va(s){const r=s.value;return r?[new Et(s.key,r,"constants have been deprecated as of v8")]:[]}function Fn(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function qa(s){if(Array.isArray(s))return s.map(qa);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const a in s)r[a]=qa(s[a]);return r}return Fn(s)}function $a(s){const r=s.key,a=s.value,f=s.valueSpec||{},p=s.objectElementValidators||{},x=s.style,b=s.styleSpec,E=s.validateSpec;let P=[];const z=wr(a);if(z!=="object")return[new Et(r,a,`object expected, ${z} found`)];for(const L in a){const N=L.split(".")[0],$=Cl(f,N)||f["*"];let H;if(Cl(p,N))H=p[N];else if(Cl(f,N)){if(a[L]===void 0)continue;H=E}else if(p["*"])H=p["*"];else{if(!f["*"]){P.push(new Et(r,a[L],`unknown property "${L}"`));continue}H=E}P=P.concat(H({key:(r&&`${r}.`)+L,value:a[L],valueSpec:$,style:x,styleSpec:b,object:a,objectKey:L,validateSpec:E},a))}for(const L in f)p[L]||f[L].required&&f[L].default===void 0&&a[L]===void 0&&P.push(new Et(r,a,`missing required property "${L}"`));return P}function Wf(s){const r=s.value,a=s.valueSpec,f=s.style,p=s.styleSpec,x=s.key,b=s.arrayElementValidator||s.validateSpec;if(wr(r)!=="array")return[new Et(x,r,`array expected, ${wr(r)} found`)];if(a.length&&r.length!==a.length)return[new Et(x,r,`array length ${a.length} expected, length ${r.length} found`)];let E={type:a.value,values:a.values};p.$version<7&&(E.function=a.function),wr(a.value)==="object"&&(E=a.value);let P=[];for(let z=0;z<r.length;z++)P=P.concat(b({array:r,arrayIndex:z,value:r[z],valueSpec:E,validateSpec:s.validateSpec,style:f,styleSpec:p,key:`${x}[${z}]`}));return P}function Cs(s){const r=s.key,a=s.value,f=s.valueSpec;let p=wr(a);return p==="number"&&a!=a&&(p="NaN"),p!=="number"?[new Et(r,a,`number expected, ${p} found`)]:"minimum"in f&&a<f.minimum?[new Et(r,a,`${a} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&a>f.maximum?[new Et(r,a,`${a} is greater than the maximum value ${f.maximum}`)]:[]}function rl(s){const r=s.valueSpec,a=Fn(s.value.type);let f,p,x,b={};const E=a!=="categorical"&&s.value.property===void 0,P=!E,z=wr(s.value.stops)==="array"&&wr(s.value.stops[0])==="array"&&wr(s.value.stops[0][0])==="object",L=$a({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if(a==="identity")return[new Et(H.key,H.value,'identity function may not have a "stops" property')];let J=[];const te=H.value;return J=J.concat(Wf({key:H.key,value:te,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:N})),wr(te)==="array"&&te.length===0&&J.push(new Et(H.key,te,"array must have at least one stop")),J},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:r,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return a==="identity"&&E&&L.push(new Et(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||L.push(new Et(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!xc(s.valueSpec)&&L.push(new Et(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(P&&!Lo(s.valueSpec)?L.push(new Et(s.key,s.value,"property functions not supported")):E&&!ip(s.valueSpec)&&L.push(new Et(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!z||s.value.property!==void 0||L.push(new Et(s.key,s.value,'"property" property is required')),L;function N(H){let J=[];const te=H.value,ie=H.key;if(wr(te)!=="array")return[new Et(ie,te,`array expected, ${wr(te)} found`)];if(te.length!==2)return[new Et(ie,te,`array length 2 expected, length ${te.length} found`)];if(z){if(wr(te[0])!=="object")return[new Et(ie,te,`object expected, ${wr(te[0])} found`)];if(te[0].zoom===void 0)return[new Et(ie,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Et(ie,te,"object stop key must have value")];if(x&&x>Fn(te[0].zoom))return[new Et(ie,te[0].zoom,"stop zoom values must appear in ascending order")];Fn(te[0].zoom)!==x&&(x=Fn(te[0].zoom),p=void 0,b={}),J=J.concat($a({key:`${ie}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Cs,value:$}}))}else J=J.concat($({key:`${ie}[0]`,value:te[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},te));return bc(qa(te[1]))?J.concat([new Et(`${ie}[1]`,te[1],"expressions are not allowed in function stops.")]):J.concat(H.validateSpec({key:`${ie}[1]`,value:te[1],valueSpec:r,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function $(H,J){const te=wr(H.value),ie=Fn(H.value),le=H.value!==null?H.value:J;if(f){if(te!==f)return[new Et(H.key,le,`${te} stop domain type must match previous stop domain type ${f}`)]}else f=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Et(H.key,le,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&a!=="categorical"){let ye=`number expected, ${te} found`;return Lo(r)&&a===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Et(H.key,le,ye)]}return a!=="categorical"||te!=="number"||isFinite(ie)&&Math.floor(ie)===ie?a!=="categorical"&&te==="number"&&p!==void 0&&ie<p?[new Et(H.key,le,"stop domain values must appear in ascending order")]:(p=ie,a==="categorical"&&ie in b?[new Et(H.key,le,"stop domain values must be unique")]:(b[ie]=!0,[])):[new Et(H.key,le,`integer expected, found ${ie}`)]}}function Ds(s){const r=(s.expressionContext==="property"?Tu:Rl)(qa(s.value),s.valueSpec);if(r.result==="error")return r.value.map((f=>new Et(`${s.key}${f.key}`,s.value,f.message)));const a=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new Et(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!wu(a))return[new Et(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!wu(a))return[new Et(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Su(a,["zoom","feature-state"]))return[new Et(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Js(a))return[new Et(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function nl(s){const r=s.key,a=s.value,f=wr(a);return f!=="string"?[new Et(r,a,`color expected, ${f} found`)]:Ot.parse(String(a))?[]:[new Et(r,a,`color expected, "${a}" found`)]}function il(s){const r=s.key,a=s.value,f=s.valueSpec,p=[];return Array.isArray(f.values)?f.values.indexOf(Fn(a))===-1&&p.push(new Et(r,a,`expected one of [${f.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(f.values).indexOf(Fn(a))===-1&&p.push(new Et(r,a,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function ns(s){return rs(qa(s.value))?Ds(jr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_o(s)}function _o(s){const r=s.value,a=s.key;if(wr(r)!=="array")return[new Et(a,r,`array expected, ${wr(r)} found`)];const f=s.styleSpec;let p,x=[];if(r.length<1)return[new Et(a,r,"filter array must have at least 1 element")];switch(x=x.concat(il({key:`${a}[0]`,value:r[0],valueSpec:f.filter_operator,style:s.style,styleSpec:s.styleSpec})),Fn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Fn(r[1])==="$type"&&x.push(new Et(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&x.push(new Et(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=wr(r[1]),p!=="string"&&x.push(new Et(`${a}[1]`,r[1],`string expected, ${p} found`)));for(let b=2;b<r.length;b++)p=wr(r[b]),Fn(r[1])==="$type"?x=x.concat(il({key:`${a}[${b}]`,value:r[b],valueSpec:f.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&x.push(new Et(`${a}[${b}]`,r[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<r.length;b++)x=x.concat(_o({key:`${a}[${b}]`,value:r[b],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=wr(r[1]),r.length!==2?x.push(new Et(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="string"&&x.push(new Et(`${a}[1]`,r[1],`string expected, ${p} found`))}return x}function al(s,r){const a=s.key,f=s.validateSpec,p=s.style,x=s.styleSpec,b=s.value,E=s.objectKey,P=x[`${r}_${s.layerType}`];if(!P)return[];const z=E.match(/^(.*)-transition$/);if(r==="paint"&&z&&P[z[1]]&&P[z[1]].transition)return f({key:a,value:b,valueSpec:x.transition,style:p,styleSpec:x});const L=s.valueSpec||P[E];if(!L)return[new Et(a,b,`unknown property "${E}"`)];let N;if(wr(b)==="string"&&Lo(L)&&!L.tokens&&(N=/^{([^}]+)}$/.exec(b)))return[new Et(a,b,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&E==="text-font"&&qf(qa(b))&&Fn(b.type)==="identity"&&$.push(new Et(a,b,'"text-font" does not support identity functions')),$.concat(f({key:s.key,value:b,valueSpec:L,style:p,styleSpec:x,expressionContext:"property",propertyType:r,propertyKey:E}))}function Os(s){return al(s,"paint")}function Yf(s){return al(s,"layout")}function Xf(s){let r=[];const a=s.value,f=s.key,p=s.style,x=s.styleSpec;if(wr(a)!=="object")return[new Et(f,a,`object expected, ${wr(a)} found`)];a.type||a.ref||r.push(new Et(f,a,'either "type" or "ref" is required'));let b=Fn(a.type);const E=Fn(a.ref);if(a.id){const P=Fn(a.id);for(let z=0;z<s.arrayIndex;z++){const L=p.layers[z];Fn(L.id)===P&&r.push(new Et(f,a.id,`duplicate layer id "${a.id}", previously used at line ${L.id.__line__}`))}}if("ref"in a){let P;["type","source","source-layer","filter","layout"].forEach((z=>{z in a&&r.push(new Et(f,a[z],`"${z}" is prohibited for ref layers`))})),p.layers.forEach((z=>{Fn(z.id)===E&&(P=z)})),P?P.ref?r.push(new Et(f,a.ref,"ref cannot reference another ref layer")):b=Fn(P.type):r.push(new Et(f,a.ref,`ref layer "${E}" not found`))}else if(b!=="background")if(a.source){const P=p.sources&&p.sources[a.source],z=P&&Fn(P.type);P?z==="vector"&&b==="raster"?r.push(new Et(f,a.source,`layer "${a.id}" requires a raster source`)):z!=="raster-dem"&&b==="hillshade"||z!=="raster-dem"&&b==="color-relief"?r.push(new Et(f,a.source,`layer "${a.id}" requires a raster-dem source`)):z==="raster"&&b!=="raster"?r.push(new Et(f,a.source,`layer "${a.id}" requires a vector source`)):z!=="vector"||a["source-layer"]?z==="raster-dem"&&b!=="hillshade"&&b!=="color-relief"?r.push(new Et(f,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):b!=="line"||!a.paint||!a.paint["line-gradient"]||z==="geojson"&&P.lineMetrics||r.push(new Et(f,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Et(f,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new Et(f,a.source,`source "${a.source}" not found`))}else r.push(new Et(f,a,'missing required property "source"'));return r=r.concat($a({key:f,value:a,valueSpec:x.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${f}.type`,value:a.type,valueSpec:x.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:a,objectKey:"type"}),filter:ns,layout:P=>$a({layer:a,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":z=>Yf(jr({layerType:b},z))}}),paint:P=>$a({layer:a,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":z=>Os(jr({layerType:b},z))}})}})),r}function xo(s){const r=s.value,a=s.key,f=wr(r);return f!=="string"?[new Et(a,r,`string expected, ${f} found`)]:[]}const Ph={promoteId:function({key:s,value:r}){if(wr(r)==="string")return xo({key:s,value:r});{const a=[];for(const f in r)a.push(...xo({key:`${s}.${f}`,value:r[f]}));return a}}};function ol(s){const r=s.value,a=s.key,f=s.styleSpec,p=s.style,x=s.validateSpec;if(!r.type)return[new Et(a,r,'"type" is required')];const b=Fn(r.type);let E;switch(b){case"vector":case"raster":return E=$a({key:a,value:r,valueSpec:f[`source_${b.replace("-","_")}`],style:s.style,styleSpec:f,objectElementValidators:Ph,validateSpec:x}),E;case"raster-dem":return E=(function(P){var z;const L=(z=P.sourceName)!==null&&z!==void 0?z:"",N=P.value,$=P.styleSpec,H=$.source_raster_dem,J=P.style;let te=[];const ie=wr(N);if(N===void 0)return te;if(ie!=="object")return te.push(new Et("source_raster_dem",N,`object expected, ${ie} found`)),te;const le=Fn(N.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],se=P.value.encoding?`"${P.value.encoding}"`:"Default";for(const fe in N)!le&&ye.includes(fe)?te.push(new Et(fe,N[fe],`In "${L}": "${fe}" is only valid when "encoding" is set to "custom". ${se} encoding found`)):H[fe]?te=te.concat(P.validateSpec({key:fe,value:N[fe],valueSpec:H[fe],validateSpec:P.validateSpec,style:J,styleSpec:$})):te.push(new Et(fe,N[fe],`unknown property "${fe}"`));return te})({sourceName:a,value:r,style:s.style,styleSpec:f,validateSpec:x}),E;case"geojson":if(E=$a({key:a,value:r,valueSpec:f.source_geojson,style:p,styleSpec:f,validateSpec:x,objectElementValidators:Ph}),r.cluster)for(const P in r.clusterProperties){const[z,L]=r.clusterProperties[P],N=typeof z=="string"?[z,["accumulated"],["get",P]]:z;E.push(...Ds({key:`${a}.${P}.map`,value:L,expressionContext:"cluster-map"})),E.push(...Ds({key:`${a}.${P}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return E;case"video":return $a({key:a,value:r,valueSpec:f.source_video,style:p,validateSpec:x,styleSpec:f});case"image":return $a({key:a,value:r,valueSpec:f.source_image,style:p,validateSpec:x,styleSpec:f});case"canvas":return[new Et(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return il({key:`${a}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Pi(s){const r=s.value,a=s.styleSpec,f=a.light,p=s.style;let x=[];const b=wr(r);if(r===void 0)return x;if(b!=="object")return x=x.concat([new Et("light",r,`object expected, ${b} found`)]),x;for(const E in r){const P=E.match(/^(.*)-transition$/);x=x.concat(P&&f[P[1]]&&f[P[1]].transition?s.validateSpec({key:E,value:r[E],valueSpec:a.transition,validateSpec:s.validateSpec,style:p,styleSpec:a}):f[E]?s.validateSpec({key:E,value:r[E],valueSpec:f[E],validateSpec:s.validateSpec,style:p,styleSpec:a}):[new Et(E,r[E],`unknown property "${E}"`)])}return x}function Bl(s){const r=s.value,a=s.styleSpec,f=a.sky,p=s.style,x=wr(r);if(r===void 0)return[];if(x!=="object")return[new Et("sky",r,`object expected, ${x} found`)];let b=[];for(const E in r)b=b.concat(f[E]?s.validateSpec({key:E,value:r[E],valueSpec:f[E],style:p,styleSpec:a}):[new Et(E,r[E],`unknown property "${E}"`)]);return b}function sp(s){const r=s.value,a=s.styleSpec,f=a.terrain,p=s.style;let x=[];const b=wr(r);if(r===void 0)return x;if(b!=="object")return x=x.concat([new Et("terrain",r,`object expected, ${b} found`)]),x;for(const E in r)x=x.concat(f[E]?s.validateSpec({key:E,value:r[E],valueSpec:f[E],validateSpec:s.validateSpec,style:p,styleSpec:a}):[new Et(E,r[E],`unknown property "${E}"`)]);return x}function lp(s){let r=[];const a=s.value,f=s.key;if(Array.isArray(a)){const p=[],x=[];for(const b in a)a[b].id&&p.includes(a[b].id)&&r.push(new Et(f,a,`all the sprites' ids must be unique, but ${a[b].id} is duplicated`)),p.push(a[b].id),a[b].url&&x.includes(a[b].url)&&r.push(new Et(f,a,`all the sprites' URLs must be unique, but ${a[b].url} is duplicated`)),x.push(a[b].url),r=r.concat($a({key:`${f}[${b}]`,value:a[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return xo({key:f,value:a})}function up(s){return!!s&&s.constructor===Object}function vm(s){return up(s.value)?[]:[new Et(s.key,s.value,`object expected, ${wr(s.value)} found`)]}const ii={"*":()=>[],array:Wf,boolean:function(s){const r=s.value,a=s.key,f=wr(r);return f!=="boolean"?[new Et(a,r,`boolean expected, ${f} found`)]:[]},number:Cs,color:nl,constants:Va,enum:il,filter:ns,function:rl,layer:Xf,object:$a,source:ol,light:Pi,sky:Bl,terrain:sp,projection:function(s){const r=s.value,a=s.styleSpec,f=a.projection,p=s.style,x=wr(r);if(r===void 0)return[];if(x!=="object")return[new Et("projection",r,`object expected, ${x} found`)];let b=[];for(const E in r)b=b.concat(f[E]?s.validateSpec({key:E,value:r[E],valueSpec:f[E],style:p,styleSpec:a}):[new Et(E,r[E],`unknown property "${E}"`)]);return b},projectionDefinition:function(s){const r=s.key;let a=s.value;a=a instanceof String?a.valueOf():a;const f=wr(a);return f!=="array"||(function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"})(a)||(function(p){return!!["interpolate","step","literal"].includes(p[0])})(a)?["array","string"].includes(f)?[]:[new Et(r,a,`projection expected, invalid type "${f}" found`)]:[new Et(r,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:xo,formatted:function(s){return xo(s).length===0?[]:Ds(s)},resolvedImage:function(s){return xo(s).length===0?[]:Ds(s)},padding:function(s){const r=s.key,a=s.value;if(wr(a)==="array"){if(a.length<1||a.length>4)return[new Et(r,a,`padding requires 1 to 4 values; ${a.length} values found`)];const f={type:"number"};let p=[];for(let x=0;x<a.length;x++)p=p.concat(s.validateSpec({key:`${r}[${x}]`,value:a[x],validateSpec:s.validateSpec,valueSpec:f}));return p}return Cs({key:r,value:a,valueSpec:{}})},numberArray:function(s){const r=s.key,a=s.value;if(wr(a)==="array"){const f={type:"number"};if(a.length<1)return[new Et(r,a,"array length at least 1 expected, length 0 found")];let p=[];for(let x=0;x<a.length;x++)p=p.concat(s.validateSpec({key:`${r}[${x}]`,value:a[x],validateSpec:s.validateSpec,valueSpec:f}));return p}return Cs({key:r,value:a,valueSpec:{}})},colorArray:function(s){const r=s.key,a=s.value;if(wr(a)==="array"){if(a.length<1)return[new Et(r,a,"array length at least 1 expected, length 0 found")];let f=[];for(let p=0;p<a.length;p++)f=f.concat(nl({key:`${r}[${p}]`,value:a[p]}));return f}return nl({key:r,value:a})},variableAnchorOffsetCollection:function(s){const r=s.key,a=s.value,f=wr(a),p=s.styleSpec;if(f!=="array"||a.length<1||a.length%2!=0)return[new Et(r,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let b=0;b<a.length;b+=2)x=x.concat(il({key:`${r}[${b}]`,value:a[b],valueSpec:p.layout_symbol["text-anchor"]})),x=x.concat(Wf({key:`${r}[${b+1}]`,value:a[b+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:p}));return x},sprite:lp,state:vm,fontFaces:function(s){const r=s.key,a=s.value,f=s.validateSpec,p=s.styleSpec,x=s.style;if(!up(a))return[new Et(r,a,`object expected, ${wr(a)} found`)];const b=[];for(const E in a){const P=a[E],z=wr(P);if(z==="string")b.push(...xo({key:`${r}.${E}`,value:P}));else if(z==="array"){const L={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[N,$]of P.entries())b.push(...$a({key:`${r}.${E}[${N}]`,value:$,valueSpec:L,styleSpec:p,style:x,validateSpec:f}))}else b.push(new Et(`${r}.${E}`,P,`string or array expected, ${z} found`))}return b}};function Eu(s){const r=s.value,a=s.valueSpec,f=s.styleSpec;return s.validateSpec=Eu,a.expression&&qf(Fn(r))?rl(s):a.expression&&bc(qa(r))?Ds(s):a.type&&ii[a.type]?ii[a.type](s):$a(jr({},s,{valueSpec:a.type?f[a.type]:a}))}function Is(s){const r=s.value,a=s.key,f=xo(s);return f.length||(r.indexOf("{fontstack}")===-1&&f.push(new Et(a,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&f.push(new Et(a,r,'"glyphs" url must include a "{range}" token'))),f}function na(s,r=Me){let a=[];return a=a.concat(Eu({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:Eu,objectElementValidators:{glyphs:Is,"*":()=>[]}})),s.constants&&(a=a.concat(Va({key:"constants",value:s.constants}))),Au(a)}function bo(s){return function(r){return s(Object.assign({},r,{validateSpec:Eu}))}}function Au(s){return[].concat(s).sort(((r,a)=>r.line-a.line))}function ia(s){return function(...r){return Au(s.apply(this,r))}}na.source=ia(bo(ol)),na.sprite=ia(bo(lp)),na.glyphs=ia(bo(Is)),na.light=ia(bo(Pi)),na.sky=ia(bo(Bl)),na.terrain=ia(bo(sp)),na.state=ia(bo(vm)),na.layer=ia(bo(Xf)),na.filter=ia(bo(ns)),na.paintProperty=ia(bo(Os)),na.layoutProperty=ia(bo(Yf));const ay={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class _m{constructor(r,a){this._globalState=a,this.setValue(r)}evaluate(){var r;return(r=this._literalValue)!==null&&r!==void 0?r:this._compiledValue.evaluate({})}setValue(r){if(r==null||r==="visible"||r==="none")return this._literalValue=r==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const a=Rl(r,ay,this._globalState);if(a.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(a.value.map((f=>`${f.key}: ${f.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=a.value,this._globalStateRefs=ra(a.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Ch=Me,is=na,Ci=is.light,Mu=is.sky,Dh=is.paintProperty,xm=is.layoutProperty;function Pu(s,r){let a=!1;if(r&&r.length)for(const f of r)s.fire(new _t(new Error(f.message))),a=!0;return a}class as{constructor(r,a,f){const p=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const b=new Int32Array(this.arrayBuffer);r=b[0],this.d=(a=b[1])+2*(f=b[2]);for(let P=0;P<this.d*this.d;P++){const z=b[3+P],L=b[3+P+1];p.push(z===L?null:b.subarray(z,L))}const E=b[3+p.length+1];this.keys=b.subarray(b[3+p.length],E),this.bboxes=b.subarray(E),this.insert=this._insertReadonly}else{this.d=a+2*f;for(let b=0;b<this.d*this.d;b++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=r,this.padding=f,this.scale=a/r,this.uid=0;const x=f/a*r;this.min=-x,this.max=r+x}insert(r,a,f,p,x){this._forEachCell(a,f,p,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(a),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,a,f,p,x,b){this.cells[x].push(b)}query(r,a,f,p,x){const b=this.min,E=this.max;if(r<=b&&a<=b&&E<=f&&E<=p&&!x)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(r,a,f,p,this._queryCell,P,{},x),P}}_queryCell(r,a,f,p,x,b,E,P){const z=this.cells[x];if(z!==null){const L=this.keys,N=this.bboxes;for(let $=0;$<z.length;$++){const H=z[$];if(E[H]===void 0){const J=4*H;(P?P(N[J+0],N[J+1],N[J+2],N[J+3]):r<=N[J+2]&&a<=N[J+3]&&f>=N[J+0]&&p>=N[J+1])?(E[H]=!0,b.push(L[H])):E[H]=!1}}}}_forEachCell(r,a,f,p,x,b,E,P){const z=this._convertToCellCoord(r),L=this._convertToCellCoord(a),N=this._convertToCellCoord(f),$=this._convertToCellCoord(p);for(let H=z;H<=N;H++)for(let J=L;J<=$;J++){const te=this.d*J+H;if((!P||P(this._convertFromCellCoord(H),this._convertFromCellCoord(J),this._convertFromCellCoord(H+1),this._convertFromCellCoord(J+1)))&&x.call(this,r,a,f,p,te,b,E,P))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,a=3+this.cells.length+1+1;let f=0;for(let b=0;b<this.cells.length;b++)f+=this.cells[b].length;const p=new Int32Array(a+f+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let x=a;for(let b=0;b<r.length;b++){const E=r[b];p[3+b]=x,p.set(E,x),x+=E.length}return p[3+r.length]=x,p.set(this.keys,x),x+=this.keys.length,p[3+r.length+1]=x,p.set(this.bboxes,x),x+=this.bboxes.length,p.buffer}static serialize(r,a){const f=r.toArrayBuffer();return a&&a.push(f),{buffer:f}}static deserialize(r){return new as(r.buffer)}}const wo={};function jt(s,r,a={}){if(wo[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),wo[s]={klass:r,omit:a.omit||[],shallow:a.shallow||[]}}jt("Object",Object),jt("Set",Set),jt("TransferableGridIndex",as),jt("Color",Ot),jt("Error",Error),jt("AJAXError",ae),jt("ResolvedImage",ki),jt("StylePropertyFunction",Ll),jt("StyleExpression",Zf,{omit:["_evaluator"]}),jt("ZoomDependentExpression",jl),jt("ZoomConstantExpression",Sa),jt("CompoundExpression",mo,{omit:["_evaluate"]});for(const s in _c)_c[s]._classRegistryKey||jt(`Expression_${s}`,_c[s]);function cp(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Tc(s){return s.$name||s.constructor._classRegistryKey}function Fl(s){return!(function(r){if(r===null||typeof r!="object")return!1;const a=Tc(r);return!(!a||a==="Object")})(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||cp(s)||za(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function Ta(s,r){if(Fl(s))return(cp(s)||za(s))&&r&&r.push(s),ArrayBuffer.isView(s)&&r&&r.push(s.buffer),s instanceof ImageData&&r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const x=[];for(const b of s)x.push(Ta(b,r));return x}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const a=Tc(s);if(!a)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!wo[a])throw new Error(`${a} is not registered.`);const{klass:f}=wo[a],p=f.serialize?f.serialize(s,r):{};if(f.serialize){if(r&&p===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in s){if(!s.hasOwnProperty(x)||wo[a].omit.indexOf(x)>=0)continue;const b=s[x];p[x]=wo[a].shallow.indexOf(x)>=0?b:Ta(b,r)}s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(p.$name=a),p}function Ec(s){if(Fl(s))return s;if(Array.isArray(s))return s.map(Ec);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const r=Tc(s)||"Object";if(!wo[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:a}=wo[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(s);const f=Object.create(a.prototype);for(const p of Object.keys(s)){if(p==="$name")continue;const x=s[p];f[p]=wo[r].shallow.indexOf(p)>=0?x:Ec(x)}return f}class Kf{constructor(){this.first=!0}update(r,a){const f=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=a),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=f,!0))}}function Ac(s){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(s))}function os(s){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(s))}function Oh(s){return/\s/u.test(String.fromCodePoint(s))}function Cu(s){for(const r of s)if(os(r.codePointAt(0)))return!0;return!1}function Du(s){for(const r of s)if(!Ih(r.codePointAt(0)))return!1;return!0}function hp(s){const r=s.map((a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}})).filter((a=>a));return new RegExp(r.join("|"),"u")}const sl=hp(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ih(s){return!sl.test(String.fromCodePoint(s))}function zs(s){return!(os(s)||(r=s,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(r))));var r}const Qf=hp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function zh(s){return Qf.test(String.fromCodePoint(s))}function ll(s,r){return!(!r&&zh(s)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(s)))}function ks(s){for(const r of s)if(zh(r.codePointAt(0)))return!0;return!1}const So=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(So.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,r){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const a=s.pluginURL,f=new Promise((x=>{this.loadScriptResolve=x}));r(a);const p=new Promise((x=>setTimeout((()=>x()),this.TIMEOUT)));if(yield Promise.race([f,p]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:a};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)}))}};class ln{constructor(r,a){this.isSupportedScript=Jf,this.zoom=r,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new Kf,this.transition=a.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Kf,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,a=r-Math.floor(r),f=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*a}}}function Jf(s){return(function(r,a){for(const f of r)if(!ll(f.codePointAt(0),a))return!1;return!0})(s,So.getRTLTextPluginStatus()==="loaded")}const Ul="-transition";class ul{constructor(r,a,f){this.property=r,this.value=a,this.expression=(function(p,x,b){if(qf(p))return new Ll(p,x);if(bc(p)){const E=Tu(p,x,b);if(E.result==="error")throw new Error(E.value.map((P=>`${P.key}: ${P.message}`)).join(", "));return E.value}{let E=p;return x.type==="color"&&typeof p=="string"?E=Ot.parse(p):x.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?x.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?x.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?E=Nr.parse(p):x.type==="projectionDefinition"&&typeof p=="string"&&(E=ni.parse(p)):E=Lr.parse(p):E=Mr.parse(p):E=on.parse(p),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}})(a===void 0?r.specification.default:a,r.specification,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(r,a,f){return this.property.possiblyEvaluate(this,r,a,f)}}class ed{constructor(r,a){this.property=r,this.value=new ul(r,void 0,a)}transitioned(r,a){return new Vl(this.property,this.value,a,yr({},r.transition,this.transition),r.now)}untransitioned(){return new Vl(this.property,this.value,null,{},0)}}class td{constructor(r,a){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._globalState=a}getValue(r){return Tt(this._values[r].value.value)}setValue(r,a){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new ed(this._values[r].property,this._globalState)),this._values[r].value=new ul(this._values[r].property,a===null?void 0:Tt(a),this._globalState)}getTransition(r){return Tt(this._values[r].transition)}setTransition(r,a){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new ed(this._values[r].property,this._globalState)),this._values[r].transition=Tt(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const f=this.getValue(a);f!==void 0&&(r[a]=f);const p=this.getTransition(a);p!==void 0&&(r[`${a}${Ul}`]=p)}return r}transitioned(r,a){const f=new kh(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].transitioned(r,a._values[p]);return f}untransitioned(){const r=new kh(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class Vl{constructor(r,a,f,p,x){this.property=r,this.value=a,this.begin=x+p.delay||0,this.end=this.begin+p.duration||0,r.specification.transition&&(p.delay||p.duration)&&(this.prior=f)}possiblyEvaluate(r,a,f){const p=r.now||0,x=this.value.possiblyEvaluate(r,a,f),b=this.prior;if(b){if(p>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(p<this.begin)return b.possiblyEvaluate(r,a,f);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(r,a,f),x,Be(E))}}return x}}class kh{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,f){const p=new Ou(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].possiblyEvaluate(r,a,f);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class bm{constructor(r,a){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._globalState=a}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Tt(this._values[r].value)}setValue(r,a){this._values[r]=new ul(this._values[r].property,a===null?void 0:Tt(a),this._globalState)}serialize(){const r={};for(const a of Object.keys(this._values)){const f=this.getValue(a);f!==void 0&&(r[a]=f)}return r}possiblyEvaluate(r,a,f){const p=new Ou(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].possiblyEvaluate(r,a,f);return p}}class To{constructor(r,a,f){this.property=r,this.value=a,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,a,f,p){return this.property.evaluate(this.value,this.parameters,r,a,f,p)}}class Ou{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Bt{constructor(r){this.specification=r}possiblyEvaluate(r,a){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(a)}interpolate(r,a,f){const p=Wi[this.specification.type];return p?p(r,a,f):r}}class Kt{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,f,p){return new To(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(a,null,{},f,p)}:r.expression,a)}interpolate(r,a,f){if(r.value.kind!=="constant"||a.value.kind!=="constant")return r;if(r.value.value===void 0||a.value.value===void 0)return new To(this,{kind:"constant",value:void 0},r.parameters);const p=Wi[this.specification.type];if(p){const x=p(r.value.value,a.value.value,f);return new To(this,{kind:"constant",value:x},r.parameters)}return r}evaluate(r,a,f,p,x,b){return r.kind==="constant"?r.value:r.evaluate(a,f,p,x,b)}}class Ea extends Kt{possiblyEvaluate(r,a,f,p){if(r.value===void 0)return new To(this,{kind:"constant",value:void 0},a);if(r.expression.kind==="constant"){const x=r.expression.evaluate(a,null,{},f,p),b=r.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,E=this._calculate(b,b,b,a);return new To(this,{kind:"constant",value:E},a)}if(r.expression.kind==="camera"){const x=this._calculate(r.expression.evaluate({zoom:a.zoom-1}),r.expression.evaluate({zoom:a.zoom}),r.expression.evaluate({zoom:a.zoom+1}),a);return new To(this,{kind:"constant",value:x},a)}return new To(this,r.expression,a)}evaluate(r,a,f,p,x,b){if(r.kind==="source"){const E=r.evaluate(a,f,p,x,b);return this._calculate(E,E,E,a)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(a.zoom)-1},f,p),r.evaluate({zoom:Math.floor(a.zoom)},f,p),r.evaluate({zoom:Math.floor(a.zoom)+1},f,p),a):r.value}_calculate(r,a,f,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:f,to:a}}interpolate(r){return r}}class rd{constructor(r){this.specification=r}possiblyEvaluate(r,a,f,p){if(r.value!==void 0){if(r.expression.kind==="constant"){const x=r.expression.evaluate(a,null,{},f,p);return this._calculate(x,x,x,a)}return this._calculate(r.expression.evaluate(new ln(Math.floor(a.zoom-1),a)),r.expression.evaluate(new ln(Math.floor(a.zoom),a)),r.expression.evaluate(new ln(Math.floor(a.zoom+1),a)),a)}}_calculate(r,a,f,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:f,to:a}}interpolate(r){return r}}class Iu{constructor(r){this.specification=r}possiblyEvaluate(r,a,f,p){return!!r.expression.evaluate(a,null,{},f,p)}interpolate(){return!1}}class ai{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in r){const f=r[a];f.specification.overridable&&this.overridableProperties.push(a);const p=this.defaultPropertyValues[a]=new ul(f,void 0,void 0),x=this.defaultTransitionablePropertyValues[a]=new ed(f,void 0);this.defaultTransitioningPropertyValues[a]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate({})}}}jt("DataDrivenProperty",Kt),jt("DataConstantProperty",Bt),jt("CrossFadedDataDrivenProperty",Ea),jt("CrossFadedProperty",rd),jt("ColorRampProperty",Iu);class Hn extends Xe{constructor(r,a,f){if(super(),this.id=r.id,this.type=r.type,this._globalState=f,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(p,x){return new _m(p,x)})(this.visibility,f),r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter,this._featureFilter=Ua(r.filter,f)),a.layout&&(this._unevaluatedLayout=new bm(a.layout,f)),a.paint)){this._transitionablePaint=new td(a.paint,f);for(const p in r.paint)this.setPaintProperty(p,r.paint[p],{validate:!1});for(const p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ou(a.paint)}}setFilter(r){this.filter=r,this._featureFilter=Ua(r,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}getLayoutAffectingGlobalStateRefs(){const r=new Set;for(const a of this._visibilityExpression.getGlobalStateRefs())r.add(a);if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[a];for(const p of f.getGlobalStateRefs())r.add(p)}for(const a of this._featureFilter.getGlobalStateRefs())r.add(a);return r}getPaintAffectingGlobalStateRefs(){var r;const a=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const p=this._transitionablePaint._values[f].value;for(const x of p.getGlobalStateRefs()){const b=(r=a.get(x))!==null&&r!==void 0?r:[];b.push({name:f,value:p.value}),a.set(x,b)}}return a}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(r,a,f={}){if(a==null||!this._validate(xm,`layers.${this.id}.layout.${r}`,r,a,f))return r==="visibility"?(this.visibility=a,this._visibilityExpression.setValue(a),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(r,a)}getPaintProperty(r){return r.endsWith(Ul)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,f={}){if(a!=null&&this._validate(Dh,`layers.${this.id}.paint.${r}`,r,a,f))return!1;if(r.endsWith(Ul))return this._transitionablePaint.setTransition(r.slice(0,-11),a||void 0),!1;{const p=this._transitionablePaint._values[r],x=p.property.specification["property-type"]==="cross-faded-data-driven",b=p.value.isDataDriven(),E=p.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const P=this._transitionablePaint._values[r].value;return P.isDataDriven()||b||x||this._handleOverridablePaintPropertyUpdate(r,E,P)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,a,f){return!1}isHidden(r=this.minzoom,a=!1){return!!(this.minzoom&&r<(a?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&r>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(r,a){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),pr(r,((a,f)=>!(a===void 0||f==="layout"&&!Object.keys(a).length||f==="paint"&&!Object.keys(a).length)))}_validate(r,a,f,p,x={}){return(!x||x.validate!==!1)&&Pu(this,r.call(is,{key:a,layerType:this.type,objectKey:f,value:p,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof To&&Lo(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}let Wn;var Rh={get paint(){return Wn=Wn||new ai({"raster-opacity":new Bt(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new Bt(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Bt(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Bt(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new Bt(Me.paint_raster["raster-saturation"]),"raster-contrast":new Bt(Me.paint_raster["raster-contrast"]),"raster-resampling":new Bt(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new Bt(Me.paint_raster["raster-fade-duration"])})}};class Rs extends Hn{constructor(r,a){super(r,Rh,a)}}const Pr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class en{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Er{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Rn(s,r=1){let a=0,f=0;return{members:s.map((p=>{const x=Pr[p.type].BYTES_PER_ELEMENT,b=a=zu(a,Math.max(r,x)),E=p.components||1;return f=Math.max(f,x),a+=x*E,{name:p.name,type:p.type,components:E,offset:b}})),size:zu(a,Math.max(f,r)),alignment:r}}function zu(s,r){return Math.ceil(s/r)*r}class aa extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const f=this.length;return this.resize(f+1),this.emplace(f,r,a)}emplace(r,a,f){const p=2*r;return this.int16[p+0]=a,this.int16[p+1]=f,r}}aa.prototype.bytesPerElement=4,jt("StructArrayLayout2i4",aa);class ku extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,f)}emplace(r,a,f,p){const x=3*r;return this.int16[x+0]=a,this.int16[x+1]=f,this.int16[x+2]=p,r}}ku.prototype.bytesPerElement=6,jt("StructArrayLayout3i6",ku);class Ru extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,f,p)}emplace(r,a,f,p,x){const b=4*r;return this.int16[b+0]=a,this.int16[b+1]=f,this.int16[b+2]=p,this.int16[b+3]=x,r}}Ru.prototype.bytesPerElement=8,jt("StructArrayLayout4i8",Ru);class ql extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,f,p,x,b)}emplace(r,a,f,p,x,b,E){const P=6*r;return this.int16[P+0]=a,this.int16[P+1]=f,this.int16[P+2]=p,this.int16[P+3]=x,this.int16[P+4]=b,this.int16[P+5]=E,r}}ql.prototype.bytesPerElement=12,jt("StructArrayLayout2i4i12",ql);class nd extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,f,p,x,b)}emplace(r,a,f,p,x,b,E){const P=4*r,z=8*r;return this.int16[P+0]=a,this.int16[P+1]=f,this.uint8[z+4]=p,this.uint8[z+5]=x,this.uint8[z+6]=b,this.uint8[z+7]=E,r}}nd.prototype.bytesPerElement=8,jt("StructArrayLayout2i4ub8",nd);class On extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const f=this.length;return this.resize(f+1),this.emplace(f,r,a)}emplace(r,a,f){const p=2*r;return this.float32[p+0]=a,this.float32[p+1]=f,r}}On.prototype.bytesPerElement=8,jt("StructArrayLayout2f8",On);class jh extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P,z,L){const N=this.length;return this.resize(N+1),this.emplace(N,r,a,f,p,x,b,E,P,z,L)}emplace(r,a,f,p,x,b,E,P,z,L,N){const $=10*r;return this.uint16[$+0]=a,this.uint16[$+1]=f,this.uint16[$+2]=p,this.uint16[$+3]=x,this.uint16[$+4]=b,this.uint16[$+5]=E,this.uint16[$+6]=P,this.uint16[$+7]=z,this.uint16[$+8]=L,this.uint16[$+9]=N,r}}jh.prototype.bytesPerElement=20,jt("StructArrayLayout10ui20",jh);class ss extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P){const z=this.length;return this.resize(z+1),this.emplace(z,r,a,f,p,x,b,E,P)}emplace(r,a,f,p,x,b,E,P,z){const L=8*r;return this.uint16[L+0]=a,this.uint16[L+1]=f,this.uint16[L+2]=p,this.uint16[L+3]=x,this.uint16[L+4]=b,this.uint16[L+5]=E,this.uint16[L+6]=P,this.uint16[L+7]=z,r}}ss.prototype.bytesPerElement=16,jt("StructArrayLayout8ui16",ss);class Lh extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P,z,L,N,$){const H=this.length;return this.resize(H+1),this.emplace(H,r,a,f,p,x,b,E,P,z,L,N,$)}emplace(r,a,f,p,x,b,E,P,z,L,N,$,H){const J=12*r;return this.int16[J+0]=a,this.int16[J+1]=f,this.int16[J+2]=p,this.int16[J+3]=x,this.uint16[J+4]=b,this.uint16[J+5]=E,this.uint16[J+6]=P,this.uint16[J+7]=z,this.int16[J+8]=L,this.int16[J+9]=N,this.int16[J+10]=$,this.int16[J+11]=H,r}}Lh.prototype.bytesPerElement=24,jt("StructArrayLayout4i4ui4i24",Lh);class Mc extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,f){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,f)}emplace(r,a,f,p){const x=3*r;return this.float32[x+0]=a,this.float32[x+1]=f,this.float32[x+2]=p,r}}Mc.prototype.bytesPerElement=12,jt("StructArrayLayout3f12",Mc);class id extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}id.prototype.bytesPerElement=4,jt("StructArrayLayout1ul4",id);class ju extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P,z){const L=this.length;return this.resize(L+1),this.emplace(L,r,a,f,p,x,b,E,P,z)}emplace(r,a,f,p,x,b,E,P,z,L){const N=10*r,$=5*r;return this.int16[N+0]=a,this.int16[N+1]=f,this.int16[N+2]=p,this.int16[N+3]=x,this.int16[N+4]=b,this.int16[N+5]=E,this.uint32[$+3]=P,this.uint16[N+8]=z,this.uint16[N+9]=L,r}}ju.prototype.bytesPerElement=20,jt("StructArrayLayout6i1ul2ui20",ju);class Nh extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,f,p,x,b)}emplace(r,a,f,p,x,b,E){const P=6*r;return this.int16[P+0]=a,this.int16[P+1]=f,this.int16[P+2]=p,this.int16[P+3]=x,this.int16[P+4]=b,this.int16[P+5]=E,r}}Nh.prototype.bytesPerElement=12,jt("StructArrayLayout2i2i2i12",Nh);class $l extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,a,f,p,x)}emplace(r,a,f,p,x,b){const E=4*r,P=8*r;return this.float32[E+0]=a,this.float32[E+1]=f,this.float32[E+2]=p,this.int16[P+6]=x,this.int16[P+7]=b,r}}$l.prototype.bytesPerElement=16,jt("StructArrayLayout2f1f2i16",$l);class hi extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,f,p,x,b)}emplace(r,a,f,p,x,b,E){const P=16*r,z=4*r,L=8*r;return this.uint8[P+0]=a,this.uint8[P+1]=f,this.float32[z+1]=p,this.float32[z+2]=x,this.int16[L+6]=b,this.int16[L+7]=E,r}}hi.prototype.bytesPerElement=16,jt("StructArrayLayout2ub2f2i16",hi);class Un extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,f)}emplace(r,a,f,p){const x=3*r;return this.uint16[x+0]=a,this.uint16[x+1]=f,this.uint16[x+2]=p,r}}Un.prototype.bytesPerElement=6,jt("StructArrayLayout3ui6",Un);class Lu extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le){const ye=this.length;return this.resize(ye+1),this.emplace(ye,r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le)}emplace(r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le,ye){const se=24*r,fe=12*r,Se=48*r;return this.int16[se+0]=a,this.int16[se+1]=f,this.uint16[se+2]=p,this.uint16[se+3]=x,this.uint32[fe+2]=b,this.uint32[fe+3]=E,this.uint32[fe+4]=P,this.uint16[se+10]=z,this.uint16[se+11]=L,this.uint16[se+12]=N,this.float32[fe+7]=$,this.float32[fe+8]=H,this.uint8[Se+36]=J,this.uint8[Se+37]=te,this.uint8[Se+38]=ie,this.uint32[fe+10]=le,this.int16[se+22]=ye,r}}Lu.prototype.bytesPerElement=48,jt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Lu);class ls extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le,ye,se,fe,Se,Ie,We,ht,dt,St,It,Mt){const mt=this.length;return this.resize(mt+1),this.emplace(mt,r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le,ye,se,fe,Se,Ie,We,ht,dt,St,It,Mt)}emplace(r,a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le,ye,se,fe,Se,Ie,We,ht,dt,St,It,Mt,mt){const ot=32*r,$t=16*r;return this.int16[ot+0]=a,this.int16[ot+1]=f,this.int16[ot+2]=p,this.int16[ot+3]=x,this.int16[ot+4]=b,this.int16[ot+5]=E,this.int16[ot+6]=P,this.int16[ot+7]=z,this.uint16[ot+8]=L,this.uint16[ot+9]=N,this.uint16[ot+10]=$,this.uint16[ot+11]=H,this.uint16[ot+12]=J,this.uint16[ot+13]=te,this.uint16[ot+14]=ie,this.uint16[ot+15]=le,this.uint16[ot+16]=ye,this.uint16[ot+17]=se,this.uint16[ot+18]=fe,this.uint16[ot+19]=Se,this.uint16[ot+20]=Ie,this.uint16[ot+21]=We,this.uint16[ot+22]=ht,this.uint32[$t+12]=dt,this.float32[$t+13]=St,this.float32[$t+14]=It,this.uint16[ot+30]=Mt,this.uint16[ot+31]=mt,r}}ls.prototype.bytesPerElement=64,jt("StructArrayLayout8i15ui1ul2f2ui64",ls);class Nu extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}Nu.prototype.bytesPerElement=4,jt("StructArrayLayout1f4",Nu);class Bh extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,f){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,f)}emplace(r,a,f,p){const x=3*r;return this.uint16[6*r+0]=a,this.float32[x+1]=f,this.float32[x+2]=p,r}}Bh.prototype.bytesPerElement=12,jt("StructArrayLayout1ui2f12",Bh);class No extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,f){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,f)}emplace(r,a,f,p){const x=4*r;return this.uint32[2*r+0]=a,this.uint16[x+2]=f,this.uint16[x+3]=p,r}}No.prototype.bytesPerElement=8,jt("StructArrayLayout1ul2ui8",No);class Pc extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const f=this.length;return this.resize(f+1),this.emplace(f,r,a)}emplace(r,a,f){const p=2*r;return this.uint16[p+0]=a,this.uint16[p+1]=f,r}}Pc.prototype.bytesPerElement=4,jt("StructArrayLayout2ui4",Pc);class w extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}w.prototype.bytesPerElement=2,jt("StructArrayLayout1ui2",w);class n extends Er{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,f,p){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,f,p)}emplace(r,a,f,p,x){const b=4*r;return this.float32[b+0]=a,this.float32[b+1]=f,this.float32[b+2]=p,this.float32[b+3]=x,r}}n.prototype.bytesPerElement=16,jt("StructArrayLayout4f16",n);class u extends en{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new M(this.anchorPointX,this.anchorPointY)}}u.prototype.size=20;class d extends ju{get(r){return new u(this,r)}}jt("CollisionBoxArray",d);class v extends en{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}v.prototype.size=48;class T extends Lu{get(r){return new v(this,r)}}jt("PlacedSymbolArray",T);class A extends en{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}A.prototype.size=64;class O extends ls{get(r){return new A(this,r)}}jt("SymbolInstanceArray",O);class R extends Nu{getoffsetX(r){return this.float32[1*r+0]}}jt("GlyphOffsetArray",R);class B extends ku{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}jt("SymbolLineVertexArray",B);class V extends en{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}V.prototype.size=12;class X extends Bh{get(r){return new V(this,r)}}jt("TextAnchorOffsetArray",X);class Y extends en{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Y.prototype.size=8;class re extends No{get(r){return new Y(this,r)}}jt("FeatureIndexArray",re);class oe extends aa{}class he extends aa{}class pe extends aa{}class de extends ql{}class xe extends nd{}class Ee extends On{}class ve extends jh{}class Pe extends ss{}class De extends Lh{}class we extends Mc{}class Re extends id{}class Qe extends Nh{}class Ye extends hi{}class He extends Un{}class Je extends Pc{}const Ct=Rn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dt}=Ct;class ut{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,a,f,p){const x=this.segments[this.segments.length-1];return r>ut.MAX_VERTEX_ARRAY_LENGTH&&fr(`Max vertices per segment is ${ut.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ut.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+r>ut.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==p?this.createNewSegment(a,f,p):x}createNewSegment(r,a,f){const p={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(p.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(r,a,f){return this.prepareSegment(0,r,a,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,f,p){return new ut([{vertexOffset:r,primitiveOffset:a,vertexLength:f,primitiveLength:p,vaos:{},sortKey:0}])}}function Zt(s,r){return 256*(s=Lt(Math.floor(s),0,255))+Lt(Math.floor(r),0,255)}ut.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt("SegmentVector",ut);const vr=Rn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Xr=Rn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var vn,dn,Sn,tn={exports:{}},fi={exports:{}},jn={exports:{}},Di=(function(){if(Sn)return tn.exports;Sn=1;var s=(vn||(vn=1,fi.exports=function(a,f){var p,x,b,E,P,z,L,N;for(x=a.length-(p=3&a.length),b=f,P=3432918353,z=461845907,N=0;N<x;)L=255&a.charCodeAt(N)|(255&a.charCodeAt(++N))<<8|(255&a.charCodeAt(++N))<<16|(255&a.charCodeAt(++N))<<24,++N,b=27492+(65535&(E=5*(65535&(b=(b^=L=(65535&(L=(L=(65535&L)*P+(((L>>>16)*P&65535)<<16)&4294967295)<<15|L>>>17))*z+(((L>>>16)*z&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(L=0,p){case 3:L^=(255&a.charCodeAt(N+2))<<16;case 2:L^=(255&a.charCodeAt(N+1))<<8;case 1:b^=L=(65535&(L=(L=(65535&(L^=255&a.charCodeAt(N)))*P+(((L>>>16)*P&65535)<<16)&4294967295)<<15|L>>>17))*z+(((L>>>16)*z&65535)<<16)&4294967295}return b^=a.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),fi.exports),r=(dn||(dn=1,jn.exports=function(a,f){for(var p,x=a.length,b=f^x,E=0;x>=4;)p=1540483477*(65535&(p=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),x-=4,++E;switch(x){case 3:b^=(255&a.charCodeAt(E+2))<<16;case 2:b^=(255&a.charCodeAt(E+1))<<8;case 1:b=1540483477*(65535&(b^=255&a.charCodeAt(E)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),jn.exports);return tn.exports=s,tn.exports.murmur3=s,tn.exports.murmur2=r,tn.exports})(),Vn=C(Di);class qn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,f,p){this.ids.push(Yi(r)),this.positions.push(a,f,p)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Yi(r);let f=0,p=this.ids.length-1;for(;f<p;){const b=f+p>>1;this.ids[b]>=a?p=b:f=b+1}const x=[];for(;this.ids[f]===a;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(r,a){const f=new Float64Array(r.ids),p=new Uint32Array(r.positions);return js(f,p,0,f.length-1),a&&a.push(f.buffer,p.buffer),{ids:f,positions:p}}static deserialize(r){const a=new qn;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function Yi(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Vn(String(s))}function js(s,r,a,f){for(;a<f;){const p=s[a+f>>1];let x=a-1,b=f+1;for(;;){do x++;while(s[x]<p);do b--;while(s[b]>p);if(x>=b)break;us(s,x,b),us(r,3*x,3*b),us(r,3*x+1,3*b+1),us(r,3*x+2,3*b+2)}b-a<f-b?(js(s,r,a,b),a=b+1):(js(s,r,b+1,f),f=b)}}function us(s,r,a){const f=s[r];s[r]=s[a],s[a]=f}jt("FeaturePositionMap",qn);class Aa{constructor(r,a){this.gl=r.gl,this.location=a}}class cl extends Aa{constructor(r,a){super(r,a),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Cc extends Aa{constructor(r,a){super(r,a),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class hl extends Aa{constructor(r,a){super(r,a),this.current=Ot.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const Gl=new Float32Array(16);function Xi(s){return[Zt(255*s.r,255*s.g),Zt(255*s.b,255*s.a)]}class Eo{constructor(r,a,f){this.value=r,this.uniformNames=a.map((p=>`u_${p}`)),this.type=f}setUniform(r,a,f){r.set(f.constantOr(this.value))}getBinding(r,a,f){return this.type==="color"?new hl(r,a):new cl(r,a)}}class Ga{constructor(r,a){this.uniformNames=a.map((f=>`u_${f}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=r.tlbr}setConstantDashPositions(r,a){this.dashTo=[0,r.y,r.height,r.width],this.dashFrom=[0,a.y,a.height,a.width]}setUniform(r,a,f,p){let x=null;p==="u_pattern_to"?x=this.patternTo:p==="u_pattern_from"?x=this.patternFrom:p==="u_dasharray_to"?x=this.dashTo:p==="u_dasharray_from"?x=this.dashFrom:p==="u_pixel_ratio_to"?x=this.pixelRatioTo:p==="u_pixel_ratio_from"&&(x=this.pixelRatioFrom),x!==null&&r.set(x)}getBinding(r,a,f){return f.startsWith("u_pattern")||f.startsWith("u_dasharray_")?new Cc(r,a):new cl(r,a)}}class Ki{constructor(r,a,f,p){this.expression=r,this.type=f,this.maxValue=0,this.paintVertexAttributes=a.map((x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0}))),this.paintVertexArray=new p}populatePaintArray(r,a,f){const p=this.paintVertexArray.length,x=this.expression.evaluate(new ln(0,f),a,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(r),this._setPaintValue(p,r,x)}updatePaintArray(r,a,f,p,x){const b=this.expression.evaluate(new ln(0,x),f,p);this._setPaintValue(r,a,b)}_setPaintValue(r,a,f){if(this.type==="color"){const p=Xi(f);for(let x=r;x<a;x++)this.paintVertexArray.emplace(x,p[0],p[1])}else{for(let p=r;p<a;p++)this.paintVertexArray.emplace(p,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class un{constructor(r,a,f,p,x,b){this.expression=r,this.uniformNames=a.map((E=>`u_${E}_t`)),this.type=f,this.useIntegerZoom=p,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=a.map((E=>({name:`a_${E}`,type:"Float32",components:f==="color"?4:2,offset:0}))),this.paintVertexArray=new b}populatePaintArray(r,a,f){const p=this.expression.evaluate(new ln(this.zoom,f),a,{},f.canonical,[],f.formattedSection),x=this.expression.evaluate(new ln(this.zoom+1,f),a,{},f.canonical,[],f.formattedSection),b=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(b,r,p,x)}updatePaintArray(r,a,f,p,x){const b=this.expression.evaluate(new ln(this.zoom,x),f,p),E=this.expression.evaluate(new ln(this.zoom+1,x),f,p);this._setPaintValue(r,a,b,E)}_setPaintValue(r,a,f,p){if(this.type==="color"){const x=Xi(f),b=Xi(p);for(let E=r;E<a;E++)this.paintVertexArray.emplace(E,x[0],x[1],b[0],b[1])}else{for(let x=r;x<a;x++)this.paintVertexArray.emplace(x,f,p);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a){const f=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,p=Lt(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);r.set(p)}getBinding(r,a,f){return new cl(r,a)}}class Tn{constructor(r,a,f,p,x,b){this.expression=r,this.type=a,this.useIntegerZoom=f,this.zoom=p,this.layerId=b,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(r,a,f){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(p,r,this.getPositionIds(a),f)}updatePaintArray(r,a,f,p,x){this._setPaintValues(r,a,this.getPositionIds(f),x)}_setPaintValues(r,a,f,p){const x=this.getPositions(p);if(!x||!f)return;const b=x[f.min],E=x[f.mid],P=x[f.max];if(b&&E&&P)for(let z=r;z<a;z++)this.emplace(this.zoomInPaintVertexArray,z,E,b),this.emplace(this.zoomOutPaintVertexArray,z,E,P)}upload(r){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const a=this.getVertexAttributes();this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,a,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,a,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Za extends Tn{getPositions(r){return r.imagePositions}getPositionIds(r){return r.patterns&&r.patterns[this.layerId]}getVertexAttributes(){return vr.members}emplace(r,a,f,p){r.emplace(a,f.tlbr[0],f.tlbr[1],f.tlbr[2],f.tlbr[3],p.tlbr[0],p.tlbr[1],p.tlbr[2],p.tlbr[3],f.pixelRatio,p.pixelRatio)}}class di extends Tn{getPositions(r){return r.dashPositions}getPositionIds(r){return r.dashes&&r.dashes[this.layerId]}getVertexAttributes(){return Xr.members}emplace(r,a,f,p){r.emplace(a,0,f.y,f.height,f.width,0,p.y,p.height,p.width)}}class ad{constructor(r,a,f){this.binders={},this._buffers=[];const p=[];for(const x in r.paint._values){if(!f(x))continue;const b=r.paint.get(x);if(!(b instanceof To&&Lo(b.property.specification)))continue;const E=wm(x,r.type),P=b.value,z=b.property.specification.type,L=b.property.useIntegerZoom,N=b.property.specification["property-type"],$=N==="cross-faded"||N==="cross-faded-data-driven";if(P.kind==="constant")this.binders[x]=$?new Ga(P.value,E):new Eo(P.value,E,z),p.push(`/u_${x}`);else if(P.kind==="source"||$){const H=Hl(x,z,"source");this.binders[x]=$?x==="line-dasharray"?new di(P,z,L,a,H,r.id):new Za(P,z,L,a,H,r.id):new Ki(P,E,z,H),p.push(`/a_${x}`)}else{const H=Hl(x,z,"composite");this.binders[x]=new un(P,E,z,L,a,H),p.push(`/z_${x}`)}}this.cacheKey=p.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof Ki||a instanceof un?a.maxValue:0}populatePaintArrays(r,a,f){for(const p in this.binders){const x=this.binders[p];(x instanceof Ki||x instanceof un||x instanceof Tn)&&x.populatePaintArray(r,a,f)}}setConstantPatternPositions(r,a){for(const f in this.binders){const p=this.binders[f];p instanceof Ga&&p.setConstantPatternPositions(r,a)}}setConstantDashPositions(r,a){for(const f in this.binders){const p=this.binders[f];p instanceof Ga&&p.setConstantDashPositions(r,a)}}updatePaintArrays(r,a,f,p,x){let b=!1;for(const E in r){const P=a.getPositions(E);for(const z of P){const L=f.feature(z.index);for(const N in this.binders){const $=this.binders[N];if(($ instanceof Ki||$ instanceof un||$ instanceof Tn)&&$.expression.isStateDependent===!0){const H=p.paint.get(N);$.expression=H.value,$.updatePaintArray(z.start,z.end,L,r[E],x),b=!0}}}}return b}defines(){const r=[];for(const a in this.binders){const f=this.binders[a];(f instanceof Eo||f instanceof Ga)&&r.push(...f.uniformNames.map((p=>`#define HAS_UNIFORM_${p}`)))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const f=this.binders[a];if(f instanceof Ki||f instanceof un)for(let p=0;p<f.paintVertexAttributes.length;p++)r.push(f.paintVertexAttributes[p].name);else if(f instanceof Tn){const p=f.getVertexAttributes();for(const x of p)r.push(x.name)}}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const f=this.binders[a];if(f instanceof Eo||f instanceof Ga||f instanceof un)for(const p of f.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,a){const f=[];for(const p in this.binders){const x=this.binders[p];if(x instanceof Eo||x instanceof Ga||x instanceof un){for(const b of x.uniformNames)if(a[b]){const E=x.getBinding(r,a[b],b);f.push({name:b,property:p,binding:E})}}}return f}setUniforms(r,a,f,p){for(const{name:x,property:b,binding:E}of a)this.binders[b].setUniform(E,p,f.get(b),x)}updatePaintBuffers(r){this._buffers=[];for(const a in this.binders){const f=this.binders[a];if(r&&f instanceof Tn){const p=r.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(f instanceof Ki||f instanceof un)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(r){for(const a in this.binders){const f=this.binders[a];(f instanceof Ki||f instanceof un||f instanceof Tn)&&f.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof Ki||a instanceof un||a instanceof Tn)&&a.destroy()}}}class Zl{constructor(r,a,f=()=>!0){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new ad(p,a,f);this.needsUpload=!1,this._featureMap=new qn,this._bufferOffset=0}populatePaintArrays(r,a,f,p){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(r,a,p);a.id!==void 0&&this._featureMap.add(a.id,f,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,f,p){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,a,x,p)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function wm(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function Hl(s,r,a){const f={color:{source:On,composite:n},number:{source:Nu,composite:On}},p=(function(x){return{"line-pattern":{source:ve,composite:ve},"fill-pattern":{source:ve,composite:ve},"fill-extrusion-pattern":{source:ve,composite:ve},"line-dasharray":{source:Pe,composite:Pe}}[x]})(s);return p&&p[a]||f[r][a]}jt("ConstantBinder",Eo),jt("CrossFadedConstantBinder",Ga),jt("SourceExpressionBinder",Ki),jt("CrossFadedPatternBinder",Za),jt("CrossFadedDasharrayBinder",di),jt("CompositeExpressionBinder",un),jt("ProgramConfiguration",ad,{omit:["_buffers"]}),jt("ProgramConfigurationSet",Zl);const od=Math.pow(2,14)-1,fp=-od-1;function Ha(s){const r=bt/s.extent,a=s.loadGeometry();for(let f=0;f<a.length;f++){const p=a[f];for(let x=0;x<p.length;x++){const b=p[x],E=Math.round(b.x*r),P=Math.round(b.y*r);b.x=Lt(E,fp,od),b.y=Lt(P,fp,od),(E<b.x||E>b.x+1||P<b.y||P>b.y+1)&&fr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function cs(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?Ha(s):[]}}const sd=-32768;function ld(s,r,a,f,p){s.emplaceBack(sd+8*r+f,sd+8*a+p)}class Dc{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new he,this.indexArray=new He,this.segments=new ut,this.programConfigurations=new Zl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,f){const p=this.layers[0],x=[];let b=null,E=!1,P=p.type==="heatmap";if(p.type==="circle"){const L=p;b=L.layout.get("circle-sort-key"),E=!b.isConstant(),P=P||L.paint.get("circle-pitch-alignment")==="map"}const z=P?a.subdivisionGranularity.circle:1;for(const{feature:L,id:N,index:$,sourceLayerIndex:H}of r){const J=this.layers[0]._featureFilter.needGeometry,te=cs(L,J);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),te,f))continue;const ie=E?b.evaluate(te,{},f):void 0,le={id:N,properties:L.properties,type:L.type,sourceLayerIndex:H,index:$,geometry:J?te.geometry:Ha(L),patterns:{},sortKey:ie};x.push(le)}E&&x.sort(((L,N)=>L.sortKey-N.sortKey));for(const L of x){const{geometry:N,index:$,sourceLayerIndex:H}=L,J=r[$].feature;this.addFeature(L,N,$,f,z),a.featureIndex.insert(J,N,$,H,this.index)}}update(r,a,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Dt),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,f,p,x=1){let b;switch(x){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const E=b.length;for(const P of a)for(const z of P){const L=z.x,N=z.y;if(L<0||L>=bt||N<0||N>=bt)continue;const $=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,r.sortKey),H=$.vertexLength;for(let J=0;J<E;J++)for(let te=0;te<E;te++)ld(this.layoutVertexArray,L,N,b[te],b[J]);for(let J=0;J<E-1;J++)for(let te=0;te<E-1;te++){const ie=H+J*E+te,le=H+(J+1)*E+te;this.indexArray.emplaceBack(ie,le+1,ie+1),this.indexArray.emplaceBack(ie,le,le+1)}$.vertexLength+=E*E,$.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,{imagePositions:{},canonical:p})}}function ud(s,r){for(let a=0;a<s.length;a++)if(Wl(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(Wl(s,r[a]))return!0;return!!Qi(s,r)}function Oc(s,r,a){return!!Wl(s,r)||!!Tm(r,s,a)}function Sm(s,r){if(s.length===1)return sy(r,s[0]);for(let a=0;a<r.length;a++){const f=r[a];for(let p=0;p<f.length;p++)if(Wl(s,f[p]))return!0}for(let a=0;a<s.length;a++)if(sy(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(Qi(s,r[a]))return!0;return!1}function Ni(s,r,a){if(s.length>1){if(Qi(s,r))return!0;for(let f=0;f<r.length;f++)if(Tm(r[f],s,a))return!0}for(let f=0;f<s.length;f++)if(Tm(s[f],r,a))return!0;return!1}function Qi(s,r){if(s.length===0||r.length===0)return!1;for(let a=0;a<s.length-1;a++){const f=s[a],p=s[a+1];for(let x=0;x<r.length-1;x++)if(m_(f,p,r[x],r[x+1]))return!0}return!1}function m_(s,r,a,f){return Sr(s,a,f)!==Sr(r,a,f)&&Sr(s,r,a)!==Sr(s,r,f)}function Tm(s,r,a){const f=a*a;if(r.length===1)return s.distSqr(r[0])<f;for(let p=1;p<r.length;p++)if(oy(s,r[p-1],r[p])<f)return!0;return!1}function oy(s,r,a){const f=r.distSqr(a);if(f===0)return s.distSqr(r);const p=((s.x-r.x)*(a.x-r.x)+(s.y-r.y)*(a.y-r.y))/f;return s.distSqr(p<0?r:p>1?a:a.sub(r)._mult(p)._add(r))}function sy(s,r){let a,f,p,x=!1;for(let b=0;b<s.length;b++){a=s[b];for(let E=0,P=a.length-1;E<a.length;P=E++)f=a[E],p=a[P],f.y>r.y!=p.y>r.y&&r.x<(p.x-f.x)*(r.y-f.y)/(p.y-f.y)+f.x&&(x=!x)}return x}function Wl(s,r){let a=!1;for(let f=0,p=s.length-1;f<s.length;p=f++){const x=s[f],b=s[p];x.y>r.y!=b.y>r.y&&r.x<(b.x-x.x)*(r.y-x.y)/(b.y-x.y)+x.x&&(a=!a)}return a}function g_(s,r,a){const f=a[0],p=a[2];if(s.x<f.x&&r.x<f.x||s.x>p.x&&r.x>p.x||s.y<f.y&&r.y<f.y||s.y>p.y&&r.y>p.y)return!1;const x=Sr(s,r,a[0]);return x!==Sr(s,r,a[1])||x!==Sr(s,r,a[2])||x!==Sr(s,r,a[3])}function Bu(s,r,a){const f=r.paint.get(s).value;return f.kind==="constant"?f.value:a.programConfigurations.get(r.id).getMaxValue(s)}function dp(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Em(s,r,a,f,p){if(!r[0]&&!r[1])return s;const x=M.convert(r)._mult(p);a==="viewport"&&x._rotate(-f);const b=[];for(let E=0;E<s.length;E++)b.push(s[E].sub(x));return b}function Am(s){const r=[];for(let a=0;a<s.length;a++){const f=s[a],p=r.at(-1);(a===0||p&&!f.equals(p))&&r.push(f)}return r}function ly({queryGeometry:s,size:r},a){return Oc(s,a,r)}function y_({queryGeometry:s,size:r,transform:a,unwrappedTileID:f,getElevation:p},x){return Oc(s,x,r*(a.projectTileCoordinates(x.x,x.y,f,p).signedDistanceFromCamera/a.cameraToCenterDistance))}function v_({queryGeometry:s,size:r,transform:a,unwrappedTileID:f,getElevation:p},x){const b=a.projectTileCoordinates(x.x,x.y,f,p).signedDistanceFromCamera,E=r*(a.cameraToCenterDistance/b);return Oc(s,pp(x,a,f,p),E)}function __({queryGeometry:s,size:r,transform:a,unwrappedTileID:f,getElevation:p},x){return Oc(s,pp(x,a,f,p),r)}function Mm({queryGeometry:s,size:r,transform:a,unwrappedTileID:f,getElevation:p,pitchAlignment:x="map",pitchScale:b="map"},E){const P=x==="map"?b==="map"?ly:y_:b==="map"?v_:__,z={queryGeometry:s,size:r,transform:a,unwrappedTileID:f,getElevation:p};for(const L of E)for(const N of L)if(P(z,N))return!0;return!1}function pp(s,r,a,f){const p=r.projectTileCoordinates(s.x,s.y,a,f).point;return new M((.5*p.x+.5)*r.width,(.5*-p.y+.5)*r.height)}let Pm,uy;jt("CircleBucket",Dc,{omit:["layers"]});var cy={get paint(){return uy=uy||new ai({"circle-radius":new Kt(Me.paint_circle["circle-radius"]),"circle-color":new Kt(Me.paint_circle["circle-color"]),"circle-blur":new Kt(Me.paint_circle["circle-blur"]),"circle-opacity":new Kt(Me.paint_circle["circle-opacity"]),"circle-translate":new Bt(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new Bt(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Bt(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Bt(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kt(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kt(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kt(Me.paint_circle["circle-stroke-opacity"])})},get layout(){return Pm=Pm||new ai({"circle-sort-key":new Kt(Me.layout_circle["circle-sort-key"])})}};class Cm extends Hn{constructor(r,a){super(r,cy,a)}createBucket(r){return new Dc(r)}queryRadius(r){const a=r;return Bu("circle-radius",this,a)+Bu("circle-stroke-width",this,a)+dp(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:a,featureState:f,geometry:p,transform:x,pixelsToTileUnits:b,unwrappedTileID:E,getElevation:P}){const z=Em(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,b),L=this.paint.get("circle-radius").evaluate(a,f)+this.paint.get("circle-stroke-width").evaluate(a,f),N=this.paint.get("circle-pitch-scale"),$=this.paint.get("circle-pitch-alignment");let H,J;return $==="map"?(H=z,J=L*b):(H=(function(te,ie,le,ye){return te.map((se=>pp(se,ie,le,ye)))})(z,x,E,P),J=L),Mm({queryGeometry:H,size:J,transform:x,unwrappedTileID:E,getElevation:P,pitchAlignment:$,pitchScale:N},p)}}class Dm extends Dc{}let hy;jt("HeatmapBucket",Dm,{omit:["layers"]});var fy={get paint(){return hy=hy||new ai({"heatmap-radius":new Kt(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kt(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Bt(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Iu(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Bt(Me.paint_heatmap["heatmap-opacity"])})}};function Om(s,{width:r,height:a},f,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*a*f)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${r*a*f}`)}else p=new Uint8Array(r*a*f);return s.width=r,s.height=a,s.data=p,s}function Yl(s,{width:r,height:a},f){if(r===s.width&&a===s.height)return;const p=Om({},{width:r,height:a},f);mp(s,p,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,a)},f),s.width=r,s.height=a,s.data=p.data}function mp(s,r,a,f,p,x){if(p.width===0||p.height===0)return r;if(p.width>s.width||p.height>s.height||a.x>s.width-p.width||a.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||f.x>r.width-p.width||f.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=s.data,E=r.data;if(b===E)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<p.height;P++){const z=((a.y+P)*s.width+a.x)*x,L=((f.y+P)*r.width+f.x)*x;for(let N=0;N<p.width*x;N++)E[L+N]=b[z+N]}return r}class gp{constructor(r,a){Om(this,r,1,a)}resize(r){Yl(this,r,1)}clone(){return new gp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,f,p,x){mp(r,a,f,p,x,1)}}class Wa{constructor(r,a){Om(this,r,4,a)}resize(r){Yl(this,r,4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Wa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,f,p,x){mp(r,a,f,p,x,4)}setPixel(r,a,f){const p=4*(r*this.width+a);this.data[p+0]=Math.round(255*f.r/f.a),this.data[p+1]=Math.round(255*f.g/f.a),this.data[p+2]=Math.round(255*f.b/f.a),this.data[p+3]=Math.round(255*f.a)}}function Xl(s){const r=new Uint8Array(s.length);for(let a=0;a<s.length;a+=4){const f=s[a+3];r[a+0]=Math.round(s[a+0]*f/255),r[a+1]=Math.round(s[a+1]*f/255),r[a+2]=Math.round(s[a+2]*f/255),r[a+3]=f}return r}function Im(s){const r={},a=s.resolution||256,f=s.clips?s.clips.length:1,p=s.image||new Wa({width:a,height:f});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const x=(b,E,P)=>{r[s.evaluationKey]=P;const z=s.expression.evaluate(r);p.setPixel(b/4/a,E/4,z)};if(s.clips)for(let b=0,E=0;b<f;++b,E+=4*a)for(let P=0,z=0;P<a;P++,z+=4){const L=P/(a-1),{start:N,end:$}=s.clips[b];x(E,z,N*(1-L)+$*L)}else for(let b=0,E=0;b<a;b++,E+=4)x(0,E,b/(a-1));return p}jt("AlphaImage",gp),jt("RGBAImage",Wa);const zm="big-fb";class km extends Hn{createBucket(r){return new Dm(r)}constructor(r,a){super(r,fy,a),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Im({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(zm)&&this.heatmapFbos.delete(zm)}queryRadius(r){return Bu("heatmap-radius",this,r)}queryIntersectsFeature({queryGeometry:r,feature:a,featureState:f,geometry:p,transform:x,pixelsToTileUnits:b,unwrappedTileID:E,getElevation:P}){return Mm({queryGeometry:r,size:this.paint.get("heatmap-radius").evaluate(a,f)*b,transform:x,unwrappedTileID:E,getElevation:P},p)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let cd;var Yn={get paint(){return cd=cd||new ai({"hillshade-illumination-direction":new Bt(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Bt(Me.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Bt(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Bt(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Bt(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Bt(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Bt(Me.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Bt(Me.paint_hillshade["hillshade-method"])})}};class jb extends Hn{constructor(r,a){super(r,Yn,a),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let r=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,p=this.paint.get("hillshade-shadow-color").values;const x=Math.max(r.length,a.length,f.length,p.length);r=r.concat(Array(x-r.length).fill(r.at(-1))),a=a.concat(Array(x-a.length).fill(a.at(-1))),f=f.concat(Array(x-f.length).fill(f.at(-1))),p=p.concat(Array(x-p.length).fill(p.at(-1)));const b=a.map(kn);return{directionRadians:r.map(kn),altitudeRadians:b,shadowColor:p,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let x_;var b_={get paint(){return x_=x_||new ai({"color-relief-opacity":new Bt(Me["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Iu(Me["paint_color-relief"]["color-relief-color"])})}};function hd(s){return"data"in s}class Kl{constructor(r,a,f,p){this.context=r,this.format=f,this.texture=r.gl.createTexture(),this._ownedHandle=this.texture,this.update(a,p)}update(r,a,f){const{width:p,height:x}=r,b=!(this.size&&this.size[0]===p&&this.size[1]===x||f),{context:E}=this,{gl:P}=E;this.useMipmap=!!(a&&a.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1);const z=this.format===P.RGBA&&(!a||a.premultiply!==!1);if(b)this.size=[p,x],hd(r)?(E.pixelStoreUnpackPremultiplyAlpha.set(!1),this._uploadRawData(r,z,p,x,P)):(E.pixelStoreUnpackPremultiplyAlpha.set(z),this._uploadDomImage(r,P));else{const{x:L,y:N}=f||{x:0,y:0};hd(r)?(E.pixelStoreUnpackPremultiplyAlpha.set(!1),this._updateRawData(r,z,L,N,p,x,P)):(E.pixelStoreUnpackPremultiplyAlpha.set(z),this._updateDomImage(r,L,N,P))}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}_uploadDomImage(r,a){a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,r)}_uploadRawData(r,a,f,p,x){let{data:b}=r;a&&b&&(b=Xl(b)),x.texImage2D(x.TEXTURE_2D,0,this.format,f,p,0,this.format,x.UNSIGNED_BYTE,b)}_updateDomImage(r,a,f,p){p.texSubImage2D(p.TEXTURE_2D,0,a,f,p.RGBA,p.UNSIGNED_BYTE,r)}_updateRawData(r,a,f,p,x,b,E){let{data:P}=r;a&&P&&(P=Xl(P)),E.texSubImage2D(E.TEXTURE_2D,0,f,p,x,b,E.RGBA,E.UNSIGNED_BYTE,P)}bind(r,a,f){const{context:p}=this,{gl:x}=p;this.texture!==this._ownedHandle&&(this.texture=this._ownedHandle),x.bindTexture(x.TEXTURE_2D,this.texture),f!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=x.LINEAR),r!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,f||r),this.filter=r),a!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,a),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null,this._ownedHandle=null}}class dy{constructor(r,a,f,p=1,x=1,b=1,E=0){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void fr(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const P=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=x,this.blueFactor=b,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let z=0;z<P;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(P,z)]=this.data[this._idx(P-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,P)]=this.data[this._idx(z,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<P;z++)for(let L=0;L<P;L++){const N=this.get(z,L);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(r,a){const f=new Uint8Array(this.data.buffer),p=4*this._idx(r,a);return this.unpack(f[p],f[p+1],f[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${r}, y: ${a}, dim: ${this.dim}`);return(a+1)*this.stride+(r+1)}unpack(r,a,f){return r*this.redFactor+a*this.greenFactor+f*this.blueFactor-this.baseShift}pack(r){return py(r,this.getUnpackVector())}getPixels(){return new Wa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,a,f){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,x=a*this.dim+this.dim,b=f*this.dim,E=f*this.dim+this.dim;switch(a){case-1:p=x-1;break;case 1:x=p+1}switch(f){case-1:b=E-1;break;case 1:E=b+1}const P=-a*this.dim,z=-f*this.dim;for(let L=b;L<E;L++)for(let N=p;N<x;N++)this.data[this._idx(N,L)]=r.data[this._idx(N+P,L+z)]}}function py(s,r){const a=r[0],f=r[1],p=r[2],x=r[3],b=Math.min(a,f,p),E=Math.round((s+x)/b);return{r:Math.floor(E*b/a)%256,g:Math.floor(E*b/f)%256,b:Math.floor(E*b/p)%256}}jt("DEMData",dy);class yp extends Hn{constructor(r,a){super(r,b_,a)}_createColorRamp(r){const a={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Sa&&f._styleExpression.expression instanceof _a){this.colorRampExpression=f;const b=f._styleExpression.expression;a.elevationStops=b.labels,a.colorStops=[];for(const E of a.elevationStops)a.colorStops.push(b.evaluate({globals:{elevation:E}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[Ot.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=r)return a;const p={elevationStops:[],colorStops:[]},x=(a.elevationStops.length-1)/(r-1);for(let b=0;b<a.elevationStops.length-.5;b+=x)p.elevationStops.push(a.elevationStops[Math.round(b)]),p.colorStops.push(a.colorStops[Math.round(b)]);return fr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${r}, provided: ${a.elevationStops.length}`),p}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(r,a,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const p=this._createColorRamp(a),x=new Wa({width:p.colorStops.length,height:1}),b=new Wa({width:p.colorStops.length,height:1});for(let E=0;E<p.elevationStops.length;E++){const P=py(p.elevationStops[E],f);b.setPixel(0,E,new Ot(P.r/255,P.g/255,P.b/255,1)),x.setPixel(0,E,p.colorStops[E])}return this.colorRampTextures={elevationTexture:new Kl(r,b,r.gl.RGBA),colorTexture:new Kl(r,x,r.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Ql=Rn([{name:"a_pos",components:2,type:"Int16"}],4),{members:w_}=Ql;function fd(s,r,a){const f=a.patternDependencies;let p=!1;for(const x of r){const b=x.paint.get(`${s}-pattern`);b.isConstant()||(p=!0);const E=b.constantOr(null);E&&(p=!0,f[E.to]=!0,f[E.from]=!0)}return p}function Rm(s,r,a,f,p){const{zoom:x}=f,b=p.patternDependencies;for(const E of r){const P=E.paint.get(`${s}-pattern`).value;if(P.kind!=="constant"){let z=P.evaluate({zoom:x-1},a,{},p.availableImages),L=P.evaluate({zoom:x},a,{},p.availableImages),N=P.evaluate({zoom:x+1},a,{},p.availableImages);z=z&&z.name?z.name:z,L=L&&L.name?L.name:L,N=N&&N.name?N.name:N,b[z]=!0,b[L]=!0,b[N]=!0,a.patterns[E.id]={min:z,mid:L,max:N}}}return a}function jm(s,r,a,f,p){let x;if(p===(function(b,E,P,z){let L=0;for(let N=E,$=P-z;N<P;N+=z)L+=(b[$]-b[N])*(b[N+1]+b[$+1]),$=N;return L})(s,r,a,f)>0)for(let b=r;b<a;b+=f)x=yy(b/f|0,s[b],s[b+1],x);else for(let b=a-f;b>=r;b-=f)x=yy(b/f|0,s[b],s[b+1],x);return x&&Fh(x,x.next)&&(ua(x),x=x.next),x}function Fu(s,r){if(!s)return s;r||(r=s);let a,f=s;do if(a=!1,f.steiner||!Fh(f,f.next)&&oi(f.prev,f,f.next)!==0)f=f.next;else{if(ua(f),f=r=f.prev,f===f.next)break;a=!0}while(a||f!==r);return r}function Ic(s,r,a,f,p,x,b){if(!s)return;!b&&x&&(function(P,z,L,N){let $=P;do $.z===0&&($.z=Lm($.x,$.y,z,L,N)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==P);$.prevZ.nextZ=null,$.prevZ=null,(function(H){let J,te=1;do{let ie,le=H;H=null;let ye=null;for(J=0;le;){J++;let se=le,fe=0;for(let Ie=0;Ie<te&&(fe++,se=se.nextZ,se);Ie++);let Se=te;for(;fe>0||Se>0&&se;)fe!==0&&(Se===0||!se||le.z<=se.z)?(ie=le,le=le.nextZ,fe--):(ie=se,se=se.nextZ,Se--),ye?ye.nextZ=ie:H=ie,ie.prevZ=ye,ye=ie;le=se}ye.nextZ=null,te*=2}while(J>1)})($)})(s,f,p,x);let E=s;for(;s.prev!==s.next;){const P=s.prev,z=s.next;if(x?Uu(s,f,p,x):S_(s))r.push(P.i,s.i,z.i),ua(s),s=z.next,E=z.next;else if((s=z)===E){b?b===1?Ic(s=Bi(Fu(s),r),r,a,f,p,x,2):b===2&&my(s,r,a,f,p,x):Ic(Fu(s),r,a,f,p,x,1);break}}}function S_(s){const r=s.prev,a=s,f=s.next;if(oi(r,a,f)>=0)return!1;const p=r.x,x=a.x,b=f.x,E=r.y,P=a.y,z=f.y,L=Math.min(p,x,b),N=Math.min(E,P,z),$=Math.max(p,x,b),H=Math.max(E,P,z);let J=f.next;for(;J!==r;){if(J.x>=L&&J.x<=$&&J.y>=N&&J.y<=H&&sa(p,E,x,P,b,z,J.x,J.y)&&oi(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Uu(s,r,a,f){const p=s.prev,x=s,b=s.next;if(oi(p,x,b)>=0)return!1;const E=p.x,P=x.x,z=b.x,L=p.y,N=x.y,$=b.y,H=Math.min(E,P,z),J=Math.min(L,N,$),te=Math.max(E,P,z),ie=Math.max(L,N,$),le=Lm(H,J,r,a,f),ye=Lm(te,ie,r,a,f);let se=s.prevZ,fe=s.nextZ;for(;se&&se.z>=le&&fe&&fe.z<=ye;){if(se.x>=H&&se.x<=te&&se.y>=J&&se.y<=ie&&se!==p&&se!==b&&sa(E,L,P,N,z,$,se.x,se.y)&&oi(se.prev,se,se.next)>=0||(se=se.prevZ,fe.x>=H&&fe.x<=te&&fe.y>=J&&fe.y<=ie&&fe!==p&&fe!==b&&sa(E,L,P,N,z,$,fe.x,fe.y)&&oi(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;se&&se.z>=le;){if(se.x>=H&&se.x<=te&&se.y>=J&&se.y<=ie&&se!==p&&se!==b&&sa(E,L,P,N,z,$,se.x,se.y)&&oi(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;fe&&fe.z<=ye;){if(fe.x>=H&&fe.x<=te&&fe.y>=J&&fe.y<=ie&&fe!==p&&fe!==b&&sa(E,L,P,N,z,$,fe.x,fe.y)&&oi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function Bi(s,r){let a=s;do{const f=a.prev,p=a.next.next;!Fh(f,p)&&gy(f,a,a.next,p)&&la(f,p)&&la(p,f)&&(r.push(f.i,a.i,p.i),ua(a),ua(a.next),a=s=p),a=a.next}while(a!==s);return Fu(a)}function my(s,r,a,f,p,x){let b=s;do{let E=b.next.next;for(;E!==b.prev;){if(b.i!==E.i&&Vu(b,E)){let P=Ls(b,E);return b=Fu(b,b.next),P=Fu(P,P.next),Ic(b,r,a,f,p,x,0),void Ic(P,r,a,f,p,x,0)}E=E.next}b=b.next}while(b!==s)}function T_(s,r){let a=s.x-r.x;return a===0&&(a=s.y-r.y,a===0)&&(a=(s.next.y-s.y)/(s.next.x-s.x)-(r.next.y-r.y)/(r.next.x-r.x)),a}function oa(s,r){const a=(function(p,x){let b=x;const E=p.x,P=p.y;let z,L=-1/0;if(Fh(p,b))return b;do{if(Fh(p,b.next))return b.next;if(P<=b.y&&P>=b.next.y&&b.next.y!==b.y){const te=b.x+(P-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(te<=E&&te>L&&(L=te,z=b.x<b.next.x?b:b.next,te===E))return z}b=b.next}while(b!==x);if(!z)return null;const N=z,$=z.x,H=z.y;let J=1/0;b=z;do{if(E>=b.x&&b.x>=$&&E!==b.x&&Xn(P<H?E:L,P,$,H,P<H?L:E,P,b.x,b.y)){const te=Math.abs(P-b.y)/(E-b.x);la(b,p)&&(te<J||te===J&&(b.x>z.x||b.x===z.x&&Lb(z,b)))&&(z=b,J=te)}b=b.next}while(b!==N);return z})(s,r);if(!a)return r;const f=Ls(a,s);return Fu(f,f.next),Fu(a,a.next)}function Lb(s,r){return oi(s.prev,s,r.prev)<0&&oi(r.next,s,s.next)<0}function Lm(s,r,a,f,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-f)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function E_(s){let r=s,a=s;do(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next;while(r!==s);return a}function Xn(s,r,a,f,p,x,b,E){return(p-b)*(r-E)>=(s-b)*(x-E)&&(s-b)*(f-E)>=(a-b)*(r-E)&&(a-b)*(x-E)>=(p-b)*(f-E)}function sa(s,r,a,f,p,x,b,E){return!(s===b&&r===E)&&Xn(s,r,a,f,p,x,b,E)}function Vu(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!(function(a,f){let p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==f.i&&p.next.i!==f.i&&gy(p,p.next,a,f))return!0;p=p.next}while(p!==a);return!1})(s,r)&&(la(s,r)&&la(r,s)&&(function(a,f){let p=a,x=!1;const b=(a.x+f.x)/2,E=(a.y+f.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&b<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(x=!x),p=p.next;while(p!==a);return x})(s,r)&&(oi(s.prev,s,r.prev)||oi(s,r.prev,r))||Fh(s,r)&&oi(s.prev,s,s.next)>0&&oi(r.prev,r,r.next)>0)}function oi(s,r,a){return(r.y-s.y)*(a.x-r.x)-(r.x-s.x)*(a.y-r.y)}function Fh(s,r){return s.x===r.x&&s.y===r.y}function gy(s,r,a,f){const p=Uh(oi(s,r,a)),x=Uh(oi(s,r,f)),b=Uh(oi(a,f,s)),E=Uh(oi(a,f,r));return p!==x&&b!==E||!(p!==0||!Nm(s,a,r))||!(x!==0||!Nm(s,f,r))||!(b!==0||!Nm(a,s,f))||!(E!==0||!Nm(a,r,f))}function Nm(s,r,a){return r.x<=Math.max(s.x,a.x)&&r.x>=Math.min(s.x,a.x)&&r.y<=Math.max(s.y,a.y)&&r.y>=Math.min(s.y,a.y)}function Uh(s){return s>0?1:s<0?-1:0}function la(s,r){return oi(s.prev,s,s.next)<0?oi(s,r,s.next)>=0&&oi(s,s.prev,r)>=0:oi(s,r,s.prev)<0||oi(s,s.next,r)<0}function Ls(s,r){const a=Bm(s.i,s.x,s.y),f=Bm(r.i,r.x,r.y),p=s.next,x=r.prev;return s.next=r,r.prev=s,a.next=p,p.prev=a,f.next=a,a.prev=f,x.next=f,f.prev=x,f}function yy(s,r,a,f){const p=Bm(s,r,a);return f?(p.next=f.next,p.prev=f,f.next.prev=p,f.next=p):(p.prev=p,p.next=p),p}function ua(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Bm(s,r,a){return{i:s,x:r,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Bo{constructor(r,a){if(a>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=a}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class Jl{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}Jl.noSubdivision=new Jl({fill:new Bo(0,0),line:new Bo(0,0),tile:new Bo(0,0),stencil:new Bo(0,0),circle:1}),jt("SubdivisionGranularityExpression",Bo),jt("SubdivisionGranularitySetting",Jl);const Fo=-32768,Vh=32767;class vy{constructor(r,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=bt/r,this._canonical=a}_getKey(r,a){return(r+=32768)<<16|a+32768}_vertexToIndex(r,a){if(r<-32768||a<-32768||r>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(r),p=0|Math.round(a),x=this._getKey(f,p);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,b),this._vertexBuffer.push(f,p),b}_subdivideTrianglesScanline(r){if(this._granularity<2)return(function(p,x){const b=[];for(let E=0;E<x.length;E+=3){const P=x[E],z=x[E+1],L=x[E+2],N=p[2*P],$=p[2*P+1];(p[2*z]-N)*(p[2*L+1]-$)-(p[2*z+1]-$)*(p[2*L]-N)>0?(b.push(P),b.push(L),b.push(z)):(b.push(P),b.push(z),b.push(L))}return b})(this._vertexBuffer,r);const a=[],f=r.length;for(let p=0;p<f;p+=3){const x=[r[p+0],r[p+1],r[p+2]],b=[this._vertexBuffer[2*r[p+0]+0],this._vertexBuffer[2*r[p+0]+1],this._vertexBuffer[2*r[p+1]+0],this._vertexBuffer[2*r[p+1]+1],this._vertexBuffer[2*r[p+2]+0],this._vertexBuffer[2*r[p+2]+1]];let E=1/0,P=1/0,z=-1/0,L=-1/0;for(let te=0;te<3;te++){const ie=b[2*te],le=b[2*te+1];E=Math.min(E,ie),z=Math.max(z,ie),P=Math.min(P,le),L=Math.max(L,le)}if(E===z||P===L)continue;const N=Math.floor(E/this._granularityCellSize),$=Math.ceil(z/this._granularityCellSize),H=Math.floor(P/this._granularityCellSize),J=Math.ceil(L/this._granularityCellSize);if(N!==$||H!==J)for(let te=H;te<J;te++){const ie=this._scanlineGenerateVertexRingForCellRow(te,b,x);dd(this._vertexBuffer,ie,a)}else a.push(...x)}return a}_scanlineGenerateVertexRingForCellRow(r,a,f){const p=r*this._granularityCellSize,x=p+this._granularityCellSize,b=[];for(let E=0;E<3;E++){const P=a[2*E],z=a[2*E+1],L=a[2*(E+1)%6],N=a[(2*(E+1)+1)%6],$=a[2*(E+2)%6],H=a[(2*(E+2)+1)%6],J=L-P,te=N-z,ie=J===0,le=te===0,ye=(p-z)/te,se=(x-z)/te,fe=Math.min(ye,se),Se=Math.max(ye,se);if(!le&&(fe>=1||Se<=0)||le&&(z<p||z>x)){N>=p&&N<=x&&b.push(f[(E+1)%3]);continue}!le&&fe>0&&b.push(this._vertexToIndex(P+J*fe,z+te*fe));const Ie=P+J*Math.max(fe,0),We=P+J*Math.min(Se,1);ie||this._generateIntraEdgeVertices(b,P,z,L,N,Ie,We),!le&&Se<1&&b.push(this._vertexToIndex(P+J*Se,z+te*Se)),(le||N>=p&&N<=x)&&b.push(f[(E+1)%3]),!le&&(N<=p||N>=x)&&this._generateInterEdgeVertices(b,P,z,L,N,$,H,We,p,x)}return b}_generateIntraEdgeVertices(r,a,f,p,x,b,E){const P=p-a,z=x-f,L=z===0,N=L?Math.min(a,p):Math.min(b,E),$=L?Math.max(a,p):Math.max(b,E),H=Math.floor(N/this._granularityCellSize)+1,J=Math.ceil($/this._granularityCellSize)-1;if(L?a<p:b<E)for(let te=H;te<=J;te++){const ie=te*this._granularityCellSize;r.push(this._vertexToIndex(ie,f+z*(ie-a)/P))}else for(let te=J;te>=H;te--){const ie=te*this._granularityCellSize;r.push(this._vertexToIndex(ie,f+z*(ie-a)/P))}}_generateInterEdgeVertices(r,a,f,p,x,b,E,P,z,L){const N=x-f,$=b-p,H=E-x,J=(z-x)/H,te=(L-x)/H,ie=Math.min(J,te),le=Math.max(J,te),ye=p+$*ie;let se=Math.floor(Math.min(ye,P)/this._granularityCellSize)+1,fe=Math.ceil(Math.max(ye,P)/this._granularityCellSize)-1,Se=P<ye;const Ie=H===0;if(Ie&&(E===z||E===L))return;if(Ie||ie>=1||le<=0){const ht=f-E,dt=b+(a-b)*Math.min((z-E)/ht,(L-E)/ht);se=Math.floor(Math.min(dt,P)/this._granularityCellSize)+1,fe=Math.ceil(Math.max(dt,P)/this._granularityCellSize)-1,Se=P<dt}const We=N>0?L:z;if(Se)for(let ht=se;ht<=fe;ht++)r.push(this._vertexToIndex(ht*this._granularityCellSize,We));else for(let ht=fe;ht>=se;ht--)r.push(this._vertexToIndex(ht*this._granularityCellSize,We))}_generateOutline(r){const a=[];for(const f of r){const p=zc(f,this._granularity,!0),x=this._pointArrayToIndices(p),b=[];for(let E=1;E<x.length;E++)b.push(x[E-1]),b.push(x[E]);a.push(b)}return a}_handlePoles(r){let a=!1,f=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(a||f)&&this._fillPoles(r,a,f)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let a=0;a<r.length;a+=2){const f=r[a+1];f===Fo&&(r[a+1]=-32767),f===Vh&&(r[a+1]=32766)}}_generatePoleQuad(r,a,f,p,x,b){p>x!=(b===Fo)?(r.push(a),r.push(f),r.push(this._vertexToIndex(p,b)),r.push(f),r.push(this._vertexToIndex(x,b)),r.push(this._vertexToIndex(p,b))):(r.push(f),r.push(a),r.push(this._vertexToIndex(p,b)),r.push(this._vertexToIndex(x,b)),r.push(f),r.push(this._vertexToIndex(p,b)))}_fillPoles(r,a,f){const p=this._vertexBuffer,x=bt,b=r.length;for(let E=2;E<b;E+=3){const P=r[E-2],z=r[E-1],L=r[E],N=p[2*P],$=p[2*P+1],H=p[2*z],J=p[2*z+1],te=p[2*L],ie=p[2*L+1];a&&($===0&&J===0&&this._generatePoleQuad(r,P,z,N,H,Fo),J===0&&ie===0&&this._generatePoleQuad(r,z,L,H,te,Fo),ie===0&&$===0&&this._generatePoleQuad(r,L,P,te,N,Fo)),f&&($===x&&J===x&&this._generatePoleQuad(r,P,z,N,H,Vh),J===x&&ie===x&&this._generatePoleQuad(r,z,L,H,te,Vh),ie===x&&$===x&&this._generatePoleQuad(r,L,P,te,N,Vh))}}_initializeVertices(r){for(let a=0;a<r.length;a+=2)this._vertexToIndex(r[a],r[a+1])}subdividePolygonInternal(r,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:p}=(function(E){const P=[],z=[];for(const L of E)if(L.length!==0){L!==E[0]&&P.push(z.length/2);for(let N=0;N<L.length;N++)z.push(L[N].x),z.push(L[N].y)}return{flattened:z,holeIndices:P}})(r);let x;this._initializeVertices(f);try{const E=(function(z,L,N=2){const $=L&&L.length,H=$?L[0]*N:z.length;let J=jm(z,0,H,N,!0);const te=[];if(!J||J.next===J.prev)return te;let ie,le,ye;if($&&(J=(function(se,fe,Se,Ie){const We=[];for(let ht=0,dt=fe.length;ht<dt;ht++){const St=jm(se,fe[ht]*Ie,ht<dt-1?fe[ht+1]*Ie:se.length,Ie,!1);St===St.next&&(St.steiner=!0),We.push(E_(St))}We.sort(T_);for(let ht=0;ht<We.length;ht++)Se=oa(We[ht],Se);return Se})(z,L,J,N)),z.length>80*N){ie=z[0],le=z[1];let se=ie,fe=le;for(let Se=N;Se<H;Se+=N){const Ie=z[Se],We=z[Se+1];Ie<ie&&(ie=Ie),We<le&&(le=We),Ie>se&&(se=Ie),We>fe&&(fe=We)}ye=Math.max(se-ie,fe-le),ye=ye!==0?32767/ye:0}return Ic(J,te,N,ie,le,ye,0),te})(f,p),P=this._convertIndices(f,E);x=this._subdivideTrianglesScanline(P)}catch(E){console.error(E)}let b=[];return a&&(b=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:b}}_convertIndices(r,a){const f=[];for(let p=0;p<a.length;p++)f.push(this._vertexToIndex(r[2*a[p]],r[2*a[p]+1]));return f}_pointArrayToIndices(r){const a=[];for(let f=0;f<r.length;f++){const p=r[f];a.push(this._vertexToIndex(p.x,p.y))}return a}}function Ns(s,r,a,f=!0){return new vy(a,r).subdividePolygonInternal(s,f)}function zc(s,r,a=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const f=s[0],p=s[s.length-1],x=a&&(f.x!==p.x||f.y!==p.y);if(r<2)return x?[...s,s[0]]:[...s];const b=Math.floor(bt/r),E=[];E.push(new M(s[0].x,s[0].y));const P=s.length,z=x?P:P-1;for(let L=0;L<z;L++){const N=s[L],$=L<P-1?s[L+1]:s[0],H=N.x,J=N.y,te=$.x,ie=$.y,le=H!==te,ye=J!==ie;if(!le&&!ye)continue;const se=te-H,fe=ie-J,Se=Math.abs(se),Ie=Math.abs(fe);let We=H,ht=J;for(;;){const St=se>0?(Math.floor(We/b)+1)*b:(Math.ceil(We/b)-1)*b,It=fe>0?(Math.floor(ht/b)+1)*b:(Math.ceil(ht/b)-1)*b,Mt=Math.abs(We-St),mt=Math.abs(ht-It),ot=Math.abs(We-te),$t=Math.abs(ht-ie),Ht=le?Mt/Se:Number.POSITIVE_INFINITY,ar=ye?mt/Ie:Number.POSITIVE_INFINITY;if((ot<=Mt||!le)&&($t<=mt||!ye))break;if(Ht<ar&&le||!ye){We=St,ht+=fe*Ht;const Xt=new M(We,Math.round(ht));E[E.length-1].x===Xt.x&&E[E.length-1].y===Xt.y||E.push(Xt)}else{We+=se*ar,ht=It;const Xt=new M(Math.round(We),ht);E[E.length-1].x===Xt.x&&E[E.length-1].y===Xt.y||E.push(Xt)}}const dt=new M(te,ie);E[E.length-1].x===dt.x&&E[E.length-1].y===dt.y||E.push(dt)}return E}function dd(s,r,a){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,p=s[2*r[0]];for(let P=1;P<r.length;P++){const z=s[2*r[P]];z<p&&(p=z,f=P)}const x=r.length;let b=f,E=(b+1)%x;for(;;){const P=b-1>=0?b-1:x-1,z=(E+1)%x,L=s[2*r[P]],N=s[2*r[z]],$=s[2*r[b]],H=s[2*r[b]+1],J=s[2*r[E]+1];let te=!1;if(L<N)te=!0;else if(L>N)te=!1;else{const ie=J-H,le=-(s[2*r[E]]-$),ye=H<J?1:-1;((L-$)*ie+(s[2*r[P]+1]-H)*le)*ye>((N-$)*ie+(s[2*r[z]+1]-H)*le)*ye&&(te=!0)}if(te){const ie=r[P],le=r[b],ye=r[E];ie!==le&&ie!==ye&&le!==ye&&a.push(ye,le,ie),b--,b<0&&(b=x-1)}else{const ie=r[z],le=r[b],ye=r[E];ie!==le&&ie!==ye&&le!==ye&&a.push(ye,le,ie),E++,E>=x&&(E=0)}if(P===z)break}}function pd(s,r,a,f,p,x,b,E,P){const z=p.length/2,L=b&&E&&P;if(z<ut.MAX_VERTEX_ARRAY_LENGTH){const N=r.prepareSegment(z,a,f),$=N.vertexLength;for(let te=0;te<x.length;te+=3)f.emplaceBack($+x[te],$+x[te+1],$+x[te+2]);let H,J;N.vertexLength+=z,N.primitiveLength+=x.length/3,L&&(J=b.prepareSegment(z,a,E),H=J.vertexLength,J.vertexLength+=z);for(let te=0;te<p.length;te+=2)s(p[te],p[te+1]);if(L)for(let te=0;te<P.length;te++){const ie=P[te];for(let le=1;le<ie.length;le+=2)E.emplaceBack(H+ie[le-1],H+ie[le]);J.primitiveLength+=ie.length/2}}else(function(N,$,H,J,te,ie){const le=[];for(let Ie=0;Ie<J.length/2;Ie++)le.push(-1);const ye={count:0};let se=0,fe=N.getOrCreateLatestSegment($,H),Se=fe.vertexLength;for(let Ie=2;Ie<te.length;Ie+=3){const We=te[Ie-2],ht=te[Ie-1],dt=te[Ie];let St=le[We]<se,It=le[ht]<se,Mt=le[dt]<se;fe.vertexLength+((St?1:0)+(It?1:0)+(Mt?1:0))>ut.MAX_VERTEX_ARRAY_LENGTH&&(fe=N.createNewSegment($,H),se=ye.count,St=!0,It=!0,Mt=!0,Se=0);const mt=qu(le,J,ie,ye,We,St,fe),ot=qu(le,J,ie,ye,ht,It,fe),$t=qu(le,J,ie,ye,dt,Mt,fe);H.emplaceBack(Se+mt-se,Se+ot-se,Se+$t-se),fe.primitiveLength++}})(r,a,f,p,x,s),L&&(function(N,$,H,J,te,ie){const le=[];for(let Ie=0;Ie<J.length/2;Ie++)le.push(-1);const ye={count:0};let se=0,fe=N.getOrCreateLatestSegment($,H),Se=fe.vertexLength;for(let Ie=0;Ie<te.length;Ie++){const We=te[Ie];for(let ht=1;ht<te[Ie].length;ht+=2){const dt=We[ht-1],St=We[ht];let It=le[dt]<se,Mt=le[St]<se;fe.vertexLength+((It?1:0)+(Mt?1:0))>ut.MAX_VERTEX_ARRAY_LENGTH&&(fe=N.createNewSegment($,H),se=ye.count,It=!0,Mt=!0,Se=0);const mt=qu(le,J,ie,ye,dt,It,fe),ot=qu(le,J,ie,ye,St,Mt,fe);H.emplaceBack(Se+mt-se,Se+ot-se),fe.primitiveLength++}}})(b,a,E,p,P,s),r.forceNewSegmentOnNextPrepare(),b?.forceNewSegmentOnNextPrepare()}function qu(s,r,a,f,p,x,b){if(x){const E=f.count;return a(r[2*p],r[2*p+1]),s[p]=f.count,f.count++,b.vertexLength++,E}return s[p]}class kc{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new pe,this.indexArray=new He,this.indexArray2=new Je,this.programConfigurations=new Zl(r.layers,r.zoom),this.segments=new ut,this.segments2=new ut,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,f){this.hasDependencies=fd("fill",this.layers,a);const p=this.layers[0].layout.get("fill-sort-key"),x=!p.isConstant(),b=[];for(const{feature:E,id:P,index:z,sourceLayerIndex:L}of r){const N=this.layers[0]._featureFilter.needGeometry,$=cs(E,N);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),$,f))continue;const H=x?p.evaluate($,{},f,a.availableImages):void 0,J={id:P,properties:E.properties,type:E.type,sourceLayerIndex:L,index:z,geometry:N?$.geometry:Ha(E),patterns:{},sortKey:H};b.push(J)}x&&b.sort(((E,P)=>E.sortKey-P.sortKey));for(const E of b){const{geometry:P,index:z,sourceLayerIndex:L}=E;if(this.hasDependencies){const N=Rm("fill",this.layers,E,{zoom:this.zoom},a);this.patternFeatures.push(N)}else this.addFeature(E,P,z,f,{},a.subdivisionGranularity);a.featureIndex.insert(r[z].feature,P,z,L,this.index)}}update(r,a,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,{imagePositions:f})}addFeatures(r,a,f){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,f,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,w_),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,f,p,x,b){for(const E of yc(a,500)){const P=Ns(E,p,b.fill.getGranularityForZoomLevel(p.z)),z=this.layoutVertexArray;pd(((L,N)=>{z.emplaceBack(L,N)}),this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles,this.segments2,this.indexArray2,P.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,{imagePositions:x,canonical:p})}}let _y,xy;jt("FillBucket",kc,{omit:["layers","patternFeatures"]});var vp={get paint(){return xy=xy||new ai({"fill-antialias":new Bt(Me.paint_fill["fill-antialias"]),"fill-opacity":new Kt(Me.paint_fill["fill-opacity"]),"fill-color":new Kt(Me.paint_fill["fill-color"]),"fill-outline-color":new Kt(Me.paint_fill["fill-outline-color"]),"fill-translate":new Bt(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new Bt(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ea(Me.paint_fill["fill-pattern"])})},get layout(){return _y=_y||new ai({"fill-sort-key":new Kt(Me.layout_fill["fill-sort-key"])})}};class A_ extends Hn{constructor(r,a){super(r,vp,a)}recalculate(r,a){super.recalculate(r,a);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new kc(r)}queryRadius(){return dp(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:a,transform:f,pixelsToTileUnits:p}){return Sm(Em(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,p),a)}isTileClipped(){return!0}}const Fm=Rn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),M_=Rn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Nb}=Fm;class _p{constructor(r,a,f,p,x){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=p,this._values=x,r.readFields(pn,this,a)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const a=r.readVarint()+r.pos,f=[];let p,x=1,b=0,E=0,P=0;for(;r.pos<a;){if(b<=0){const z=r.readVarint();x=7&z,b=z>>3}if(b--,x===1||x===2)E+=r.readSVarint(),P+=r.readSVarint(),x===1&&(p&&f.push(p),p=[]),p&&p.push(new M(E,P));else{if(x!==7)throw new Error(`unknown command ${x}`);p&&p.push(p[0].clone())}}return p&&f.push(p),f}bbox(){const r=this._pbf;r.pos=this._geometry;const a=r.readVarint()+r.pos;let f=1,p=0,x=0,b=0,E=1/0,P=-1/0,z=1/0,L=-1/0;for(;r.pos<a;){if(p<=0){const N=r.readVarint();f=7&N,p=N>>3}if(p--,f===1||f===2)x+=r.readSVarint(),b+=r.readSVarint(),x<E&&(E=x),x>P&&(P=x),b<z&&(z=b),b>L&&(L=b);else if(f!==7)throw new Error(`unknown command ${f}`)}return[E,z,P,L]}toGeoJSON(r,a,f){const p=this.extent*Math.pow(2,f),x=this.extent*r,b=this.extent*a,E=this.loadGeometry();function P($){return[360*($.x+x)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*($.y+b)/p)*Math.PI))-90]}function z($){return $.map(P)}let L;if(this.type===1){const $=[];for(const J of E)$.push(J[0]);const H=z($);L=$.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const $=E.map(z);L=$.length===1?{type:"LineString",coordinates:$[0]}:{type:"MultiLineString",coordinates:$}}else{if(this.type!==3)throw new Error("unknown feature type");{const $=In(E),H=[];for(const J of $)H.push(J.map(z));L=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const N={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(N.id=this.id),N}}function pn(s,r,a){s===1?r.id=a.readVarint():s===2?(function(f,p){const x=f.readVarint()+f.pos;for(;f.pos<x;){const b=p._keys[f.readVarint()],E=p._values[f.readVarint()];p.properties[b]=E}})(a,r):s===3?r.type=a.readVarint():s===4&&(r._geometry=a.pos)}function In(s){const r=s.length;if(r<=1)return[s];const a=[];let f,p;for(let x=0;x<r;x++){const b=Vr(s[x]);b!==0&&(p===void 0&&(p=b<0),p===b<0?(f&&a.push(f),f=[s[x]]):f&&f.push(s[x]))}return f&&a.push(f),a}function Vr(s){let r=0;for(let a,f,p=0,x=s.length,b=x-1;p<x;b=p++)a=s[p],f=s[b],r+=(f.x-a.x)*(a.y+f.y);return r}_p.types=["Unknown","Point","LineString","Polygon"];class Hr{constructor(r,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(En,this,a),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const a=this._pbf.readVarint()+this._pbf.pos;return new _p(this._pbf,a,this.extent,this._keys,this._values)}}function En(s,r,a){s===15?r.version=a.readVarint():s===1?r.name=a.readString():s===5?r.extent=a.readVarint():s===2?r._features.push(a.pos):s===3?r._keys.push(a.readString()):s===4&&r._values.push((function(f){let p=null;const x=f.readVarint()+f.pos;for(;f.pos<x;){const b=f.readVarint()>>3;p=b===1?f.readString():b===2?f.readFloat():b===3?f.readDouble():b===4?f.readVarint64():b===5?f.readVarint():b===6?f.readSVarint():b===7?f.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p})(a))}class Uo{constructor(r,a){this.layers=r.readFields(Rc,{},a)}}function Rc(s,r,a){if(s===3){const f=new Hr(a,a.readVarint()+a.pos);f.length&&(r[f.name]=f)}}const jc=Math.pow(2,13);function qh(s,r,a,f,p,x,b,E){s.emplaceBack(r,a,2*Math.floor(f*jc)+b,p*jc*2,x*jc*2,Math.round(E))}class fl{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new de,this.centroidVertexArray=new oe,this.indexArray=new He,this.programConfigurations=new Zl(r.layers,r.zoom),this.segments=new ut,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,f){this.features=[],this.hasDependencies=fd("fill-extrusion",this.layers,a);for(const{feature:p,id:x,index:b,sourceLayerIndex:E}of r){const P=this.layers[0]._featureFilter.needGeometry,z=cs(p,P);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),z,f))continue;const L={id:x,sourceLayerIndex:E,index:b,geometry:P?z.geometry:Ha(p),properties:p.properties,type:p.type,patterns:{}};this.hasDependencies?this.features.push(Rm("fill-extrusion",this.layers,L,{zoom:this.zoom},a)):this.addFeature(L,L.geometry,b,f,{},a.subdivisionGranularity),a.featureIndex.insert(p,L.geometry,b,E,this.index,!0)}}addFeatures(r,a,f){for(const p of this.features){const{geometry:x}=p;this.addFeature(p,x,p.index,a,f,r.subdivisionGranularity)}}update(r,a,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Nb),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,M_.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,a,f,p,x,b){for(const E of yc(a,500)){const P={x:0,y:0,sampleCount:0},z=this.layoutVertexArray.length;this.processPolygon(P,p,r,E,b);const L=this.layoutVertexArray.length-z,N=Math.floor(P.x/P.sampleCount),$=Math.floor(P.y/P.sampleCount);for(let H=0;H<L;H++)this.centroidVertexArray.emplaceBack(N,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,{imagePositions:x,canonical:p})}processPolygon(r,a,f,p,x){if(p.length<1||Nc(p[0]))return;for(const N of p)N.length!==0&&vi(r,N);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=x.fill.getGranularityForZoomLevel(a.z),P=_p.types[f.type]==="Polygon";for(const N of p){if(N.length===0||Nc(N))continue;const $=zc(N,E,P);this._generateSideFaces($,b)}if(!P)return;const z=Ns(p,a,E,!1),L=this.layoutVertexArray;pd(((N,$)=>{qh(L,N,$,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles)}_generateSideFaces(r,a){let f=0;for(let p=1;p<r.length;p++){const x=r[p],b=r[p-1];if(Lc(x,b))continue;a.segment.vertexLength+4>ut.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=x.sub(b)._perp()._unit(),P=b.dist(x);f+P>32768&&(f=0),qh(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,0,f),qh(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,1,f),f+=P,qh(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,0,f),qh(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,1,f);const z=a.segment.vertexLength;this.indexArray.emplaceBack(z,z+2,z+1),this.indexArray.emplaceBack(z+1,z+2,z+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function vi(s,r){for(let a=0;a<r.length;a++){const f=r[a];a===r.length-1&&r[0].x===f.x&&r[0].y===f.y||(s.x+=f.x,s.y+=f.y,s.sampleCount++)}}function Lc(s,r){return s.x===r.x&&(s.x<0||s.x>bt)||s.y===r.y&&(s.y<0||s.y>bt)}function Nc(s){return s.every((r=>r.x<0))||s.every((r=>r.x>bt))||s.every((r=>r.y<0))||s.every((r=>r.y>bt))}let Um;jt("FillExtrusionBucket",fl,{omit:["layers","features"]});var hs={get paint(){return Um=Um||new ai({"fill-extrusion-opacity":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kt(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ea(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kt(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kt(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class md extends Hn{constructor(r,a){super(r,hs,a)}createBucket(r){return new fl(r)}queryRadius(){return dp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:a,featureState:f,geometry:p,transform:x,pixelsToTileUnits:b,pixelPosMatrix:E}){const P=Em(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,b),z=this.paint.get("fill-extrusion-height").evaluate(a,f),L=this.paint.get("fill-extrusion-base").evaluate(a,f),N=(function(H,J){const te=[];for(const ie of H){const le=[ie.x,ie.y,0,1];zt(le,le,J),te.push(new M(le[0]/le[3],le[1]/le[3]))}return te})(P,E),$=(function(H,J,te,ie){const le=[],ye=[],se=ie[8]*J,fe=ie[9]*J,Se=ie[10]*J,Ie=ie[11]*J,We=ie[8]*te,ht=ie[9]*te,dt=ie[10]*te,St=ie[11]*te;for(const It of H){const Mt=[],mt=[];for(const ot of It){const $t=ot.x,Ht=ot.y,ar=ie[0]*$t+ie[4]*Ht+ie[12],Xt=ie[1]*$t+ie[5]*Ht+ie[13],Ar=ie[2]*$t+ie[6]*Ht+ie[14],Qn=ie[3]*$t+ie[7]*Ht+ie[15],Ui=Ar+Se,Qa=Qn+Ie,iu=ar+We,$o=Xt+ht,Ma=Ar+dt,Ja=Qn+St,bi=new M((ar+se)/Qa,(Xt+fe)/Qa);bi.z=Ui/Qa,Mt.push(bi);const Pa=new M(iu/Ja,$o/Ja);Pa.z=Ma/Ja,mt.push(Pa)}le.push(Mt),ye.push(mt)}return[le,ye]})(p,L,z,E);return(function(H,J,te){let ie=1/0;Sm(te,J)&&(ie=Ao(te,J[0]));for(let le=0;le<J.length;le++){const ye=J[le],se=H[le];for(let fe=0;fe<ye.length-1;fe++){const Se=ye[fe],Ie=[Se,ye[fe+1],se[fe+1],se[fe],Se];ud(te,Ie)&&(ie=Math.min(ie,Ao(te,Ie)))}}return ie!==1/0&&ie})($[0],$[1],N)}}function $u(s,r){return s.x*r.x+s.y*r.y}function Ao(s,r){if(s.length===1){let a=0;const f=r[a++];let p;for(;!p||f.equals(p);)if(p=r[a++],!p)return 1/0;for(;a<r.length;a++){const x=r[a],b=s[0],E=p.sub(f),P=x.sub(f),z=b.sub(f),L=$u(E,E),N=$u(E,P),$=$u(P,P),H=$u(z,E),J=$u(z,P),te=L*$-N*N,ie=($*H-N*J)/te,le=(L*J-N*H)/te,ye=f.z*(1-ie-le)+p.z*ie+x.z*le;if(isFinite(ye))return ye}return 1/0}{let a=1/0;for(const f of r)a=Math.min(a,f.z);return a}}const by=Rn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Vm}=by,P_=Rn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:qm}=P_,$m=Math.cos(Math.PI/180*37.5),Gu=Math.pow(2,14)/.5;class Oi{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((a=>{this.gradients[a.id]={}})),this.layoutVertexArray=new xe,this.layoutVertexArray2=new Ee,this.indexArray=new He,this.programConfigurations=new Zl(r.layers,r.zoom),this.segments=new ut,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,f){this.hasDependencies=fd("line",this.layers,a)||this.hasLineDasharray(this.layers);const p=this.layers[0].layout.get("line-sort-key"),x=!p.isConstant(),b=[];for(const{feature:E,id:P,index:z,sourceLayerIndex:L}of r){const N=this.layers[0]._featureFilter.needGeometry,$=cs(E,N);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),$,f))continue;const H=x?p.evaluate($,{},f):void 0,J={id:P,properties:E.properties,type:E.type,sourceLayerIndex:L,index:z,geometry:N?$.geometry:Ha(E),patterns:{},dashes:{},sortKey:H};b.push(J)}x&&b.sort(((E,P)=>E.sortKey-P.sortKey));for(const E of b){const{geometry:P,index:z,sourceLayerIndex:L}=E;this.hasDependencies?(fd("line",this.layers,a)?Rm("line",this.layers,E,{zoom:this.zoom},a):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,E,this.zoom,a),this.patternFeatures.push(E)):this.addFeature(E,P,z,f,{},{},a.subdivisionGranularity),a.featureIndex.insert(r[z].feature,P,z,L,this.index)}}update(r,a,f,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,{imagePositions:f,dashPositions:p})}addFeatures(r,a,f,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,f,p,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,qm)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Vm),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,f,p,x,b,E){const P=this.layers[0].layout,z=P.get("line-join").evaluate(r,{}),L=P.get("line-cap"),N=P.get("line-miter-limit"),$=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const H of a)this.addLine(H,r,z,L,N,$,p,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,{imagePositions:x,dashPositions:b,canonical:p})}addLine(r,a,f,p,x,b,E,P){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=zc(r,E?P.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<r.length-1;se++)this.totalDistance+=r[se].dist(r[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=_p.types[a.type]==="Polygon";let L=r.length;for(;L>=2&&r[L-1].equals(r[L-2]);)L--;let N=0;for(;N<L-1&&r[N].equals(r[N+1]);)N++;if(L<(z?3:2))return;f==="bevel"&&(x=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let J,te,ie,le,ye;this.e1=this.e2=-1,z&&(J=r[L-2],ye=r[N].sub(J)._unit()._perp());for(let se=N;se<L;se++){if(ie=se===L-1?z?r[N+1]:void 0:r[se+1],ie&&r[se].equals(ie))continue;ye&&(le=ye),J&&(te=J),J=r[se],ye=ie?ie.sub(J)._unit()._perp():le,le=le||ye;let fe=le.add(ye);fe.x===0&&fe.y===0||fe._unit();const Se=le.x*ye.x+le.y*ye.y,Ie=fe.x*ye.x+fe.y*ye.y,We=Ie!==0?1/Ie:1/0,ht=2*Math.sqrt(2-2*Ie),dt=Ie<$m&&te&&ie,St=le.x*ye.y-le.y*ye.x>0;if(dt&&se>N){const mt=J.dist(te);if(mt>2*$){const ot=J.sub(J.sub(te)._mult($/mt)._round());this.updateDistance(te,ot),this.addCurrentVertex(ot,le,0,0,H),te=ot}}const It=te&&ie;let Mt=It?f:z?"butt":p;if(It&&Mt==="round"&&(We<b?Mt="miter":We<=2&&(Mt="fakeround")),Mt==="miter"&&We>x&&(Mt="bevel"),Mt==="bevel"&&(We>2&&(Mt="flipbevel"),We<x&&(Mt="miter")),te&&this.updateDistance(te,J),Mt==="miter")fe._mult(We),this.addCurrentVertex(J,fe,0,0,H);else if(Mt==="flipbevel"){if(We>100)fe=ye.mult(-1);else{const mt=We*le.add(ye).mag()/le.sub(ye).mag();fe._perp()._mult(mt*(St?-1:1))}this.addCurrentVertex(J,fe,0,0,H),this.addCurrentVertex(J,fe.mult(-1),0,0,H)}else if(Mt==="bevel"||Mt==="fakeround"){const mt=-Math.sqrt(We*We-1),ot=St?mt:0,$t=St?0:mt;if(te&&this.addCurrentVertex(J,le,ot,$t,H),Mt==="fakeround"){const Ht=Math.round(180*ht/Math.PI/20);for(let ar=1;ar<Ht;ar++){let Xt=ar/Ht;if(Xt!==.5){const Qn=Xt-.5;Xt+=Xt*Qn*(Xt-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*Qn*Qn+(.848013+Se*(.215638*Se-1.06021)))}const Ar=ye.sub(le)._mult(Xt)._add(le)._unit()._mult(St?-1:1);this.addHalfVertex(J,Ar.x,Ar.y,!1,St,0,H)}}ie&&this.addCurrentVertex(J,ye,-ot,-$t,H)}else if(Mt==="butt")this.addCurrentVertex(J,fe,0,0,H);else if(Mt==="square"){const mt=te?1:-1;this.addCurrentVertex(J,fe,mt,mt,H)}else Mt==="round"&&(te&&(this.addCurrentVertex(J,le,0,0,H),this.addCurrentVertex(J,le,1,1,H,!0)),ie&&(this.addCurrentVertex(J,ye,-1,-1,H,!0),this.addCurrentVertex(J,ye,0,0,H)));if(dt&&se<L-1){const mt=J.dist(ie);if(mt>2*$){const ot=J.add(ie.sub(J)._mult($/mt)._round());this.updateDistance(J,ot),this.addCurrentVertex(ot,ye,0,0,H),J=ot}}}}addCurrentVertex(r,a,f,p,x,b=!1){const E=a.y*p-a.x,P=-a.y-a.x*p;this.addHalfVertex(r,a.x+a.y*f,a.y-a.x*f,b,!1,f,x),this.addHalfVertex(r,E,P,b,!0,-p,x),this.distance>Gu/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,a,f,p,x,b))}addHalfVertex({x:r,y:a},f,p,x,b,E,P){const z=.5*(this.lineClips?this.scaledDistance*(Gu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(x?1:0),(a<<1)+(b?1:0),Math.round(63*f)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,L,this.e2),P.primitiveLength++),b?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}hasLineDasharray(r){for(const a of r){const f=a.paint.get("line-dasharray");if(f&&!f.isConstant())return!0}return!1}addLineDashDependencies(r,a,f,p){for(const x of r){const b=x.paint.get("line-dasharray");if(!b||b.value.kind==="constant")continue;const E=x.layout.get("line-cap")==="round",P={dasharray:b.value.evaluate({zoom:f-1},a,{}),round:E},z={dasharray:b.value.evaluate({zoom:f},a,{}),round:E},L={dasharray:b.value.evaluate({zoom:f+1},a,{}),round:E},N=`${P.dasharray.join(",")},${P.round}`,$=`${z.dasharray.join(",")},${z.round}`,H=`${L.dasharray.join(",")},${L.round}`;p.dashDependencies[N]=P,p.dashDependencies[$]=z,p.dashDependencies[H]=L,a.dashes[x.id]={min:N,mid:$,max:H}}}}let Zu,$h;jt("LineBucket",Oi,{omit:["layers","patternFeatures"]});var eu={get paint(){return $h=$h||new ai({"line-opacity":new Kt(Me.paint_line["line-opacity"]),"line-color":new Kt(Me.paint_line["line-color"]),"line-translate":new Bt(Me.paint_line["line-translate"]),"line-translate-anchor":new Bt(Me.paint_line["line-translate-anchor"]),"line-width":new Kt(Me.paint_line["line-width"]),"line-gap-width":new Kt(Me.paint_line["line-gap-width"]),"line-offset":new Kt(Me.paint_line["line-offset"]),"line-blur":new Kt(Me.paint_line["line-blur"]),"line-dasharray":new Ea(Me.paint_line["line-dasharray"]),"line-pattern":new Ea(Me.paint_line["line-pattern"]),"line-gradient":new Iu(Me.paint_line["line-gradient"])})},get layout(){return Zu=Zu||new ai({"line-cap":new Bt(Me.layout_line["line-cap"]),"line-join":new Kt(Me.layout_line["line-join"]),"line-miter-limit":new Bt(Me.layout_line["line-miter-limit"]),"line-round-limit":new Bt(Me.layout_line["line-round-limit"]),"line-sort-key":new Kt(Me.layout_line["line-sort-key"])})}};class wy extends Kt{possiblyEvaluate(r,a){return a=new ln(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(r,a)}evaluate(r,a,f,p){return a=yr({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(r,a,f,p)}}let gd;class C_ extends Hn{constructor(r,a){super(r,eu,a),this.gradientVersion=0,gd||(gd=new wy(eu.paint.properties["line-width"].specification),gd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!(function(f){return f._styleExpression!==void 0})(a)&&a._styleExpression.expression instanceof mu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,a){super.recalculate(r,a),this.paint._values["line-floorwidth"]=gd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Oi(r)}queryRadius(r){const a=r,f=yd(Bu("line-width",this,a),Bu("line-gap-width",this,a)),p=Bu("line-offset",this,a);return f/2+Math.abs(p)+dp(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:a,featureState:f,geometry:p,transform:x,pixelsToTileUnits:b}){const E=Em(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,b),P=b/2*yd(this.paint.get("line-width").evaluate(a,f),this.paint.get("line-gap-width").evaluate(a,f)),z=this.paint.get("line-offset").evaluate(a,f);return z&&(p=(function(L,N){const $=[];for(let H=0;H<L.length;H++){const J=Am(L[H]),te=[];for(let ie=0;ie<J.length;ie++){const le=J[ie],ye=J[ie-1],se=J[ie+1],fe=ie===0?new M(0,0):le.sub(ye)._unit()._perp(),Se=ie===J.length-1?new M(0,0):se.sub(le)._unit()._perp(),Ie=fe._add(Se)._unit(),We=Ie.x*Se.x+Ie.y*Se.y;We!==0&&Ie._mult(1/We),te.push(Ie._mult(N)._add(le))}$.push(te)}return $})(p,z*b)),(function(L,N,$){for(let H=0;H<N.length;H++){const J=N[H];if(L.length>=3){for(let te=0;te<J.length;te++)if(Wl(L,J[te]))return!0}if(Ni(L,J,$))return!0}return!1})(E,p,P)}isTileClipped(){return!0}}function yd(s,r){return r>0?r+2*s:s}const Sy=Rn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fs=Rn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Rn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const D_=Rn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Rn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Mo=Rn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),O_=Rn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function I_(s,r,a){return s.sections.forEach((f=>{f.text=(function(p,x,b){const E=x.layout.get("text-transform").evaluate(b,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),So.applyArabicShaping&&(p=So.applyArabicShaping(p)),p})(f.text,r,a)})),s}Rn([{name:"triangle",components:3,type:"Uint16"}]),Rn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Rn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Rn([{type:"Float32",name:"offsetX"}]),Rn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Rn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Fi=24;const Bs={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Gm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ty={40:!0};function Gh(s,r,a,f,p,x){if("fontStack"in r){const b=a[r.fontStack],E=b&&b[s];return E?E.metrics.advance*r.scale+p:0}{const b=f[r.imageName];return b?b.displaySize[0]*r.scale*Fi/x+p:0}}function Ey(s,r,a,f){const p=Math.pow(s-r,2);return f?s<r?p/2:2*p:p+Math.abs(a)*a}function z_(s,r,a){let f=0;return s===10&&(f-=1e4),a&&(f+=150),s!==40&&s!==65288||(f+=50),r!==41&&r!==65289||(f+=50),f}function Ay(s,r,a,f,p,x){let b=null,E=Ey(r,a,p,x);for(const P of f){const z=Ey(r-P.x,a,p,x)+P.badness;z<=E&&(b=P,E=z)}return{index:s,x:r,priorBreak:b,badness:E}}function My(s){return s?My(s.priorBreak).concat(s.index):[]}class Hu{constructor(r="",a=[],f=[]){this.text=r,this.sections=a,this.sectionIndex=f,this.imageSectionID=null}static fromFeature(r,a){const f=new Hu;for(let p=0;p<r.sections.length;p++){const x=r.sections[p];x.image?f.addImageSection(x):f.addTextSection(x,a)}return f}length(){return[...this.text].length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}verticalizePunctuation(){this.text=(function(r){let a="",f={premature:!0,value:void 0};const p=r[Symbol.iterator]();let x=p.next();const b=r[Symbol.iterator]();b.next();let E=b.next();for(;!x.done;)a+=!E.done&&zs(E.value.codePointAt(0))&&!Bs[E.value]||!f.premature&&zs(f.value.codePointAt(0))&&!Bs[f.value]||!Bs[x.value]?x.value:Bs[x.value],f={value:x.value,premature:!1},x=p.next(),E=b.next();return a})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const r=this.text.match(/^\s*/),a=r?r[0].length:0,f=this.text.match(/\S\s*$/),p=f?f[0].length-1:0;this.text=this.text.substring(a,this.text.length-p),this.sectionIndex=this.sectionIndex.slice(a,this.sectionIndex.length-p)}substring(r,a){const f=[...this.text].slice(r,a).join(""),p=this.sectionIndex.slice(r,a);return new Hu(f,this.sections,p)}toCodeUnitIndex(r){return[...this.text].slice(0,r).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,a)=>Math.max(r,this.sections[a].scale)),0)}getMaxImageSize(r){let a=0,f=0;for(let p=0;p<this.length();p++){const x=this.getSection(p);if("imageName"in x){const b=r[x.imageName];if(!b)continue;const E=b.displaySize;a=Math.max(a,E[0]),f=Math.max(f,E[1])}}return{maxImageWidth:a,maxImageHeight:f}}addTextSection(r,a){this.text+=r.text,this.sections.push({scale:r.scale||1,verticalAlign:r.verticalAlign||"bottom",fontStack:r.fontStack||a});const f=this.sections.length-1;this.sectionIndex.push(...[...r.text].map((()=>f)))}addImageSection(r){const a=r.image?r.image.name:"";if(a.length===0)return void fr("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push({scale:1,verticalAlign:r.verticalAlign||"bottom",imageName:a}),this.sectionIndex.push(this.sections.length-1)):fr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(r,a,f,p,x){const b=[],E=this.determineAverageLineWidth(r,a,f,p,x),P=this.hasZeroWidthSpaces();let z=0,L=0;const N=this.text[Symbol.iterator]();let $=N.next();const H=this.text[Symbol.iterator]();H.next();let J=H.next();const te=this.text[Symbol.iterator]();te.next(),te.next();let ie=te.next();for(;!$.done;){const le=this.getSection(L),ye=$.value.codePointAt(0);if(Oh(ye)||(z+=Gh(ye,le,f,p,r,x)),!J.done){const se=Ac(ye),fe=J.value.codePointAt(0);(Gm[ye]||se||"imageName"in le||!ie.done&&Ty[fe])&&b.push(Ay(L+1,z,E,b,z_(ye,fe,se&&P),!1))}L++,$=N.next(),J=H.next(),ie=te.next()}return My(Ay(this.length(),z,E,b,0,!0))}determineAverageLineWidth(r,a,f,p,x){let b=0,E=0;for(const P of this.text){const z=this.getSection(E);b+=Gh(P.codePointAt(0),z,f,p,r,x),E++}return b/Math.max(1,Math.ceil(b/a))}}const xp=4294967296,k_=1/xp,R_=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Zm{constructor(r=new Uint8Array(16)){this.buf=ArrayBuffer.isView(r)?r:new Uint8Array(r),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(r,a,f=this.length){for(;this.pos<f;){const p=this.readVarint(),x=p>>3,b=this.pos;this.type=7&p,r(x,a,this),this.pos===b&&this.skip(p)}return a}readMessage(r,a){return this.readFields(r,a,this.readVarint()+this.pos)}readFixed32(){const r=this.dataView.getUint32(this.pos,!0);return this.pos+=4,r}readSFixed32(){const r=this.dataView.getInt32(this.pos,!0);return this.pos+=4,r}readFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*xp;return this.pos+=8,r}readSFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*xp;return this.pos+=8,r}readFloat(){const r=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,r}readDouble(){const r=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,r}readVarint(r){const a=this.buf;let f,p;return p=a[this.pos++],f=127&p,p<128?f:(p=a[this.pos++],f|=(127&p)<<7,p<128?f:(p=a[this.pos++],f|=(127&p)<<14,p<128?f:(p=a[this.pos++],f|=(127&p)<<21,p<128?f:(p=a[this.pos],f|=(15&p)<<28,(function(x,b,E){const P=E.buf;let z,L;if(L=P[E.pos++],z=(112&L)>>4,L<128||(L=P[E.pos++],z|=(127&L)<<3,L<128)||(L=P[E.pos++],z|=(127&L)<<10,L<128)||(L=P[E.pos++],z|=(127&L)<<17,L<128)||(L=P[E.pos++],z|=(127&L)<<24,L<128)||(L=P[E.pos++],z|=(1&L)<<31,L<128))return Zh(x,z,b);throw new Error("Expected varint not more than 10 bytes")})(f,r,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const r=this.readVarint();return r%2==1?(r+1)/-2:r/2}readBoolean(){return!!this.readVarint()}readString(){const r=this.readVarint()+this.pos,a=this.pos;return this.pos=r,r-a>=12&&R_?R_.decode(this.buf.subarray(a,r)):(function(f,p,x){let b="",E=p;for(;E<x;){const P=f[E];let z,L,N,$=null,H=P>239?4:P>223?3:P>191?2:1;if(E+H>x)break;H===1?P<128&&($=P):H===2?(z=f[E+1],(192&z)==128&&($=(31&P)<<6|63&z,$<=127&&($=null))):H===3?(z=f[E+1],L=f[E+2],(192&z)==128&&(192&L)==128&&($=(15&P)<<12|(63&z)<<6|63&L,($<=2047||$>=55296&&$<=57343)&&($=null))):H===4&&(z=f[E+1],L=f[E+2],N=f[E+3],(192&z)==128&&(192&L)==128&&(192&N)==128&&($=(15&P)<<18|(63&z)<<12|(63&L)<<6|63&N,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,H=1):$>65535&&($-=65536,b+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),b+=String.fromCharCode($),E+=H}return b})(this.buf,a,r)}readBytes(){const r=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,r);return this.pos=r,a}readPackedVarint(r=[],a){const f=this.readPackedEnd();for(;this.pos<f;)r.push(this.readVarint(a));return r}readPackedSVarint(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readSVarint());return r}readPackedBoolean(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readBoolean());return r}readPackedFloat(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readFloat());return r}readPackedDouble(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readDouble());return r}readPackedFixed32(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readFixed32());return r}readPackedSFixed32(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readSFixed32());return r}readPackedFixed64(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readFixed64());return r}readPackedSFixed64(r=[]){const a=this.readPackedEnd();for(;this.pos<a;)r.push(this.readSFixed64());return r}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(r){const a=7&r;if(a===0)for(;this.buf[this.pos++]>127;);else if(a===2)this.pos=this.readVarint()+this.pos;else if(a===5)this.pos+=4;else{if(a!==1)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(r,a){this.writeVarint(r<<3|a)}realloc(r){let a=this.length||16;for(;a<this.pos+r;)a*=2;if(a!==this.length){const f=new Uint8Array(a);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeSFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*k_),!0),this.pos+=8}writeSFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*k_),!0),this.pos+=8}writeVarint(r){(r=+r||0)>268435455||r<0?(function(a,f){let p,x;if(a>=0?(p=a%4294967296|0,x=a/4294967296|0):(p=~(-a%4294967296),x=~(-a/4294967296),4294967295^p?p=p+1|0:(p=0,x=x+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),(function(b,E,P){P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,P.buf[P.pos]=127&(b>>>=7)})(p,0,f),(function(b,E){const P=(7&b)<<4;E.buf[E.pos++]|=P|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))})(x,f)})(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))}writeSVarint(r){this.writeVarint(r<0?2*-r-1:2*r)}writeBoolean(r){this.writeVarint(+r)}writeString(r){r=String(r),this.realloc(4*r.length),this.pos++;const a=this.pos;this.pos=(function(p,x,b){for(let E,P,z=0;z<x.length;z++){if(E=x.charCodeAt(z),E>55295&&E<57344){if(!P){E>56319||z+1===x.length?(p[b++]=239,p[b++]=191,p[b++]=189):P=E;continue}if(E<56320){p[b++]=239,p[b++]=191,p[b++]=189,P=E;continue}E=P-55296<<10|E-56320|65536,P=null}else P&&(p[b++]=239,p[b++]=191,p[b++]=189,P=null);E<128?p[b++]=E:(E<2048?p[b++]=E>>6|192:(E<65536?p[b++]=E>>12|224:(p[b++]=E>>18|240,p[b++]=E>>12&63|128),p[b++]=E>>6&63|128),p[b++]=63&E|128)}return b})(this.buf,r,this.pos);const f=this.pos-a;f>=128&&Py(a,f,this),this.pos=a-1,this.writeVarint(f),this.pos+=f}writeFloat(r){this.realloc(4),this.dataView.setFloat32(this.pos,r,!0),this.pos+=4}writeDouble(r){this.realloc(8),this.dataView.setFloat64(this.pos,r,!0),this.pos+=8}writeBytes(r){const a=r.length;this.writeVarint(a),this.realloc(a);for(let f=0;f<a;f++)this.buf[this.pos++]=r[f]}writeRawMessage(r,a){this.pos++;const f=this.pos;r(a,this);const p=this.pos-f;p>=128&&Py(f,p,this),this.pos=f-1,this.writeVarint(p),this.pos+=p}writeMessage(r,a,f){this.writeTag(r,2),this.writeRawMessage(a,f)}writePackedVarint(r,a){a.length&&this.writeMessage(r,vd,a)}writePackedSVarint(r,a){a.length&&this.writeMessage(r,Hm,a)}writePackedBoolean(r,a){a.length&&this.writeMessage(r,N_,a)}writePackedFloat(r,a){a.length&&this.writeMessage(r,j_,a)}writePackedDouble(r,a){a.length&&this.writeMessage(r,L_,a)}writePackedFixed32(r,a){a.length&&this.writeMessage(r,B_,a)}writePackedSFixed32(r,a){a.length&&this.writeMessage(r,F_,a)}writePackedFixed64(r,a){a.length&&this.writeMessage(r,U_,a)}writePackedSFixed64(r,a){a.length&&this.writeMessage(r,Wm,a)}writeBytesField(r,a){this.writeTag(r,2),this.writeBytes(a)}writeFixed32Field(r,a){this.writeTag(r,5),this.writeFixed32(a)}writeSFixed32Field(r,a){this.writeTag(r,5),this.writeSFixed32(a)}writeFixed64Field(r,a){this.writeTag(r,1),this.writeFixed64(a)}writeSFixed64Field(r,a){this.writeTag(r,1),this.writeSFixed64(a)}writeVarintField(r,a){this.writeTag(r,0),this.writeVarint(a)}writeSVarintField(r,a){this.writeTag(r,0),this.writeSVarint(a)}writeStringField(r,a){this.writeTag(r,2),this.writeString(a)}writeFloatField(r,a){this.writeTag(r,5),this.writeFloat(a)}writeDoubleField(r,a){this.writeTag(r,1),this.writeDouble(a)}writeBooleanField(r,a){this.writeVarintField(r,+a)}}function Zh(s,r,a){return a?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function Py(s,r,a){const f=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(f);for(let p=a.pos-1;p>=s;p--)a.buf[p+f]=a.buf[p]}function vd(s,r){for(let a=0;a<s.length;a++)r.writeVarint(s[a])}function Hm(s,r){for(let a=0;a<s.length;a++)r.writeSVarint(s[a])}function j_(s,r){for(let a=0;a<s.length;a++)r.writeFloat(s[a])}function L_(s,r){for(let a=0;a<s.length;a++)r.writeDouble(s[a])}function N_(s,r){for(let a=0;a<s.length;a++)r.writeBoolean(s[a])}function B_(s,r){for(let a=0;a<s.length;a++)r.writeFixed32(s[a])}function F_(s,r){for(let a=0;a<s.length;a++)r.writeSFixed32(s[a])}function U_(s,r){for(let a=0;a<s.length;a++)r.writeFixed64(s[a])}function Wm(s,r){for(let a=0;a<s.length;a++)r.writeSFixed64(s[a])}function V_(s,r,a){s===1&&a.readMessage(q_,r)}function q_(s,r,a){if(s===3){const{id:f,bitmap:p,width:x,height:b,left:E,top:P,advance:z}=a.readMessage(An,{});r.push({id:f,bitmap:new gp({width:x+6,height:b+6},p),metrics:{width:x,height:b,left:E,top:P,advance:z}})}}function An(s,r,a){s===1?r.id=a.readVarint():s===2?r.bitmap=a.readBytes():s===3?r.width=a.readVarint():s===4?r.height=a.readVarint():s===5?r.left=a.readSVarint():s===6?r.top=a.readSVarint():s===7&&(r.advance=a.readVarint())}function Ym(s){let r=0,a=0;for(const b of s)r+=b.w*b.h,a=Math.max(a,b.w);s.sort(((b,E)=>E.h-b.h));const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let p=0,x=0;for(const b of s)for(let E=f.length-1;E>=0;E--){const P=f[E];if(!(b.w>P.w||b.h>P.h)){if(b.x=P.x,b.y=P.y,x=Math.max(x,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===P.w&&b.h===P.h){const z=f.pop();z&&E<f.length&&(f[E]=z)}else b.h===P.h?(P.x+=b.w,P.w-=b.w):b.w===P.w?(P.y+=b.h,P.h-=b.h):(f.push({x:P.x+b.w,y:P.y,w:P.w-b.w,h:b.h}),P.y+=b.h,P.h-=b.h);break}}return{w:p,h:x,fill:r/(p*x)||0}}class Cy{constructor(r,{pixelRatio:a,version:f,stretchX:p,stretchY:x,content:b,textFitWidth:E,textFitHeight:P}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=p,this.stretchY=x,this.content=b,this.version=f,this.textFitWidth=E,this.textFitHeight=P}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Dy{constructor(r,a){const f={},p={};this.haveRenderCallbacks=[];const x=[];this.addImages(r,f,x),this.addImages(a,p,x);const{w:b,h:E}=Ym(x),P=new Wa({width:b||1,height:E||1});for(const z in r){const L=r[z],N=f[z].paddedRect;Wa.copy(L.data,P,{x:0,y:0},{x:N.x+1,y:N.y+1},L.data)}for(const z in a){const L=a[z],N=p[z].paddedRect,$=N.x+1,H=N.y+1,J=L.data.width,te=L.data.height;Wa.copy(L.data,P,{x:0,y:0},{x:$,y:H},L.data),Wa.copy(L.data,P,{x:0,y:te-1},{x:$,y:H-1},{width:J,height:1}),Wa.copy(L.data,P,{x:0,y:0},{x:$,y:H+te},{width:J,height:1}),Wa.copy(L.data,P,{x:J-1,y:0},{x:$-1,y:H},{width:1,height:te}),Wa.copy(L.data,P,{x:0,y:0},{x:$+J,y:H},{width:1,height:te})}this.image=P,this.iconPositions=f,this.patternPositions=p}addImages(r,a,f){for(const p in r){const x=r[p],b={x:0,y:0,w:x.data.width+2,h:x.data.height+2};f.push(b),a[p]=new Cy(b,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(r,a){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in r.updatedImages)this.patchUpdatedImage(this.iconPositions[f],r.getImage(f),a),this.patchUpdatedImage(this.patternPositions[f],r.getImage(f),a)}patchUpdatedImage(r,a,f){if(!r||!a||r.version===a.version)return;r.version=a.version;const[p,x]=r.tl;f.update(a.data,void 0,{x:p,y:x})}}var Bc;function Xm(s,r,a,f,p,x,b,E,P,z,L,N,$,H,J){const te=Hu.fromFeature(s,p);let ie;N===_.az.vertical&&te.verticalizePunctuation();let le=te.determineLineBreaks(z,x,r,f,H);const{processBidirectionalText:ye,processStyledBidirectionalText:se}=So;if(ye&&te.sections.length===1){ie=[],le=le.map((We=>te.toCodeUnitIndex(We)));const Ie=ye(te.toString(),le);for(const We of Ie){const ht=[...We].map((()=>0));ie.push(new Hu(We,te.sections,ht))}}else if(se){ie=[],le=le.map((dt=>te.toCodeUnitIndex(dt)));let Ie=0;const We=[];for(const dt of te.text)We.push(...Array(dt.length).fill(te.sectionIndex[Ie])),Ie++;const ht=se(te.text,We,le);for(const dt of ht){const St=[];let It="";for(const Mt of dt[0])St.push(dt[1][It.length]),It+=Mt;ie.push(new Hu(dt[0],te.sections,St))}}else ie=(function(Ie,We){const ht=[];let dt=0;for(const St of We)ht.push(Ie.substring(dt,St)),dt=St;return dt<Ie.length()&&ht.push(Ie.substring(dt,Ie.length())),ht})(te,le);const fe=[],Se={positionedLines:fe,text:te.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:N,iconsInText:!1,verticalizable:!1};return(function(Ie,We,ht,dt,St,It,Mt,mt,ot,$t,Ht,ar){let Xt=0,Ar=0,Qn=0,Ui=0;const Qa=mt==="right"?1:mt==="left"?0:.5,iu=Fi/ar;let $o=0;for(const bi of St){bi.trim();const Pa=bi.getMaxScale(),Po={positionedGlyphs:[],lineOffset:0};Ie.positionedLines[$o]=Po;const Co=Po.positionedGlyphs;let ps=0;if(!bi.length()){Ar+=It,++$o;continue}const eo=Km(dt,bi,iu);let ms=0;for(const ha of bi.text){const si=bi.getSection(ms),Vi=ha.codePointAt(0),pi=Iy(ot,Ht,Vi),fa={glyph:Vi,imageName:null,x:Xt,y:Ar+-17,vertical:pi,scale:1,fontStack:"",sectionIndex:bi.getSectionIndex(ms),metrics:null,rect:null};let tf;if("fontStack"in si){if(tf=Qm(si,Vi,pi,eo,We,ht),!tf)continue;fa.fontStack=si.fontStack}else{if(Ie.iconsInText=!0,si.scale*=iu,tf=zy(si,pi,Pa,eo,dt),!tf)continue;ps=Math.max(ps,tf.imageOffset),fa.imageName=si.imageName}const{rect:Qu,metrics:ov,baselineOffset:zd}=tf;fa.y+=zd,fa.scale=si.scale,fa.metrics=ov,fa.rect=Qu,Co.push(fa),pi?(Ie.verticalizable=!0,Xt+=("imageName"in si?ov.advance:Fi)*si.scale+$t):Xt+=ov.advance*si.scale+$t,ms++}Co.length!==0&&(Qn=Math.max(Xt-$t,Qn),Fc(Co,0,Co.length-1,Qa)),Xt=0,Po.lineOffset=Math.max(ps,(Pa-1)*Fi);const au=It*Pa+ps;Ar+=au,Ui=Math.max(au,Ui),++$o}const{horizontalAlign:Ma,verticalAlign:Ja}=Oy(Mt);(function(bi,Pa,Po,Co,ps,eo,ms,au,ha){const si=(Pa-Po)*ps;let Vi=0;Vi=eo!==ms?-au*Co- -17:-Co*ha*ms+.5*ms;for(const pi of bi)for(const fa of pi.positionedGlyphs)fa.x+=si,fa.y+=Vi})(Ie.positionedLines,Qa,Ma,Ja,Qn,Ui,It,Ar,St.length),Ie.top+=-Ja*Ar,Ie.bottom=Ie.top+Ar,Ie.left+=-Ma*Qn,Ie.right=Ie.left+Qn})(Se,r,a,f,ie,b,E,P,N,z,$,J),!(function(Ie){for(const We of Ie)if(We.positionedGlyphs.length!==0)return!1;return!0})(fe)&&Se}function Oy(s){let r=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function Km(s,r,a){const f=r.getMaxScale()*Fi,{maxImageWidth:p,maxImageHeight:x}=r.getMaxImageSize(s),b=Math.max(f,x*a);return{verticalLineContentWidth:Math.max(f,p*a),horizontalLineContentHeight:b}}function Hh(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function Iy(s,r,a){return!(s===_.az.horizontal||!r&&!os(a)||r&&(Oh(a)||(f=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function Qm(s,r,a,f,p,x){const b=x[s.fontStack],E=(function(z,L,N,$){if(z&&z.rect)return z;const H=L[N.fontStack],J=H&&H[$];return J?{rect:null,metrics:J.metrics}:null})(b&&b[r],p,s,r);if(E===null)return null;let P;if(a)P=f.verticalLineContentWidth-s.scale*Fi;else{const z=Hh(s.verticalAlign);P=(f.horizontalLineContentHeight-s.scale*Fi)*z}return{rect:E.rect,metrics:E.metrics,baselineOffset:P}}function zy(s,r,a,f,p){const x=p[s.imageName];if(!x)return null;const b=x.paddedRect,E=x.displaySize,P={width:E[0],height:E[1],left:1,top:-3,advance:r?E[1]:E[0]};let z;if(r)z=f.verticalLineContentWidth-E[1]*s.scale;else{const L=Hh(s.verticalAlign);z=(f.horizontalLineContentHeight-E[1]*s.scale)*L}return{rect:b,metrics:P,baselineOffset:z,imageOffset:(r?E[0]:E[1])*s.scale-Fi*a}}function Fc(s,r,a,f){if(f===0)return;const p=s[a],x=(s[a].x+p.metrics.advance*p.scale)*f;for(let b=r;b<=a;b++)s[b].x-=x}function tu(s,r,a){const{horizontalAlign:f,verticalAlign:p}=Oy(a),x=r[0]-s.displaySize[0]*f,b=r[1]-s.displaySize[1]*p;return{image:s,top:b,bottom:b+s.displaySize[1],left:x,right:x+s.displaySize[0]}}function _d(s){var r,a;let f=s.left,p=s.top,x=s.right-f,b=s.bottom-p;const E=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",P=(a=s.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",z=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(P==="proportional"){if(E==="stretchOnly"&&x/b<z||E==="proportional"){const L=Math.ceil(b*z);f*=L/x,x=L}}else if(E==="proportional"&&P==="stretchOnly"&&z!==0&&x/b>z){const L=Math.ceil(x/z);p*=L/b,b=L}return{x1:f,y1:p,x2:f+x,y2:p+b}}function $_(s,r,a,f,p,x){const b=s.image;let E;if(b.content){const ie=b.content,le=b.pixelRatio||1;E=[ie[0]/le,ie[1]/le,b.displaySize[0]-ie[2]/le,b.displaySize[1]-ie[3]/le]}const P=r.left*x,z=r.right*x;let L,N,$,H;a==="width"||a==="both"?(H=p[0]+P-f[3],N=p[0]+z+f[1]):(H=p[0]+(P+z-b.displaySize[0])/2,N=H+b.displaySize[0]);const J=r.top*x,te=r.bottom*x;return a==="height"||a==="both"?(L=p[1]+J-f[0],$=p[1]+te+f[2]):(L=p[1]+(J+te-b.displaySize[1])/2,$=L+b.displaySize[1]),{image:b,top:L,right:N,bottom:$,left:H,collisionPadding:E}}jt("ImagePosition",Cy),jt("ImageAtlas",Dy),_.az=void 0,(Bc=_.az||(_.az={}))[Bc.none=0]="none",Bc[Bc.horizontal=1]="horizontal",Bc[Bc.vertical=2]="vertical",Bc[Bc.horizontalOnly=3]="horizontalOnly";const ru=128,Wu=32640;function ky(s,r){const{expression:a}=r;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new ln(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:p}=a;let x=0;for(;x<f.length&&f[x]<=s;)x++;x=Math.max(0,x-1);let b=x;for(;b<f.length&&f[b]<s+1;)b++;b=Math.min(f.length-1,b);const E=f[x],P=f[b];return a.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:P,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:P,minSize:a.evaluate(new ln(E)),maxSize:a.evaluate(new ln(P)),interpolationType:p}}}function Jm(s,r,a){let f="never";const p=s.get(r);return p?f=p:s.get(a)&&(f="always"),f}const Bb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function xd(s,r,a,f,p,x,b,E,P,z,L,N,$){const H=E?Math.min(Wu,Math.round(E[0])):0,J=E?Math.min(Wu,Math.round(E[1])):0;s.emplaceBack(r,a,Math.round(32*f),Math.round(32*p),x,b,(H<<1)+(P?1:0),J,16*z,16*L,256*N,256*$)}function eg(s,r,a){s.emplaceBack(r.x,r.y,a),s.emplaceBack(r.x,r.y,a),s.emplaceBack(r.x,r.y,a),s.emplaceBack(r.x,r.y,a)}function G_(s){for(const r of s.sections)if(ks(r.text))return!0;return!1}class Ry{constructor(r){this.layoutVertexArray=new De,this.indexArray=new He,this.programConfigurations=r,this.segments=new ut,this.dynamicLayoutVertexArray=new we,this.opacityVertexArray=new Re,this.hasVisibleVertices=!1,this.placedSymbolArray=new T}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,a,f,p){this.isEmpty()||(f&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Sy.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,fs.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,Bb,!0),this.opacityVertexBuffer.itemSize=1),(f||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}jt("SymbolBuffers",Ry);class bp{constructor(r,a,f){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new f,this.segments=new ut,this.collisionVertexArray=new Ye}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,D_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}jt("CollisionBuffers",bp);class Uc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((b=>b.id)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ky(this.zoom,a["text-size"]),this.iconSizeData=ky(this.zoom,a["icon-size"]);const f=this.layers[0].layout,p=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=Jm(f,"text-overlap","text-allow-overlap")!=="never"||Jm(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map((b=>_.az[b]))),this.stateDependentLayerIds=this.layers.filter((b=>b.isStateDependent())).map((b=>b.id)),this.sourceID=r.sourceID}createArrays(){this.text=new Ry(new Zl(this.layers,this.zoom,(r=>/^text/.test(r)))),this.icon=new Ry(new Zl(this.layers,this.zoom,(r=>/^icon/.test(r)))),this.glyphOffsetArray=new R,this.lineVertexArray=new B,this.symbolInstances=new O,this.textAnchorOffsets=new X}calculateGlyphDependencies(r,a,f,p,x){for(const b of r)if(a[b.codePointAt(0)]=!0,(f||p)&&x){const E=Bs[b];E&&(a[E.codePointAt(0)]=!0)}}populate(r,a,f){const p=this.layers[0],x=p.layout,b=x.get("text-font"),E=x.get("text-field"),P=x.get("icon-image"),z=(E.value.kind!=="constant"||E.value.value instanceof xr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),L=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,N=x.get("symbol-sort-key");if(this.features=[],!z&&!L)return;const $=a.iconDependencies,H=a.glyphDependencies,J=a.availableImages,te=new ln(this.zoom);for(const{feature:ie,id:le,index:ye,sourceLayerIndex:se}of r){const fe=p._featureFilter.needGeometry,Se=cs(ie,fe);if(!p._featureFilter.filter(te,Se,f))continue;let Ie,We;if(fe||(Se.geometry=Ha(ie)),z){const dt=p.getValueAndResolveTokens("text-field",Se,f,J),St=xr.factory(dt),It=this.hasRTLText=this.hasRTLText||G_(St);(!It||So.getRTLTextPluginStatus()==="unavailable"||It&&So.isParsed())&&(Ie=I_(St,p,Se))}if(L){const dt=p.getValueAndResolveTokens("icon-image",Se,f,J);We=dt instanceof ki?dt:ki.fromString(dt)}if(!Ie&&!We)continue;const ht=this.sortFeaturesByKey?N.evaluate(Se,{},f):void 0;if(this.features.push({id:le,text:Ie,icon:We,index:ye,sourceLayerIndex:se,geometry:Se.geometry,properties:ie.properties,type:_p.types[ie.type],sortKey:ht}),We&&($[We.name]=!0),Ie){const dt=b.evaluate(Se,{},f).join(","),St=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_.az.vertical)>=0;for(const It of Ie.sections)if(It.image)$[It.image.name]=!0;else{const Mt=Cu(Ie.toString()),mt=It.fontStack||dt,ot=H[mt]=H[mt]||{};this.calculateGlyphDependencies(It.text,ot,St,this.allowVerticalPlacement,Mt)}}}x.get("symbol-placement")==="line"&&(this.features=(function(ie){const le={},ye={},se=[];let fe=0;function Se(dt){se.push(ie[dt]),fe++}function Ie(dt,St,It){const Mt=ye[dt];return delete ye[dt],ye[St]=Mt,se[Mt].geometry[0].pop(),se[Mt].geometry[0]=se[Mt].geometry[0].concat(It[0]),Mt}function We(dt,St,It){const Mt=le[St];return delete le[St],le[dt]=Mt,se[Mt].geometry[0].shift(),se[Mt].geometry[0]=It[0].concat(se[Mt].geometry[0]),Mt}function ht(dt,St,It){const Mt=It?St[0][St[0].length-1]:St[0][0];return`${dt}:${Mt.x}:${Mt.y}`}for(let dt=0;dt<ie.length;dt++){const St=ie[dt],It=St.geometry,Mt=St.text?St.text.toString():null;if(!Mt){Se(dt);continue}const mt=ht(Mt,It),ot=ht(Mt,It,!0);if(mt in ye&&ot in le&&ye[mt]!==le[ot]){const $t=We(mt,ot,It),Ht=Ie(mt,ot,se[$t].geometry);delete le[mt],delete ye[ot],ye[ht(Mt,se[Ht].geometry,!0)]=Ht,se[$t].geometry=null}else mt in ye?Ie(mt,ot,It):ot in le?We(mt,ot,It):(Se(dt),le[mt]=fe-1,ye[ot]=fe-1)}return se.filter((dt=>dt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ie,le)=>ie.sortKey-le.sortKey))}update(r,a,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,{imagePositions:f}),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,{imagePositions:f}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const f=this.lineVertexArray.length;if(r.segment!==void 0){let p=r.dist(a[r.segment+1]),x=r.dist(a[r.segment]);const b={};for(let E=r.segment+1;E<a.length;E++)b[E]={x:a[E].x,y:a[E].y,tileUnitDistanceFromAnchor:p},E<a.length-1&&(p+=a[E+1].dist(a[E]));for(let E=r.segment||0;E>=0;E--)b[E]={x:a[E].x,y:a[E].y,tileUnitDistanceFromAnchor:x},E>0&&(x+=a[E-1].dist(a[E]));for(let E=0;E<a.length;E++){const P=b[E];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(r,a,f,p,x,b,E,P,z,L,N,$){const H=r.indexArray,J=r.layoutVertexArray,te=r.segments.prepareSegment(4*a.length,J,H,this.canOverlap?b.sortKey:void 0),ie=this.glyphOffsetArray.length,le=te.vertexLength,ye=this.allowVerticalPlacement&&E===_.az.vertical?Math.PI/2:0,se=b.text&&b.text.sections;for(let fe=0;fe<a.length;fe++){const{tl:Se,tr:Ie,bl:We,br:ht,tex:dt,pixelOffsetTL:St,pixelOffsetBR:It,minFontScaleX:Mt,minFontScaleY:mt,glyphOffset:ot,isSDF:$t,sectionIndex:Ht}=a[fe],ar=te.vertexLength,Xt=ot[1];xd(J,P.x,P.y,Se.x,Xt+Se.y,dt.x,dt.y,f,$t,St.x,St.y,Mt,mt),xd(J,P.x,P.y,Ie.x,Xt+Ie.y,dt.x+dt.w,dt.y,f,$t,It.x,St.y,Mt,mt),xd(J,P.x,P.y,We.x,Xt+We.y,dt.x,dt.y+dt.h,f,$t,St.x,It.y,Mt,mt),xd(J,P.x,P.y,ht.x,Xt+ht.y,dt.x+dt.w,dt.y+dt.h,f,$t,It.x,It.y,Mt,mt),eg(r.dynamicLayoutVertexArray,P,ye),H.emplaceBack(ar,ar+2,ar+1),H.emplaceBack(ar+1,ar+2,ar+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ot[0]),fe!==a.length-1&&Ht===a[fe+1].sectionIndex||r.programConfigurations.populatePaintArrays(J.length,b,b.index,{imagePositions:{},canonical:$,formattedSection:se&&se[Ht]})}r.placedSymbolArray.emplaceBack(P.x,P.y,ie,this.glyphOffsetArray.length-ie,le,z,L,P.segment,f?f[0]:0,f?f[1]:0,p[0],p[1],E,0,!1,0,N)}_addCollisionDebugVertex(r,a,f,p,x,b){return a.emplaceBack(0,0),r.emplaceBack(f.x,f.y,p,x,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(r,a,f,p,x,b,E){const P=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),z=P.vertexLength,L=x.layoutVertexArray,N=x.collisionVertexArray,$=E.anchorX,H=E.anchorY;this._addCollisionDebugVertex(L,N,b,$,H,new M(r,a)),this._addCollisionDebugVertex(L,N,b,$,H,new M(f,a)),this._addCollisionDebugVertex(L,N,b,$,H,new M(f,p)),this._addCollisionDebugVertex(L,N,b,$,H,new M(r,p)),P.vertexLength+=4;const J=x.indexArray;J.emplaceBack(z,z+1),J.emplaceBack(z+1,z+2),J.emplaceBack(z+2,z+3),J.emplaceBack(z+3,z),P.primitiveLength+=4}addDebugCollisionBoxes(r,a,f,p){for(let x=r;x<a;x++){const b=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,p?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bp(Qe,Mo.members,Je),this.iconCollisionBox=new bp(Qe,Mo.members,Je);for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(r,a,f,p,x,b,E,P,z){const L={};for(let N=a;N<f;N++){const $=r.get(N);L.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.textFeatureIndex=$.featureIndex;break}for(let N=p;N<x;N++){const $=r.get(N);L.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalTextFeatureIndex=$.featureIndex;break}for(let N=b;N<E;N++){const $=r.get(N);L.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.iconFeatureIndex=$.featureIndex;break}for(let N=P;N<z;N++){const $=r.get(N);L.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalIconFeatureIndex=$.featureIndex;break}return L}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const f=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const f=r.placedSymbolArray.get(a),p=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<p;x+=4)r.indexArray.emplaceBack(x,x+2,x+1),r.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(r),f=Math.cos(r),p=[],x=[],b=[];for(let E=0;E<this.symbolInstances.length;++E){b.push(E);const P=this.symbolInstances.get(E);p.push(0|Math.round(a*P.anchorX+f*P.anchorY)),x.push(P.featureIndex)}return b.sort(((E,P)=>p[E]-p[P]||x[P]-x[E])),b}addToSortKeyRanges(r,a){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===a?f.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const f=this.symbolInstances.get(a);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(((p,x,b)=>{p>=0&&b.indexOf(p)===x&&this.addIndicesForPlacedSymbol(this.text,p)})),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Z_,H_;jt("SymbolBucket",Uc,{omit:["layers","collisionBoxArray","features","compareText"]}),Uc.MAX_GLYPHS=65535,Uc.addDynamicAttributes=eg;var Wh={get paint(){return H_=H_||new ai({"icon-opacity":new Kt(Me.paint_symbol["icon-opacity"]),"icon-color":new Kt(Me.paint_symbol["icon-color"]),"icon-halo-color":new Kt(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kt(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kt(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new Bt(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new Bt(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new Kt(Me.paint_symbol["text-opacity"]),"text-color":new Kt(Me.paint_symbol["text-color"],{runtimeType:Ra,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Kt(Me.paint_symbol["text-halo-color"]),"text-halo-width":new Kt(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new Kt(Me.paint_symbol["text-halo-blur"]),"text-translate":new Bt(Me.paint_symbol["text-translate"]),"text-translate-anchor":new Bt(Me.paint_symbol["text-translate-anchor"])})},get layout(){return Z_=Z_||new ai({"symbol-placement":new Bt(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new Bt(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Bt(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kt(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Bt(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Bt(Me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Bt(Me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Bt(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new Bt(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Bt(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kt(Me.layout_symbol["icon-size"]),"icon-text-fit":new Bt(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Bt(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kt(Me.layout_symbol["icon-image"]),"icon-rotate":new Kt(Me.layout_symbol["icon-rotate"]),"icon-padding":new Kt(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new Bt(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new Kt(Me.layout_symbol["icon-offset"]),"icon-anchor":new Kt(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Bt(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Bt(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Bt(Me.layout_symbol["text-rotation-alignment"]),"text-field":new Kt(Me.layout_symbol["text-field"]),"text-font":new Kt(Me.layout_symbol["text-font"]),"text-size":new Kt(Me.layout_symbol["text-size"]),"text-max-width":new Kt(Me.layout_symbol["text-max-width"]),"text-line-height":new Bt(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new Kt(Me.layout_symbol["text-letter-spacing"]),"text-justify":new Kt(Me.layout_symbol["text-justify"]),"text-radial-offset":new Kt(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Bt(Me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Kt(Me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Kt(Me.layout_symbol["text-anchor"]),"text-max-angle":new Bt(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new Bt(Me.layout_symbol["text-writing-mode"]),"text-rotate":new Kt(Me.layout_symbol["text-rotate"]),"text-padding":new Bt(Me.layout_symbol["text-padding"]),"text-keep-upright":new Bt(Me.layout_symbol["text-keep-upright"]),"text-transform":new Kt(Me.layout_symbol["text-transform"]),"text-offset":new Kt(Me.layout_symbol["text-offset"]),"text-allow-overlap":new Bt(Me.layout_symbol["text-allow-overlap"]),"text-overlap":new Bt(Me.layout_symbol["text-overlap"]),"text-ignore-placement":new Bt(Me.layout_symbol["text-ignore-placement"]),"text-optional":new Bt(Me.layout_symbol["text-optional"])})}};class W_{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Cn,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jt("FormatSectionOverride",W_,{omit:["defaultValue"]});class wp extends Hn{constructor(r,a){super(r,Wh,a)}recalculate(r,a){if(super.recalculate(r,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const p=[];for(const x of f)p.indexOf(x)<0&&p.push(x);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,a,f,p){const x=this.layout.get(r).evaluate(a,{},f,p),b=this._unevaluatedLayout._values[r];return b.isDataDriven()||bc(b.value)||!x?x:(function(E,P){return P.replace(/{([^{}]+)}/g,((z,L)=>E&&L in E?String(E[L]):""))})(a.properties,x)}createBucket(r){return new Uc(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Wh.paint.overridableProperties){if(!wp.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),f=new W_(a),p=new Zf(f,a.property.specification);let x=null;x=a.value.kind==="constant"||a.value.kind==="source"?new Sa("source",p):new jl("composite",p,a.value.zoomStops),this.paint._values[r]=new To(a.property,x,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,f){return!(!this.layout||a.isDataDriven()||f.isDataDriven())&&wp.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const f=r.get("text-field"),p=Wh.paint.properties[a];let x=!1;const b=E=>{for(const P of E)if(p.overrides&&p.overrides.hasOverride(P))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof xr)b(f.value.value.sections);else if(f.value.kind==="source"||f.value.kind==="composite"){const E=z=>{x||(z instanceof gi&&Zr(z.value)===ja?b(z.value.sections):z instanceof If?b(z.sections):z.eachChild(E))},P=f.value;P._styleExpression&&E(P._styleExpression.expression)}return x}}let Fr;var jy={get paint(){return Fr=Fr||new ai({"background-color":new Bt(Me.paint_background["background-color"]),"background-pattern":new rd(Me.paint_background["background-pattern"]),"background-opacity":new Bt(Me.paint_background["background-opacity"])})}};class tg extends Hn{constructor(r,a){super(r,jy,a)}}class Ly extends Hn{constructor(r,a){super(r,{},a),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Y_{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ny={once:!0},Yh=63710088e-1;class dl{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new dl(Vt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,f=this.lat*a,p=r.lat*a,x=Math.sin(f)*Math.sin(p)+Math.cos(f)*Math.cos(p)*Math.cos((r.lng-this.lng)*a);return Yh*Math.acos(Math.min(x,1))}static convert(r){if(r instanceof dl)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new dl(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new dl(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const X_=2*Math.PI*Yh;function By(s){return X_*Math.cos(s*Math.PI/180)}function K_(s){return(180+s)/360}function Q_(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Fy(s,r){return s/By(r)}function Uy(s){return 360*s-180}function mn(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function rg(s,r){return s*By(mn(r))}class Ii{constructor(r,a,f=0){this.x=+r,this.y=+a,this.z=+f}static fromLngLat(r,a=0){const f=dl.convert(r);return new Ii(K_(f.lng),Q_(f.lat),Fy(a,f.lat))}toLngLat(){return new dl(Uy(this.x),mn(this.y))}toAltitude(){return rg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/X_*(r=mn(this.y),1/Math.cos(r*Math.PI/180));var r}}function J_(s,r,a){var f=2*Math.PI*6378137/256/Math.pow(2,a);return[s*f-2*Math.PI*6378137/2,r*f-2*Math.PI*6378137/2]}class ng{constructor(r,a,f){if(!(function(p,x,b){return!(p<0||p>25||b<0||b>=Math.pow(2,p)||x<0||x>=Math.pow(2,p))})(r,a,f))throw new Error(`x=${a}, y=${f}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=a,this.y=f,this.key=Vc(0,r,r,a,f)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a,f){const p=(b=this.y,E=this.z,P=J_(256*(x=this.x),256*(b=Math.pow(2,E)-b-1),E),z=J_(256*(x+1),256*(b+1),E),P[0]+","+P[1]+","+z[0]+","+z[1]);var x,b,E,P,z;const L=(function(N,$,H){let J,te="";for(let ie=N;ie>0;ie--)J=1<<ie-1,te+=($&J?1:0)+(H&J?2:0);return te})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,p)}isChildOf(r){const a=this.z-r.z;return a>0&&r.x===this.x>>a&&r.y===this.y>>a}getTilePoint(r){const a=Math.pow(2,this.z);return new M((r.x*a-this.x)*bt,(r.y*a-this.y)*bt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class e0{constructor(r,a){this.wrap=r,this.canonical=a,this.key=Vc(r,a.z,a.z,a.x,a.y)}}class Ya{constructor(r,a,f,p,x){if(this.terrainRttPosMatrix32f=null,r<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${f}`);this.overscaledZ=r,this.wrap=a,this.canonical=new ng(f,+p,+x),this.key=Vc(a,r,f,p,x)}clone(){return new Ya(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-r;return r>this.canonical.z?new Ya(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ya(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(r,a){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-r;return r>this.canonical.z?Vc(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y):Vc(this.wrap*+a,r,r,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(r){if(r.wrap!==this.wrap||this.overscaledZ-r.overscaledZ<=0)return!1;if(r.overscaledZ===0)return this.overscaledZ>0;const a=this.canonical.z-r.canonical.z;return!(a<0)&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,f=2*this.canonical.x,p=2*this.canonical.y;return[new Ya(a,this.wrap,a,f,p),new Ya(a,this.wrap,a,f+1,p),new Ya(a,this.wrap,a,f,p+1),new Ya(a,this.wrap,a,f+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ya(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new e0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Ii(r.x-this.wrap,r.y))}normalizeCoordinates(r,a,f=8192){if(r>=0&&r<f&&a>=0&&a<f)return{tileID:this,x:r,y:a};const p=Math.floor(r/f),x=Math.floor(a/f),b=r-p*f,E=a-x*f,P=this.canonical.z,z=1<<P,L=this.canonical.y+x;if(L<0||L>=z)return null;let N=this.canonical.x+p,$=this.wrap;return N<0?($-=Math.ceil(-N/z),N=(N%z+z)%z):N>=z&&($+=Math.floor(N/z),N%=z),{tileID:new Ya(this.overscaledZ,$,P,N,L),x:b,y:E}}}function Vc(s,r,a,f,p){(s*=2)<0&&(s=-1*s-1);const x=1<<a;return(x*x*s+x*p+f).toString(36)+a.toString(36)+r.toString(36)}function bd(s,r){return r?s.properties[r]:s.id}function t0(s,r){const a={id:s.id};if(r.removeAllProperties&&(delete s.removeProperties,delete s.addOrUpdateProperties,delete r.removeProperties),r.removeProperties)for(const f of r.removeProperties){const p=s.addOrUpdateProperties.findIndex((x=>x.key===f));p>-1&&s.addOrUpdateProperties.splice(p,1)}return(s.removeAllProperties||r.removeAllProperties)&&(a.removeAllProperties=!0),(s.removeProperties||r.removeProperties)&&(a.removeProperties=[...s.removeProperties||[],...r.removeProperties||[]]),(s.addOrUpdateProperties||r.addOrUpdateProperties)&&(a.addOrUpdateProperties=[...s.addOrUpdateProperties||[],...r.addOrUpdateProperties||[]]),(s.newGeometry||r.newGeometry)&&(a.newGeometry=r.newGeometry||s.newGeometry),a}function Vy(s){var r,a;if(!s)return{};const f={};return f.removeAll=s.removeAll,f.remove=new Set(s.remove||[]),f.add=new Map((r=s.add)===null||r===void 0?void 0:r.map((p=>[p.id,p]))),f.update=new Map((a=s.update)===null||a===void 0?void 0:a.map((p=>[p.id,p]))),f}jt("CanonicalTileID",ng),jt("OverscaledTileID",Ya,{omit:["terrainRttPosMatrix32f"]});class Yu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(r){return this.minX=Math.min(this.minX,r.x),this.minY=Math.min(this.minY,r.y),this.maxX=Math.max(this.maxX,r.x),this.maxY=Math.max(this.maxY,r.y),this}expandBy(r){return this.minX-=r,this.minY-=r,this.maxX+=r,this.maxY+=r,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(r){return this.expandBy(-r)}map(r){const a=new Yu;return a.extend(r(new M(this.minX,this.minY))),a.extend(r(new M(this.maxX,this.minY))),a.extend(r(new M(this.minX,this.maxY))),a.extend(r(new M(this.maxX,this.maxY))),a}static fromPoints(r){const a=new Yu;for(const f of r)a.extend(f);return a}contains(r){return r.x>=this.minX&&r.x<=this.maxX&&r.y>=this.minY&&r.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(r){return!this.empty()&&!r.empty()&&r.minX>=this.minX&&r.maxX<=this.maxX&&r.minY>=this.minY&&r.maxY<=this.maxY}intersects(r){return!this.empty()&&!r.empty()&&r.minX<=this.maxX&&r.maxX>=this.minX&&r.minY<=this.maxY&&r.maxY>=this.minY}}class ig{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const f=r[a];this._stringToNumber[f]=a,this._numberToString[a]=f}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class r0{constructor(r,a,f,p,x){this.type="Feature",this._vectorTileFeature=r,this._x=f,this._y=p,this._z=a,this.properties=r.properties,this.id=x}projectPoint(r,a,f,p){return[360*(r.x+a)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(r.y+f)/p)*Math.PI))-90]}projectLine(r,a,f,p){return r.map((x=>this.projectPoint(x,a,f,p)))}get geometry(){if(this._geometry)return this._geometry;const r=this._vectorTileFeature,a=r.extent*Math.pow(2,this._z),f=r.extent*this._x,p=r.extent*this._y,x=r.loadGeometry();switch(r.type){case 1:{const b=[];for(const P of x)b.push(P[0]);const E=this.projectLine(b,f,p,a);this._geometry=b.length===1?{type:"Point",coordinates:E[0]}:{type:"MultiPoint",coordinates:E};break}case 2:{const b=x.map((E=>this.projectLine(E,f,p,a)));this._geometry=b.length===1?{type:"LineString",coordinates:b[0]}:{type:"MultiLineString",coordinates:b};break}case 3:{const b=In(x),E=[];for(const P of b)E.push(P.map((z=>this.projectLine(z,f,p,a))));this._geometry=E.length===1?{type:"Polygon",coordinates:E[0]}:{type:"MultiPolygon",coordinates:E};break}default:throw new Error(`unknown feature type: ${r.type}`)}return this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&a!=="_x"&&a!=="_y"&&a!=="_z"&&(r[a]=this[a]);return r}}class Xh{_name;dataBuffer;nullabilityBuffer;_size;constructor(r,a,f){this._name=r,this.dataBuffer=a,typeof f=="number"?this._size=f:(this.nullabilityBuffer=f,this._size=f.size())}getValue(r){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(r)?null:this.getValueFromBuffer(r)}has(r){return this.nullabilityBuffer&&this.nullabilityBuffer.get(r)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class ag extends Xh{}class og extends ag{getValueFromBuffer(r){return this.dataBuffer[r]}}class qy extends ag{getValueFromBuffer(r){return this.dataBuffer[r]}}class n0 extends Xh{delta;constructor(r,a,f,p){super(r,a,p),this.delta=f}}class nu extends n0{constructor(r,a,f,p){super(r,Int32Array.of(a),f,p)}getValueFromBuffer(r){return this.dataBuffer[0]+r*this.delta}}class sg extends Xh{constructor(r,a,f){super(r,Int32Array.of(a),f)}getValueFromBuffer(r){return this.dataBuffer[0]}}class i0{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(r,a,f,p,x=4096){this._name=r,this._geometryVector=a,this._idVector=f,this._propertyVectors=p,this._extent=x}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(r){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((a=>[a.name,a])))),this.propertyVectorsMap.get(r)}*[Symbol.iterator](){const r=this.geometryVector[Symbol.iterator]();let a=0;for(;a<this.numFeatures;){let f;this.idVector&&(f=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(a)):this.idVector.getValue(a));const p=r?.next().value,x={};for(const b of this.propertyVectors){if(!b)continue;const E=b.name,P=b.getValue(a);P!==null&&(x[E]=P)}a++,yield{id:f,geometry:p,properties:x}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const r=[],a=this.geometryVector.getGeometries();for(let f=0;f<this.numFeatures;f++){let p;this.idVector&&(p=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(f)):this.idVector.getValue(f));const x={coordinates:a[f],type:this.geometryVector.geometryType(f)},b={};for(const E of this.propertyVectors){if(!E)continue;const P=E.name,z=E.getValue(f);z!==null&&(b[P]=z)}r.push({id:p,geometry:x,properties:b})}return r}containsMaxSaveIntegerValues(r){return r instanceof og||r instanceof sg&&r instanceof nu||r instanceof qy}}class $y{value;constructor(r){this.value=r}get(){return this.value}set(r){this.value=r}increment(){return this.value++}add(r){this.value+=r}}var cn,qc,Ji,ds,Xu,Vo,Kr,_i,Gy,qo;function ca(s,r,a){const f=new Int32Array(a);let p=0,x=r.get();for(let b=0;b<f.length;b++){let E=s[x++],P=127&E;E<128||(E=s[x++],P|=(127&E)<<7,E<128||(E=s[x++],P|=(127&E)<<14,E<128||(E=s[x++],P|=(127&E)<<21,E<128||(E=s[x++],P|=(15&E)<<28)))),f[p++]=P}return r.set(x),f}function Kh(s,r,a){const f=new BigInt64Array(a);for(let p=0;p<f.length;p++)f[p]=Fs(s,r);return f}function Fs(s,r){let a=0n,f=0,p=r.get();for(;p<s.length;){const x=s[p++];if(a|=BigInt(127&x)<<BigInt(f),!(128&x))break;if(f+=7,f>=64)throw new Error("Varint too long")}return r.set(p),a}function a0(s,r){let a,f;return f=s[r.get()],r.increment(),a=127&f,f<128?a:(f=s[r.get()],r.increment(),a|=(127&f)<<7,f<128?a:(f=s[r.get()],r.increment(),a|=(127&f)<<14,f<128?a:(f=s[r.get()],r.increment(),a|=(127&f)<<21,f<128?a:(f=s[r.get()],a|=(15&f)<<28,(function(p,x,b){let E,P;if(P=x[b.get()],b.increment(),E=(112&P)>>4,P<128||(P=x[b.get()],b.increment(),E|=(127&P)<<3,P<128)||(P=x[b.get()],b.increment(),E|=(127&P)<<10,P<128)||(P=x[b.get()],b.increment(),E|=(127&P)<<17,P<128)||(P=x[b.get()],b.increment(),E|=(127&P)<<24,P<128)||(P=x[b.get()],b.increment(),E|=(1&P)<<31,P<128))return 4294967296*E+(p>>>0);throw new Error("Expected varint not more than 10 bytes")})(a,s,r)))))}function zn(s){return s>>>1^-(1&s)}function xi(s){return s>>1n^-(1n&s)}function wd(s){return s%2==1?(s+1)/-2:s/2}function o0(s,r,a){if(a===void 0){a=0;for(let x=0;x<r;x++)a+=s[x]}const f=new Int32Array(a);let p=0;for(let x=0;x<r;x++){const b=s[x];f.fill(s[x+r],p,p+b),p+=b}return f}function Qh(s,r,a){if(a===void 0){a=0;for(let x=0;x<r;x++)a+=Number(s[x])}const f=new BigInt64Array(a);let p=0;for(let x=0;x<r;x++){const b=Number(s[x]);f.fill(s[x+r],p,p+b),p+=b}return f}function Zy(s,r,a){const f=new Float64Array(a);let p=0;for(let x=0;x<r;x++){const b=s[x];f.fill(s[x+r],p,p+b),p+=b}return f}function s0(s){const r=s.length/4*4;let a=1;if(r>=4)for(let f=s[0];a<r-4;a+=4)f=s[a]+=f,f=s[a+1]+=f,f=s[a+2]+=f,f=s[a+3]+=f;for(;a!=s.length;)s[a]+=s[a-1],++a}(function(s){s.NONE="NONE",s.DELTA="DELTA",s.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",s.RLE="RLE",s.MORTON="MORTON",s.PDE="PDE"})(cn||(cn={})),(function(s){s.NONE="NONE",s.FAST_PFOR="FAST_PFOR",s.VARINT="VARINT",s.ALP="ALP"})(qc||(qc={})),(function(s){s.PRESENT="PRESENT",s.DATA="DATA",s.OFFSET="OFFSET",s.LENGTH="LENGTH"})(Ji||(Ji={}));class Hy{_dictionaryType;_offsetType;_lengthType;constructor(r,a,f){this._dictionaryType=r,this._offsetType=a,this._lengthType=f}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Xa(s,r){const a=(function(f,p){const x=f[p.get()],b=Object.values(Ji)[x>>4];let E=null;switch(b){case Ji.DATA:E=new Hy(Object.values(ds)[15&x]);break;case Ji.OFFSET:E=new Hy(null,Object.values(Xu)[15&x]);break;case Ji.LENGTH:E=new Hy(null,null,Object.values(Vo)[15&x])}p.increment();const P=f[p.get()],z=Object.values(cn)[P>>5],L=Object.values(cn)[P>>2&7],N=Object.values(qc)[3&P];p.increment();const $=ca(f,p,2),H=$[0];return{physicalStreamType:b,logicalStreamType:E,logicalLevelTechnique1:z,logicalLevelTechnique2:L,physicalLevelTechnique:N,numValues:H,byteLength:$[1],decompressedCount:H}})(s,r);return a.logicalLevelTechnique1===cn.MORTON?(function(f,p,x){const b=ca(p,x,2);return{physicalStreamType:f.physicalStreamType,logicalStreamType:f.logicalStreamType,logicalLevelTechnique1:f.logicalLevelTechnique1,logicalLevelTechnique2:f.logicalLevelTechnique2,physicalLevelTechnique:f.physicalLevelTechnique,numValues:f.numValues,byteLength:f.byteLength,decompressedCount:f.decompressedCount,numBits:b[0],coordinateShift:b[1]}})(a,s,r):cn.RLE!==a.logicalLevelTechnique1&&cn.RLE!==a.logicalLevelTechnique2||qc.NONE===a.physicalLevelTechnique?a:(function(f,p,x){const b=ca(p,x,2);return{physicalStreamType:f.physicalStreamType,logicalStreamType:f.logicalStreamType,logicalLevelTechnique1:f.logicalLevelTechnique1,logicalLevelTechnique2:f.logicalLevelTechnique2,physicalLevelTechnique:f.physicalLevelTechnique,numValues:f.numValues,byteLength:f.byteLength,decompressedCount:b[1],runs:b[0],numRleValues:b[1]}})(a,s,r)}(function(s){s.NONE="NONE",s.SINGLE="SINGLE",s.SHARED="SHARED",s.VERTEX="VERTEX",s.MORTON="MORTON",s.FSST="FSST"})(ds||(ds={})),(function(s){s.VERTEX="VERTEX",s.INDEX="INDEX",s.STRING="STRING",s.KEY="KEY"})(Xu||(Xu={})),(function(s){s.VAR_BINARY="VAR_BINARY",s.GEOMETRIES="GEOMETRIES",s.PARTS="PARTS",s.RINGS="RINGS",s.TRIANGLES="TRIANGLES",s.SYMBOL="SYMBOL",s.DICTIONARY="DICTIONARY"})(Vo||(Vo={})),(function(s){s[s.FLAT=0]="FLAT",s[s.CONST=1]="CONST",s[s.SEQUENCE=2]="SEQUENCE",s[s.DICTIONARY=3]="DICTIONARY",s[s.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(Kr||(Kr={}));class pl{values;_size;constructor(r,a){this.values=r,this._size=a}get(r){const a=Math.floor(r/8);return(this.values[a]>>r%8&1)==1}set(r,a){const f=Math.floor(r/8);this.values[f]=this.values[f]|(a?1:0)<<r%8}getInt(r){const a=Math.floor(r/8);return this.values[a]>>r%8&1}size(){return this._size}getBuffer(){return this.values}}function lg(s,r,a){if(!r)return s;const f=r.size(),p=new s.constructor(f);let x=0;for(let b=0;b<f;b++)p[b]=r.get(b)?s[x++]:a;return p}function Ka(s,r,a,f,p,x){return(function(b,E,P,z,L){switch(E.logicalLevelTechnique1){case cn.DELTA:if(E.logicalLevelTechnique2===cn.RLE){const N=E;if(!L)return(function($,H,J){const te=new Int32Array(J);let ie=0,le=0;for(let ye=0;ye<H;ye++){const se=$[ye],fe=zn($[ye+H]);for(let Se=0;Se<se;Se++)le+=fe,te[ie++]=le}return te})(b,N.runs,N.numRleValues);b=o0(b,N.runs,N.numRleValues)}(function(N){N[0]=zn(N[0]);const $=N.length/4*4;let H=1;if($>=4)for(;H<$-4;H+=4){const J=N[H+1],te=N[H+2],ie=N[H+3];N[H]=zn(N[H])+N[H-1],N[H+1]=zn(J)+N[H],N[H+2]=zn(te)+N[H+1],N[H+3]=zn(ie)+N[H+2]}for(;H!=N.length;++H)N[H]=zn(N[H])+N[H-1]})(b);break;case cn.RLE:b=(function(N,$,H){return H?(function(J,te,ie){if(ie===void 0){ie=0;for(let se=0;se<te;se++)ie+=J[se]}const le=new Int32Array(ie);let ye=0;for(let se=0;se<te;se++){const fe=J[se];let Se=J[se+te];Se=zn(Se),le.fill(Se,ye,ye+fe),ye+=fe}return le})(N,$.runs,$.numRleValues):o0(N,$.runs,$.numRleValues)})(b,E,P);break;case cn.MORTON:s0(b);break;case cn.COMPONENTWISE_DELTA:(function(N){if(N.length<2)return;N[0]=zn(N[0]),N[1]=zn(N[1]);const $=N.length/4*4;let H=2;if($>=4)for(;H<$-4;H+=4){const J=N[H+1],te=N[H+2],ie=N[H+3];N[H]=zn(N[H])+N[H-2],N[H+1]=zn(J)+N[H-1],N[H+2]=zn(te)+N[H],N[H+3]=zn(ie)+N[H+1]}for(;H!=N.length;H+=2)N[H]=zn(N[H])+N[H-2],N[H+1]=zn(N[H+1])+N[H-1]})(b);break;case cn.NONE:P&&(function(N){for(let $=0;$<N.length;$++)N[$]=zn(N[$])})(b);break;default:throw new Error(`The specified Logical level technique is not supported: ${E.logicalLevelTechnique1}`)}return L?lg(b,L,0):b})(Sp(s,r,a),a,f,0,x)}function $c(s,r,a){return(function(f,p){if(p.logicalLevelTechnique1===cn.DELTA&&p.logicalLevelTechnique2===cn.NONE)return(function(x){const b=new Int32Array(x.length+1);b[0]=0,b[1]=zn(x[0]);let E=b[1];for(let P=2;P!=b.length;++P)E+=zn(x[P-1]),b[P]=b[P-1]+E;return new Uint32Array(b)})(f);if(p.logicalLevelTechnique1===cn.RLE&&p.logicalLevelTechnique2===cn.NONE)return(function(x,b,E){const P=new Int32Array(E+1);P[0]=0;let z=1,L=P[0];for(let N=0;N<b;N++){const $=x[N],H=x[N+b];for(let J=z;J<z+$;J++)P[J]=H+L,L=P[J];z+=$}return new Uint32Array(P)})(f,p.runs,p.numRleValues);if(p.logicalLevelTechnique1===cn.NONE&&p.logicalLevelTechnique2===cn.NONE){(function(b){let E=0;for(let P=0;P<b.length;P++)b[P]+=E,E=b[P]})(f);const x=new Uint32Array(p.numValues+1);return x[0]=0,x.set(f,1),x}if(p.logicalLevelTechnique1===cn.DELTA&&p.logicalLevelTechnique2===cn.RLE){const x=(function(b,E,P){const z=new Int32Array(P+1);z[0]=0;let L=1,N=z[0];for(let $=0;$<E;$++){const H=b[$];let J=b[$+E];J=zn(J);for(let te=L;te<L+H;te++)z[te]=J+N,N=z[te];L+=H}return new Uint32Array(z)})(f,p.runs,p.numRleValues);return s0(x),x}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(Sp(s,r,a),a)}function Sp(s,r,a){const f=a.physicalLevelTechnique;if(f===qc.FAST_PFOR)return(function(){throw new Error("FastPFor is not implemented yet.")})();if(f===qc.VARINT)return ca(s,r,a.numValues);if(f===qc.NONE){const p=r.get();r.add(a.byteLength);const x=s.subarray(p,r.get());return new Int32Array(x)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Gc(s,r,a,f){const p=Sp(s,r,a);if(p.length===1){const x=p[0];return f?zn(x):x}return f?(function(x){return zn(x[1])})(p):(function(x){return x[1]})(p)}function Sd(s,r,a){return(function(f){if(f.length==2){const p=zn(f[1]);return[p,p]}return[zn(f[2]),zn(f[3])]})(Sp(s,r,a))}function Wy(s,r,a){return(function(f){if(f.length==2){const p=xi(f[1]);return[p,p]}return[xi(f[2]),xi(f[3])]})(Kh(s,r,a.numValues))}function l0(s,r,a,f,p){return(function(x,b,E,P){switch(b.logicalLevelTechnique1){case cn.DELTA:if(b.logicalLevelTechnique2===cn.RLE){const z=b;if(!P)return(function(L,N,$){const H=new BigInt64Array($);let J=0,te=0n;for(let ie=0;ie<N;ie++){const le=Number(L[ie]),ye=xi(L[ie+N]);for(let se=0;se<le;se++)te+=ye,H[J++]=te}return H})(x,z.runs,z.numRleValues);x=Qh(x,z.runs,z.numRleValues)}(function(z){z[0]=xi(z[0]);const L=z.length/4*4;let N=1;if(L>=4)for(;N<L-4;N+=4){const $=z[N+1],H=z[N+2],J=z[N+3];z[N]=xi(z[N])+z[N-1],z[N+1]=xi($)+z[N],z[N+2]=xi(H)+z[N+1],z[N+3]=xi(J)+z[N+2]}for(;N!=z.length;++N)z[N]=xi(z[N])+z[N-1]})(x);break;case cn.RLE:x=(function(z,L,N){return N?(function($,H,J){if(J===void 0){J=0;for(let le=0;le<H;le++)J+=Number($[le])}const te=new BigInt64Array(J);let ie=0;for(let le=0;le<H;le++){const ye=Number($[le]);let se=$[le+H];se=xi(se),te.fill(se,ie,ie+ye),ie+=ye}return te})(z,L.runs,L.numRleValues):Qh(z,L.runs,L.numRleValues)})(x,b,E);break;case cn.NONE:E&&(function(z){for(let L=0;L<z.length;L++)z[L]=xi(z[L])})(x);break;default:throw new Error(`The specified Logical level technique is not supported: ${b.logicalLevelTechnique1}`)}return P?lg(x,P,0n):x})(Kh(s,r,a.numValues),a,f,p)}function Jh(s,r,a,f){const p=Kh(s,r,a.numValues);if(p.length===1){const x=p[0];return f?xi(x):x}return f?(function(x){return xi(x[1])})(p):(function(x){return x[1]})(p)}function Zc(s,r,a,f){const p=s.logicalLevelTechnique1;if(p===cn.RLE)return s.runs===1?Kr.CONST:Kr.FLAT;if(p!==cn.DELTA||s.logicalLevelTechnique2!==cn.RLE)return s.numValues===1?Kr.CONST:Kr.FLAT;const x=r instanceof pl?r.size():r;if(s.numRleValues!==x)return Kr.FLAT;if(s.runs===1)return Kr.SEQUENCE;if(s.runs!==2)return s.numValues===1?Kr.CONST:Kr.FLAT;const b=f.get();let E;if(s.physicalLevelTechnique===qc.VARINT)E=ca(a,f,4);else{const P=f.get();E=new Int32Array(a.buffer,a.byteOffset+P,4)}return f.set(b),E[2]===2&&E[3]===2?Kr.SEQUENCE:s.numValues===1?Kr.CONST:Kr.FLAT}class Yy extends ag{getValueFromBuffer(r){return this.dataBuffer[r]}}class Tp extends n0{constructor(r,a,f,p){super(r,BigInt64Array.of(a),f,p)}getValueFromBuffer(r){return this.dataBuffer[0]+BigInt(r)*this.delta}}class Hc{_geometryOffsets;_partOffsets;_ringOffsets;constructor(r,a,f){this._geometryOffsets=r,this._partOffsets=a,this._ringOffsets=f}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function Ep(s,r,a){return{x:Ap(s,r)-a,y:Ap(s>>1,r)-a}}function Ap(s,r){let a=0;for(let f=0;f<r;f++)a|=(s&1<<2*f)>>f;return a}(function(s){s[s.POINT=0]="POINT",s[s.LINESTRING=1]="LINESTRING",s[s.POLYGON=2]="POLYGON",s[s.MULTIPOINT=3]="MULTIPOINT",s[s.MULTILINESTRING=4]="MULTILINESTRING",s[s.MULTIPOLYGON=5]="MULTIPOLYGON"})(_i||(_i={})),(function(s){s[s.POINT=0]="POINT",s[s.LINESTRING=1]="LINESTRING",s[s.POLYGON=2]="POLYGON"})(Gy||(Gy={})),(function(s){s[s.MORTON=0]="MORTON",s[s.VEC_2=1]="VEC_2",s[s.VEC_3=2]="VEC_3"})(qo||(qo={}));class u0{createPoint(r){return[[r]]}createMultiPoint(r){return r.map((a=>[a]))}createLineString(r){return[r]}createMultiLineString(r){return r}createPolygon(r,a){return[r].concat(a)}createMultiPolygon(r){return r.flat()}}function Xy(s){const r=new Array(s.numGeometries);let a=1,f=1,p=1,x=0;const b=new u0;let E=0,P=0;const z=s.mortonSettings,L=s.topologyVector,N=L.geometryOffsets,$=L.partOffsets,H=L.ringOffsets,J=s.vertexOffsets,te=s.containsPolygonGeometry(),ie=s.vertexBuffer;for(let le=0;le<s.numGeometries;le++){const ye=s.geometryType(le);if(ye===_i.POINT){if(J&&J.length!==0)if(s.vertexBufferType===qo.VEC_2){const se=2*J[P++],fe=new M(ie[se],ie[se+1]);r[x++]=b.createPoint(fe)}else{const se=Ep(ie[J[P++]],z.numBits,z.coordinateShift),fe=new M(se.x,se.y);r[x++]=b.createPoint(fe)}else{const se=new M(ie[E++],ie[E++]);r[x++]=b.createPoint(se)}N&&p++,$&&a++,H&&f++}else if(ye===_i.MULTIPOINT){const se=N[p]-N[p-1];p++;const fe=new Array(se);if(J&&J.length!==0){for(let Se=0;Se<se;Se++){const Ie=2*J[P++];fe[Se]=new M(ie[Ie],ie[Ie+1])}r[x++]=b.createMultiPoint(fe)}else{for(let Se=0;Se<se;Se++){const Ie=ie[E++],We=ie[E++];fe[Se]=new M(Ie,We)}r[x++]=b.createMultiPoint(fe)}}else if(ye===_i.LINESTRING){let se,fe=0;te?(fe=H[f]-H[f-1],f++):fe=$[a]-$[a-1],a++,J&&J.length!==0?(se=s.vertexBufferType===qo.VEC_2?Ky(ie,J,P,fe,!1):Td(ie,J,P,fe,!1,z),P+=fe):(se=Pp(ie,E,fe,!1),E+=2*fe),r[x++]=b.createLineString(se),N&&p++}else if(ye===_i.POLYGON){const se=$[a]-$[a-1];a++;const fe=new Array(se-1);let Se=H[f]-H[f-1];if(f++,J&&J.length!==0){const Ie=s.vertexBufferType===qo.VEC_2?Mp(ie,J,P,Se):cg(ie,J,P,Se,0,z);P+=Se;for(let We=0;We<fe.length;We++)Se=H[f]-H[f-1],f++,fe[We]=s.vertexBufferType===qo.VEC_2?Mp(ie,J,P,Se):cg(ie,J,P,Se,0,z),P+=Se;r[x++]=b.createPolygon(Ie,fe)}else{const Ie=ug(ie,E,Se);E+=2*Se;for(let We=0;We<fe.length;We++)Se=H[f]-H[f-1],f++,fe[We]=ug(ie,E,Se),E+=2*Se;r[x++]=b.createPolygon(Ie,fe)}N&&p++}else if(ye===_i.MULTILINESTRING){const se=N[p]-N[p-1];p++;const fe=new Array(se);if(J&&J.length!==0){for(let Se=0;Se<se;Se++){let Ie=0;te?(Ie=H[f]-H[f-1],f++):Ie=$[a]-$[a-1],a++;const We=s.vertexBufferType===qo.VEC_2?Ky(ie,J,P,Ie,!1):Td(ie,J,P,Ie,!1,z);fe[Se]=We,P+=Ie}r[x++]=b.createMultiLineString(fe)}else{for(let Se=0;Se<se;Se++){let Ie=0;te?(Ie=H[f]-H[f-1],f++):Ie=$[a]-$[a-1],a++,fe[Se]=Pp(ie,E,Ie,!1),E+=2*Ie}r[x++]=b.createMultiLineString(fe)}}else{if(ye!==_i.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const se=N[p]-N[p-1];p++;const fe=new Array(se);let Se=0;if(J&&J.length!==0){for(let Ie=0;Ie<se;Ie++){const We=$[a]-$[a-1];a++;const ht=new Array(We-1);Se=H[f]-H[f-1],f++;const dt=s.vertexBufferType===qo.VEC_2?Mp(ie,J,P,Se):cg(ie,J,P,Se,0,z);P+=Se;for(let St=0;St<ht.length;St++)Se=H[f]-H[f-1],f++,ht[St]=s.vertexBufferType===qo.VEC_2?Mp(ie,J,P,Se):cg(ie,J,P,Se,0,z),P+=Se;fe[Ie]=b.createPolygon(dt,ht)}r[x++]=b.createMultiPolygon(fe)}else{for(let Ie=0;Ie<se;Ie++){const We=$[a]-$[a-1];a++;const ht=new Array(We-1);Se=H[f]-H[f-1],f++;const dt=ug(ie,E,Se);E+=2*Se;for(let St=0;St<ht.length;St++){const It=H[f]-H[f-1];f++,ht[St]=ug(ie,E,It),E+=2*It}fe[Ie]=b.createPolygon(dt,ht)}r[x++]=b.createMultiPolygon(fe)}}}}return r}function ug(s,r,a){return Pp(s,r,a,!0)}function Mp(s,r,a,f){return Ky(s,r,a,f,!0)}function cg(s,r,a,f,p,x){return Td(s,r,a,f,!0,x)}function Pp(s,r,a,f){const p=new Array(f?a+1:a);for(let x=0;x<2*a;x+=2)p[x/2]=new M(s[r+x],s[r+x+1]);return f&&(p[p.length-1]=p[0]),p}function Ky(s,r,a,f,p){const x=new Array(p?f+1:f);for(let b=0;b<2*f;b+=2){const E=2*r[a+b/2];x[b/2]=new M(s[E],s[E+1])}return p&&(x[x.length-1]=x[0]),x}function Td(s,r,a,f,p,x){const b=new Array(p?f+1:f);for(let E=0;E<f;E++){const P=Ep(s[r[a+E]],x.numBits,x.coordinateShift);b[E]=new M(P.x,P.y)}return p&&(b[b.length-1]=b[0]),b}class Cp{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(r,a,f,p,x){this._vertexBufferType=r,this._topologyVector=a,this._vertexOffsets=f,this._vertexBuffer=p,this._mortonSettings=x}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const r=Xy(this);let a=0;for(;a<this.numGeometries;)yield{coordinates:r[a],type:this.geometryType(a)},a++}getSimpleEncodedVertex(r){const a=this.vertexOffsets?2*this.vertexOffsets[r]:2*r;return[this.vertexBuffer[a],this.vertexBuffer[a+1]]}getVertex(r){if(this.vertexOffsets&&this.mortonSettings){const f=Ep(this.vertexBuffer[this.vertexOffsets[r]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[f.x,f.y]}const a=this.vertexOffsets?2*this.vertexOffsets[r]:2*r;return[this.vertexBuffer[a],this.vertexBuffer[a+1]]}getGeometries(){return Xy(this)}get mortonSettings(){return this._mortonSettings}}class Dp extends Cp{_numGeometries;_geometryType;constructor(r,a,f,p,x,b,E){super(f,p,x,b,E),this._numGeometries=r,this._geometryType=a}geometryType(r){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===_i.POLYGON||this._geometryType===_i.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class c0 extends Cp{_geometryTypes;constructor(r,a,f,p,x,b){super(r,f,p,x,b),this._geometryTypes=a}geometryType(r){return this._geometryTypes[r]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let r=0;r<this.numGeometries;r++)if(this.geometryType(r)===_i.POLYGON||this.geometryType(r)===_i.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class Ed{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(r,a,f,p){this._triangleOffsets=r,this._indexBuffer=a,this._vertexBuffer=f,this._topologyVector=p}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const r=new Array(this.numGeometries),a=this._topologyVector,f=a.partOffsets,p=a.ringOffsets,x=a.geometryOffsets;let b=0,E=1,P=1,z=1;for(let L=0;L<this.numGeometries;L++)switch(this.geometryType(L)){case _i.POLYGON:{const N=f[E]-f[E-1];E++;const $=[];for(let H=0;H<N;H++){const J=p[P]-p[P-1];P++;const te=[];for(let ie=0;ie<J;ie++){const le=this._vertexBuffer[b++],ye=this._vertexBuffer[b++];te.push(new M(le,ye))}te.length>0&&te.push(te[0]),$.push(te)}r[L]=$,x&&z++}break;case _i.MULTIPOLYGON:{const N=x[z]-x[z-1];z++;const $=[];for(let H=0;H<N;H++){const J=f[E]-f[E-1];E++;for(let te=0;te<J;te++){const ie=p[P]-p[P-1];P++;const le=[];for(let ye=0;ye<ie;ye++){const se=this._vertexBuffer[b++],fe=this._vertexBuffer[b++];le.push(new M(se,fe))}le.length>0&&le.push(le[0]),$.push(le)}}r[L]=$}}return r}[Symbol.iterator](){return null}}function h0(s,r,a,f,p,x){return new f0(s,r,a,f,p,x)}class f0 extends Ed{_numGeometries;_geometryType;constructor(r,a,f,p,x,b){super(f,p,x,b),this._numGeometries=r,this._geometryType=a}geometryType(r){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Qy(s,r,a,f,p){return new d0(s,r,a,f,p)}class d0 extends Ed{_geometryTypes;constructor(r,a,f,p,x){super(a,f,p,x),this._geometryTypes=r}geometryType(r){return this._geometryTypes[r]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function p0(s,r,a,f,p){const x=Xa(s,a);let b=null,E=null,P=null,z=null;if(Zc(x,f,s,a)===Kr.CONST){const ye=Gc(s,a,x,!1);let se=null,fe=null,Se=null,Ie=null;for(let We=0;We<r-1;We++){const ht=Xa(s,a);switch(ht.physicalStreamType){case Ji.LENGTH:switch(ht.logicalStreamType.lengthType){case Vo.GEOMETRIES:se=$c(s,a,ht);break;case Vo.PARTS:fe=$c(s,a,ht);break;case Vo.RINGS:Se=$c(s,a,ht);break;case Vo.TRIANGLES:Ie=$c(s,a,ht)}break;case Ji.OFFSET:switch(ht.logicalStreamType.offsetType){case Xu.VERTEX:b=Ka(s,a,ht,!1);break;case Xu.INDEX:z=Ka(s,a,ht,!1)}break;case Ji.DATA:ds.VERTEX===ht.logicalStreamType.dictionaryType?E=Ka(s,a,ht,!0):(P={numBits:ht.numBits,coordinateShift:ht.coordinateShift},E=Ka(s,a,ht,!1))}}return z!==null?se!=null||fe!=null?h0(f,ye,Ie,z,E,new Hc(se,fe,Se)):h0(f,ye,Ie,z,E):P===null?(function(We,ht,dt,St,It){return new Dp(We,ht,qo.VEC_2,dt,St,It)})(f,ye,new Hc(se,fe,Se),b,E):(function(We,ht,dt,St,It,Mt){return new Dp(We,ht,qo.MORTON,dt,St,It,Mt)})(f,ye,new Hc(se,fe,Se),b,E,P)}const L=Ka(s,a,x,!1);let N=null,$=null,H=null,J=null;for(let ye=0;ye<r-1;ye++){const se=Xa(s,a);switch(se.physicalStreamType){case Ji.LENGTH:switch(se.logicalStreamType.lengthType){case Vo.GEOMETRIES:N=Ka(s,a,se,!1);break;case Vo.PARTS:$=Ka(s,a,se,!1);break;case Vo.RINGS:H=Ka(s,a,se,!1);break;case Vo.TRIANGLES:J=$c(s,a,se)}break;case Ji.OFFSET:switch(se.logicalStreamType.offsetType){case Xu.VERTEX:b=Ka(s,a,se,!1);break;case Xu.INDEX:z=Ka(s,a,se,!1)}break;case Ji.DATA:ds.VERTEX===se.logicalStreamType.dictionaryType?E=Ka(s,a,se,!0):(P={numBits:se.numBits,coordinateShift:se.coordinateShift},E=Ka(s,a,se,!1))}}let te=null,ie=null,le=null;return N!==null?(te=Op(L,N,2),$!==null&&H!==null?(ie=Jy(L,te,$,!1),le=(function(ye,se,fe,Se){const Ie=new Uint32Array(fe[fe.length-1]+1);let We=0;Ie[0]=We;let ht=1,dt=1,St=0;for(let It=0;It<ye.length;It++){const Mt=ye[It],mt=se[It+1]-se[It];if(Mt!==0&&Mt!==3)for(let ot=0;ot<mt;ot++){const $t=fe[ht]-fe[ht-1];ht++;for(let Ht=0;Ht<$t;Ht++)We=Ie[dt++]=We+Se[St++]}else for(let ot=0;ot<mt;ot++)Ie[dt++]=++We,ht++}return Ie})(L,te,ie,H)):$!==null&&(ie=(function(ye,se,fe){const Se=new Uint32Array(se[se.length-1]+1);let Ie=0;Se[0]=Ie;let We=1,ht=0;for(let dt=0;dt<ye.length;dt++){const St=ye[dt],It=se[dt+1]-se[dt];if(St===4||St===1)for(let Mt=0;Mt<It;Mt++)Ie=Se[We++]=Ie+fe[ht++];else for(let Mt=0;Mt<It;Mt++)Se[We++]=++Ie}return Se})(L,te,$))):$!==null&&H!==null?(ie=Op(L,$,1),le=Jy(L,ie,H,!0)):$!==null&&(ie=Op(L,$,0)),z!==null&&ie===null?Qy(L,J,z,E):z!==null?Qy(L,J,z,E,new Hc(te,ie,le)):P===null?(function(ye,se,fe,Se){return new c0(qo.VEC_2,ye,se,fe,Se)})(L,new Hc(te,ie,le),b,E):(function(ye,se,fe,Se,Ie){return new c0(qo.MORTON,ye,se,fe,Se,Ie)})(L,new Hc(te,ie,le),b,E,P)}function Op(s,r,a){const f=new Uint32Array(s.length+1);let p=0;f[0]=p;let x=0;for(let b=0;b<s.length;b++)p=f[b+1]=p+(s[b]>a?r[x++]:1);return f}function Jy(s,r,a,f){const p=new Uint32Array(r[r.length-1]+1);let x=0;p[0]=x;let b=1,E=0;for(let P=0;P<s.length;P++){const z=s[P],L=r[P+1]-r[P];if(z===5||z===2||f&&(z===4||z===1))for(let N=0;N<L;N++)x=p[b++]=x+a[E++];else for(let N=0;N<L;N++)p[b++]=++x}return p}class m0 extends Xh{dataVector;constructor(r,a,f){super(r,a.getBuffer(),f),this.dataVector=a}getValueFromBuffer(r){return this.dataVector.get(r)}}class hg extends ag{getValueFromBuffer(r){return this.dataBuffer[r]}}class g0 extends Xh{constructor(r,a,f){super(r,BigInt64Array.of(a),f)}getValueFromBuffer(r){return this.dataBuffer[0]}}function Ip(s,r,a,f,p){const x=(function(b,E,P,z){const L=new Uint8Array(E);let N=0;const $=z.get()+P;for(;N<E&&!(z.get()>=$);){const H=b[z.increment()];if(H<=127){const J=H+3,te=b[z.increment()],ie=Math.min(N+J,E);L.fill(te,N,ie),N=ie}else{const J=256-H;for(let te=0;te<J&&N<E;te++)L[N++]=b[z.increment()]}}return z.set($),L})(s,Math.ceil(r/8),a,f);return p?(function(b,E,P){if(!P)return b;const z=P.size(),L=new pl(b,E),N=new pl(new Uint8Array(Math.ceil(z/8)),z);let $=0;for(let H=0;H<z;H++){const J=!!P.get(H)&&L.get($++);N.set(H,J)}return N.getBuffer()})(x,r,p):x}const ev=new TextDecoder;function zp(s,r,a){return a-r>=12?ev.decode(s.subarray(r,a)):(function(f,p,x){let b="",E=p;for(;E<x;){const P=f[E];let z,L,N,$=null,H=P>239?4:P>223?3:P>191?2:1;if(E+H>x)break;H===1?P<128&&($=P):H===2?(z=f[E+1],(192&z)==128&&($=(31&P)<<6|63&z,$<=127&&($=null))):H===3?(z=f[E+1],L=f[E+2],(192&z)==128&&(192&L)==128&&($=(15&P)<<12|(63&z)<<6|63&L,($<=2047||$>=55296&&$<=57343)&&($=null))):H===4&&(z=f[E+1],L=f[E+2],N=f[E+3],(192&z)==128&&(192&L)==128&&(192&N)==128&&($=(15&P)<<18|(63&z)<<12|(63&L)<<6|63&N,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,H=1):$>65535&&($-=65536,b+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),b+=String.fromCharCode($),E+=H}return b})(s,r,a)}class Ad extends Xh{offsetBuffer;constructor(r,a,f,p){super(r,f,p),this.offsetBuffer=a}}class fg extends Ad{textEncoder;constructor(r,a,f,p){super(r,a,f,p??a.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(r){return zp(this.dataBuffer,this.offsetBuffer[r],this.offsetBuffer[r+1])}}class ef extends Ad{indexBuffer;textEncoder;constructor(r,a,f,p,x){super(r,f,p,x??a.length),this.indexBuffer=a,this.indexBuffer=a,this.textEncoder=new TextEncoder}getValueFromBuffer(r){const a=this.indexBuffer[r];return zp(this.dataBuffer,this.offsetBuffer[a],this.offsetBuffer[a+1])}}class dg extends Ad{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(r,a,f,p,x,b,E){super(r,f,p,E),this.indexBuffer=a,this.symbolOffsetBuffer=x,this.symbolTableBuffer=b,this.textEncoder=new TextEncoder}getValueFromBuffer(r){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(f,p,x){const b=[],E=new Array(p.length).fill(0);for(let P=1;P<p.length;P++)E[P]=E[P-1]+p[P-1];for(let P=0;P<x.length;P++)if(x[P]===255)b.push(x[++P]);else{const z=p[x[P]],L=E[x[P]];for(let N=0;N<z;N++)b.push(f[L+N])}return new Uint8Array(b)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const a=this.indexBuffer[r];return zp(this.decodedDictionary,this.offsetBuffer[a],this.offsetBuffer[a+1])}offsetToLengthBuffer(r){const a=new Uint32Array(r.length-1);let f=r[0];for(let p=1;p<r.length;p++){const x=r[p];a[p-1]=x-f,f=x}return a}}function Wc(s,r,a,f,p,x){return a.type==="scalarType"?(function(b,E,P,z,L,N){let $=null,H=0;if(b===0)return null;if(N.nullable){const te=Xa(E,P);H=te.numValues;const ie=P.get(),le=Ip(E,H,te.byteLength,P);P.set(ie+te.byteLength),$=new pl(le,te.numValues)}const J=$??z;switch(L.physicalType){case 4:case 3:return(function(te,ie,le,ye,se){const fe=Xa(te,ie),Se=Zc(fe,se,te,ie),Ie=ye.physicalType===3;if(Se===Kr.FLAT){const We=Ka(te,ie,fe,Ie,0,Us(se)?se:void 0);return new og(le.name,We,se)}if(Se===Kr.SEQUENCE){const We=Sd(te,ie,fe);return new nu(le.name,We[0],We[1],fe.numRleValues)}{const We=Gc(te,ie,fe,Ie);return new sg(le.name,We,se)}})(E,P,N,L,J);case 9:return(function(te,ie,le,ye,se){let fe=null,Se=null,Ie=null,We=null,ht=null,dt=null,St=null,It=null;for(let Mt=0;Mt<ye;Mt++){const mt=Xa(ie,le);if(mt.byteLength!==0)switch(mt.physicalStreamType){case Ji.PRESENT:{const ot=Ip(ie,mt.numValues,mt.byteLength,le);dt=new pl(ot,mt.numValues);break}case Ji.OFFSET:Se=Ka(ie,le,mt,!1,0,se!=null||dt!=null?se??dt:void 0);break;case Ji.LENGTH:{const ot=$c(ie,le,mt);Vo.DICTIONARY===mt.logicalStreamType.lengthType?fe=ot:Vo.SYMBOL===mt.logicalStreamType.lengthType?We=ot:St=ot;break}case Ji.DATA:{const ot=ie.subarray(le.get(),le.get()+mt.byteLength);le.add(mt.byteLength);const $t=mt.logicalStreamType.dictionaryType;ds.FSST===$t?ht=ot:ds.SINGLE===$t||ds.SHARED===$t?Ie=ot:ds.NONE===$t&&(It=ot);break}}}return(function(Mt,mt,ot,$t,Ht,ar,Xt){return mt?new dg(Mt,ot,$t,Ht,ar,mt,Xt):null})(te,ht,Se,fe,Ie,We,se??dt)??(function(Mt,mt,ot,$t,Ht){return mt?Ht?new ef(Mt,ot,$t,mt,Ht):new ef(Mt,ot,$t,mt):null})(te,Ie,Se,fe,se??dt)??(function(Mt,mt,ot,$t,Ht){if(!mt||!ot)return null;if($t)return Ht?new ef(Mt,$t,mt,ot,Ht):new ef(Mt,$t,mt,ot);if(Ht&&Ht.size()!==mt.length-1){const ar=new Int32Array(Ht.size());let Xt=0;for(let Ar=0;Ar<Ht.size();Ar++)ar[Ar]=Ht.get(Ar)?Xt++:0;return new ef(Mt,ar,mt,ot,Ht)}return Ht?new fg(Mt,mt,ot,Ht):new fg(Mt,mt,ot)})(te,St,It,Se,se??dt)})(N.name,E,P,N.nullable?b-1:b,$);case 0:return(function(te,ie,le,ye,se){const fe=Xa(te,ie),Se=fe.numValues,Ie=ie.get(),We=Us(se)?se:void 0,ht=Ip(te,Se,fe.byteLength,ie,We);ie.set(Ie+fe.byteLength);const dt=new pl(ht,Se);return new m0(le.name,dt,se)})(E,P,N,0,J);case 6:case 5:return(function(te,ie,le,ye,se){const fe=Xa(te,ie),Se=Zc(fe,ye,te,ie),Ie=se.physicalType===5;if(Se===Kr.FLAT){const We=l0(te,ie,fe,Ie,Us(ye)?ye:void 0);return new Yy(le.name,We,ye)}if(Se===Kr.SEQUENCE){const We=Wy(te,ie,fe);return new Tp(le.name,We[0],We[1],fe.numRleValues)}{const We=Jh(te,ie,fe,Ie);return new g0(le.name,We,ye)}})(E,P,N,J,L);case 7:return(function(te,ie,le,ye){const se=Xa(te,ie),fe=Us(ye)?ye:void 0,Se=(function(Ie,We,ht,dt){const St=We.get(),It=St+ht*Float32Array.BYTES_PER_ELEMENT,Mt=new Uint8Array(Ie.subarray(St,It)).buffer,mt=new Float32Array(Mt);return We.set(It),dt?lg(mt,dt,0):mt})(te,ie,se.numValues,fe);return new hg(le.name,Se,ye)})(E,P,N,J);case 8:return(function(te,ie,le,ye){const se=Xa(te,ie),fe=Us(ye)?ye:void 0,Se=(function(Ie,We,ht,dt){const St=We.get(),It=St+ht*Float64Array.BYTES_PER_ELEMENT,Mt=new Uint8Array(Ie.subarray(St,It)).buffer,mt=new Float64Array(Mt);return We.set(It),dt?lg(mt,dt,0):mt})(te,ie,se.numValues,fe);return new qy(le.name,Se,ye)})(E,P,N,J);default:throw new Error(`The specified data type for the field is currently not supported: ${L}`)}})(f,s,r,p,a.scalarType,a):f===0?null:(function(b,E,P,z){let L=null,N=null,$=null,H=null,J=!1;for(;!J;){const ye=Xa(b,E);switch(ye.physicalStreamType){case Ji.LENGTH:Vo.DICTIONARY===ye.logicalStreamType.lengthType?L=$c(b,E,ye):$=$c(b,E,ye);break;case Ji.DATA:ds.SINGLE===ye.logicalStreamType.dictionaryType||ds.SHARED===ye.logicalStreamType.dictionaryType?(N=b.subarray(E.get(),E.get()+ye.byteLength),J=!0):H=b.subarray(E.get(),E.get()+ye.byteLength),E.add(ye.byteLength)}}const te=P.complexType.children,ie=[];let le=0;for(const ye of te){const se=ca(b,E,1)[0];if(se==0)continue;const fe=ye.name?`${P.name}${ye.name}`:P.name;if(se!==2||ye.type!=="scalarField"||ye.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Se=Xa(b,E),Ie=Ip(b,Se.numValues,Se.byteLength,E),We=Xa(b,E),ht=Ka(b,E,We,!1,0,We.decompressedCount!==z?new pl(Ie,Se.numValues):void 0);ie[le++]=H?new dg(fe,ht,L,N,$,H,new pl(Ie,Se.numValues)):new ef(fe,ht,L,N,new pl(Ie,Se.numValues))}return ie})(s,r,a,p)}function Us(s){return s instanceof pl}function Ku(s){switch(s){case 0:case 1:case 2:case 3:{const r={};r.nullable=!!(1&s),r.columnScope=0;const a={};return a.physicalType=s>1?6:4,a.type="physicalType",r.scalarType=a,r.type="scalarType",r}case 4:{const r={nullable:!1,columnScope:0},a={type:"physicalType",physicalType:0};return r.type="complexType",r.complexType=a,r}case 30:{const r={nullable:!1,columnScope:0},a={type:"physicalType",physicalType:1};return r.type="complexType",r.complexType=a,r}default:return(function(r){let a=null;switch(r){case 10:case 11:a=0;break;case 12:case 13:a=1;break;case 14:case 15:a=2;break;case 16:case 17:a=3;break;case 18:case 19:a=4;break;case 20:case 21:a=5;break;case 22:case 23:a=6;break;case 24:case 25:a=7;break;case 26:case 27:a=8;break;case 28:case 29:a=9;break;default:return null}const f={};f.nullable=!!(1&r),f.columnScope=0;const p={type:"physicalType"};return p.physicalType=a,f.type="scalarType",f.scalarType=p,f})(s)}}function Md(s){return s>=10}function Pd(s){return s===30}function Yc(s){if(s.name==="id")return!1;if(s.type==="scalarType"){const r=s.scalarType;if(r.type==="physicalType")switch(r.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(r.type==="logicalType")return!1}else if(s.type==="complexType"){const r=s.complexType;if(r.type==="physicalType")switch(r.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",s),!1}const Fb=new TextDecoder;function pg(s,r){const a=ca(s,r,1)[0];if(a===0)return"";const f=r.get(),p=s.subarray(f,f+a);return r.add(a),Fb.decode(p)}function Cd(s,r){const a=ca(s,r,1)[0]>>>0;if(a<10||a>30)throw new Error(`Unsupported field type code ${a}. Supported: 10-29(scalars), 30(STRUCT)`);const f=Ku(a);if(Md(a)&&(f.name=pg(s,r)),Pd(a)){const p=ca(s,r,1)[0]>>>0;f.complexType.children=new Array(p);for(let x=0;x<p;x++)f.complexType.children[x]=Cd(s,r)}return(function(p){return{name:p.name,nullable:p.nullable,scalarField:p.scalarType,complexField:p.complexType,type:p.type==="scalarType"?"scalarField":"complexField"}})(f)}function Ub(s,r){const a=ca(s,r,1)[0]>>>0,f=Ku(a);if(!f)throw new Error(`Unsupported column type code ${a}. Supported: 0-3(ID), 4(GEOMETRY), 10-29(scalars), 30(STRUCT)`);if(Md(a)?f.name=pg(s,r):a>=0&&a<=3?f.name="id":a===4&&(f.name="geometry"),Pd(a)){const p=ca(s,r,1)[0]>>>0,x=f.complexType;x.children=new Array(p);for(let b=0;b<p;b++)x.children[b]=Cd(s,r)}return f}function y0(s,r){const a={featureTables:[]},f={};f.name=pg(s,r);const p=ca(s,r,1)[0]>>>0,x=ca(s,r,1)[0]>>>0;f.columns=new Array(x);for(let b=0;b<x;b++)f.columns[b]=Ub(s,r);return a.featureTables.push(f),[a,p]}function mg(s,r,a,f,p,x,b=!1){const E=r.scalarType.physicalType,P=Zc(p,x,s,a);if(E===4)switch(P){case Kr.FLAT:{const z=Ka(s,a,p,!1);return new og(f,z,x)}case Kr.SEQUENCE:{const z=Sd(s,a,p);return new nu(f,z[0],z[1],p.numRleValues)}case Kr.CONST:{const z=Gc(s,a,p,!1);return new sg(f,z,x)}}else switch(P){case Kr.FLAT:{if(b){const L=(function(N,$,H){const J=(function(te,ie,le){const ye=new Float64Array(le);for(let se=0;se<le;se++)ye[se]=a0(te,ie);return ye})(N,$,H.numValues);return(function(te,ie){switch(ie.logicalLevelTechnique1){case cn.DELTA:return ie.logicalLevelTechnique2===cn.RLE&&(te=Zy(te,ie.runs,ie.numRleValues)),(function(le){le[0]=wd(le[0]);const ye=le.length/4*4;let se=1;if(ye>=4)for(;se<ye-4;se+=4){const fe=le[se+1],Se=le[se+2],Ie=le[se+3];le[se]=wd(le[se])+le[se-1],le[se+1]=wd(fe)+le[se],le[se+2]=wd(Se)+le[se+1],le[se+3]=wd(Ie)+le[se+2]}for(;se!=le.length;++se)le[se]=wd(le[se])+le[se-1]})(te),te;case cn.RLE:return(function(le,ye){return Zy(le,ye.runs,ye.numRleValues)})(te,ie);case cn.NONE:return te;default:throw new Error(`The specified Logical level technique is not supported: ${ie.logicalLevelTechnique1}`)}})(J,H)})(s,a,p);return new qy(f,L,x)}const z=l0(s,a,p,!1);return new Yy(f,z,x)}case Kr.SEQUENCE:{const z=Wy(s,a,p);return new Tp(f,z[0],z[1],p.numRleValues)}case Kr.CONST:{const z=Jh(s,a,p,!1);return new g0(f,z,x)}}throw new Error("Vector type not supported for id column.")}class v0{constructor(r,a){var f;switch(this._featureData=r,this.properties=this._featureData.properties||{},(f=this._featureData.geometry)===null||f===void 0?void 0:f.type){case _i.POINT:case _i.MULTIPOINT:this.type=1;break;case _i.LINESTRING:case _i.MULTILINESTRING:this.type=2;break;case _i.POLYGON:case _i.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=a,this.id=Number(this._featureData.id)}loadGeometry(){const r=[];for(const a of this._featureData.geometry.coordinates){const f=[];for(const p of a)f.push(new M(p.x,p.y));r.push(f)}return r}}class Vb{constructor(r){this.features=[],this.featureTable=r,this.name=r.name,this.extent=r.extent,this.version=2,this.features=r.getFeatures(),this.length=this.features.length}feature(r){return new v0(this.features[r],this.extent)}}class kp{constructor(r){this.layers={};const a=(function(f,p,x=!0){const b=new $y(0),E=[];for(;b.get()<f.length;){const P=ca(f,b,1)[0]>>>0,z=b.get()+P;if(z>f.length)throw new Error(`Block overruns tile: ${z} > ${f.length}`);if(ca(f,b,1)[0]>>>0!=1){b.set(z);continue}const L=y0(f,b),N=L[1],$=L[0].featureTables[0];let H=null,J=null;const te=[];let ie=0;for(const ye of $.columns){const se=ye.name;if(se==="id"){let fe=null;if(ye.nullable){const Ie=Xa(f,b),We=b.get(),ht=Ip(f,Ie.numValues,Ie.byteLength,b);b.set(We+Ie.byteLength),fe=new pl(ht,Ie.numValues)}const Se=Xa(f,b);ie=Se.decompressedCount,H=mg(f,ye,b,se,Se,fe??ie,x)}else if(se==="geometry"){const fe=ca(f,b,1)[0];if(ie===0){const Se=b.get();ie=Xa(f,b).decompressedCount,b.set(Se)}J=p0(f,fe,b,ie)}else{const fe=Yc(ye)?ca(f,b,1)[0]:1;if(fe===0)continue;const Se=Wc(f,b,ye,fe,ie);if(Se)if(Array.isArray(Se))for(const Ie of Se)te.push(Ie);else te.push(Se)}}const le=new i0($.name,J,H,te,N);E.push(le),b.set(z)}return E})(new Uint8Array(r));this.layers=a.reduce(((f,p)=>Object.assign(Object.assign({},f),{[p.name]:new Vb(p)})),{})}}class gg{constructor(r,a){this.feature=r,this.type=r.type,this.properties=r.tags?r.tags:{},this.extent=a,"id"in r&&(typeof r.id=="string"?this.id=parseInt(r.id,10):typeof r.id!="number"||isNaN(r.id)||(this.id=r.id))}loadGeometry(){const r=[],a=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const f of a){const p=[];for(const x of f)p.push(new M(x[0],x[1]));r.push(p)}return r}}const Dd="_geojsonTileLayer";function Od(s,r){r.writeVarintField(15,s.version||1),r.writeStringField(1,s.name||""),r.writeVarintField(5,s.extent||4096);const a={keys:[],values:[],keycache:{},valuecache:{}};for(let x=0;x<s.length;x++)a.feature=s.feature(x),r.writeMessage(2,_0,a);const f=a.keys;for(const x of f)r.writeStringField(3,x);const p=a.values;for(const x of p)r.writeMessage(4,yg,x)}function _0(s,r){if(!s.feature)return;const a=s.feature;a.id!==void 0&&r.writeVarintField(1,a.id),r.writeMessage(2,tv,s),r.writeVarintField(3,a.type),r.writeMessage(4,qb,a)}function tv(s,r){for(const a in s.feature?.properties){let f=s.feature.properties[a],p=s.keycache[a];if(f==null)continue;p===void 0&&(s.keys.push(a),p=s.keys.length-1,s.keycache[a]=p),r.writeVarint(p),typeof f!="string"&&typeof f!="boolean"&&typeof f!="number"&&(f=JSON.stringify(f));const x=typeof f+":"+f;let b=s.valuecache[x];b===void 0&&(s.values.push(f),b=s.values.length-1,s.valuecache[x]=b),r.writeVarint(b)}}function Id(s,r){return(r<<3)+(7&s)}function rv(s){return s<<1^s>>31}function qb(s,r){const a=s.loadGeometry(),f=s.type;let p=0,x=0;for(const b of a){let E=1;f===1&&(E=b.length),r.writeVarint(Id(1,E));const P=f===3?b.length-1:b.length;for(let z=0;z<P;z++){z===1&&f!==1&&r.writeVarint(Id(2,P-1));const L=b[z].x-p,N=b[z].y-x;r.writeVarint(rv(L)),r.writeVarint(rv(N)),p+=L,x+=N}s.type===3&&r.writeVarint(Id(7,1))}}function yg(s,r){const a=typeof s;a==="string"?r.writeStringField(1,s):a==="boolean"?r.writeBooleanField(7,s):a==="number"&&(s%1!=0?r.writeDoubleField(3,s):s<0?r.writeSVarintField(6,s):r.writeVarintField(5,s))}class l{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new as(bt,16,0),this.grid3D=new as(bt,16,0),this.featureIndexArray=new re,this.promoteId=a}insert(r,a,f,p,x,b){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,p,x);const P=b?this.grid3D:this.grid;for(let z=0;z<a.length;z++){const L=a[z],N=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const H=L[$];N[0]=Math.min(N[0],H.x),N[1]=Math.min(N[1],H.y),N[2]=Math.max(N[2],H.x),N[3]=Math.max(N[3],H.y)}N[0]<bt&&N[1]<bt&&N[2]>=0&&N[3]>=0&&P.insert(E,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new Uo(new Zm(this.rawTileData)).layers:new kp(this.rawTileData).layers,this.sourceLayerCoder=new ig(this.vtLayers?Object.keys(this.vtLayers).sort():[Dd])),this.vtLayers}query(r,a,f,p){this.loadVTLayers();const x=r.params,b=bt/r.tileSize/r.scale,E=Ua(x.filter,x.globalState),P=r.queryGeometry,z=r.queryPadding*b,L=Yu.fromPoints(P),N=this.grid.query(L.minX-z,L.minY-z,L.maxX+z,L.maxY+z),$=Yu.fromPoints(r.cameraQueryGeometry).expandBy(z),H=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,((ie,le,ye,se)=>(function(fe,Se,Ie,We,ht){for(const St of fe)if(Se<=St.x&&Ie<=St.y&&We>=St.x&&ht>=St.y)return!0;const dt=[new M(Se,Ie),new M(Se,ht),new M(We,ht),new M(We,Ie)];if(fe.length>2){for(const St of dt)if(Wl(fe,St))return!0}for(let St=0;St<fe.length-1;St++)if(g_(fe[St],fe[St+1],dt))return!0;return!1})(r.cameraQueryGeometry,ie-z,le-z,ye+z,se+z)));for(const ie of H)N.push(ie);N.sort(g);const J={};let te;for(let ie=0;ie<N.length;ie++){const le=N[ie];if(le===te)continue;te=le;const ye=this.featureIndexArray.get(le);let se=null;this.loadMatchingFeature(J,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,E,x.layers,x.availableImages,a,f,p,((fe,Se,Ie)=>(se||(se=Ha(fe)),Se.queryIntersectsFeature({queryGeometry:P,feature:fe,featureState:Ie,geometry:se,zoom:this.z,transform:r.transform,pixelsToTileUnits:b,pixelPosMatrix:r.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:r.getElevation}))))}return J}loadMatchingFeature(r,a,f,p,x,b,E,P,z,L,N){const $=this.bucketLayerIDs[a];if(b&&!$.some((ie=>b.has(ie))))return;const H=this.sourceLayerCoder.decode(f),J=this.vtLayers[H].feature(p);if(x.needGeometry){const ie=cs(J,!0);if(!x.filter(new ln(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!x.filter(new ln(this.tileID.overscaledZ),J))return;const te=this.getId(J,H);for(let ie=0;ie<$.length;ie++){const le=$[ie];if(b&&!b.has(le))continue;const ye=P[le];if(!ye)continue;let se={};te&&L&&(se=L.getState(ye.sourceLayer||Dd,te));const fe=yr({},z[le]);fe.paint=h(fe.paint,ye.paint,J,se,E),fe.layout=h(fe.layout,ye.layout,J,se,E);const Se=!N||N(J,ye,se);if(!Se)continue;const Ie=new r0(J,this.z,this.x,this.y,te);Ie.layer=fe;let We=r[le];We===void 0&&(We=r[le]=[]),We.push({featureIndex:p,feature:Ie,intersectionZ:Se})}}lookupSymbolFeatures(r,a,f,p,x,b,E,P){const z={};this.loadVTLayers();const L=Ua(x.filterSpec,x.globalState);for(const N of r)this.loadMatchingFeature(z,f,p,N,L,b,E,P,a);return z}hasLayer(r){for(const a of this.bucketLayerIDs)for(const f of a)if(r===f)return!0;return!1}getId(r,a){var f;let p=r.id;return this.promoteId&&(p=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((f=r.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(p=Number(r.properties.cluster_id))),p}}function h(s,r,a,f,p){return tr(s,((x,b)=>{const E=r instanceof Ou?r.get(b):null;return E&&E.evaluate?E.evaluate(a,f,p):E}))}function g(s,r){return r-s}function S(s,r,a,f,p){const x=[];for(let b=0;b<s.length;b++){const E=s[b];let P;for(let z=0;z<E.length-1;z++){let L=E[z],N=E[z+1];L.x<r&&N.x<r||(L.x<r?L=new M(r,L.y+(r-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x<r&&(N=new M(r,L.y+(r-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y<a&&N.y<a||(L.y<a?L=new M(L.x+(a-L.y)/(N.y-L.y)*(N.x-L.x),a)._round():N.y<a&&(N=new M(L.x+(a-L.y)/(N.y-L.y)*(N.x-L.x),a)._round()),L.x>=f&&N.x>=f||(L.x>=f?L=new M(f,L.y+(f-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x>=f&&(N=new M(f,L.y+(f-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y>=p&&N.y>=p||(L.y>=p?L=new M(L.x+(p-L.y)/(N.y-L.y)*(N.x-L.x),p)._round():N.y>=p&&(N=new M(L.x+(p-L.y)/(N.y-L.y)*(N.x-L.x),p)._round()),P&&L.equals(P[P.length-1])||(P=[L],x.push(P)),P.push(N)))))}}return x}function I(s,r,a,f,p){switch(r){case 1:return(function(x,b,E,P){const z=[];for(const L of x)for(const N of L){const $=P===0?N.x:N.y;$>=b&&$<=E&&z.push([N])}return z})(s,a,f,p);case 2:return Q(s,a,f,p,!1);case 3:return Q(s,a,f,p,!0)}return[]}function j(s,r,a,f,p){const x=f===0?ce:ke;let b=[];const E=[];for(let L=0;L<s.length-1;L++){const N=s[L],$=s[L+1],H=f===0?N.x:N.y,J=f===0?$.x:$.y;let te=!1;H<r?J>r&&b.push(x(N,$,r)):H>a?J<a&&b.push(x(N,$,a)):b.push(N),J<r&&H>=r&&(b.push(x(N,$,r)),te=!0),J>a&&H<=a&&(b.push(x(N,$,a)),te=!0),!p&&te&&(E.push(b),b=[])}const P=s.length-1,z=f===0?s[P].x:s[P].y;return z>=r&&z<=a&&b.push(s[P]),p&&b.length>0&&!b[0].equals(b[b.length-1])&&b.push(new M(b[0].x,b[0].y)),b.length>0&&E.push(b),E}function Q(s,r,a,f,p){const x=[];for(const b of s){const E=j(b,r,a,f,p);E.length>0&&x.push(...E)}return x}function ce(s,r,a){return new M(a,s.y+(a-s.x)/(r.x-s.x)*(r.y-s.y))}function ke(s,r,a){return new M(s.x+(a-s.y)/(r.y-s.y)*(r.x-s.x),a)}jt("FeatureIndex",l,{omit:["rawTileData","sourceLayerCoder"]});class Ke extends M{constructor(r,a,f,p){super(r,a),this.angle=f,p!==void 0&&(this.segment=p)}clone(){return new Ke(this.x,this.y,this.angle,this.segment)}}function vt(s,r,a,f,p){if(r.segment===void 0||a===0)return!0;let x=r,b=r.segment+1,E=0;for(;E>-a/2;){if(b--,b<0)return!1;E-=s[b].dist(x),x=s[b]}E+=s[b].dist(s[b+1]),b++;const P=[];let z=0;for(;E<a/2;){const L=s[b],N=s[b+1];if(!N)return!1;let $=s[b-1].angleTo(L)-L.angleTo(N);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:E,angleDelta:$}),z+=$;E-P[0].distance>f;)z-=P.shift().angleDelta;if(z>p)return!1;b++,E+=L.dist(N)}return!0}function At(s){let r=0;for(let a=0;a<s.length-1;a++)r+=s[a].dist(s[a+1]);return r}function it(s,r,a){return s?.6*r*a:0}function ct(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function er(s,r,a,f,p,x){const b=it(a,p,x),E=ct(a,f)*x;let P=0;const z=At(s)/2;for(let L=0;L<s.length-1;L++){const N=s[L],$=s[L+1],H=N.dist($);if(P+H>z){const J=(z-P)/H,te=Wi.number(N.x,$.x,J),ie=Wi.number(N.y,$.y,J),le=new Ke(te,ie,$.angleTo(N),L);return le._round(),!b||vt(s,le,E,b,r)?le:void 0}P+=H}}function _r(s,r,a,f,p,x,b,E,P){const z=it(f,x,b),L=ct(f,p),N=L*b,$=s[0].x===0||s[0].x===P||s[0].y===0||s[0].y===P;return r-N<r/4&&(r=N+r/4),Mn(s,$?r/2*E%r:(L/2+2*x)*b*E%r,r,z,a,N,$,!1,P)}function Mn(s,r,a,f,p,x,b,E,P){const z=x/2,L=At(s);let N=0,$=r-a,H=[];for(let J=0;J<s.length-1;J++){const te=s[J],ie=s[J+1],le=te.dist(ie),ye=ie.angleTo(te);for(;$+a<N+le;){$+=a;const se=($-N)/le,fe=Wi.number(te.x,ie.x,se),Se=Wi.number(te.y,ie.y,se);if(fe>=0&&fe<P&&Se>=0&&Se<P&&$-z>=0&&$+z<=L){const Ie=new Ke(fe,Se,ye,J);Ie._round(),f&&!vt(s,Ie,x,f,p)||H.push(Ie)}}N+=le}return E||H.length||b||(H=Mn(s,N/2,a,f,p,x,b,!0,P)),H}function $e(s,r,a,f){const p=[],x=s.image,b=x.pixelRatio,E=x.paddedRect.w-2,P=x.paddedRect.h-2;let z={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const L=x.stretchX||[[0,E]],N=x.stretchY||[[0,P]],$=(ot,$t)=>ot+$t[1]-$t[0],H=L.reduce($,0),J=N.reduce($,0),te=E-H,ie=P-J;let le=0,ye=H,se=0,fe=J,Se=0,Ie=te,We=0,ht=ie;if(x.content&&f){const ot=x.content,$t=ot[2]-ot[0],Ht=ot[3]-ot[1];(x.textFitWidth||x.textFitHeight)&&(z=_d(s)),le=Le(L,0,ot[0]),se=Le(N,0,ot[1]),ye=Le(L,ot[0],ot[2]),fe=Le(N,ot[1],ot[3]),Se=ot[0]-le,We=ot[1]-se,Ie=$t-ye,ht=Ht-fe}const dt=z.x1,St=z.y1,It=z.x2-dt,Mt=z.y2-St,mt=(ot,$t,Ht,ar)=>{const Xt=wt(ot.stretch-le,ye,It,dt),Ar=cr(ot.fixed-Se,Ie,ot.stretch,H),Qn=wt($t.stretch-se,fe,Mt,St),Ui=cr($t.fixed-We,ht,$t.stretch,J),Qa=wt(Ht.stretch-le,ye,It,dt),iu=cr(Ht.fixed-Se,Ie,Ht.stretch,H),$o=wt(ar.stretch-se,fe,Mt,St),Ma=cr(ar.fixed-We,ht,ar.stretch,J),Ja=new M(Xt,Qn),bi=new M(Qa,Qn),Pa=new M(Qa,$o),Po=new M(Xt,$o),Co=new M(Ar/b,Ui/b),ps=new M(iu/b,Ma/b),eo=r*Math.PI/180;if(eo){const ha=Math.sin(eo),si=Math.cos(eo),Vi=[si,-ha,ha,si];Ja._matMult(Vi),bi._matMult(Vi),Po._matMult(Vi),Pa._matMult(Vi)}const ms=ot.stretch+ot.fixed,au=$t.stretch+$t.fixed;return{tl:Ja,tr:bi,bl:Po,br:Pa,tex:{x:x.paddedRect.x+1+ms,y:x.paddedRect.y+1+au,w:Ht.stretch+Ht.fixed-ms,h:ar.stretch+ar.fixed-au},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Co,pixelOffsetBR:ps,minFontScaleX:Ie/b/It,minFontScaleY:ht/b/Mt,isSDF:a}};if(f&&(x.stretchX||x.stretchY)){const ot=et(L,te,H),$t=et(N,ie,J);for(let Ht=0;Ht<ot.length-1;Ht++){const ar=ot[Ht],Xt=ot[Ht+1];for(let Ar=0;Ar<$t.length-1;Ar++)p.push(mt(ar,$t[Ar],Xt,$t[Ar+1]))}}else p.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:P+1}));return p}function Le(s,r,a){let f=0;for(const p of s)f+=Math.max(r,Math.min(a,p[1]))-Math.max(r,Math.min(a,p[0]));return f}function et(s,r,a){const f=[{fixed:-1,stretch:0}];for(const[p,x]of s){const b=f[f.length-1];f.push({fixed:p-b.stretch,stretch:b.stretch}),f.push({fixed:p-b.stretch,stretch:b.stretch+(x-p)})}return f.push({fixed:r+1,stretch:a}),f}function wt(s,r,a,f){return s/r*a+f}function cr(s,r,a,f){return s-r*a/f}jt("Anchor",Ke);class Qr{constructor(r,a,f,p,x,b,E,P,z,L){var N;if(this.boxStartIndex=r.length,z){let $=b.top,H=b.bottom;const J=b.collisionPadding;J&&($-=J[1],H+=J[3]);let te=H-$;te>0&&(te=Math.max(10,te),this.circleDiameter=te)}else{const $=!((N=b.image)===null||N===void 0)&&N.content&&(b.image.textFitWidth||b.image.textFitHeight)?_d(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};$.y1=$.y1*E-P[0],$.y2=$.y2*E+P[2],$.x1=$.x1*E-P[3],$.x2=$.x2*E+P[1];const H=b.collisionPadding;if(H&&($.x1-=H[0]*E,$.y1-=H[1]*E,$.x2+=H[2]*E,$.y2+=H[3]*E),L){const J=new M($.x1,$.y1),te=new M($.x2,$.y1),ie=new M($.x1,$.y2),le=new M($.x2,$.y2),ye=L*Math.PI/180;J._rotate(ye),te._rotate(ye),ie._rotate(ye),le._rotate(ye),$.x1=Math.min(J.x,te.x,ie.x,le.x),$.x2=Math.max(J.x,te.x,ie.x,le.x),$.y1=Math.min(J.y,te.y,ie.y,le.y),$.y2=Math.max(J.y,te.y,ie.y,le.y)}r.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,f,p,x)}this.boxEndIndex=r.length}}class or{constructor(r=[],a=(f,p)=>f<p?-1:f>p?1:0){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:f}=this,p=a[r];for(;r>0;){const x=r-1>>1,b=a[x];if(f(p,b)>=0)break;a[r]=b,r=x}a[r]=p}_down(r){const{data:a,compare:f}=this,p=this.length>>1,x=a[r];for(;r<p;){let b=1+(r<<1);const E=b+1;if(E<this.length&&f(a[E],a[b])<0&&(b=E),f(a[b],x)>=0)break;a[r]=a[b],r=b}a[r]=x}}function zr(s,r=1,a=!1){const f=Yu.fromPoints(s[0]),p=Math.min(f.width(),f.height());let x=p/2;const b=new or([],Wr),{minX:E,minY:P,maxX:z,maxY:L}=f;if(p===0)return new M(E,P);for(let H=E;H<z;H+=p)for(let J=P;J<L;J+=p)b.push(new qr(H+x,J+x,x,s));let N=(function(H){let J=0,te=0,ie=0;const le=H[0];for(let ye=0,se=le.length,fe=se-1;ye<se;fe=ye++){const Se=le[ye],Ie=le[fe],We=Se.x*Ie.y-Ie.x*Se.y;te+=(Se.x+Ie.x)*We,ie+=(Se.y+Ie.y)*We,J+=3*We}return new qr(te/J,ie/J,0,H)})(s),$=b.length;for(;b.length;){const H=b.pop();(H.d>N.d||!N.d)&&(N=H,a&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-N.d<=r||(x=H.h/2,b.push(new qr(H.p.x-x,H.p.y-x,x,s)),b.push(new qr(H.p.x+x,H.p.y-x,x,s)),b.push(new qr(H.p.x-x,H.p.y+x,x,s)),b.push(new qr(H.p.x+x,H.p.y+x,x,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${N.d}`)),N.p}function Wr(s,r){return r.max-s.max}function qr(s,r,a,f){this.p=new M(s,r),this.h=a,this.d=(function(p,x){let b=!1,E=1/0;for(let P=0;P<x.length;P++){const z=x[P];for(let L=0,N=z.length,$=N-1;L<N;$=L++){const H=z[L],J=z[$];H.y>p.y!=J.y>p.y&&p.x<(J.x-H.x)*(p.y-H.y)/(J.y-H.y)+H.x&&(b=!b),E=Math.min(E,oy(p,H,J))}}return(b?1:-1)*Math.sqrt(E)})(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Kn;_.aP=void 0,(Kn=_.aP||(_.aP={}))[Kn.center=1]="center",Kn[Kn.left=2]="left",Kn[Kn.right=3]="right",Kn[Kn.top=4]="top",Kn[Kn.bottom=5]="bottom",Kn[Kn["top-left"]=6]="top-left",Kn[Kn["top-right"]=7]="top-right",Kn[Kn["bottom-left"]=8]="bottom-left",Kn[Kn["bottom-right"]=9]="bottom-right";const nv=Number.POSITIVE_INFINITY;function IT(s,r){return r[1]!==nv?(function(a,f,p){let x=0,b=0;switch(f=Math.abs(f),p=Math.abs(p),a){case"top-right":case"top-left":case"top":b=p-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-p}switch(a){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,b]})(s,r[0],r[1]):(function(a,f){let p=0,x=0;f<0&&(f=0);const b=f/Math.SQRT2;switch(a){case"top-right":case"top-left":x=b-7;break;case"bottom-right":case"bottom-left":x=7-b;break;case"bottom":x=7-f;break;case"top":x=f-7}switch(a){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=f;break;case"right":p=-f}return[p,x]})(s,r[0])}function zT(s,r,a){var f;const p=s.layout,x=(f=p.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(r,{},a);if(x){const E=x.values,P=[];for(let z=0;z<E.length;z+=2){const L=P[z]=E[z],N=E[z+1].map(($=>$*Fi));L.startsWith("top")?N[1]-=7:L.startsWith("bottom")&&(N[1]+=7),P[z+1]=N}return new Nr(P)}const b=p.get("text-variable-anchor");if(b){let E;E=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(r,{},a)*Fi,nv]:p.get("text-offset").evaluate(r,{},a).map((z=>z*Fi));const P=[];for(const z of b)P.push(z,IT(z,E));return new Nr(P)}return null}function $b(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function DR(s,r,a,f,p,x,b,E,P,z,L,N){let $=x.textMaxSize.evaluate(r,{});$===void 0&&($=b);const H=s.layers[0].layout,J=H.get("icon-offset").evaluate(r,{},L),te=RT(a.horizontal),ie=b/24,le=s.tilePixelRatio*ie,ye=s.tilePixelRatio*$/24,se=s.tilePixelRatio*E,fe=s.tilePixelRatio*H.get("symbol-spacing"),Se=H.get("text-padding")*s.tilePixelRatio,Ie=(function(Ht,ar,Xt,Ar=1){const Qn=Ht.get("icon-padding").evaluate(ar,{},Xt),Ui=Qn&&Qn.values;return[Ui[0]*Ar,Ui[1]*Ar,Ui[2]*Ar,Ui[3]*Ar]})(H,r,L,s.tilePixelRatio),We=H.get("text-max-angle")/180*Math.PI,ht=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",dt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",St=H.get("symbol-placement"),It=fe/2,Mt=H.get("icon-text-fit");let mt;f&&Mt!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(mt=$_(f,a.vertical,Mt,H.get("icon-text-fit-padding"),J,ie)),te&&(f=$_(f,te,Mt,H.get("icon-text-fit-padding"),J,ie)));const ot=L?N.line.getGranularityForZoomLevel(L.z):1,$t=(Ht,ar)=>{ar.x<0||ar.x>=bt||ar.y<0||ar.y>=bt||(function(Xt,Ar,Qn,Ui,Qa,iu,$o,Ma,Ja,bi,Pa,Po,Co,ps,eo,ms,au,ha,si,Vi,pi,fa,tf,Qu,ov){const zd=Xt.addToLineVertexArray(Ar,Qn);let Rp,vg,_g,xg,BT=0,FT=0,UT=0,VT=0,Qb=-1,Jb=-1;const rf={};let qT=Vn("");if(Xt.allowVerticalPlacement&&Ui.vertical){const Do=Ma.layout.get("text-rotate").evaluate(pi,{},Qu)+90;_g=new Qr(Ja,Ar,bi,Pa,Po,Ui.vertical,Co,ps,eo,Do),$o&&(xg=new Qr(Ja,Ar,bi,Pa,Po,$o,au,ha,eo,Do))}if(Qa){const Do=Ma.layout.get("icon-rotate").evaluate(pi,{}),ml=Ma.layout.get("icon-text-fit")!=="none",jp=$e(Qa,Do,tf,ml),ec=$o?$e($o,Do,tf,ml):void 0;vg=new Qr(Ja,Ar,bi,Pa,Po,Qa,au,ha,!1,Do),BT=4*jp.length;const Lp=Xt.iconSizeData;let Xc=null;Lp.kind==="source"?(Xc=[ru*Ma.layout.get("icon-size").evaluate(pi,{})],Xc[0]>Wu&&fr(`${Xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Lp.kind==="composite"&&(Xc=[ru*fa.compositeIconSizes[0].evaluate(pi,{},Qu),ru*fa.compositeIconSizes[1].evaluate(pi,{},Qu)],(Xc[0]>Wu||Xc[1]>Wu)&&fr(`${Xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Xt.addSymbols(Xt.icon,jp,Xc,Vi,si,pi,_.az.none,Ar,zd.lineStartIndex,zd.lineLength,-1,Qu),Qb=Xt.icon.placedSymbolArray.length-1,ec&&(FT=4*ec.length,Xt.addSymbols(Xt.icon,ec,Xc,Vi,si,pi,_.az.vertical,Ar,zd.lineStartIndex,zd.lineLength,-1,Qu),Jb=Xt.icon.placedSymbolArray.length-1)}const $T=Object.keys(Ui.horizontal);for(const Do of $T){const ml=Ui.horizontal[Do];if(!Rp){qT=Vn(ml.text);const ec=Ma.layout.get("text-rotate").evaluate(pi,{},Qu);Rp=new Qr(Ja,Ar,bi,Pa,Po,ml,Co,ps,eo,ec)}const jp=ml.positionedLines.length===1;if(UT+=kT(Xt,Ar,ml,iu,Ma,eo,pi,ms,zd,Ui.vertical?_.az.horizontal:_.az.horizontalOnly,jp?$T:[Do],rf,Qb,fa,Qu),jp)break}Ui.vertical&&(VT+=kT(Xt,Ar,Ui.vertical,iu,Ma,eo,pi,ms,zd,_.az.vertical,["vertical"],rf,Jb,fa,Qu));const zR=Rp?Rp.boxStartIndex:Xt.collisionBoxArray.length,kR=Rp?Rp.boxEndIndex:Xt.collisionBoxArray.length,RR=_g?_g.boxStartIndex:Xt.collisionBoxArray.length,jR=_g?_g.boxEndIndex:Xt.collisionBoxArray.length,LR=vg?vg.boxStartIndex:Xt.collisionBoxArray.length,NR=vg?vg.boxEndIndex:Xt.collisionBoxArray.length,BR=xg?xg.boxStartIndex:Xt.collisionBoxArray.length,FR=xg?xg.boxEndIndex:Xt.collisionBoxArray.length;let Ju=-1;const b0=(Do,ml)=>Do&&Do.circleDiameter?Math.max(Do.circleDiameter,ml):ml;Ju=b0(Rp,Ju),Ju=b0(_g,Ju),Ju=b0(vg,Ju),Ju=b0(xg,Ju);const GT=Ju>-1?1:0;GT&&(Ju*=ov/Fi),Xt.glyphOffsetArray.length>=Uc.MAX_GLYPHS&&fr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pi.sortKey!==void 0&&Xt.addToSortKeyRanges(Xt.symbolInstances.length,pi.sortKey);const UR=zT(Ma,pi,Qu),[VR,qR]=(function(Do,ml){const jp=Do.length,ec=ml?.values;if(ec?.length>0)for(let Lp=0;Lp<ec.length;Lp+=2){const Xc=ec[Lp+1];Do.emplaceBack(_.aP[ec[Lp]],Xc[0],Xc[1])}return[jp,Do.length]})(Xt.textAnchorOffsets,UR);Xt.symbolInstances.emplaceBack(Ar.x,Ar.y,rf.right>=0?rf.right:-1,rf.center>=0?rf.center:-1,rf.left>=0?rf.left:-1,rf.vertical||-1,Qb,Jb,qT,zR,kR,RR,jR,LR,NR,BR,FR,bi,UT,VT,BT,FT,GT,0,Co,Ju,VR,qR)})(s,ar,Ht,a,f,p,mt,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,le,[Se,Se,Se,Se],ht,P,se,Ie,dt,J,r,x,z,L,b)};if(St==="line")for(const Ht of S(r.geometry,0,0,bt,bt)){const ar=zc(Ht,ot),Xt=_r(ar,fe,We,a.vertical||te,f,24,ye,s.overscaling,bt);for(const Ar of Xt)te&&OR(s,te.text,It,Ar)||$t(ar,Ar)}else if(St==="line-center"){for(const Ht of r.geometry)if(Ht.length>1){const ar=zc(Ht,ot),Xt=er(ar,We,a.vertical||te,f,24,ye);Xt&&$t(ar,Xt)}}else if(r.type==="Polygon")for(const Ht of yc(r.geometry,0)){const ar=zr(Ht,16);$t(zc(Ht[0],ot,!0),new Ke(ar.x,ar.y,0))}else if(r.type==="LineString")for(const Ht of r.geometry){const ar=zc(Ht,ot);$t(ar,new Ke(ar[0].x,ar[0].y,0))}else if(r.type==="Point")for(const Ht of r.geometry)for(const ar of Ht)$t([ar],new Ke(ar.x,ar.y,0))}function kT(s,r,a,f,p,x,b,E,P,z,L,N,$,H,J){const te=(function(ye,se,fe,Se,Ie,We,ht,dt){const St=Se.layout.get("text-rotate").evaluate(We,{})*Math.PI/180,It=[];for(const Mt of se.positionedLines)for(const mt of Mt.positionedGlyphs){if(!mt.rect)continue;const ot=mt.rect||{};let $t=4,Ht=!0,ar=1,Xt=0;const Ar=(Ie||dt)&&mt.vertical,Qn=mt.metrics.advance*mt.scale/2;if(dt&&se.verticalizable&&(Xt=Mt.lineOffset/2-(mt.imageName?-(Fi-mt.metrics.width*mt.scale)/2:(mt.scale-1)*Fi)),mt.imageName){const ha=ht[mt.imageName];Ht=ha.sdf,ar=ha.pixelRatio,$t=1/ar}const Ui=Ie?[mt.x+Qn,mt.y]:[0,0];let Qa=Ie?[0,0]:[mt.x+Qn+fe[0],mt.y+fe[1]-Xt],iu=[0,0];Ar&&(iu=Qa,Qa=[0,0]);const $o=mt.metrics.isDoubleResolution?2:1,Ma=(mt.metrics.left-$t)*mt.scale-Qn+Qa[0],Ja=(-mt.metrics.top-$t)*mt.scale+Qa[1],bi=Ma+ot.w/$o*mt.scale/ar,Pa=Ja+ot.h/$o*mt.scale/ar,Po=new M(Ma,Ja),Co=new M(bi,Ja),ps=new M(Ma,Pa),eo=new M(bi,Pa);if(Ar){const ha=new M(-Qn,Qn- -17),si=-Math.PI/2,Vi=12-Qn,pi=new M(22-Vi,-(mt.imageName?Vi:0)),fa=new M(...iu);Po._rotateAround(si,ha)._add(pi)._add(fa),Co._rotateAround(si,ha)._add(pi)._add(fa),ps._rotateAround(si,ha)._add(pi)._add(fa),eo._rotateAround(si,ha)._add(pi)._add(fa)}if(St){const ha=Math.sin(St),si=Math.cos(St),Vi=[si,-ha,ha,si];Po._matMult(Vi),Co._matMult(Vi),ps._matMult(Vi),eo._matMult(Vi)}const ms=new M(0,0),au=new M(0,0);It.push({tl:Po,tr:Co,bl:ps,br:eo,tex:ot,writingMode:se.writingMode,glyphOffset:Ui,sectionIndex:mt.sectionIndex,isSDF:Ht,pixelOffsetTL:ms,pixelOffsetBR:au,minFontScaleX:0,minFontScaleY:0})}return It})(0,a,E,p,x,b,f,s.allowVerticalPlacement),ie=s.textSizeData;let le=null;ie.kind==="source"?(le=[ru*p.layout.get("text-size").evaluate(b,{})],le[0]>Wu&&fr(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ie.kind==="composite"&&(le=[ru*H.compositeTextSizes[0].evaluate(b,{},J),ru*H.compositeTextSizes[1].evaluate(b,{},J)],(le[0]>Wu||le[1]>Wu)&&fr(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,te,le,E,x,b,z,r,P.lineStartIndex,P.lineLength,$,J);for(const ye of L)N[ye]=s.text.placedSymbolArray.length-1;return 4*te.length}function RT(s){for(const r in s)return s[r];return null}function OR(s,r,a,f){const p=s.compareText;if(r in p){const x=p[r];for(let b=x.length-1;b>=0;b--)if(f.dist(x[b])<a)return!0}else p[r]=[];return p[r].push(f),!1}const jT=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gb{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,f]=new Uint8Array(r,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=f>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const x=jT[15&f];if(!x)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(r,2,1),[E]=new Uint32Array(r,4,1);return new Gb(E,b,x,r)}constructor(r,a=64,f=Float64Array,p){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=f,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const x=jT.indexOf(this.ArrayType),b=2*r*this.ArrayType.BYTES_PER_ELEMENT,E=r*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-E%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+E+P,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+b+E+P),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+E+P,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=r)}add(r,a){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=r,this.coords[this._pos++]=a,f}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Zb(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,a,f,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:b,nodeSize:E}=this,P=[0,x.length-1,0],z=[];for(;P.length;){const L=P.pop()||0,N=P.pop()||0,$=P.pop()||0;if(N-$<=E){for(let ie=$;ie<=N;ie++){const le=b[2*ie],ye=b[2*ie+1];le>=r&&le<=f&&ye>=a&&ye<=p&&z.push(x[ie])}continue}const H=$+N>>1,J=b[2*H],te=b[2*H+1];J>=r&&J<=f&&te>=a&&te<=p&&z.push(x[H]),(L===0?r<=J:a<=te)&&(P.push($),P.push(H-1),P.push(1-L)),(L===0?f>=J:p>=te)&&(P.push(H+1),P.push(N),P.push(1-L))}return z}within(r,a,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:x,nodeSize:b}=this,E=[0,p.length-1,0],P=[],z=f*f;for(;E.length;){const L=E.pop()||0,N=E.pop()||0,$=E.pop()||0;if(N-$<=b){for(let ie=$;ie<=N;ie++)NT(x[2*ie],x[2*ie+1],r,a)<=z&&P.push(p[ie]);continue}const H=$+N>>1,J=x[2*H],te=x[2*H+1];NT(J,te,r,a)<=z&&P.push(p[H]),(L===0?r-f<=J:a-f<=te)&&(E.push($),E.push(H-1),E.push(1-L)),(L===0?r+f>=J:a+f>=te)&&(E.push(H+1),E.push(N),E.push(1-L))}return P}}function Zb(s,r,a,f,p,x){if(p-f<=a)return;const b=f+p>>1;LT(s,r,b,f,p,x),Zb(s,r,a,f,b-1,1-x),Zb(s,r,a,b+1,p,1-x)}function LT(s,r,a,f,p,x){for(;p>f;){if(p-f>600){const z=p-f+1,L=a-f+1,N=Math.log(z),$=.5*Math.exp(2*N/3),H=.5*Math.sqrt(N*$*(z-$)/z)*(L-z/2<0?-1:1);LT(s,r,a,Math.max(f,Math.floor(a-L*$/z+H)),Math.min(p,Math.floor(a+(z-L)*$/z+H)),x)}const b=r[2*a+x];let E=f,P=p;for(iv(s,r,f,a),r[2*p+x]>b&&iv(s,r,f,p);E<P;){for(iv(s,r,E,P),E++,P--;r[2*E+x]<b;)E++;for(;r[2*P+x]>b;)P--}r[2*f+x]===b?iv(s,r,f,P):(P++,iv(s,r,P,p)),P<=a&&(f=P+1),a<=P&&(p=P-1)}}function iv(s,r,a,f){Hb(s,a,f),Hb(r,2*a,2*f),Hb(r,2*a+1,2*f+1)}function Hb(s,r,a){const f=s[r];s[r]=s[a],s[a]=f}function NT(s,r,a,f){const p=s-a,x=r-f;return p*p+x*x}var Wb;_.cI=void 0,(Wb=_.cI||(_.cI={})).create="create",Wb.load="load",Wb.fullLoad="fullLoad";let x0=null,av=[];const Yb=1e3/60,Xb="loadTime",Kb="fullLoadTime",IR={mark(s){performance.mark(s)},recordStartOfFrameAt(s){x0!=null&&av.push(s-x0),x0=s},resetRuntimeMetrics(){x0=null,av=[]},clearInitializationMetrics(){performance.clearMeasures(Xb),performance.clearMeasures(Kb);for(const s in _.cI)performance.clearMarks(_.cI[s])},remove(){this.resetRuntimeMetrics(),this.clearInitializationMetrics()},getPerformanceMetrics(){performance.measure(Xb,_.cI.create,_.cI.load),performance.measure(Kb,_.cI.create,_.cI.fullLoad);const s=performance.getEntriesByName(Xb)[0].duration,r=performance.getEntriesByName(Kb)[0].duration,a=av.length;return{loadTimeMs:s,fullLoadTimeMs:r,averageFramesPerSecond:1/(av.reduce(((f,p)=>f+p),0)/a/1e3),virtualDroppedFramesCount:av.filter((f=>f>Yb)).reduce(((f,p)=>f+(p-Yb)/Yb),0),totalFramesCount:a}}};_.$=q,_.A=ge,_.B=Pu,_.C=is,_.D=Bt,_.E=Xe,_.F=function([s,r,a]){return r+=90,r*=Math.PI/180,a*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(a),y:s*Math.sin(r)*Math.sin(a),z:s*Math.cos(a)}},_.G=Wi,_.H=ln,_.I=Cy,_.J=Mu,_.K=function(s){if(Tr==null){const r=s.navigator?s.navigator.userAgent:null;Tr=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Tr},_.L=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Y_((()=>this.process())),this.subscription=bn(this.target,"message",(a=>this.receive(a)),!1),this.globalScope=rn(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}unregisterMessageHandler(s){delete this.messageHandlers[s]}sendAsync(s,r){return new Promise(((a,f)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=r?bn(r.signal,"abort",(()=>{x?.unsubscribe(),delete this.resolveRejects[p];const P={id:p,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(P)}),Ny):null;this.resolveRejects[p]={resolve:P=>{x?.unsubscribe(),a(P)},reject:P=>{x?.unsubscribe(),f(P)}};const b=[],E=Object.assign(Object.assign({},s),{id:p,sourceMapId:this.mapId,origin:location.origin,data:Ta(s.data,b)});this.target.postMessage(E,{transfer:b})}))}receive(s){const r=s.data,a=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[a];const f=this.abortControllers[a];return delete this.abortControllers[a],void(f&&f.abort())}if(rn(self)||r.mustQueue)return this.tasks[a]=r,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return c(this,void 0,void 0,(function*(){if(r.type==="<response>"){const p=this.resolveRejects[s];return delete this.resolveRejects[s],p?void(r.error?p.reject(Ec(r.error)):p.resolve(Ec(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Ec(r.data),f=new AbortController;this.abortControllers[s]=f;try{const p=yield this.messageHandlers[r.type](r.sourceMapId,a,f);this.completeTask(s,null,p)}catch(p){this.completeTask(s,p)}}))}completeTask(s,r,a){const f=[];delete this.abortControllers[s];const p={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Ta(r):null,data:Ta(a,f)};this.target.postMessage(p,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},_.M=ne,_.N=function(){var s=new ge(16);return ge!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},_.O=function(s,r,a){var f,p,x,b,E,P,z,L,N,$,H,J,te=a[0],ie=a[1],le=a[2];return r===s?(s[12]=r[0]*te+r[4]*ie+r[8]*le+r[12],s[13]=r[1]*te+r[5]*ie+r[9]*le+r[13],s[14]=r[2]*te+r[6]*ie+r[10]*le+r[14],s[15]=r[3]*te+r[7]*ie+r[11]*le+r[15]):(p=r[1],x=r[2],b=r[3],E=r[4],P=r[5],z=r[6],L=r[7],N=r[8],$=r[9],H=r[10],J=r[11],s[0]=f=r[0],s[1]=p,s[2]=x,s[3]=b,s[4]=E,s[5]=P,s[6]=z,s[7]=L,s[8]=N,s[9]=$,s[10]=H,s[11]=J,s[12]=f*te+E*ie+N*le+r[12],s[13]=p*te+P*ie+$*le+r[13],s[14]=x*te+z*ie+H*le+r[14],s[15]=b*te+L*ie+J*le+r[15]),s},_.P=M,_.Q=function(s,r,a){var f=a[0],p=a[1],x=a[2];return s[0]=r[0]*f,s[1]=r[1]*f,s[2]=r[2]*f,s[3]=r[3]*f,s[4]=r[4]*p,s[5]=r[5]*p,s[6]=r[6]*p,s[7]=r[7]*p,s[8]=r[8]*x,s[9]=r[9]*x,s[10]=r[10]*x,s[11]=r[11]*x,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},_.R=Wa,_.S=function(s,r,a){var f=r[0],p=r[1],x=r[2],b=r[3],E=r[4],P=r[5],z=r[6],L=r[7],N=r[8],$=r[9],H=r[10],J=r[11],te=r[12],ie=r[13],le=r[14],ye=r[15],se=a[0],fe=a[1],Se=a[2],Ie=a[3];return s[0]=se*f+fe*E+Se*N+Ie*te,s[1]=se*p+fe*P+Se*$+Ie*ie,s[2]=se*x+fe*z+Se*H+Ie*le,s[3]=se*b+fe*L+Se*J+Ie*ye,s[4]=(se=a[4])*f+(fe=a[5])*E+(Se=a[6])*N+(Ie=a[7])*te,s[5]=se*p+fe*P+Se*$+Ie*ie,s[6]=se*x+fe*z+Se*H+Ie*le,s[7]=se*b+fe*L+Se*J+Ie*ye,s[8]=(se=a[8])*f+(fe=a[9])*E+(Se=a[10])*N+(Ie=a[11])*te,s[9]=se*p+fe*P+Se*$+Ie*ie,s[10]=se*x+fe*z+Se*H+Ie*le,s[11]=se*b+fe*L+Se*J+Ie*ye,s[12]=(se=a[12])*f+(fe=a[13])*E+(Se=a[14])*N+(Ie=a[15])*te,s[13]=se*p+fe*P+Se*$+Ie*ie,s[14]=se*x+fe*z+Se*H+Ie*le,s[15]=se*b+fe*L+Se*J+Ie*ye,s},_.T=Kl,_.U=function(s,r){const a={};for(let f=0;f<r.length;f++){const p=r[f];p in s&&(a[p]=s[p])}return a},_.V=dl,_.W=Vt,_.X=Q_,_.Y=K_,_.Z=ws,_._=c,_.a=du,_.a$=yt,_.a0=ue,_.a1=ka,_.a2=Ya,_.a3=Uy,_.a4=mn,_.a5=bt,_.a6=function(s,r,a){if(!s)return r||{};if(!r)return s||{};const f=Vy(s),p=Vy(r);(function(b,E){E.removeAll&&(b.add.clear(),b.update.clear(),b.remove.clear(),E.remove.clear());for(const P of E.remove)b.add.delete(P),b.update.delete(P);for(const[P,z]of E.update){const L=b.update.get(P);L&&(E.update.set(P,t0(L,z)),b.update.delete(P))}})(f,p);const x={};if((f.removeAll||p.removeAll)&&(x.removeAll=!0),x.remove=new Set([...f.remove,...p.remove]),x.add=new Map([...f.add,...p.add]),x.update=new Map([...f.update,...p.update]),x.remove.size&&x.add.size)for(const b of x.add.keys())x.remove.delete(b);return(function(b){const E={};return b.removeAll&&(E.removeAll=b.removeAll),b.remove&&(E.remove=Array.from(b.remove)),b.add&&(E.add=Array.from(b.add.values())),b.update&&(E.update=Array.from(b.update.values())),E})(x)},_.a7=function(s,r){const a=new Map;if(s==null||s.type==null)return a;if(s.type==="Feature"){const f=bd(s,r);return f==null?void 0:(a.set(f,s),a)}if(s.type==="FeatureCollection"){const f=new Set;for(const p of s.features){const x=bd(p,r);if(x==null||f.has(x))return;f.add(x),a.set(x,p)}return a}},_.a8=function(s,r,a){var f,p;const x=[];if(r.removeAll)s.clear();else if(r.remove)for(const b of r.remove){const E=s.get(b);E&&(x.push(E.geometry),s.delete(b))}if(r.add)for(const b of r.add){const E=bd(b,a);if(E==null)continue;const P=s.get(E);P&&x.push(P.geometry),x.push(b.geometry),s.set(E,b)}if(r.update)for(const b of r.update){const E=s.get(b.id);if(!E)continue;const P=!!b.newGeometry,z=b.removeAllProperties||((f=b.removeProperties)===null||f===void 0?void 0:f.length)>0||((p=b.addOrUpdateProperties)===null||p===void 0?void 0:p.length)>0;if(!P&&!z)continue;x.push(E.geometry);const L=Object.assign({},E);if(s.set(b.id,L),P&&(x.push(b.newGeometry),L.geometry=b.newGeometry),z){if(L.properties=b.removeAllProperties?{}:Object.assign({},L.properties||{}),b.removeProperties)for(const N of b.removeProperties)delete L.properties[N];if(b.addOrUpdateProperties)for(const{key:N,value:$}of b.addOrUpdateProperties)L.properties[N]=$}}return x},_.a9=Ii,_.aA=function(s,{uSize:r,uSizeT:a},{lowerSize:f,upperSize:p}){return s.kind==="source"?f/ru:s.kind==="composite"?Wi.number(f/ru,p/ru,a):r},_.aB=function(s,r){var a=r[0],f=r[1],p=r[2],x=r[3],b=r[4],E=r[5],P=r[6],z=r[7],L=r[8],N=r[9],$=r[10],H=r[11],J=r[12],te=r[13],ie=r[14],le=r[15],ye=a*E-f*b,se=a*P-p*b,fe=a*z-x*b,Se=f*P-p*E,Ie=f*z-x*E,We=p*z-x*P,ht=L*te-N*J,dt=L*ie-$*J,St=L*le-H*J,It=N*ie-$*te,Mt=N*le-H*te,mt=$*le-H*ie,ot=ye*mt-se*Mt+fe*It+Se*St-Ie*dt+We*ht;return ot?(s[0]=(E*mt-P*Mt+z*It)*(ot=1/ot),s[1]=(p*Mt-f*mt-x*It)*ot,s[2]=(te*We-ie*Ie+le*Se)*ot,s[3]=($*Ie-N*We-H*Se)*ot,s[4]=(P*St-b*mt-z*dt)*ot,s[5]=(a*mt-p*St+x*dt)*ot,s[6]=(ie*fe-J*We-le*se)*ot,s[7]=(L*We-$*fe+H*se)*ot,s[8]=(b*Mt-E*St+z*ht)*ot,s[9]=(f*St-a*Mt-x*ht)*ot,s[10]=(J*Ie-te*fe+le*ye)*ot,s[11]=(N*fe-L*Ie-H*ye)*ot,s[12]=(E*dt-b*It-P*ht)*ot,s[13]=(a*It-f*dt+p*ht)*ot,s[14]=(te*se-J*Se-ie*ye)*ot,s[15]=(L*Se-N*se+$*ye)*ot,s):null},_.aC=at,_.aD=function(s){var r=s[0],a=s[1];return Math.sqrt(r*r+a*a)},_.aE=function(s){return s[0]=0,s[1]=0,s},_.aF=function(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s},_.aG=eg,_.aH=zt,_.aI=function(s,r,a,f){const p=r.y-s.y,x=r.x-s.x,b=f.y-a.y,E=f.x-a.x,P=b*x-E*p;if(P===0)return null;const z=(E*(s.y-a.y)-b*(s.x-a.x))/P;return new M(s.x+z*x,s.y+z*p)},_.aJ=S,_.aK=ud,_.aL=function(s){let r=1/0,a=1/0,f=-1/0,p=-1/0;for(const x of s)r=Math.min(r,x.x),a=Math.min(a,x.y),f=Math.max(f,x.x),p=Math.max(p,x.y);return[r,a,f,p]},_.aM=Fi,_.aN=Ut,_.aO=function(s,r,a,f,p=!1){if(!a[0]&&!a[1])return[0,0];const x=p?f==="map"?-s.bearingInRadians:0:f==="viewport"?s.bearingInRadians:0;if(x){const b=Math.sin(x),E=Math.cos(x);a=[a[0]*E-a[1]*b,a[0]*b+a[1]*E]}return[p?a[0]:Ut(r,a[0],s.zoom),p?a[1]:Ut(r,a[1],s.zoom)]},_.aQ=Jm,_.aR=$b,_.aS=Oy,_.aT=Gb,_.aU=Rn,_.aV=Jl,_.aW=oe,_.aX=ut,_.aY=He,_.aZ=ma,_.a_=rg,_.aa=Yu,_.ab=25,_.ac=ng,_.ad=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise((a=>{r.onloadstart=()=>{a(r)};for(const f of s){const p=window.document.createElement("source");qe(f)||(r.crossOrigin="Anonymous"),p.src=f,r.appendChild(p)}}))},_.ae=Et,_.af=function(){return ft++},_.ag=d,_.ah=Uc,_.ai=Dd,_.aj=Ua,_.ak=cs,_.al=r0,_.am=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((a,f,p,x)=>{const b=p||x;return r[f]=!b||b.toLowerCase(),""})),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r},_.an=Lt,_.ao=85.051129,_.ap=kn,_.aq=function(s){return Math.pow(2,s)},_.ar=ze,_.as=Fy,_.at=function(s){return Math.log(s)/Math.LN2},_.au=function(s){var r=s[0],a=s[1];return r*r+a*a},_.av=function(s){if(!s.length)return new Set;const r=Math.max(...s.map((P=>P.canonical.z)));let a=1/0,f=-1/0,p=1/0,x=-1/0;const b=[];for(const P of s){const{x:z,y:L,z:N}=P.canonical,$=Math.pow(2,r-N),H=z*$,J=L*$;b.push({id:P,x:H,y:J}),H<a&&(a=H),H>f&&(f=H),J<p&&(p=J),J>x&&(x=J)}const E=new Set;for(const P of b)P.x!==a&&P.x!==f&&P.y!==p&&P.y!==x||E.add(P.id);return E},_.aw=function(s,r){const a=Math.abs(2*s.wrap)-+(s.wrap<0),f=Math.abs(2*r.wrap)-+(r.wrap<0);return s.overscaledZ-r.overscaledZ||f-a||r.canonical.y-s.canonical.y||r.canonical.x-s.canonical.x},_.ax=class{constructor(s,r){this.max=s,this.onRemove=r,this.reset()}reset(){for(const s in this.data)for(const r of this.data[s])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(s,r,a){const f=s.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const p={value:r,timeout:void 0};if(a!==void 0&&(p.timeout=setTimeout((()=>{this.remove(s,p)}),a)),this.data[f].push(p),this.order.push(f),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const r=this.data[s].shift();return r.timeout&&clearTimeout(r.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),r.value}getByKey(s){const r=this.data[s];return r?r[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,r){if(!this.has(s))return this;const a=s.wrapped().key,f=r===void 0?0:this.data[a].indexOf(r),p=this.data[a][f];return this.data[a].splice(f,1),p.timeout&&clearTimeout(p.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(p.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(s){const r=[];for(const a in this.data)for(const f of this.data[a])s(f.value)||r.push(f);for(const a of r)this.remove(a.value.tileID,a)}},_.ay=function(s,r){let a=0,f=0;if(s.kind==="constant")f=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:x,maxZoom:b}=s,E=p?Lt(_a.interpolationFactor(p,r,x,b),0,1):0;s.kind==="camera"?f=Wi.number(s.minSize,s.maxSize,E):a=E}return{uSizeT:a,uSize:f}},_.b=za,_.b$=hl,_.b0=gt,_.b1=function(s){var r=new ge(3);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r},_.b2=function(s,r,a){return s[0]=r[0]-a[0],s[1]=r[1]-a[1],s[2]=r[2]-a[2],s},_.b3=function(s,r){var a=r[0],f=r[1],p=r[2],x=a*a+f*f+p*p;return x>0&&(x=1/Math.sqrt(x)),s[0]=r[0]*x,s[1]=r[1]*x,s[2]=r[2]*x,s},_.b4=tt,_.b5=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]},_.b6=function(s,r,a){return s[0]=r[0]*a[0],s[1]=r[1]*a[1],s[2]=r[2]*a[2],s[3]=r[3]*a[3],s},_.b7=Oe,_.b8=function(s,r,a){const f=r[0]*a[0]+r[1]*a[1]+r[2]*a[2];return f===0?null:(-(s[0]*a[0]+s[1]*a[1]+s[2]*a[2])-a[3])/f},_.b9=Rt,_.bA=function(){return new Float64Array(3)},_.bB=Ue,_.bC=function(s,r,a){var f=a[0],p=a[1],x=a[2],b=a[3],E=r[0],P=r[1],z=r[2],L=p*z-x*P,N=x*E-f*z,$=f*P-p*E;return s[0]=E+b*(L+=L)+p*($+=$)-x*(N+=N),s[1]=P+b*N+x*L-f*$,s[2]=z+b*$+f*N-p*L,s},_.bD=function(s,r,a){const f=(p=[s[0],s[1],s[2],r[0],r[1],r[2],a[0],a[1],a[2]])[0]*((L=p[8])*(b=p[4])-(E=p[5])*(z=p[7]))+p[1]*(-L*(x=p[3])+E*(P=p[6]))+p[2]*(z*x-b*P);var p,x,b,E,P,z,L;if(f===0)return null;const N=tt([],[r[0],r[1],r[2]],[a[0],a[1],a[2]]),$=tt([],[a[0],a[1],a[2]],[s[0],s[1],s[2]]),H=tt([],[s[0],s[1],s[2]],[r[0],r[1],r[2]]),J=yt([],N,-s[3]);return gt(J,J,yt([],$,-r[3])),gt(J,J,yt([],H,-a[3])),yt(J,J,1/f),J},_.bE=Yh,_.bF=function(){return new Float64Array(4)},_.bG=function(s,r,a,f){var p=[],x=[];return p[0]=r[0]-a[0],p[1]=r[1]-a[1],p[2]=r[2]-a[2],x[0]=p[0]*Math.cos(f)-p[1]*Math.sin(f),x[1]=p[0]*Math.sin(f)+p[1]*Math.cos(f),x[2]=p[2],s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},_.bH=function(s,r,a,f){var p=[],x=[];return p[0]=r[0]-a[0],p[1]=r[1]-a[1],p[2]=r[2]-a[2],x[0]=p[0],x[1]=p[1]*Math.cos(f)-p[2]*Math.sin(f),x[2]=p[1]*Math.sin(f)+p[2]*Math.cos(f),s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},_.bI=function(s,r,a,f){var p=[],x=[];return p[0]=r[0]-a[0],p[1]=r[1]-a[1],p[2]=r[2]-a[2],x[0]=p[2]*Math.sin(f)+p[0]*Math.cos(f),x[1]=p[1],x[2]=p[2]*Math.cos(f)-p[0]*Math.sin(f),s[0]=x[0]+a[0],s[1]=x[1]+a[1],s[2]=x[2]+a[2],s},_.bJ=function(s,r,a){var f=Math.sin(a),p=Math.cos(a),x=r[0],b=r[1],E=r[2],P=r[3],z=r[8],L=r[9],N=r[10],$=r[11];return r!==s&&(s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=x*p-z*f,s[1]=b*p-L*f,s[2]=E*p-N*f,s[3]=P*p-$*f,s[8]=x*f+z*p,s[9]=b*f+L*p,s[10]=E*f+N*p,s[11]=P*f+$*p,s},_.bK=function(s,r){const a=Ce(s,360),f=Ce(r,360),p=f-a,x=f>a?p-360:p+360;return Math.abs(p)<Math.abs(x)?p:x},_.bL=function(s){return s[0]=0,s[1]=0,s[2]=0,s},_.bM=function(s,r,a,f){const p=Math.sqrt(s*s+r*r),x=Math.sqrt(a*a+f*f);s/=p,r/=p,a/=x,f/=x;const b=Math.acos(s*a+r*f);return-r*a+s*f>0?b:-b},_.bN=function(s,r){const a=Ce(s,2*Math.PI),f=Ce(r,2*Math.PI);return Math.min(Math.abs(a-f),Math.abs(a-f+2*Math.PI),Math.abs(a-f-2*Math.PI))},_.bO=function(){const s={},r=Me.$version;for(const a in Me.$root){const f=Me.$root[a];if(f.required){let p=null;p=a==="version"?r:f.type==="array"?[]:{},p!=null&&(s[a]=p)}}return s},_.bP=_e,_.bQ=Kf,_.bR=function s(r,a){if(Array.isArray(r)){if(!Array.isArray(a)||r.length!==a.length)return!1;for(let f=0;f<r.length;f++)if(!s(r[f],a[f]))return!1;return!0}if(typeof r=="object"&&r!==null&&a!==null){if(typeof a!="object"||Object.keys(r).length!==Object.keys(a).length)return!1;for(const f in r)if(!s(r[f],a[f]))return!1;return!0}return r===a},_.bS=function(s){s=s.slice();const r=Object.create(null);for(let a=0;a<s.length;a++)r[s[a].id]=s[a];for(let a=0;a<s.length;a++)"ref"in s[a]&&(s[a]=hr(s[a],r[s[a].ref]));return s},_.bT=function(s,r){if(s.type==="custom")return new Ly(s,r);switch(s.type){case"background":return new tg(s,r);case"circle":return new Cm(s,r);case"color-relief":return new yp(s,r);case"fill":return new A_(s,r);case"fill-extrusion":return new md(s,r);case"heatmap":return new km(s,r);case"hillshade":return new jb(s,r);case"line":return new C_(s,r);case"raster":return new Rs(s,r);case"symbol":return new wp(s,r)}},_.bU=s=>s.type==="raster",_.bV=Tt,_.bW=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let a=[];try{if(!Yt(s.version,r.version))return[{command:"setStyle",args:[r]}];Yt(s.center,r.center)||a.push({command:"setCenter",args:[r.center]}),Yt(s.state,r.state)||a.push({command:"setGlobalState",args:[r.state]}),Yt(s.centerAltitude,r.centerAltitude)||a.push({command:"setCenterAltitude",args:[r.centerAltitude]}),Yt(s.zoom,r.zoom)||a.push({command:"setZoom",args:[r.zoom]}),Yt(s.bearing,r.bearing)||a.push({command:"setBearing",args:[r.bearing]}),Yt(s.pitch,r.pitch)||a.push({command:"setPitch",args:[r.pitch]}),Yt(s.roll,r.roll)||a.push({command:"setRoll",args:[r.roll]}),Yt(s.sprite,r.sprite)||a.push({command:"setSprite",args:[r.sprite]}),Yt(s.glyphs,r.glyphs)||a.push({command:"setGlyphs",args:[r.glyphs]}),Yt(s.transition,r.transition)||a.push({command:"setTransition",args:[r.transition]}),Yt(s.light,r.light)||a.push({command:"setLight",args:[r.light]}),Yt(s.terrain,r.terrain)||a.push({command:"setTerrain",args:[r.terrain]}),Yt(s.sky,r.sky)||a.push({command:"setSky",args:[r.sky]}),Yt(s.projection,r.projection)||a.push({command:"setProjection",args:[r.projection]});const f={},p=[];(function(b,E,P,z){let L;for(L in E=E||{},b=b||{})Object.prototype.hasOwnProperty.call(b,L)&&(Object.prototype.hasOwnProperty.call(E,L)||mr(L,P,z));for(L in E)Object.prototype.hasOwnProperty.call(E,L)&&(Object.prototype.hasOwnProperty.call(b,L)?Yt(b[L],E[L])||(b[L].type==="geojson"&&E[L].type==="geojson"&&nn(b,E,L)?lr(P,{command:"setGeoJSONSourceData",args:[L,E[L].data]}):Bn(L,E,P,z)):rr(L,E,P))})(s.sources,r.sources,p,f);const x=[];s.layers&&s.layers.forEach((b=>{"source"in b&&f[b.source]?a.push({command:"removeLayer",args:[b.id]}):x.push(b)})),a=a.concat(p),(function(b,E,P){E=E||[];const z=(b=b||[]).map(ui),L=E.map(ui),N=b.reduce(an,{}),$=E.reduce(an,{}),H=z.slice(),J=Object.create(null);let te,ie,le,ye,se;for(let fe=0,Se=0;fe<z.length;fe++)te=z[fe],Object.prototype.hasOwnProperty.call($,te)?Se++:(lr(P,{command:"removeLayer",args:[te]}),H.splice(H.indexOf(te,Se),1));for(let fe=0,Se=0;fe<L.length;fe++)te=L[L.length-1-fe],H[H.length-1-fe]!==te&&(Object.prototype.hasOwnProperty.call(N,te)?(lr(P,{command:"removeLayer",args:[te]}),H.splice(H.lastIndexOf(te,H.length-Se),1)):Se++,ye=H[H.length-fe],lr(P,{command:"addLayer",args:[$[te],ye]}),H.splice(H.length-fe,0,te),J[te]=!0);for(let fe=0;fe<L.length;fe++)if(te=L[fe],ie=N[te],le=$[te],!J[te]&&!Yt(ie,le))if(Yt(ie.source,le.source)&&Yt(ie["source-layer"],le["source-layer"])&&Yt(ie.type,le.type)){for(se in hn(ie.layout,le.layout,P,te,null,"setLayoutProperty"),hn(ie.paint,le.paint,P,te,null,"setPaintProperty"),Yt(ie.filter,le.filter)||lr(P,{command:"setFilter",args:[te,le.filter]}),Yt(ie.minzoom,le.minzoom)&&Yt(ie.maxzoom,le.maxzoom)||lr(P,{command:"setLayerZoomRange",args:[te,le.minzoom,le.maxzoom]}),ie)Object.prototype.hasOwnProperty.call(ie,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?hn(ie[se],le[se],P,te,se.slice(6),"setPaintProperty"):Yt(ie[se],le[se])||lr(P,{command:"setLayerProperty",args:[te,se,le[se]]}));for(se in le)Object.prototype.hasOwnProperty.call(le,se)&&!Object.prototype.hasOwnProperty.call(ie,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?hn(ie[se],le[se],P,te,se.slice(6),"setPaintProperty"):Yt(ie[se],le[se])||lr(P,{command:"setLayerProperty",args:[te,se,le[se]]}))}else lr(P,{command:"removeLayer",args:[te]}),ye=H[H.lastIndexOf(te)+1],lr(P,{command:"addLayer",args:[le,ye]})})(x,r.layers,a)}catch(f){console.warn("Unable to compute style diff:",f),a=[{command:"setStyle",args:[r]}]}return a},_.bX=function(s){const r=[],a=s.id;return a===void 0&&r.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},_.bY=tr,_.bZ=pr,_.b_=class extends Aa{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},_.ba=function(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s[3]=r[3]*a,s},_.bb=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]},_.bc=e0,_.bd=Vc,_.be=function(s,r,a,f,p){var x=1/Math.tan(r/2);if(s[0]=x/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0){var b=1/(f-p);s[10]=(p+f)*b,s[14]=2*p*f*b}else s[10]=-1,s[14]=-2*f;return s},_.bf=function(s){var r=new ge(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},_.bg=function(s,r,a){var f=Math.sin(a),p=Math.cos(a),x=r[0],b=r[1],E=r[2],P=r[3],z=r[4],L=r[5],N=r[6],$=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=x*p+z*f,s[1]=b*p+L*f,s[2]=E*p+N*f,s[3]=P*p+$*f,s[4]=z*p-x*f,s[5]=L*p-b*f,s[6]=N*p-E*f,s[7]=$*p-P*f,s},_.bh=function(s,r,a){var f=Math.sin(a),p=Math.cos(a),x=r[4],b=r[5],E=r[6],P=r[7],z=r[8],L=r[9],N=r[10],$=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=x*p+z*f,s[5]=b*p+L*f,s[6]=E*p+N*f,s[7]=P*p+$*f,s[8]=z*p-x*f,s[9]=L*p-b*f,s[10]=N*p-E*f,s[11]=$*p-P*f,s},_.bi=function(){const s=new Float32Array(16);return ze(s),s},_.bj=function(){const s=new Float64Array(16);return ze(s),s},_.bk=function(){return new Float64Array(16)},_.bl=function(s,r,a){const f=new Float64Array(4);return Ue(f,s,r-90,a),f},_.bm=function(s,r,a,f){var p,x,b,E,P,z=r[0],L=r[1],N=r[2],$=r[3],H=a[0],J=a[1],te=a[2],ie=a[3];return(x=z*H+L*J+N*te+$*ie)<0&&(x=-x,H=-H,J=-J,te=-te,ie=-ie),1-x>me?(p=Math.acos(x),b=Math.sin(p),E=Math.sin((1-f)*p)/b,P=Math.sin(f*p)/b):(E=1-f,P=f),s[0]=E*z+P*H,s[1]=E*L+P*J,s[2]=E*N+P*te,s[3]=E*$+P*ie,s},_.bn=function(s){const r=new Float64Array(9);var a,f,p,x,b,E,P,z,L,N,$,H,J,te,ie,le,ye,se;N=(p=(f=s)[0])*(P=p+p),$=(x=f[1])*P,J=(b=f[2])*P,te=b*(z=x+x),le=(E=f[3])*P,ye=E*z,se=E*(L=b+b),(a=r)[0]=1-(H=x*z)-(ie=b*L),a[3]=$-se,a[6]=J+ye,a[1]=$+se,a[4]=1-N-ie,a[7]=te-le,a[2]=J-ye,a[5]=te+le,a[8]=1-N-H;const fe=ma(-Math.asin(Lt(r[2],-1,1)));let Se,Ie;return Math.hypot(r[5],r[8])<.001?(Se=0,Ie=-ma(Math.atan2(r[3],r[4]))):(Se=ma(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),Ie=ma(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:Se,pitch:fe+90,bearing:Ie}},_.bo=function(s,r){return s.roll==r.roll&&s.pitch==r.pitch&&s.bearing==r.bearing},_.bp=Ot,_.bq=cl,_.br=Fo,_.bs=Vh,_.bt=Bo,_.bu=nt,_.bv=Be,_.bw=ni,_.bx=function(s,r,a,f,p){return nt(f,p,Lt((s-r)/(a-r),0,1))},_.by=function(s,r,a,f){return s[0]=r[0]+a[0]*f,s[1]=r[1]+a[1]*f,s[2]=r[2]+a[2]*f,s},_.bz=Ce,_.c=je,_.c$=class{constructor(s){this.start=`${s}#start`,this.end=`${s}#end`,this.measure=s,performance.mark(this.start)}finish(){performance.mark(this.end);let s=performance.getEntriesByName(this.measure);return s.length===0&&(performance.measure(this.measure,this.start,this.end),s=performance.getEntriesByName(this.measure),performance.clearMarks(this.start),performance.clearMarks(this.end),performance.clearMeasures(this.measure)),s}},_.c0=class extends Aa{constructor(s,r){super(s,r),this.current=Gl}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},_.c1=Cc,_.c2=class extends Aa{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},_.c3=class extends Aa{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},_.c4=be,_.c5=function(s,r){var a=Math.sin(r),f=Math.cos(r);return s[0]=f,s[1]=a,s[2]=0,s[3]=-a,s[4]=f,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},_.c6=function(s,r,a){var f=r[0],p=r[1],x=r[2];return s[0]=f*a[0]+p*a[3]+x*a[6],s[1]=f*a[1]+p*a[4]+x*a[7],s[2]=f*a[2]+p*a[5]+x*a[8],s},_.c7=function(s,r,a,f,p,x,b){var E=1/(r-a),P=1/(f-p),z=1/(x-b);return s[0]=-2*E,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*P,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*z,s[11]=0,s[12]=(r+a)*E,s[13]=(p+f)*P,s[14]=(b+x)*z,s[15]=1,s},_.c8=class extends Aa{constructor(s,r){super(s,r),this.current=new Array}set(s){if(s!=this.current){this.current=s;const r=new Float32Array(4*s.length);for(let a=0;a<s.length;a++)r[4*a]=s[a].r,r[4*a+1]=s[a].g,r[4*a+2]=s[a].b,r[4*a+3]=s[a].a;this.gl.uniform4fv(this.location,r)}}},_.c9=class extends Aa{constructor(s,r){super(s,r),this.current=new Array}set(s){if(s!=this.current){this.current=s;const r=new Float32Array(s);this.gl.uniform1fv(this.location,r)}}},_.cA=function(s,r){var a;if(!ta[r])return!1;const f=s?.target,p=((a=f?.ownerDocument)===null||a===void 0?void 0:a.defaultView)||window;return s instanceof p.MouseEvent||s instanceof p.WheelEvent},_.cB=function(s,r){return co[r]&&"touches"in s},_.cC=function(s){return co[s]||ta[s]},_.cD=function(s,r,a){var f=r[0],p=r[1];return s[0]=a[0]*f+a[4]*p+a[12],s[1]=a[1]*f+a[5]*p+a[13],s},_.cE=function(s,r){const{x:a,y:f}=Ii.fromLngLat(r);return!(s<0||s>25||f<0||f>=1||a<0||a>=1)},_.cF=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},_.cG=class extends ku{},_.cH=IR,_.cJ=ae,_.cK=function(s,r){je.REGISTERED_PROTOCOLS[s]=r},_.cL=function(s){delete je.REGISTERED_PROTOCOLS[s]},_.cM=function(s,r){const a={};for(let p=0;p<s.length;p++){const x=r&&r[s[p].id]||tl(s[p]);r&&(r[s[p].id]=x);let b=a[x];b||(b=a[x]=[]),b.push(s[p])}const f=[];for(const p in a)f.push(a[p]);return f},_.cN=jt,_.cO=ig,_.cP=l,_.cQ=Dy,_.cR=function(s){var r;s.bucket.createArrays(),s.bucket.tilePixelRatio=bt/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const a=s.bucket.layers[0],f=a.layout,p=a._unevaluatedLayout._values,x={layoutIconSize:p["icon-size"].possiblyEvaluate(new ln(s.bucket.zoom+1),s.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new ln(s.bucket.zoom+1),s.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new ln(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=s.bucket.textSizeData;x.compositeTextSizes=[p["text-size"].possiblyEvaluate(new ln(L),s.canonical),p["text-size"].possiblyEvaluate(new ln(N),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:N}=s.bucket.iconSizeData;x.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new ln(L),s.canonical),p["icon-size"].possiblyEvaluate(new ln(N),s.canonical)]}const b=f.get("text-line-height")*Fi,E=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",P=f.get("text-keep-upright"),z=f.get("text-size");for(const L of s.bucket.features){const N=f.get("text-font").evaluate(L,{},s.canonical).join(","),$=z.evaluate(L,{},s.canonical),H=x.layoutTextSize.evaluate(L,{},s.canonical),J=x.layoutIconSize.evaluate(L,{},s.canonical),te={horizontal:{},vertical:void 0},ie=L.text;let le,ye=[0,0];if(ie){const Se=ie.toString(),Ie=f.get("text-letter-spacing").evaluate(L,{},s.canonical)*Fi,We=Du(Se)?Ie:0,ht=f.get("text-anchor").evaluate(L,{},s.canonical),dt=zT(a,L,s.canonical);if(!dt){const mt=f.get("text-radial-offset").evaluate(L,{},s.canonical);ye=mt?IT(ht,[mt*Fi,nv]):f.get("text-offset").evaluate(L,{},s.canonical).map((ot=>ot*Fi))}let St=E?"center":f.get("text-justify").evaluate(L,{},s.canonical);const It=f.get("symbol-placement")==="point"?f.get("text-max-width").evaluate(L,{},s.canonical)*Fi:1/0,Mt=()=>{s.bucket.allowVerticalPlacement&&Cu(Se)&&(te.vertical=Xm(ie,s.glyphMap,s.glyphPositions,s.imagePositions,N,It,b,ht,"left",We,ye,_.az.vertical,!0,H,$))};if(!E&&dt){const mt=new Set;if(St==="auto")for(let $t=0;$t<dt.values.length;$t+=2)mt.add($b(dt.values[$t]));else mt.add(St);let ot=!1;for(const $t of mt)if(!te.horizontal[$t])if(ot)te.horizontal[$t]=te.horizontal[0];else{const Ht=Xm(ie,s.glyphMap,s.glyphPositions,s.imagePositions,N,It,b,"center",$t,We,ye,_.az.horizontal,!1,H,$);Ht&&(te.horizontal[$t]=Ht,ot=Ht.positionedLines.length===1)}Mt()}else{St==="auto"&&(St=$b(ht));const mt=Xm(ie,s.glyphMap,s.glyphPositions,s.imagePositions,N,It,b,ht,St,We,ye,_.az.horizontal,!1,H,$);mt&&(te.horizontal[St]=mt),Mt(),Cu(Se)&&E&&P&&(te.vertical=Xm(ie,s.glyphMap,s.glyphPositions,s.imagePositions,N,It,b,ht,St,We,ye,_.az.vertical,!1,H,$))}}let se=!1;if(L.icon&&L.icon.name){const Se=s.imageMap[L.icon.name];Se&&(le=tu(s.imagePositions[L.icon.name],f.get("icon-offset").evaluate(L,{},s.canonical),f.get("icon-anchor").evaluate(L,{},s.canonical)),se=!!Se.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=se:s.bucket.sdfIcons!==se&&fr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Se.pixelRatio!==s.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const fe=RT(te.horizontal)||te.vertical;(r=s.bucket).iconsInText||(r.iconsInText=!!fe&&fe.iconsInText),(fe||le)&&DR(s.bucket,L,te,le,s.imageMap,x,H,J,ye,se,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},_.cS=kc,_.cT=fl,_.cU=Oi,_.cV=function(s){const r=new Zm;return(function(a,f){for(const p in a.layers)f.writeMessage(3,Od,a.layers[p])})(s,r),r.finish()},_.cW=function(s,r,a,f,p,x){let b=I(s,r,a,p,0);return b=I(b,r,f,x,1),b},_.cX=class{constructor(s){this.maxEntries=s,this.map=new Map}get(s){const r=this.map.get(s);return r!==void 0&&(this.map.delete(s),this.map.set(s,r)),r}set(s,r){if(this.map.has(s))this.map.delete(s);else if(this.map.size>=this.maxEntries){const a=this.map.keys().next().value;this.map.delete(a)}this.map.set(s,r)}clear(){this.map.clear()}},_.cY=Uo,_.cZ=Zm,_.c_=kp,_.ca=class extends $l{},_.cb=O_,_.cc=class extends Un{},_.cd=zm,_.ce=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},_.cf=Im,_.cg=function(s,r,a){var f=r[0],p=r[1],x=r[2],b=a[3]*f+a[7]*p+a[11]*x+a[15];return s[0]=(a[0]*f+a[4]*p+a[8]*x+a[12])/(b=b||1),s[1]=(a[1]*f+a[5]*p+a[9]*x+a[13])/b,s[2]=(a[2]*f+a[6]*p+a[10]*x+a[14])/b,s},_.ch=class extends Ru{},_.ci=class extends w{},_.cj=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},_.ck=function(s,r){var a=s[0],f=s[1],p=s[2],x=s[3],b=s[4],E=s[5],P=s[6],z=s[7],L=s[8],N=s[9],$=s[10],H=s[11],J=s[12],te=s[13],ie=s[14],le=s[15],ye=r[0],se=r[1],fe=r[2],Se=r[3],Ie=r[4],We=r[5],ht=r[6],dt=r[7],St=r[8],It=r[9],Mt=r[10],mt=r[11],ot=r[12],$t=r[13],Ht=r[14],ar=r[15];return Math.abs(a-ye)<=me*Math.max(1,Math.abs(a),Math.abs(ye))&&Math.abs(f-se)<=me*Math.max(1,Math.abs(f),Math.abs(se))&&Math.abs(p-fe)<=me*Math.max(1,Math.abs(p),Math.abs(fe))&&Math.abs(x-Se)<=me*Math.max(1,Math.abs(x),Math.abs(Se))&&Math.abs(b-Ie)<=me*Math.max(1,Math.abs(b),Math.abs(Ie))&&Math.abs(E-We)<=me*Math.max(1,Math.abs(E),Math.abs(We))&&Math.abs(P-ht)<=me*Math.max(1,Math.abs(P),Math.abs(ht))&&Math.abs(z-dt)<=me*Math.max(1,Math.abs(z),Math.abs(dt))&&Math.abs(L-St)<=me*Math.max(1,Math.abs(L),Math.abs(St))&&Math.abs(N-It)<=me*Math.max(1,Math.abs(N),Math.abs(It))&&Math.abs($-Mt)<=me*Math.max(1,Math.abs($),Math.abs(Mt))&&Math.abs(H-mt)<=me*Math.max(1,Math.abs(H),Math.abs(mt))&&Math.abs(J-ot)<=me*Math.max(1,Math.abs(J),Math.abs(ot))&&Math.abs(te-$t)<=me*Math.max(1,Math.abs(te),Math.abs($t))&&Math.abs(ie-Ht)<=me*Math.max(1,Math.abs(ie),Math.abs(Ht))&&Math.abs(le-ar)<=me*Math.max(1,Math.abs(le),Math.abs(ar))},_.cl=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},_.cm=s=>s.type==="symbol",_.cn=s=>s.type==="circle",_.co=s=>s.type==="heatmap",_.cp=s=>s.type==="line",_.cq=s=>s.type==="fill",_.cr=s=>s.type==="fill-extrusion",_.cs=s=>s.type==="hillshade",_.ct=s=>s.type==="color-relief",_.cu=s=>s.type==="background",_.cv=s=>s.type==="custom",_.cw=lt,_.cx=function(s,r,a){if(r<=0)return s;const f=1/r;return a===void 0||Math.abs(a)<1e-10?Math.round(s*f)/f:(a>0?Math.ceil(s*f-1e-9):Math.floor(s*f+1e-10))/f},_.cy=function(s,r,a){const f=pt(r.x-a.x,r.y-a.y),p=pt(s.x-a.x,s.y-a.y);var x,b;return ma(Math.atan2(f[0]*p[1]-f[1]*p[0],(x=f)[0]*(b=p)[0]+x[1]*b[1]))},_.cz=Ft,_.d=qe,_.d0=function(s,r,a,f,p){return c(this,void 0,void 0,(function*(){if(ue())try{return yield ka(s,r,a,f,p)}catch{}return(function(x,b,E,P,z){const L=x.width,N=x.height;pa&&uo||(pa=new OffscreenCanvas(L,N),uo=pa.getContext("2d",{willReadFrequently:!0})),pa.width=L,pa.height=N,uo.drawImage(x,0,0,L,N);const $=uo.getImageData(b,E,P,z);return uo.clearRect(0,0,L,N),$.data})(s,r,a,f,p)}))},_.d1=dy,_.d2=C,_.d3=class{constructor(s,r){this.layers={[Dd]:this},this.name=Dd,this.version=r?r.version:1,this.extent=r?r.extent:4096,this.length=s.length,this.features=s}feature(s){return new gg(this.features[s],this.extent)}},_.d4=Rl,_.d5=So,_.e=yr,_.f=s=>c(void 0,void 0,void 0,(function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),_.g=ee,_.h=s=>new Promise(((r,a)=>{const f=new Image;f.onload=()=>{r(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame((()=>{f.src=bs}))},f.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(s)],{type:"image/png"});f.src=s.byteLength?URL.createObjectURL(p):bs})),_.i=rn,_.j=(s,r)=>Te(yr(s,{type:"json"}),r),_.k=_t,_.l=Ve,_.m=Te,_.n=(s,r)=>Te(yr(s,{type:"arrayBuffer"}),r),_.o=function(s){return new Zm(s).readFields(V_,[])},_.p=Ym,_.q=function(s){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(s))},_.r=gp,_.s=bn,_.t=ai,_.u=Me,_.v=Ch,_.w=fr,_.x=td,_.y=Ci,_.z=Ul})),m("worker",["./shared"],(function(_){class c{constructor(ee,ne){this.keyCache={},ee&&this.replace(ee,ne)}replace(ee,ne){this._layerConfigs={},this._layers={},this.update(ee,[],ne)}update(ee,ne,ae){for(const Te of ee){this._layerConfigs[Te.id]=Te;const qe=this._layers[Te.id]=_.bT(Te,ae);qe._featureFilter=_.aj(qe.filter,ae),this.keyCache[Te.id]&&delete this.keyCache[Te.id]}for(const Te of ne)delete this.keyCache[Te],delete this._layerConfigs[Te],delete this._layers[Te];this.familiesBySource={};const _e=_.cM(Object.values(this._layerConfigs),this.keyCache);for(const Te of _e){const qe=Te.map((Me=>this._layers[Me.id])),Ze=qe[0];if(Ze.isHidden())continue;const Ne=Ze.source||"";let Ve=this.familiesBySource[Ne];Ve||(Ve=this.familiesBySource[Ne]={});const _t=Ze.sourceLayer||_.ai;let Xe=Ve[_t];Xe||(Xe=Ve[_t]=[]),Xe.push(qe)}}}class M{constructor(ee){const ne={},ae=[];for(const Ze in ee){const Ne=ee[Ze],Ve=ne[Ze]={};for(const _t in Ne){const Xe=Ne[+_t];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Me={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};ae.push(Me),Ve[_t]={rect:Me,metrics:Xe.metrics}}}const{w:_e,h:Te}=_.p(ae),qe=new _.r({width:_e||1,height:Te||1});for(const Ze in ee){const Ne=ee[Ze];for(const Ve in Ne){const _t=Ne[+Ve];if(!_t||_t.bitmap.width===0||_t.bitmap.height===0)continue;const Xe=ne[Ze][Ve].rect;_.r.copy(_t.bitmap,qe,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},_t.bitmap)}}this.image=qe,this.positions=ne}}_.cN("GlyphAtlas",M);class C{constructor(ee){this.tileID=new _.a2(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,ne,ae,_e,Te){return _._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new _.ag;const qe=new _.cO(Object.keys(ee.layers).sort()),Ze=new _.cP(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];const Ne={},Ve={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ae,subdivisionGranularity:Te},_t=ne.familiesBySource[this.source];for(const jr in _t){const fn=ee.layers[jr];if(!fn)continue;fn.version===1&&_.w(`Vector tile source "${this.source}" layer "${jr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ya=qe.encode(jr),Cn=[];for(let xt=0;xt<fn.length;xt++){const ur=fn.feature(xt),sr=Ze.getId(ur,jr);Cn.push({feature:ur,id:sr,index:xt,sourceLayerIndex:ya})}for(const xt of _t[jr]){const ur=xt[0];ur.source!==this.source&&_.w(`layer.source = ${ur.source} does not equal this.source = ${this.source}`),ur.isHidden(this.zoom,!0)||(D(xt,this.zoom,ae),(Ne[ur.id]=ur.createBucket({index:Ze.bucketLayerIDs.length,layers:xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ya,sourceID:this.source})).populate(Cn,Ve,this.tileID.canonical),Ze.bucketLayerIDs.push(xt.map((sr=>sr.id))))}}const Xe=_.bY(Ve.glyphDependencies,(jr=>Object.keys(jr).map(Number)));this.inFlightDependencies.forEach((jr=>jr?.abort())),this.inFlightDependencies=[];let Me=Promise.resolve({});if(Object.keys(Xe).length){const jr=new AbortController;this.inFlightDependencies.push(jr),Me=_e.sendAsync({type:"GG",data:{stacks:Xe,source:this.source,tileID:this.tileID,type:"glyphs"}},jr)}const qt=Object.keys(Ve.iconDependencies);let hr=Promise.resolve({});if(qt.length){const jr=new AbortController;this.inFlightDependencies.push(jr),hr=_e.sendAsync({type:"GI",data:{icons:qt,source:this.source,tileID:this.tileID,type:"icons"}},jr)}const Yt=Object.keys(Ve.patternDependencies);let lr=Promise.resolve({});if(Yt.length){const jr=new AbortController;this.inFlightDependencies.push(jr),lr=_e.sendAsync({type:"GI",data:{icons:Yt,source:this.source,tileID:this.tileID,type:"patterns"}},jr)}const rr=Ve.dashDependencies;let mr=Promise.resolve({});if(Object.keys(rr).length){const jr=new AbortController;this.inFlightDependencies.push(jr),mr=_e.sendAsync({type:"GDA",data:{dashes:rr}},jr)}const[Bn,nn,hn,ui]=yield Promise.all([Me,hr,lr,mr]),an=new M(Bn),Et=new _.cQ(nn,hn);for(const jr in Ne){const fn=Ne[jr];fn instanceof _.ah?(D(fn.layers,this.zoom,ae),_.cR({bucket:fn,glyphMap:Bn,glyphPositions:an.positions,imageMap:nn,imagePositions:Et.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ve.subdivisionGranularity})):fn.hasDependencies&&(fn instanceof _.cS||fn instanceof _.cT||fn instanceof _.cU)&&(D(fn.layers,this.zoom,ae),fn.addFeatures(Ve,this.tileID.canonical,Et.patternPositions,ui))}return this.status="done",{buckets:Object.values(Ne).filter((jr=>!jr.isEmpty())),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:an.image,imageAtlas:Et,dashPositions:ui,glyphMap:this.returnDependencies?Bn:null,iconMap:this.returnDependencies?nn:null,glyphPositions:this.returnDependencies?an.positions:null}}))}}function D(je,ee,ne){const ae=new _.H(ee);for(const _e of je)_e.recalculate(ae,ne)}class k{constructor(){this.loading={},this.loaded={},this.parsing={}}startLoading(ee,ne){this.loading[ee]=ne}finishLoading(ee){delete this.loading[ee]}abort(ee){const ne=this.loading[ee];ne?.abort&&(ne.abort.abort(),delete this.loading[ee])}setParsing(ee,ne){this.parsing[ee]=ne}consumeParsing(ee){const ne=this.parsing[ee];if(ne)return delete this.parsing[ee],ne}clearParsing(ee){delete this.parsing[ee]}markLoaded(ee,ne){this.loaded[ee]=ne}getLoaded(ee){const ne=this.loaded[ee];if(ne)return ne}removeLoaded(ee){delete this.loaded[ee]}clearLoaded(){this.loaded={}}}class F{constructor(ee,ne,ae,_e,Te){this.type=ee,this.properties=ae||{},this.extent=Te,this.pointsArray=ne,this.id=_e}loadGeometry(){return this.pointsArray.map((ee=>ee.map((ne=>new _.P(ne.x,ne.y)))))}}class G{constructor(ee,ne,ae){this.version=2,this._myFeatures=ee,this.name=ne,this.length=ee.length,this.extent=ae}feature(ee){return this._myFeatures[ee]}}class K{constructor(){this.layers={}}addLayer(ee){this.layers[ee.name]=ee}}function W(je){let ee=_.cV(je);return ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),{vectorTile:je,rawData:ee.buffer}}function q(je,ee,ne){const{extent:ae}=je,_e=Math.pow(2,ne.z-ee.z),Te=(ne.x-ee.x*_e)*ae,qe=(ne.y-ee.y*_e)*ae,Ze=[];for(let Ne=0;Ne<je.length;Ne++){const Ve=je.feature(Ne);let _t=Ve.loadGeometry();for(const Me of _t)for(const qt of Me)qt.x=qt.x*_e-Te,qt.y=qt.y*_e-qe;const Xe=128;_t=_.cW(_t,Ve.type,-Xe,-Xe,ae+Xe,ae+Xe),_t.length!==0&&Ze.push(new F(Ve.type,_t,Ve.properties,Ve.id,ae))}return new G(Ze,je.name,ae)}class ue{constructor(ee,ne,ae){this.actor=ee,this.layerIndex=ne,this.availableImages=ae,this.tileState=new k,this.overzoomedTileResultCache=new _.cX(1e3)}loadVectorTile(ee,ne){return _._(this,void 0,void 0,(function*(){const ae=yield _.n(ee.request,ne);try{return{vectorTile:ee.encoding!=="mlt"?new _.cY(new _.cZ(ae.data)):new _.c_(ae.data),rawData:ae.data,cacheControl:ae.cacheControl,expires:ae.expires}}catch(_e){const Te=new Uint8Array(ae.data);let qe=`Unable to parse the tile at ${ee.request.url}, `;throw qe+=Te[0]===31&&Te[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${_e.message}`,new Error(qe)}}))}loadTile(ee){return _._(this,void 0,void 0,(function*(){const{uid:ne,overzoomParameters:ae}=ee;ae&&(ee.request=ae.overzoomRequest);const _e=this._startRequestTiming(ee),Te=new C(ee);this.tileState.startLoading(ne,Te);const qe=new AbortController;Te.abort=qe;try{const Ze=yield this.loadVectorTile(ee,qe);if(this.tileState.finishLoading(ne),!Ze)return null;let{vectorTile:Ne,rawData:Ve}=Ze;ae&&({vectorTile:Ne,rawData:Ve}=this._getOverzoomTile(ee,Ze.vectorTile));const _t=this._getExpiryData(Ze),Xe=this._finishRequestTiming(_e);Te.vectorTile=Ne,this.tileState.markLoaded(ne,Te);const Me={rawData:Ve,cacheControl:_t,resourceTiming:Xe};this.tileState.setParsing(ne,Me);try{return yield this._parseWorkerTile(Te,ee,Me)}finally{this.tileState.clearParsing(ne)}}catch(Ze){throw this.tileState.finishLoading(ne),Te.status="done",this.tileState.markLoaded(ne,Te),Ze}}))}_parseWorkerTile(ee,ne,ae){return _._(this,void 0,void 0,(function*(){let _e=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);if(ae){const{rawData:Te,cacheControl:qe,resourceTiming:Ze}=ae;_e=_.e({rawTileData:Te.slice(0),encoding:ne.encoding},_e,qe,Ze)}return _e}))}_getExpiryData(ee){const{expires:ne,cacheControl:ae}=ee,_e={};return ne&&(_e.expires=ne),ae&&(_e.cacheControl=ae),_e}_startRequestTiming(ee){var ne;if(!((ne=ee.request)===null||ne===void 0)&&ne.collectResourceTiming)return new _.c$(ee.request.url)}_finishRequestTiming(ee){const ne=ee?.finish();return ne?{resourceTiming:JSON.parse(JSON.stringify(ne))}:{}}_getOverzoomTile(ee,ne){const{tileID:ae,source:_e,overzoomParameters:Te}=ee,{maxZoomTileID:qe}=Te,Ze=`${qe.key}_${ae.key}`,Ne=this.overzoomedTileResultCache.get(Ze);if(Ne)return Ne;const Ve=new K,_t=this.layerIndex.familiesBySource[_e];for(const Me in _t){const qt=ne.layers[Me];if(!qt)continue;const hr=q(qt,qe,ae.canonical);hr.length>0&&Ve.addLayer(hr)}const Xe=W(Ve);return this.overzoomedTileResultCache.set(Ze,Xe),Xe}reloadTile(ee){return _._(this,void 0,void 0,(function*(){const ne=ee.uid,ae=this.tileState.getLoaded(ne);if(!ae)throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");if(ae.showCollisionBoxes=ee.showCollisionBoxes,ae.status==="parsing"){const _e=this.tileState.consumeParsing(ne);return yield this._parseWorkerTile(ae,ee,_e)}if(ae.status==="done"&&ae.vectorTile)return yield this._parseWorkerTile(ae,ee)}))}abortTile(ee){return _._(this,void 0,void 0,(function*(){this.tileState.abort(ee.uid)}))}removeTile(ee){return _._(this,void 0,void 0,(function*(){this.tileState.removeLoaded(ee.uid)}))}}class me{constructor(){this.loaded={}}loadTile(ee){return _._(this,void 0,void 0,(function*(){const{uid:ne,encoding:ae,rawImageData:_e,redFactor:Te,greenFactor:qe,blueFactor:Ze,baseShift:Ne}=ee,Ve=_e.width+2,_t=_e.height+2,Xe=_.b(_e)?new _.R({width:Ve,height:_t},yield _.d0(_e,-1,-1,Ve,_t)):_e,Me=new _.d1(ne,Xe,ae,Te,qe,Ze,Ne);return this.loaded=this.loaded||{},this.loaded[ne]=Me,Me}))}removeTile(ee){const ne=this.loaded,ae=ee.uid;ne&&ne[ae]&&delete ne[ae]}}var ge,be,ze=(function(){if(be)return ge;function je(ne,ae){if(ne.length!==0){ee(ne[0],ae);for(var _e=1;_e<ne.length;_e++)ee(ne[_e],!ae)}}function ee(ne,ae){for(var _e=0,Te=0,qe=0,Ze=ne.length,Ne=Ze-1;qe<Ze;Ne=qe++){var Ve=(ne[qe][0]-ne[Ne][0])*(ne[Ne][1]+ne[qe][1]),_t=_e+Ve;Te+=Math.abs(_e)>=Math.abs(Ve)?_e-_t+Ve:Ve-_t+_e,_e=_t}_e+Te>=0!=!!ae&&ne.reverse()}return be=1,ge=function ne(ae,_e){var Te,qe=ae&&ae.type;if(qe==="FeatureCollection")for(Te=0;Te<ae.features.length;Te++)ne(ae.features[Te],_e);else if(qe==="GeometryCollection")for(Te=0;Te<ae.geometries.length;Te++)ne(ae.geometries[Te],_e);else if(qe==="Feature")ne(ae.geometry,_e);else if(qe==="Polygon")je(ae.coordinates,_e);else if(qe==="MultiPolygon")for(Te=0;Te<ae.coordinates.length;Te++)je(ae.coordinates[Te],_e);return ae}})(),Ae=_.d2(ze);const Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:je=>je},rt=Math.fround||(gt=new Float32Array(1),je=>(gt[0]=+je,gt[0]));var gt;class yt{constructor(ee){this.options=Object.assign(Object.create(Oe),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ne,minZoom:ae,maxZoom:_e}=this.options;ne&&console.time("total time");const Te=`prepare ${ee.length} points`;ne&&console.time(Te),this.points=ee;const qe=[];for(let Ne=0;Ne<ee.length;Ne++){const Ve=ee[Ne];if(!Ve.geometry)continue;const[_t,Xe]=Ve.geometry.coordinates,Me=rt(Rt(_t)),qt=rt(zt(Xe));qe.push(Me,qt,1/0,Ne,-1,1),this.options.reduce&&qe.push(0)}let Ze=this.trees[_e+1]=this._createTree(qe);ne&&console.timeEnd(Te);for(let Ne=_e;Ne>=ae;Ne--){const Ve=+Date.now();Ze=this.trees[Ne]=this._createTree(this._cluster(Ze,Ne)),ne&&console.log("z%d: %d clusters in %dms",Ne,Ze.numItems,+Date.now()-Ve)}return ne&&console.timeEnd("total time"),this}getClusters(ee,ne){let ae=((ee[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,ee[1]));let Te=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ae=-180,Te=180;else if(ae>Te){const Xe=this.getClusters([ae,_e,180,qe],ne),Me=this.getClusters([-180,_e,Te,qe],ne);return Xe.concat(Me)}const Ze=this.trees[this._limitZoom(ne)],Ne=Ze.range(Rt(ae),zt(qe),Rt(Te),zt(_e)),Ve=Ze.data,_t=[];for(const Xe of Ne){const Me=this.stride*Xe;_t.push(Ve[Me+5]>1?tt(Ve,Me,this.clusterProps):this.points[Ve[Me+3]])}return _t}getChildren(ee){const ne=this._getOriginId(ee),ae=this._getOriginZoom(ee),_e="No cluster with the specified id.",Te=this.trees[ae];if(!Te)throw new Error(_e);const qe=Te.data;if(ne*this.stride>=qe.length)throw new Error(_e);const Ze=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Ne=Te.within(qe[ne*this.stride],qe[ne*this.stride+1],Ze),Ve=[];for(const _t of Ne){const Xe=_t*this.stride;qe[Xe+4]===ee&&Ve.push(qe[Xe+5]>1?tt(qe,Xe,this.clusterProps):this.points[qe[Xe+3]])}if(Ve.length===0)throw new Error(_e);return Ve}getLeaves(ee,ne,ae){const _e=[];return this._appendLeaves(_e,ee,ne=ne||10,ae=ae||0,0),_e}getTile(ee,ne,ae){const _e=this.trees[this._limitZoom(ee)],Te=Math.pow(2,ee),{extent:qe,radius:Ze}=this.options,Ne=Ze/qe,Ve=(ae-Ne)/Te,_t=(ae+1+Ne)/Te,Xe={features:[]};return this._addTileFeatures(_e.range((ne-Ne)/Te,Ve,(ne+1+Ne)/Te,_t),_e.data,ne,ae,Te,Xe),ne===0&&this._addTileFeatures(_e.range(1-Ne/Te,Ve,1,_t),_e.data,Te,ae,Te,Xe),ne===Te-1&&this._addTileFeatures(_e.range(0,Ve,Ne/Te,_t),_e.data,-1,ae,Te,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(ee){let ne=this._getOriginZoom(ee)-1;for(;ne<=this.options.maxZoom;){const ae=this.getChildren(ee);if(ne++,ae.length!==1)break;ee=ae[0].properties.cluster_id}return ne}_appendLeaves(ee,ne,ae,_e,Te){const qe=this.getChildren(ne);for(const Ze of qe){const Ne=Ze.properties;if(Ne&&Ne.cluster?Te+Ne.point_count<=_e?Te+=Ne.point_count:Te=this._appendLeaves(ee,Ne.cluster_id,ae,_e,Te):Te<_e?Te++:ee.push(Ze),ee.length===ae)break}return Te}_createTree(ee){const ne=new _.aT(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ae=0;ae<ee.length;ae+=this.stride)ne.add(ee[ae],ee[ae+1]);return ne.finish(),ne.data=ee,ne}_addTileFeatures(ee,ne,ae,_e,Te,qe){for(const Ze of ee){const Ne=Ze*this.stride,Ve=ne[Ne+5]>1;let _t,Xe,Me;if(Ve)_t=Ge(ne,Ne,this.clusterProps),Xe=ne[Ne],Me=ne[Ne+1];else{const Yt=this.points[ne[Ne+3]];_t=Yt.properties;const[lr,rr]=Yt.geometry.coordinates;Xe=Rt(lr),Me=zt(rr)}const qt={type:1,geometry:[[Math.round(this.options.extent*(Xe*Te-ae)),Math.round(this.options.extent*(Me*Te-_e))]],tags:_t};let hr;hr=Ve||this.options.generateId?ne[Ne+3]:this.points[ne[Ne+3]].id,hr!==void 0&&(qt.id=hr),qe.features.push(qt)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ne){const{radius:ae,extent:_e,reduce:Te,minPoints:qe}=this.options,Ze=ae/(_e*Math.pow(2,ne)),Ne=ee.data,Ve=[],_t=this.stride;for(let Xe=0;Xe<Ne.length;Xe+=_t){if(Ne[Xe+2]<=ne)continue;Ne[Xe+2]=ne;const Me=Ne[Xe],qt=Ne[Xe+1],hr=ee.within(Ne[Xe],Ne[Xe+1],Ze),Yt=Ne[Xe+5];let lr=Yt;for(const rr of hr){const mr=rr*_t;Ne[mr+2]>ne&&(lr+=Ne[mr+5])}if(lr>Yt&&lr>=qe){let rr,mr=Me*Yt,Bn=qt*Yt,nn=-1;const hn=(Xe/_t<<5)+(ne+1)+this.points.length;for(const ui of hr){const an=ui*_t;if(Ne[an+2]<=ne)continue;Ne[an+2]=ne;const Et=Ne[an+5];mr+=Ne[an]*Et,Bn+=Ne[an+1]*Et,Ne[an+4]=hn,Te&&(rr||(rr=this._map(Ne,Xe,!0),nn=this.clusterProps.length,this.clusterProps.push(rr)),Te(rr,this._map(Ne,an)))}Ne[Xe+4]=hn,Ve.push(mr/lr,Bn/lr,1/0,hn,-1,lr),Te&&Ve.push(nn)}else{for(let rr=0;rr<_t;rr++)Ve.push(Ne[Xe+rr]);if(lr>1)for(const rr of hr){const mr=rr*_t;if(!(Ne[mr+2]<=ne)){Ne[mr+2]=ne;for(let Bn=0;Bn<_t;Bn++)Ve.push(Ne[mr+Bn])}}}}return Ve}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ne,ae){if(ee[ne+5]>1){const qe=this.clusterProps[ee[ne+6]];return ae?Object.assign({},qe):qe}const _e=this.points[ee[ne+3]].properties,Te=this.options.map(_e);return ae&&Te===_e?Object.assign({},Te):Te}}function tt(je,ee,ne){return{type:"Feature",id:je[ee+3],properties:Ge(je,ee,ne),geometry:{type:"Point",coordinates:[(ae=je[ee],360*(ae-.5)),kt(je[ee+1])]}};var ae}function Ge(je,ee,ne){const ae=je[ee+5],_e=ae>=1e4?`${Math.round(ae/1e3)}k`:ae>=1e3?Math.round(ae/100)/10+"k":ae,Te=je[ee+6],qe=Te===-1?{}:Object.assign({},ne[Te]);return Object.assign(qe,{cluster:!0,cluster_id:je[ee+3],point_count:ae,point_count_abbreviated:_e})}function Rt(je){return je/360+.5}function zt(je){const ee=Math.sin(je*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function kt(je){const ee=(180-360*je)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Ue(je,ee,ne,ae){let _e=ae;const Te=ee+(ne-ee>>1);let qe,Ze=ne-ee;const Ne=je[ee],Ve=je[ee+1],_t=je[ne],Xe=je[ne+1];for(let Me=ee+3;Me<ne;Me+=3){const qt=at(je[Me],je[Me+1],Ne,Ve,_t,Xe);if(qt>_e)qe=Me,_e=qt;else if(qt===_e){const hr=Math.abs(Me-Te);hr<Ze&&(qe=Me,Ze=hr)}}_e>ae&&(qe-ee>3&&Ue(je,ee,qe,ae),je[qe+2]=_e,ne-qe>3&&Ue(je,qe,ne,ae))}function at(je,ee,ne,ae,_e,Te){let qe=_e-ne,Ze=Te-ae;if(qe!==0||Ze!==0){const Ne=((je-ne)*qe+(ee-ae)*Ze)/(qe*qe+Ze*Ze);Ne>1?(ne=_e,ae=Te):Ne>0&&(ne+=qe*Ne,ae+=Ze*Ne)}return qe=je-ne,Ze=ee-ae,qe*qe+Ze*Ze}function pt(je,ee,ne,ae){const _e={type:ee,geom:ne},Te={id:je??null,type:_e.type,geometry:_e.geom,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(_e.type){case"Point":case"MultiPoint":case"LineString":bt(Te,_e.geom);break;case"Polygon":bt(Te,_e.geom[0]);break;case"MultiLineString":for(const qe of _e.geom)bt(Te,qe);break;case"MultiPolygon":for(const qe of _e.geom)bt(Te,qe[0])}return Te}function bt(je,ee){for(let ne=0;ne<ee.length;ne+=3)je.minX=Math.min(je.minX,ee[ne]),je.minY=Math.min(je.minY,ee[ne+1]),je.maxX=Math.max(je.maxX,ee[ne]),je.maxY=Math.max(je.maxY,ee[ne+1])}function Ut(je,ee){const ne=[];switch(je.type){case"FeatureCollection":for(let ae=0;ae<je.features.length;ae++)Ce(ne,je.features[ae],ee,ae);break;case"Feature":Ce(ne,je,ee);break;default:Ce(ne,{geometry:je,properties:void 0},ee)}return ne}function Ce(je,ee,ne,ae){if(!ee.geometry)return;if(ee.geometry.type==="GeometryCollection"){for(const Ze of ee.geometry.geometries)Ce(je,{id:ee.id,geometry:Ze,properties:ee.properties},ne,ae);return}if(!ee.geometry.coordinates?.length)return;const Te=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let qe=ee.id;switch(ne.promoteId?qe=ee.properties?.[ne.promoteId]:ne.generateId&&(qe=ae||0),ee.geometry.type){case"Point":{const Ze=[];return nt(ee.geometry.coordinates,Ze),void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}case"MultiPoint":{const Ze=[];for(const Ne of ee.geometry.coordinates)nt(Ne,Ze);return void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}case"LineString":{const Ze=[];return Be(ee.geometry.coordinates,Ze,Te,!1),void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}case"MultiLineString":{if(ne.lineMetrics){for(const Ne of ee.geometry.coordinates){const Ve=[];Be(Ne,Ve,Te,!1),je.push(pt(qe,"LineString",Ve,ee.properties))}return}const Ze=[];return lt(ee.geometry.coordinates,Ze,Te,!1),void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}case"Polygon":{const Ze=[];return lt(ee.geometry.coordinates,Ze,Te,!0),void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}case"MultiPolygon":{const Ze=[];for(const Ne of ee.geometry.coordinates){const Ve=[];lt(Ne,Ve,Te,!0),Ze.push(Ve)}return void je.push(pt(qe,ee.geometry.type,Ze,ee.properties))}default:throw new Error("Input data is not a valid GeoJSON object.")}}function nt(je,ee){ee.push(Ft(je[0]),Lt(je[1]),0)}function Be(je,ee,ne,ae){let _e,Te,qe=0;for(let Ne=0;Ne<je.length;Ne++){const Ve=Ft(je[Ne][0]),_t=Lt(je[Ne][1]);ee.push(Ve,_t,0),Ne>0&&(qe+=ae?(_e*_t-Ve*Te)/2:Math.sqrt(Math.pow(Ve-_e,2)+Math.pow(_t-Te,2))),_e=Ve,Te=_t}const Ze=ee.length-3;ee[2]=1,ne>0&&Ue(ee,0,Ze,ne),ee[Ze+2]=1,ee.size=Math.abs(qe),ee.start=0,ee.end=ee.size}function lt(je,ee,ne,ae){for(let _e=0;_e<je.length;_e++){const Te=[];Be(je[_e],Te,ne,ae),ee.push(Te)}}function Ft(je){return je/360+.5}function Lt(je){const ee=Math.sin(je*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function Vt(je,ee,ne,ae,_e,Te,qe,Ze){if(ae/=ee,Te>=(ne/=ee)&&qe<ae)return je;if(qe<ne||Te>=ae)return null;const Ne=[];for(const Ve of je){const _t=_e===0?Ve.minX:Ve.minY,Xe=_e===0?Ve.maxX:Ve.maxY;if(_t>=ne&&Xe<ae)Ne.push(Ve);else if(!(Xe<ne||_t>=ae))switch(Ve.type){case"Point":case"MultiPoint":{const Me=[];if(yr(Ve.geometry,Me,ne,ae,_e),!Me.length)continue;Ne.push(pt(Ve.id,Me.length===3?"Point":"MultiPoint",Me,Ve.tags));continue}case"LineString":{const Me=[];if(ft(Ve.geometry,Me,ne,ae,_e,!1,Ze.lineMetrics),!Me.length)continue;if(Ze.lineMetrics){for(const qt of Me)Ne.push(pt(Ve.id,Ve.type,qt,Ve.tags));continue}if(Me.length>1){Ne.push(pt(Ve.id,"MultiLineString",Me,Ve.tags));continue}Ne.push(pt(Ve.id,Ve.type,Me[0],Ve.tags));continue}case"MultiLineString":{const Me=[];if(pr(Ve.geometry,Me,ne,ae,_e,!1),!Me.length)continue;if(Me.length===1){Ne.push(pt(Ve.id,"LineString",Me[0],Ve.tags));continue}Ne.push(pt(Ve.id,Ve.type,Me,Ve.tags));continue}case"Polygon":{const Me=[];if(pr(Ve.geometry,Me,ne,ae,_e,!0),!Me.length)continue;Ne.push(pt(Ve.id,Ve.type,Me,Ve.tags));continue}case"MultiPolygon":{const Me=[];for(const qt of Ve.geometry){const hr=[];pr(qt,hr,ne,ae,_e,!0),hr.length&&Me.push(hr)}if(!Me.length)continue;Ne.push(pt(Ve.id,Ve.type,Me,Ve.tags));continue}}}return Ne.length?Ne:null}function yr(je,ee,ne,ae,_e){for(let Te=0;Te<je.length;Te+=3){const qe=je[Te+_e];qe>=ne&&qe<=ae&&Tt(ee,je[Te],je[Te+1],je[Te+2])}}function ft(je,ee,ne,ae,_e,Te,qe){let Ze=tr(je);const Ne=_e===0?gn:fr;let Ve,_t,Xe=je.start;for(let lr=0;lr<je.length-3;lr+=3){const rr=je[lr],mr=je[lr+1],Bn=je[lr+2],nn=je[lr+3],hn=je[lr+4],ui=_e===0?rr:mr,an=_e===0?nn:hn;let Et=!1;qe&&(Ve=Math.sqrt(Math.pow(rr-nn,2)+Math.pow(mr-hn,2))),ui<ne?an>ne&&(_t=Ne(Ze,rr,mr,nn,hn,ne),qe&&(Ze.start=Xe+Ve*_t)):ui>ae?an<ae&&(_t=Ne(Ze,rr,mr,nn,hn,ae),qe&&(Ze.start=Xe+Ve*_t)):Tt(Ze,rr,mr,Bn),an<ne&&ui>=ne&&(_t=Ne(Ze,rr,mr,nn,hn,ne),Et=!0),an>ae&&ui<=ae&&(_t=Ne(Ze,rr,mr,nn,hn,ae),Et=!0),!Te&&Et&&(qe&&(Ze.end=Xe+Ve*_t),ee.push(Ze),Ze=tr(je)),qe&&(Xe+=Ve)}let Me=je.length-3;const qt=je[Me],hr=je[Me+1],Yt=_e===0?qt:hr;Yt>=ne&&Yt<=ae&&Tt(Ze,qt,hr,je[Me+2]),Me=Ze.length-3,Te&&Me>=3&&(Ze[Me]!==Ze[0]||Ze[Me+1]!==Ze[1])&&Tt(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ee.push(Ze)}function tr(je){const ee=[];return ee.size=je.size,ee.start=je.start,ee.end=je.end,ee}function pr(je,ee,ne,ae,_e,Te){for(const qe of je)ft(qe,ee,ne,ae,_e,Te,!1)}function Tt(je,ee,ne,ae){je.push(ee,ne,ae)}function gn(je,ee,ne,ae,_e,Te){const qe=(Te-ee)/(ae-ee);return Tt(je,Te,ne+(_e-ne)*qe,1),qe}function fr(je,ee,ne,ae,_e,Te){const qe=(Te-ne)/(_e-ne);return Tt(je,ee+(ae-ee)*qe,Te,1),qe}function Sr(je,ee){const ne=ee.buffer/ee.extent;let ae=je;const _e=Vt(je,1,-1-ne,ne,0,-1,2,ee),Te=Vt(je,1,1-ne,2+ne,0,-1,2,ee);return(_e||Te)&&(ae=Vt(je,1,-ne,1+ne,0,-1,2,ee)||[],_e&&(ae=rn(_e,1).concat(ae)),Te&&(ae=ae.concat(rn(Te,-1)))),ae}function rn(je,ee){const ne=[];for(const ae of je)switch(ae.type){case"Point":case"MultiPoint":case"LineString":{const _e=Tr(ae.geometry,ee);ne.push(pt(ae.id,ae.type,_e,ae.tags));continue}case"MultiLineString":case"Polygon":{const _e=[];for(const Te of ae.geometry)_e.push(Tr(Te,ee));ne.push(pt(ae.id,ae.type,_e,ae.tags));continue}case"MultiPolygon":{const _e=[];for(const Te of ae.geometry){const qe=[];for(const Ze of Te)qe.push(Tr(Ze,ee));_e.push(qe)}ne.push(pt(ae.id,ae.type,_e,ae.tags));continue}}return ne}function Tr(je,ee){const ne=[];ne.size=je.size,je.start!==void 0&&(ne.start=je.start,ne.end=je.end);for(let ae=0;ae<je.length;ae+=3)ne.push(je[ae]+ee,je[ae+1],je[ae+2]);return ne}function za(je,ee){if(je.transformed)return je;const ne=1<<je.z,ae=je.x,_e=je.y;for(const Te of je.features){if(Te.type===1){const Ze=[];for(let Ne=0;Ne<Te.geometry.length;Ne+=2)Ze.push(bs(Te.geometry[Ne],Te.geometry[Ne+1],ee,ne,ae,_e));Te.geometry=Ze;continue}const qe=[];for(const Ze of Te.geometry){const Ne=[];for(let Ve=0;Ve<Ze.length;Ve+=2)Ne.push(bs(Ze[Ve],Ze[Ve+1],ee,ne,ae,_e));qe.push(Ne)}Te.geometry=qe}return je.transformed=!0,je}function bs(je,ee,ne,ae,_e,Te){return[Math.round(ne*(je*ae-_e)),Math.round(ne*(ee*ae-Te))]}function ka(je,ee,ne,ae,_e){const Te=ee===_e.maxZoom?0:_e.tolerance/((1<<ee)*_e.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:je.length,source:null,x:ne,y:ae,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ze of je)pa(qe,Ze,Te,_e);return qe}function pa(je,ee,ne,ae){je.minX=Math.min(je.minX,ee.minX),je.minY=Math.min(je.minY,ee.minY),je.maxX=Math.max(je.maxX,ee.maxX),je.maxY=Math.max(je.maxY,ee.maxY);let _e,Te=ee.tags||null;switch(ee.type){case"Point":case"MultiPoint":{const qe=[];for(let Ze=0;Ze<ee.geometry.length;Ze+=3)qe.push(ee.geometry[Ze],ee.geometry[Ze+1]),je.numPoints++,je.numSimplified++;if(!qe.length)return;_e={type:1,tags:Te,geometry:qe};break}case"LineString":{const qe=[];if(uo(qe,ee.geometry,je,ne,!1,!1),!qe.length)return;if(ae.lineMetrics){Te={};for(const Ze in ee.tags)Te[Ze]=ee.tags[Ze];Te.mapbox_clip_start=ee.geometry.start/ee.geometry.size,Te.mapbox_clip_end=ee.geometry.end/ee.geometry.size}_e={type:2,tags:Te,geometry:qe};break}case"MultiLineString":case"Polygon":{const qe=[];for(let Ze=0;Ze<ee.geometry.length;Ze++)uo(qe,ee.geometry[Ze],je,ne,ee.type==="Polygon",Ze===0);if(!qe.length)return;_e={type:ee.type==="Polygon"?3:2,tags:Te,geometry:qe};break}case"MultiPolygon":{const qe=[];for(let Ze=0;Ze<ee.geometry.length;Ze++){const Ne=ee.geometry[Ze];for(let Ve=0;Ve<Ne.length;Ve++)uo(qe,Ne[Ve],je,ne,!0,Ve===0)}if(!qe.length)return;_e={type:3,tags:Te,geometry:qe};break}}ee.id!==null&&(_e.id=ee.id),je.features.push(_e)}function uo(je,ee,ne,ae,_e,Te){const qe=ae*ae;if(ae>0&&ee.size<(_e?qe:ae))return void(ne.numPoints+=ee.length/3);const Ze=[];for(let Ne=0;Ne<ee.length;Ne+=3)(ae===0||ee[Ne+2]>qe)&&(ne.numSimplified++,Ze.push(ee[Ne],ee[Ne+1])),ne.numPoints++;_e&&(function(Ne,Ve){let _t=0;for(let Xe=0,Me=Ne.length,qt=Me-2;Xe<Me;qt=Xe,Xe+=2)_t+=(Ne[Xe]-Ne[qt])*(Ne[Xe+1]+Ne[qt+1]);if(_t>0===Ve)for(let Xe=0,Me=Ne.length;Xe<Me/2;Xe+=2){const qt=Ne[Xe],hr=Ne[Xe+1];Ne[Xe]=Ne[Me-2-Xe],Ne[Xe+1]=Ne[Me-1-Xe],Ne[Me-2-Xe]=qt,Ne[Me-1-Xe]=hr}})(Ze,Te),je.push(Ze)}function bn(je,ee,ne){const ae=!!ee.newGeometry,_e=ee.removeAllProperties||ee.removeProperties?.length>0||ee.addOrUpdateProperties?.length>0;if(ae){let Te=Ut({type:"FeatureCollection",features:[{type:"Feature",id:je.id,geometry:ee.newGeometry,properties:_e?kn(je.tags,ee):je.tags}]},ne);return Te=Sr(Te,ne),Te[0]}if(_e){const Te={...je};return Te.tags=kn(Te.tags,ee),Te}return null}function kn(je,ee){if(ee.removeAllProperties)return{};const ne={...je||{}};if(ee.removeProperties)for(const ae of ee.removeProperties)delete ne[ae];if(ee.addOrUpdateProperties)for(const{key:ae,value:_e}of ee.addOrUpdateProperties)ne[ae]=_e;return ne}const ma={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class co{options;tiles;tileCoords;stats={};total=0;source;constructor(ee,ne){const ae=(ne=this.options=Object.assign({},ma,ne)).debug;if(ae&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let _e=Ut(ee,ne);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_e=Sr(_e,ne),_e.length&&this.splitTile(_e,0,0,0),ne.updateable&&(this.source=_e),ae&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,ne,ae,_e,Te,qe,Ze){const Ne=[ee,ne,ae,_e],Ve=this.options,_t=Ve.debug;for(;Ne.length;){_e=Ne.pop(),ae=Ne.pop(),ne=Ne.pop(),ee=Ne.pop();const Xe=1<<ne,Me=ta(ne,ae,_e);let qt=this.tiles[Me];if(!qt&&(_t>1&&console.time("creation"),qt=this.tiles[Me]=ka(ee,ne,ae,_e,Ve),this.tileCoords.push({z:ne,x:ae,y:_e,id:Me}),_t)){_t>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,ae,_e,qt.numFeatures,qt.numPoints,qt.numSimplified),console.timeEnd("creation"));const Et=`z${ne}`;this.stats[Et]=(this.stats[Et]||0)+1,this.total++}if(qt.source=ee,Te==null){if(ne===Ve.indexMaxZoom||qt.numPoints<=Ve.indexMaxPoints)continue}else{if(ne===Ve.maxZoom||ne===Te)continue;if(Te!=null){const Et=Te-ne;if(ae!==qe>>Et||_e!==Ze>>Et)continue}}if(qt.source=null,!ee.length)continue;_t>1&&console.time("clipping");const hr=.5*Ve.buffer/Ve.extent,Yt=.5-hr,lr=.5+hr,rr=1+hr;let mr=null,Bn=null,nn=null,hn=null;const ui=Vt(ee,Xe,ae-hr,ae+lr,0,qt.minX,qt.maxX,Ve),an=Vt(ee,Xe,ae+Yt,ae+rr,0,qt.minX,qt.maxX,Ve);ui&&(mr=Vt(ui,Xe,_e-hr,_e+lr,1,qt.minY,qt.maxY,Ve),Bn=Vt(ui,Xe,_e+Yt,_e+rr,1,qt.minY,qt.maxY,Ve)),an&&(nn=Vt(an,Xe,_e-hr,_e+lr,1,qt.minY,qt.maxY,Ve),hn=Vt(an,Xe,_e+Yt,_e+rr,1,qt.minY,qt.maxY,Ve)),_t>1&&console.timeEnd("clipping"),Ne.push(mr||[],ne+1,2*ae,2*_e),Ne.push(Bn||[],ne+1,2*ae,2*_e+1),Ne.push(nn||[],ne+1,2*ae+1,2*_e),Ne.push(hn||[],ne+1,2*ae+1,2*_e+1)}}getTile(ee,ne,ae){ee=+ee,ne=+ne,ae=+ae;const _e=this.options,{extent:Te,debug:qe}=_e;if(ee<0||ee>24)return null;const Ze=1<<ee,Ne=ta(ee,ne=ne+Ze&Ze-1,ae);if(this.tiles[Ne])return za(this.tiles[Ne],Te);qe>1&&console.log("drilling down to z%d-%d-%d",ee,ne,ae);let Ve,_t=ee,Xe=ne,Me=ae;for(;!Ve&&_t>0;)_t--,Xe>>=1,Me>>=1,Ve=this.tiles[ta(_t,Xe,Me)];return Ve?.source?(qe>1&&(console.log("found parent tile z%d-%d-%d",_t,Xe,Me),console.time("drilling down")),this.splitTile(Ve.source,_t,Xe,Me,ee,ne,ae),qe>1&&console.timeEnd("drilling down"),this.tiles[Ne]?za(this.tiles[Ne],Te):null):null}invalidateTiles(ee){const ne=this.options,{debug:ae}=ne;let _e=1/0,Te=-1/0,qe=1/0,Ze=-1/0;for(const _t of ee)_e=Math.min(_e,_t.minX),Te=Math.max(Te,_t.maxX),qe=Math.min(qe,_t.minY),Ze=Math.max(Ze,_t.maxY);const Ne=ne.buffer/ne.extent,Ve=new Set;for(const _t in this.tiles){const Xe=this.tiles[_t],Me=1<<Xe.z,qt=(Xe.x-Ne)/Me,hr=(Xe.x+1+Ne)/Me,Yt=(Xe.y-Ne)/Me,lr=(Xe.y+1+Ne)/Me;if(Te<qt||_e>=hr||Ze<Yt||qe>=lr)continue;let rr=!1;for(const mr of ee)if(mr.maxX>=qt&&mr.minX<hr&&mr.maxY>=Yt&&mr.minY<lr){rr=!0;break}if(rr){if(ae){ae>1&&console.log("invalidate tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Xe.z,Xe.x,Xe.y,Xe.numFeatures,Xe.numPoints,Xe.numSimplified);const mr=`z${Xe.z}`;this.stats[mr]=(this.stats[mr]||0)-1,this.total--}delete this.tiles[_t],Ve.add(_t)}}Ve.size&&(this.tileCoords=this.tileCoords.filter((_t=>!Ve.has(_t.id))))}updateData(ee){const ne=this.options,ae=ne.debug;if(!ne.updateable)throw new Error("to update tile geojson `updateable` option must be set to true");const{affected:_e,source:Te}=(function(Xe,Me,qt){const hr=(function(lr){return lr?{removeAll:lr.removeAll,remove:new Set(lr.remove||[]),add:new Map(lr.add?.map((rr=>[rr.id,rr]))),update:new Map(lr.update?.map((rr=>[rr.id,rr])))}:{remove:new Set,add:new Map,update:new Map}})(Me);let Yt=[];if(hr.removeAll&&(Yt=Xe,Xe=[]),hr.remove.size||hr.add.size){const lr=[];for(const rr of Xe){const{id:mr}=rr;(hr.remove.has(mr)||hr.add.has(mr))&&lr.push(rr)}if(lr.length){Yt.push(...lr);const rr=new Set(lr.map((mr=>mr.id)));Xe=Xe.filter((mr=>!rr.has(mr.id)))}if(hr.add.size){let rr=Ut({type:"FeatureCollection",features:Array.from(hr.add.values())},qt);rr=Sr(rr,qt),Yt.push(...rr),Xe.push(...rr)}}if(hr.update.size)for(const[lr,rr]of hr.update){const mr=Xe.findIndex((hn=>hn.id===lr));if(mr===-1)continue;const Bn=Xe[mr],nn=bn(Bn,rr,qt);nn&&(Yt.push(Bn,nn),Xe[mr]=nn)}return{affected:Yt,source:Xe}})(this.source,ee,ne);if(!_e.length)return;this.source=Te,ae>1&&(console.log("invalidating tiles"),console.time("invalidating")),this.invalidateTiles(_e),ae>1&&console.timeEnd("invalidating");const[qe,Ze,Ne]=[0,0,0],Ve=ka(this.source,qe,Ze,Ne,this.options);Ve.source=this.source;const _t=ta(qe,Ze,Ne);if(this.tiles[_t]=Ve,this.tileCoords.push({z:qe,x:Ze,y:Ne,id:_t}),ae){const Xe=`z${qe}`;this.stats[Xe]=(this.stats[Xe]||0)+1,this.total++}}}function ta(je,ee,ne){return 32*((1<<je)*ne+ee)+je}class ga{constructor(ee,ne,ae,_e=du){this._dataUpdateable=new Map,this.actor=ee,this.layerIndex=ne,this.availableImages=ae,this.tileState=new k,this._createGeoJSONIndex=_e}loadVectorTile(ee){if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const{z:ne,x:ae,y:_e}=ee.tileID.canonical,Te=this._geoJSONIndex.getTile(ne,ae,_e);return Te?W(new _.d3(Te.features,{version:2,extent:_.a5})):null}loadTile(ee){return _._(this,void 0,void 0,(function*(){const{uid:ne}=ee,ae=new C(ee);ae.abort=new AbortController;try{const _e=this.loadVectorTile(ee);if(!_e)return null;const{vectorTile:Te,rawData:qe}=_e;ae.vectorTile=Te,this.tileState.markLoaded(ne,ae);const Ze={rawData:qe};this.tileState.setParsing(ne,Ze);try{return yield this._parseWorkerTile(ae,ee,Ze)}finally{this.tileState.clearParsing(ne)}}catch(_e){throw ae.status="done",this.tileState.markLoaded(ne,ae),_e}}))}_reloadLoadedTile(ee){return _._(this,void 0,void 0,(function*(){const ne=ee.uid,ae=this.tileState.getLoaded(ne);if(!ae)throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");if(ae.showCollisionBoxes=ee.showCollisionBoxes,ae.status==="parsing"){const _e=this.tileState.consumeParsing(ne);return yield this._parseWorkerTile(ae,ee,_e)}if(ae.status==="done"&&ae.vectorTile)return yield this._parseWorkerTile(ae,ee)}))}_parseWorkerTile(ee,ne,ae){return _._(this,void 0,void 0,(function*(){let _e=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);if(ae){const{rawData:Te}=ae;_e=_.e({rawTileData:Te.slice(0)},_e)}return _e}))}abortTile(ee){return _._(this,void 0,void 0,(function*(){this.tileState.abort(ee.uid)}))}removeTile(ee){return _._(this,void 0,void 0,(function*(){this.tileState.removeLoaded(ee.uid)}))}loadData(ee){return _._(this,void 0,void 0,(function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const ae=this._startRequestTiming(ee);this._pendingRequest=new AbortController;try{(!this._pendingData||ee.request||ee.data||ee.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest));const _e=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(_e,ee),this.tileState.clearLoaded();const Te={};return ee.request&&(Te.data=_e),this._finishRequestTiming(ae,ee,Te),Te}catch(_e){if(delete this._pendingRequest,_.Z(_e))return{abandoned:!0};throw _e}}))}_startRequestTiming(ee){var ne;if(!((ne=ee.request)===null||ne===void 0)&&ne.collectResourceTiming)return new _.c$(ee.request.url)}_finishRequestTiming(ee,ne,ae){const _e=ee?.finish();_e&&(ae.resourceTiming={[ne.source]:JSON.parse(JSON.stringify(_e))})}getData(){return _._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ee){return this.tileState.getLoaded(ee.uid)?this._reloadLoadedTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,ne){return _._(this,void 0,void 0,(function*(){let ae;if(ee.request?ae=yield this.loadGeoJSONFromUrl(ee.request,ee.promoteId,ne):ee.data?ae=this._loadGeoJSONFromObject(ee.data,ee.promoteId):ee.dataDiff&&(ae=this._loadGeoJSONFromDiff(ee.dataDiff,ee.promoteId,ee.source)),delete this._pendingRequest,typeof ae!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);return Ae(ae,!0),ee.filter&&(ae=this._filterGeoJSON(ae,ee.filter)),ae}))}loadGeoJSONFromUrl(ee,ne,ae){return _._(this,void 0,void 0,(function*(){const _e=yield _.j(ee,ae);return this._dataUpdateable=_.a7(_e.data,ne),_e.data}))}_loadGeoJSONFromObject(ee,ne){return this._dataUpdateable=_.a7(ee,ne),ee}_loadGeoJSONFromDiff(ee,ne,ae){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ae}`);_.a8(this._dataUpdateable,ee,ne);const _e=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(_e)}_filterGeoJSON(ee,ne){const ae=_.d4(ne,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ae.result==="error")throw new Error(ae.value.map((Te=>`${Te.key}: ${Te.message}`)).join(", "));const _e=ee.features.filter((Te=>ae.value.evaluate({zoom:0},Te)));return this._toFeatureCollection(_e)}_toFeatureCollection(ee){return{type:"FeatureCollection",features:ee}}removeSource(ee){return _._(this,void 0,void 0,(function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort()}))}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}function du(je,ee){return ee.cluster?new yt((function({superclusterOptions:ne,clusterProperties:ae}){if(!ae||!ne)return ne;const _e={},Te={},qe={accumulated:null,zoom:0},Ze={properties:null},Ne=Object.keys(ae);for(const Ve of Ne){const[_t,Xe]=ae[Ve],Me=_.d4(Xe),qt=_.d4(typeof _t=="string"?[_t,["accumulated"],["get",Ve]]:_t);_e[Ve]=Me.value,Te[Ve]=qt.value}return ne.map=Ve=>{Ze.properties=Ve;const _t={};for(const Xe of Ne)_t[Xe]=_e[Xe].evaluate(qe,Ze);return _t},ne.reduce=(Ve,_t)=>{Ze.properties=_t;for(const Xe of Ne)qe.accumulated=Ve[Xe],Ve[Xe]=Te[Xe].evaluate(qe,Ze)},ne})(ee)).load(je.features):(function(ne,ae){return new co(ne,ae)})(je,ee.geojsonVtOptions)}class ws{constructor(ee){this.self=ee,this.actor=new _.L(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ne,ae)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=ae},this.self.addProtocol=_.cK,this.self.removeProtocol=_.cL,this.self.registerRTLTextPlugin=ne=>{_.d5.setMethods(ne)},this.actor.registerMessageHandler("LDT",((ne,ae)=>this._getDEMWorkerSource(ne,ae.source).loadTile(ae))),this.actor.registerMessageHandler("RDT",((ne,ae)=>_._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(ne,ae.source).removeTile(ae)})))),this.actor.registerMessageHandler("GCEZ",((ne,ae)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterExpansionZoom(ae)})))),this.actor.registerMessageHandler("GCC",((ne,ae)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterChildren(ae)})))),this.actor.registerMessageHandler("GCL",((ne,ae)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterLeaves(ae)})))),this.actor.registerMessageHandler("LD",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).loadData(ae))),this.actor.registerMessageHandler("GD",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).getData())),this.actor.registerMessageHandler("LT",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).loadTile(ae))),this.actor.registerMessageHandler("RT",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).reloadTile(ae))),this.actor.registerMessageHandler("AT",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).abortTile(ae))),this.actor.registerMessageHandler("RMT",((ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).removeTile(ae))),this.actor.registerMessageHandler("RS",((ne,ae)=>_._(this,void 0,void 0,(function*(){if(!this.workerSources[ne]||!this.workerSources[ne][ae.type]||!this.workerSources[ne][ae.type][ae.source])return;const _e=this.workerSources[ne][ae.type][ae.source];delete this.workerSources[ne][ae.type][ae.source],_e.removeSource!==void 0&&_e.removeSource(ae)})))),this.actor.registerMessageHandler("RM",(ne=>_._(this,void 0,void 0,(function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],this.globalStates.delete(ne)})))),this.actor.registerMessageHandler("SR",((ne,ae)=>_._(this,void 0,void 0,(function*(){this.referrer=ae})))),this.actor.registerMessageHandler("SRPS",((ne,ae)=>this._syncRTLPluginState(ne,ae))),this.actor.registerMessageHandler("IS",((ne,ae)=>_._(this,void 0,void 0,(function*(){this.self.importScripts(ae)})))),this.actor.registerMessageHandler("SI",((ne,ae)=>this._setImages(ne,ae))),this.actor.registerMessageHandler("UL",((ne,ae)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(ne).update(ae.layers,ae.removedIds,this._getGlobalState(ne))})))),this.actor.registerMessageHandler("UGS",((ne,ae)=>_._(this,void 0,void 0,(function*(){const _e=this._getGlobalState(ne);for(const Te in ae)_e[Te]=ae[Te]})))),this.actor.registerMessageHandler("SL",((ne,ae)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(ne).replace(ae,this._getGlobalState(ne))}))))}_getGlobalState(ee){let ne=this.globalStates.get(ee);return ne||(ne={},this.globalStates.set(ee,ne)),ne}_setImages(ee,ne){return _._(this,void 0,void 0,(function*(){this.availableImages[ee]=ne;for(const ae in this.workerSources[ee]){const _e=this.workerSources[ee][ae];for(const Te in _e)_e[Te].availableImages=ne}}))}_syncRTLPluginState(ee,ne){return _._(this,void 0,void 0,(function*(){return yield _.d5.syncState(ne,this.self.importScripts)}))}_getAvailableImages(ee){let ne=this.availableImages[ee];return ne||(ne=[]),ne}_getLayerIndex(ee){let ne=this.layerIndexes[ee];return ne||(ne=this.layerIndexes[ee]=new c),ne}_getWorkerSource(ee,ne,ae){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ne]||(this.workerSources[ee][ne]={}),!this.workerSources[ee][ne][ae]){const _e={sendAsync:(Te,qe)=>(Te.targetMapId=ee,this.actor.sendAsync(Te,qe))};switch(ne){case"vector":this.workerSources[ee][ne][ae]=new ue(_e,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][ne][ae]=new ga(_e,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][ne][ae]=new this.externalWorkerSourceTypes[ne](_e,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][ne][ae]}_getDEMWorkerSource(ee,ne){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ne]||(this.demWorkerSources[ee][ne]=new me),this.demWorkerSources[ee][ne]}}return _.i(self)&&(self.worker=new ws(self)),ws})),m("index",["exports","./shared"],(function(_,c){var M="5.19.0";function C(){var w=new c.A(4);return c.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let D,k,F;const G={frame(w,n,u,d){const v=d||window,T=v.requestAnimationFrame((O=>{A(),n(O)})),{unsubscribe:A}=c.s(w.signal,"abort",(()=>{A(),v.cancelAnimationFrame(T),u(new c.a(w.signal.reason))}),!1)},frameAsync(w,n){return new Promise(((u,d)=>{this.frame(w,u,d,n)}))},getImageData(w,n=0){return this.getImageCanvasContext(w).getImageData(-n,-n,w.width+2*n,w.height+2*n)},getImageCanvasContext(w){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=w.width,n.height=w.height,u.drawImage(w,0,0,w.width,w.height),u},resolveURL:w=>(D||(D=document.createElement("a")),D.href=w,D.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return F!==void 0?F:!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)},set prefersReducedMotion(w){F=w}},K=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(w){this._frozenAt=w}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function W(){return K.getCurrentTime()}class q{static testProp(n){if(!q.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in q.docStyle)return n[u];return n[0]}static create(n,u,d){const v=window.document.createElement(n);return u!==void 0&&(v.className=u),d&&d.appendChild(v),v}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){q.docStyle&&q.selectProp&&(q.userSelect=q.docStyle[q.selectProp],q.docStyle[q.selectProp]="none")}static enableDrag(){q.docStyle&&q.selectProp&&(q.docStyle[q.selectProp]=q.userSelect)}static setTransform(n,u){n.style[q.transformProp]=u}static addEventListener(n,u,d,v={}){n.addEventListener(u,d,"passive"in v?v:v.capture)}static removeEventListener(n,u,d,v={}){n.removeEventListener(u,d,"passive"in v?v:v.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",q.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",q.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",q.suppressClickInternal,!0)}),0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,d){const v=u.boundingClientRect;return new c.P((d.clientX-v.left)/u.x-n.clientLeft,(d.clientY-v.top)/u.y-n.clientTop)}static mousePos(n,u){const d=q.getScale(n);return q.getPoint(n,d,u)}static touchPos(n,u){const d=[],v=q.getScale(n);for(let T=0;T<u.length;T++)d.push(q.getPoint(n,v,u[T]));return d}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const u=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),d=u.querySelectorAll("script");for(const v of d)v.remove();return q.clean(u),u.innerHTML}static isPossiblyDangerous(n,u){const d=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!d.includes("javascript:")&&!d.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const u=n.children;for(const d of u)q.removeAttributes(d),q.clean(d)}static removeAttributes(n){for(const{name:u,value:d}of n.attributes)q.isPossiblyDangerous(u,d)&&n.removeAttribute(u)}}q.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,q.selectProp=q.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),q.transformProp=q.testProp(["transform","WebkitTransform"]);const ue={supported:!1,testSupport:function(w){!be&&ge&&(ze?Ae(w):me=w)}};let me,ge,be=!1,ze=!1;function Ae(w){const n=w.createTexture();w.bindTexture(w.TEXTURE_2D,n);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,ge),w.isContextLost())return;ue.supported=!0}catch{}w.deleteTexture(n),be=!0}var Oe;typeof document<"u"&&(ge=document.createElement("img"),ge.onload=()=>{me&&Ae(me),me=null,ze=!0},ge.onerror=()=>{be=!0,me=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(w){let n,u,d,v;w.resetRequestQueue=()=>{n=[],u=0,d=0,v={}},w.addThrottleControl=R=>{const B=d++;return v[B]=R,B},w.removeThrottleControl=R=>{delete v[R],A()},w.getImage=(R,B,V=!0)=>new Promise(((X,Y)=>{ue.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),c.e(R,{type:"image"}),n.push({abortController:B,requestParameters:R,supportImageRefresh:V,state:"queued",onError:re=>{Y(re)},onSuccess:re=>{X(re)}}),A()}));const T=R=>c._(this,void 0,void 0,(function*(){R.state="running";const{requestParameters:B,supportImageRefresh:V,onError:X,onSuccess:Y,abortController:re}=R,oe=V===!1&&!c.i(self)&&!c.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce(((de,xe)=>de&&xe==="accept"),!0));u++;const he=oe?O(B,re):c.m(B,re);try{const de=yield he;delete R.abortController,R.state="completed",de.data instanceof HTMLImageElement||c.b(de.data)?Y(de):de.data&&Y({data:yield(pe=de.data,typeof createImageBitmap=="function"?c.f(pe):c.h(pe)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete R.abortController,X(de)}finally{u--,A()}var pe})),A=()=>{const R=(()=>{for(const B of Object.keys(v))if(v[B]())return!0;return!1})()?c.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=u;B<R&&n.length>0;B++){const V=n.shift();V.abortController.signal.aborted?B--:T(V)}},O=(R,B)=>new Promise(((V,X)=>{const Y=new Image,re=R.url,oe=R.credentials;oe&&oe==="include"?Y.crossOrigin="use-credentials":(oe&&oe==="same-origin"||!c.d(re))&&(Y.crossOrigin="anonymous"),B.signal.addEventListener("abort",(()=>{Y.src="",X(new c.a(B.signal.reason))})),Y.fetchPriority="high",Y.onload=()=>{Y.onerror=Y.onload=null,V({data:Y})},Y.onerror=()=>{Y.onerror=Y.onload=null,B.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Y.src=re}))})(Oe||(Oe={})),Oe.resetRequestQueue();class rt{constructor(n){this._transformRequestFn=n??null}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function gt(w){const n=[];if(typeof w=="string")n.push({id:"default",url:w});else if(w&&w.length>0){const u=[];for(const{id:d,url:v}of w){const T=`${d}${v}`;u.indexOf(T)===-1&&(u.push(T),n.push({id:d,url:v}))}}return n}function yt(w,n,u){try{const d=new URL(w);return d.pathname+=`${n}${u}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function tt(w){const{userImage:n}=w;return!!(n&&n.render&&n.render())&&(w.data.replace(new Uint8Array(n.data.buffer)),!0)}class Ge extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const n of Object.keys(this.images))this.removeImage(n);this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:d}of this.requestors)d(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const d=u.spriteData;u.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let d=!0;const v=u.data||u.spriteData;return this._validateStretch(u.stretchX,v&&v.width)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchX" value`))),d=!1),this._validateStretch(u.stretchY,v&&v.height)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "stretchY" value`))),d=!1),this._validateContent(u.content,u)||(this.fire(new c.k(new Error(`Image "${n}" has invalid "content" value`))),d=!1),d}_validateStretch(n,u){if(!n)return!0;let d=0;for(const v of n){if(v[0]<d||v[1]<v[0]||u<v[1])return!1;d=v[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const d=u.spriteData,v=d&&d.width||u.data.width,T=d&&d.height||u.data.height;return!(n[0]<0||v<n[0]||n[1]<0||T<n[1]||n[2]<0||v<n[2]||n[3]<0||T<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,d=!0){const v=this.getImage(n);if(d&&(v.data.width!==u.data.width||v.data.height!==u.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=v.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise(((u,d)=>{let v=!0;if(!this.isLoaded())for(const T of n)this.images[T]||(v=!1);this.isLoaded()||v?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})}))}_getImagesForIds(n){const u={};for(const d of n){let v=this.getImage(d);v||(this.fire(new c.l("styleimagemissing",{id:d})),v=this.getImage(d)),v?u[d]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:c.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],d=this.getImage(n);if(!d)return null;if(u&&u.position.version===d.version)return u.position;if(u)u.position.version=d.version;else{const v={w:d.data.width+2,h:d.data.height+2,x:0,y:0},T=new c.I(v,d);this.patterns[n]={bin:v,position:T}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const T in this.patterns)n.push(this.patterns[T].bin);const{w:u,h:d}=c.p(n),v=this.atlasImage;v.resize({width:u||1,height:d||1});for(const T in this.patterns){const{bin:A}=this.patterns[T],O=A.x+1,R=A.y+1,B=this.getImage(T).data,V=B.width,X=B.height;c.R.copy(B,v,{x:0,y:0},{x:O,y:R},{width:V,height:X}),c.R.copy(B,v,{x:0,y:X-1},{x:O,y:R-1},{width:V,height:1}),c.R.copy(B,v,{x:0,y:0},{x:O,y:R+X},{width:V,height:1}),c.R.copy(B,v,{x:V-1,y:0},{x:O-1,y:R},{width:1,height:X}),c.R.copy(B,v,{x:0,y:0},{x:O+V,y:R},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const d=this.getImage(u);d||c.w(`Image with ID: "${u}" was not found`),tt(d)&&this.updateImage(u,d)}}cloneImages(){const n={};for(const u in this.images){const d=this.images[u];n[u]=Object.assign(Object.assign({},d),{data:d.data?d.data.clone():null})}return n}}const Rt=1e20;function zt(w,n,u,d,v,T,A,O,R){for(let B=n;B<n+d;B++)kt(w,u*T+B,T,v,A,O,R);for(let B=u;B<u+v;B++)kt(w,B*T+n,1,d,A,O,R)}function kt(w,n,u,d,v,T,A){T[0]=0,A[0]=-Rt,A[1]=Rt,v[0]=w[n];for(let O=1,R=0,B=0;O<d;O++){v[O]=w[n+O*u];const V=O*O;do{const X=T[R];B=(v[O]-v[X]+V-X*X)/(O-X)/2}while(B<=A[R]&&--R>-1);R++,T[R]=O,A[R]=B,A[R+1]=Rt}for(let O=0,R=0;O<d;O++){for(;A[R+1]<O;)R++;const B=T[R],V=O-B;w[n+O*u]=v[B]+V*V}}const Ue=c.v.layout_symbol["text-font"].default.join(",");class at{constructor(n,u,d){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={},this.lang=d}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,(function*(){const u=[];for(const T in n)for(const A of n[T])u.push(this._getAndCacheGlyphsPromise(T,A));const d=yield Promise.all(u),v={};for(const{stack:T,id:A,glyph:O}of d)v[T]||(v[T]={}),v[T][A]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};return v}))}_getAndCacheGlyphsPromise(n,u){return c._(this,void 0,void 0,(function*(){let d=this.entries[n];d||(d=this.entries[n]={glyphs:{},requests:{},ranges:{}});let v=d.glyphs[u];return v!==void 0?{stack:n,id:u,glyph:v}:!this.url||this._charUsesLocalIdeographFontFamily(u)?(v=d.glyphs[u]=this._drawGlyph(d,n,u),{stack:n,id:u,glyph:v}):yield this._downloadAndCacheRangePromise(n,u)}))}_downloadAndCacheRangePromise(n,u){return c._(this,void 0,void 0,(function*(){const d=this.entries[n],v=Math.floor(u/256);if(d.ranges[v])return{stack:n,id:u,glyph:null};if(!d.requests[v]){const T=at.loadGlyphRange(n,v,this.url,this.requestManager);d.requests[v]=T}try{const T=yield d.requests[v];for(const A in T)d.glyphs[+A]=T[+A];return d.ranges[v]=!0,{stack:n,id:u,glyph:T[u]||null}}catch(T){const A=d.glyphs[u]=this._drawGlyph(d,n,u);return this._warnOnMissingGlyphRange(A,v,u,T),{stack:n,id:u,glyph:A}}}))}_warnOnMissingGlyphRange(n,u,d,v){const T=256*u,A=T+255,O=d.toString(16).padStart(4,"0").toUpperCase();c.w(`Unable to load glyph range ${u}, ${T}-${A}. Rendering codepoint U+${O} locally instead. ${v}`)}_charUsesLocalIdeographFontFamily(n){return!!this.localIdeographFontFamily&&c.q(n)}_drawGlyph(n,u,d){const v=u===Ue&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(d),T=v?"ideographTinySDF":"tinySDF";n[T]||(n[T]=this._createTinySDF(v?this.localIdeographFontFamily:u));const A=n[T].draw(String.fromCodePoint(d)),O=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(d));return{id:d,bitmap:new c.r({width:A.width||60,height:A.height||60},A.data),metrics:{width:O?0:A.glyphWidth/2||24,height:A.glyphHeight/2||24,left:A.glyphLeft/2+.5||0,top:A.glyphTop/2-27.5||-8,advance:O?0:A.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(n){const u=n?n.split(","):[];u.push("sans-serif");const d=u.map((v=>/[-\w]+/.test(v)?v:`'${CSS.escape(v)}'`)).join(",");return new at.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:this._fontWeight(u[0]),fontStyle:this._fontStyle(u[0]),lang:this.lang})}_fontStyle(n){return/italic/i.test(n)?"italic":/oblique/i.test(n)?"oblique":"normal"}_fontWeight(n){const u={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let d;for(const[v,T]of Object.entries(u))new RegExp(`\\b${v}\\b`,"i").test(n)&&(d=`${T}`);return d}destroy(){for(const n in this.entries){const u=this.entries[n];u.tinySDF&&(u.tinySDF=null),u.ideographTinySDF&&(u.ideographTinySDF=null),u.glyphs={},u.requests={},u.ranges={}}this.entries={}}}at.loadGlyphRange=function(w,n,u,d){return c._(this,void 0,void 0,(function*(){const v=256*n,T=v+255,A=d.transformRequest(u.replace("{fontstack}",w).replace("{range}",`${v}-${T}`),"Glyphs"),O=yield c.n(A,new AbortController);if(!O||!O.data)throw new Error(`Could not load glyph range. range: ${n}, ${v}-${T}`);const R={};for(const B of c.o(O.data))R[B.id]=B;return R}))},at.TinySDF=class{constructor({fontSize:w=24,buffer:n=3,radius:u=8,cutoff:d=.25,fontFamily:v="sans-serif",fontWeight:T="normal",fontStyle:A="normal",lang:O=null}={}){this.buffer=n,this.cutoff=d,this.radius=u,this.lang=O;const R=this.size=w+4*n,B=this._createCanvas(R),V=this.ctx=B.getContext("2d",{willReadFrequently:!0});V.font=`${A} ${T} ${w}px ${v}`,V.textBaseline="alphabetic",V.textAlign="left",V.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(w){const n=document.createElement("canvas");return n.width=n.height=w,n}draw(w){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:d,actualBoundingBoxLeft:v,actualBoundingBoxRight:T}=this.ctx.measureText(w),A=Math.ceil(u),O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-v))),R=Math.min(this.size-this.buffer,A+Math.ceil(d)),B=O+2*this.buffer,V=R+2*this.buffer,X=Math.max(B*V,0),Y=new Uint8ClampedArray(X),re={data:Y,width:B,height:V,glyphWidth:O,glyphHeight:R,glyphTop:A,glyphLeft:0,glyphAdvance:n};if(O===0||R===0)return re;const{ctx:oe,buffer:he,gridInner:pe,gridOuter:de}=this;this.lang&&(oe.lang=this.lang),oe.clearRect(he,he,O,R),oe.fillText(w,he,he+A);const xe=oe.getImageData(he,he,O,R);de.fill(Rt,0,X),pe.fill(0,0,X);for(let Ee=0;Ee<R;Ee++)for(let ve=0;ve<O;ve++){const Pe=xe.data[4*(Ee*O+ve)+3]/255;if(Pe===0)continue;const De=(Ee+he)*B+ve+he;if(Pe===1)de[De]=0,pe[De]=Rt;else{const we=.5-Pe;de[De]=we>0?we*we:0,pe[De]=we<0?we*we:0}}zt(de,0,0,B,V,B,this.f,this.v,this.z),zt(pe,he,he,O,R,B,this.f,this.v,this.z);for(let Ee=0;Ee<X;Ee++){const ve=Math.sqrt(de[Ee])-Math.sqrt(pe[Ee]);Y[Ee]=Math.round(255-255*(ve/this.radius+this.cutoff))}return re}};class pt{constructor(){this.specification=c.u.light.position}possiblyEvaluate(n,u){return c.F(n.expression.evaluate(u))}interpolate(n,u,d){return{x:c.G.number(n.x,u.x,d),y:c.G.number(n.y,u.y,d),z:c.G.number(n.z,u.z,d)}}}let bt;class Ut extends c.E{constructor(n){super(),bt=bt||new c.t({anchor:new c.D(c.u.light.anchor),position:new pt,color:new c.D(c.u.light.color),intensity:new c.D(c.u.light.intensity)}),this._transitionable=new c.x(bt,void 0),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(c.y,n,u))for(const d in n){const v=n[d];d.endsWith(c.z)?this._transitionable.setTransition(d.slice(0,-c.z.length),v):this._transitionable.setValue(d,v)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,d){return(!d||d.validate!==!1)&&c.B(this,n.call(c.C,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.u}))}}const Ce=new c.t({"sky-color":new c.D(c.u.sky["sky-color"]),"horizon-color":new c.D(c.u.sky["horizon-color"]),"fog-color":new c.D(c.u.sky["fog-color"]),"fog-ground-blend":new c.D(c.u.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.u.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.u.sky["atmosphere-blend"])});class nt extends c.E{constructor(n){super(),this._transitionable=new c.x(Ce,void 0),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0))}setSky(n,u={}){if(!this._validate(c.J,n,u)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in n){const v=n[d];d.endsWith(c.z)?this._transitionable.setTransition(d.slice(0,-c.z.length),v):this._transitionable.setValue(d,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,d={}){return d?.validate!==!1&&c.B(this,n.call(c.C,c.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.u})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Be{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const d=n.join(",")+String(u);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(n,u)),this.dashEntry[d]}getDashRanges(n,u,d){const v=[];let T=n.length%2==1?-n[n.length-1]*d:0,A=n[0]*d,O=!0;v.push({left:T,right:A,isDash:O,zeroLength:n[0]===0});let R=n[0];for(let B=1;B<n.length;B++){O=!O;const V=n[B];T=R*d,R+=V,A=R*d,v.push({left:T,right:A,isDash:O,zeroLength:V===0})}return v}addRoundDash(n,u,d){const v=u/2;for(let T=-d;T<=d;T++){const A=this.width*(this.nextRow+d+T);let O=0,R=n[O];for(let B=0;B<this.width;B++){B/R.right>1&&(R=n[++O]);const V=Math.abs(B-R.left),X=Math.abs(B-R.right),Y=Math.min(V,X);let re;const oe=T/d*(v+1);if(R.isDash){const he=v-Math.abs(oe);re=Math.sqrt(Y*Y+he*he)}else re=v-Math.sqrt(Y*Y+oe*oe);this.data[A+B]=Math.max(0,Math.min(255,re+128))}}}addRegularDash(n){for(let O=n.length-1;O>=0;--O){const R=n[O],B=n[O+1];R.zeroLength?n.splice(O,1):B&&B.isDash===R.isDash&&(B.left=R.left,n.splice(O,1))}const u=n[0],d=n[n.length-1];u.isDash===d.isDash&&(u.left=d.left-this.width,d.right=u.right+this.width);const v=this.width*this.nextRow;let T=0,A=n[T];for(let O=0;O<this.width;O++){O/A.right>1&&(A=n[++T]);const R=Math.abs(O-A.left),B=Math.abs(O-A.right),V=Math.min(R,B);this.data[v+O]=Math.max(0,Math.min(255,(A.isDash?V:-V)+128))}}addDash(n,u){const d=u?7:0,v=2*d+1;if(this.nextRow+v>this.height)return c.w("LineAtlas out of space"),null;let T=0;for(let O=0;O<n.length;O++)T+=n[O];if(T!==0){const O=this.width/T,R=this.getDashRanges(n,this.width,O);u?this.addRoundDash(R,O,d):this.addRegularDash(R)}const A={y:this.nextRow+d,height:2*d,width:T};return this.nextRow+=v,this.dirty=!0,A}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const lt="maplibre_preloaded_worker_pool";class Ft{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Ft.workerCount;)this.workers.push(new Worker(c.c.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[lt]}numActive(){return Object.keys(this.active).length}}const Lt=Math.floor(G.hardwareConcurrency/2);let Vt,yr;function ft(){return Vt||(Vt=new Ft),Vt}Ft.workerCount=c.K(globalThis)?Math.max(Math.min(Lt,3),1):1;class tr{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const d=this.workerPool.acquire(u);for(let v=0;v<d.length;v++){const T=new c.L(d[v],u);T.name=`Worker ${v}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const d=[];for(const v of this.actors)d.push(v.sendAsync({type:n,data:u}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const d of this.actors)d.registerMessageHandler(n,u)}unregisterMessageHandler(n){for(const u of this.actors)u.unregisterMessageHandler(n)}}function pr(){return yr||(yr=new tr(ft(),c.M),yr.registerMessageHandler("GR",((w,n,u)=>c.m(n,u)))),yr}function Tt(w,n){const u=c.N();return c.O(u,u,[1,1,0]),c.Q(u,u,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?c.S(u,u,w.calculatePosMatrix(n.toUnwrapped())):u}function gn(w,n,u,d,v,T,A){var O;const R=(function(Y,re,oe){if(Y)for(const he of Y){const pe=re[he];if(pe&&pe.source===oe&&pe.type==="fill-extrusion")return!0}else for(const he in re){const pe=re[he];if(pe.source===oe&&pe.type==="fill-extrusion")return!0}return!1})((O=v?.layers)!==null&&O!==void 0?O:null,n,w.id),B=T.maxPitchScaleFactor(),V=w.tilesIn(d,B,R);V.sort(fr);const X=[];for(const Y of V)X.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(n,u,w.getState(),Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,v,T,B,Tt(T,Y.tileID),A?(re,oe)=>A(Y.tileID,re,oe):void 0)});return(function(Y,re){for(const oe in Y)for(const he of Y[oe])Sr(he,re);return Y})((function(Y){const re={},oe={};for(const he of Y){const pe=he.queryResults,de=he.wrappedTileID,xe=oe[de]=oe[de]||{};for(const Ee in pe){const ve=pe[Ee],Pe=xe[Ee]=xe[Ee]||{},De=re[Ee]=re[Ee]||[];for(const we of ve)Pe[we.featureIndex]||(Pe[we.featureIndex]=!0,De.push(we))}}return re})(X),w)}function fr(w,n){const u=w.tileID,d=n.tileID;return u.overscaledZ-d.overscaledZ||u.canonical.y-d.canonical.y||u.wrap-d.wrap||u.canonical.x-d.canonical.x}function Sr(w,n){const u=w.feature,d=n.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=d}function rn(w,n,u,d){return c._(this,void 0,void 0,(function*(){let v=w;if(w.url?v=(yield c.j(n.transformRequest(w.url,"Source"),u)).data:yield G.frameAsync(u,d),!v)return null;const T=c.U(c.e(v,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in v&&v.vector_layers&&(T.vectorLayerIds=v.vector_layers.map((A=>A.id))),T}))}class Tr{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.V?new c.V(n.lng,n.lat):c.V.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.V?new c.V(n.lng,n.lat):c.V.convert(n),this}extend(n){const u=this._sw,d=this._ne;let v,T;if(n instanceof c.V)v=n,T=n;else{if(!(n instanceof Tr))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Tr.convert(n)):this.extend(c.V.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.V.convert(n)):this;if(v=n._sw,T=n._ne,!v||!T)return this}return u||d?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),d.lng=Math.max(T.lng,d.lng),d.lat=Math.max(T.lat,d.lat)):(this._sw=new c.V(v.lng,v.lat),this._ne=new c.V(T.lng,T.lat)),this}getCenter(){return new c.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.V(this.getWest(),this.getNorth())}getSouthEast(){return new c.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:d}=c.V.convert(n);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&v}intersects(n){if(!((n=Tr.convert(n)).getNorth()>=this.getSouth()&&n.getSouth()<=this.getNorth()))return!1;const u=Math.abs(this.getEast()-this.getWest()),d=Math.abs(n.getEast()-n.getWest());if(u>=360||d>=360)return!0;const v=c.W(this.getWest(),-180,180),T=c.W(this.getEast(),-180,180),A=c.W(n.getWest(),-180,180),O=c.W(n.getEast(),-180,180),R=v>T,B=A>O;return!(!R||!B)||(R?O>=v||A<=T:B?T>=A||v<=O:A<=T&&O>=v)}static convert(n){return n instanceof Tr?n:n&&new Tr(n)}static fromLngLat(n,u=0){const d=360*u/40075017,v=d/Math.cos(Math.PI/180*n.lat);return new Tr(new c.V(n.lng-v,n.lat-d),new c.V(n.lng+v,n.lat+d))}adjustAntiMeridian(){const n=new c.V(this._sw.lng,this._sw.lat),u=new c.V(this._ne.lng,this._ne.lat);return new Tr(n,n.lng>u.lng?new c.V(u.lng+360,u.lat):u)}}class za{constructor(n,u,d){this.bounds=Tr.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),d=Math.floor(c.Y(this.bounds.getWest())*u),v=Math.floor(c.X(this.bounds.getNorth())*u),T=Math.ceil(c.Y(this.bounds.getEast())*u),A=Math.ceil(c.X(this.bounds.getSouth())*u);return n.x>=d&&n.x<T&&n.y>=v&&n.y<A}}class bs extends c.E{constructor(n,u,d,v){if(super(),this.id=n,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.U(u,["url","scheme","tileSize","promoteId","encoding"])),this._options=c.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield rn(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new za(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this._loaded=!0,c.Z(n)||this.fire(new c.k(n))}}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(n)};d.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise(((T,A)=>{n.reloadPromise={resolve:T,reject:A}}))}else n.actor=this.dispatcher.getActor(),v="LT";n.abortController=new AbortController;try{const T=yield n.actor.sendAsync({type:v,data:d},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,T)}catch(T){if(delete n.abortController,n.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(n,null)}}))}_getOverzoomParameters(n){if(n.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const u=n.tileID.scaledTo(this.maxzoom).canonical,d=u.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:u,overzoomRequest:this.map._requestManager.transformRequest(d,"Tile")}}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const d=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(d.resolve).catch(d.reject)}}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class ka extends c.E{constructor(n,u,d,v){super(),this.id=n,this.dispatcher=d,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},u),c.e(this,c.U(u,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(n=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield rn(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,u&&(c.e(this,u),u.bounds&&(this.tileBounds=new za(u.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,c.Z(u)||this.fire(new c.k(u))}}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const d=yield Oe.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&n.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const v=this.map.painter.context,T=v.gl,A=d.data;n.texture=this.map.painter.getTileTexture(A.width),n.texture?n.texture.update(A,{useMipmap:!0}):(n.texture=new c.T(v,A,T.RGBA,{useMipmap:!0}),n.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(d){if(delete n.abortController,n.aborted)n.state="unloaded";else if(d)throw n.state="errored",d}}))}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)}))}hasTransition(){return!1}}class pa extends ka{constructor(n,u,d,v){super(n,u,d,v),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const v=yield Oe.getImage(d,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(v&&v.data){const T=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&n.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const A=c.b(T)&&c.$()?T:yield this.readImageNow(T),O={type:this.type,uid:n.uid,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const R=yield n.actor.sendAsync({type:"LDT",data:O});n.dem=R,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(v){if(delete n.abortController,n.aborted)n.state="unloaded";else if(v)throw n.state="errored",v}}))}readImageNow(n){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.a0()){const u=n.width+2,d=n.height+2;try{return new c.R({width:u,height:d},yield c.a1(n,-1,-1,u,d))}catch{}}return G.getImageData(n,1)}))}_getNeighboringTiles(n){const u=n.canonical,d=Math.pow(2,u.z),v=(u.x-1+d)%d,T=u.x===0?n.wrap-1:n.wrap,A=(u.x+1+d)%d,O=u.x+1===d?n.wrap+1:n.wrap,R={};return R[new c.a2(n.overscaledZ,T,u.z,v,u.y).key]={backfilled:!1},R[new c.a2(n.overscaledZ,O,u.z,A,u.y).key]={backfilled:!1},u.y>0&&(R[new c.a2(n.overscaledZ,T,u.z,v,u.y-1).key]={backfilled:!1},R[new c.a2(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},R[new c.a2(n.overscaledZ,O,u.z,A,u.y-1).key]={backfilled:!1}),u.y+1<d&&(R[new c.a2(n.overscaledZ,T,u.z,v,u.y+1).key]={backfilled:!1},R[new c.a2(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},R[new c.a2(n.overscaledZ,O,u.z,A,u.y+1).key]={backfilled:!1}),R}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))}))}}function uo(w){return w&&w.length!==0?typeof w[0]=="number"?[w]:w.flatMap((n=>uo(n))):[]}function bn(w){return w.type==="GeometryCollection"?w.geometries.flatMap((n=>bn(n))):uo(w.coordinates)}function kn(w){const n=new Tr;let u;switch(w.type){case"FeatureCollection":u=w.features.flatMap((d=>bn(d.geometry)));break;case"Feature":u=bn(w.geometry);break;default:u=bn(w)}if(u.length===0)return n;for(let d=0;d<u.length;d++){const[v,T]=u[d];n.extend([v,T])}return n}class ma extends c.E{constructor(n,u,d,v){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=d.getActor(),this.setEventedParent(v),this._data=typeof u.data=="string"?{url:u.data}:{geojson:u.data},this._options=c.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:c.a5,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:c.a5,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(n){return n*(c.a5/this.tileSize)}_getClusterMaxZoom(n){const u=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${u}"`),u}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(n){this.map=n,this.load()}setData(n,u){this._data=typeof n=="string"?{url:n}:{geojson:n},this._pendingWorkerUpdate={data:n};const d=this._updateWorkerData();return u?d:this}updateData(n,u){this._pendingWorkerUpdate.diff=c.a6(this._pendingWorkerUpdate.diff,n);const d=this._updateWorkerData();return u?d:this}getData(){return c._(this,void 0,void 0,(function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})}))}getBounds(){return c._(this,void 0,void 0,(function*(){return kn(yield this.getData())}))}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:d}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void c.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:n,diff:u}=this._pendingWorkerUpdate,d=this._getLoadGeoJSONParameters(n,u);n!==void 0?this._pendingWorkerUpdate.data=void 0:u&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(d)}))}_getLoadGeoJSONParameters(n,u){const d=c.e({type:this.type},this.workerOptions);return typeof n=="string"?(d.request=this.map._requestManager.transformRequest(G.resolveURL(n),"Source"),d.request.collectResourceTiming=this._collectResourceTiming,d):n!==void 0?(d.data=n,d):(u&&(d.dataDiff=u),d)}_dispatchWorkerUpdate(n){return c._(this,void 0,void 0,(function*(){this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:n});if(this._isUpdatingWorker=!1,this._removed||u.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));u.data&&(this._data={geojson:u.data});const d=this._applyDiffToSource(n.dataDiff),v=this._getShouldReloadTileOptions(d),T={dataType:"source"};this._applyResourceTiming(T,u),this.fire(new c.l("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},T),{sourceDataType:"content",shouldReloadTileOptions:v})))}catch(u){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(u))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyResourceTiming(n,u){var d;if(!this._collectResourceTiming)return;const v=(d=u.resourceTiming)===null||d===void 0?void 0:d[this.id];if(!v)return;const T=v.slice(0);T?.length&&c.e(n,{resourceTiming:T})}_applyDiffToSource(n){if(!n)return;const u=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const v=c.a7(this._data.geojson,u);if(!v)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:v}}if(!this._data.updateable)return;const d=c.a8(this._data.updateable,n,u);return n.removeAll||this._options.cluster?void 0:d}_getShouldReloadTileOptions(n){if(n)return{affectedBounds:n.filter(Boolean).map((u=>kn(u)))}}shouldReloadTile(n,{affectedBounds:u}){if(n.state==="loading")return!0;if(n.state==="unloaded")return!1;const{buffer:d,extent:v}=this.workerOptions.geojsonVtOptions,T=(function({x:A,y:O,z:R},B=0){const V=c.a3((A-B)/Math.pow(2,R)),X=c.a4((O+1+B)/Math.pow(2,R)),Y=c.a3((A+1+B)/Math.pow(2,R)),re=c.a4((O-B)/Math.pow(2,R));return new Tr([V,X],[Y,re])})(n.tileID.canonical,d/v);for(const A of u)if(T.intersects(A))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(n){return c._(this,void 0,void 0,(function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const d={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};n.abortController=new AbortController;const v=yield this.actor.sendAsync({type:u,data:d},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(v,this.map.painter,u==="RT")}))}abortTile(n){return c._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0}))}unloadTile(n){return c._(this,void 0,void 0,(function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class co extends c.E{constructor(n,u,d,v){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=d,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u}load(n){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Oe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,c.Z(u)||this.fire(new c.k(u))}}))}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(c.a9.fromLngLat);var d;return this.tileID=(function(v){const T=c.aa.fromPoints(v),A=T.width(),O=T.height(),R=Math.max(A,O),B=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),V=Math.pow(2,B);return new c.ac(B,Math.floor((T.minX+T.maxX)/2*V),Math.floor((T.minY+T.maxY)/2*V))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((v=>this.tileID.getTilePoint(v)._round())),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.texture||(this.texture=new c.T(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let d=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,d=!0)}d&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:u,minY:d,maxX:v,maxY:T}=c.aa.fromPoints(n),A={};for(let O=0;O<=c.ab;O++){const R=Math.pow(2,O),B=Math.floor(u*R),V=Math.floor(d*R),X=Math.floor(v*R),Y=Math.floor(T*R),re=(B%R+R)%R,oe=X%R,he=Math.floor(B/R),pe=Math.floor(X/R);A[O]={minWrap:he,maxWrap:pe,minTileXWrapped:re,maxTileXWrapped:oe,minTileY:V,maxTileY:Y}}return A}}class ta extends co{constructor(n,u,d,v){super(n,u,d,v),this.roundZoom=!0,this.type="video",this.options=u}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield c.ad(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new c.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new c.k(new c.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let d=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,d=!0)}d&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ga extends co{constructor(n,u,d,v){super(n,u,d,v),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((A=>typeof A!="number"))))||this.fire(new c.k(new c.ae(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.ae(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new c.k(new c.ae(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.ae(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.ae(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,d=u.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new c.T(u,this.canvas,d.RGBA,{premultiply:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let v=!1;for(const T in this.tiles){const A=this.tiles[T];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,v=!0)}v&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const du={},ws=w=>{switch(w){case"geojson":return ma;case"image":return co;case"raster":return ka;case"raster-dem":return pa;case"vector":return bs;case"video":return ta;case"canvas":return ga}return du[w]},je="RTLPluginLoaded";class ee extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=pr()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,(function*(u,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=G.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(je))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ne=null;function ae(){return ne||(ne=new ee),ne}var _e,Te;(function(w){w[w.Base=0]="Base",w[w.Parent=1]="Parent"})(_e||(_e={})),(function(w){w[w.Departing=0]="Departing",w[w.Incoming=1]="Incoming"})(Te||(Te={}));class qe{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=n,this.uid=c.af(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttFingerprint={},this.expiredRequestCount=0,this.state="loading"}isRenderable(n){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(n||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:n,fadingDirection:u,fadingParentID:d,fadeEndTime:v}){this.resetFadeLogic(),this.fadingRole=n,this.fadingDirection=u,this.fadingParentID=d,this.fadeEndTime=v}setSelfFadeLogic(n){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=n}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=W(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData,this.latestFeatureIndex.encoding=n.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(v,T){const A={};if(!T)return A;for(const O of v){const R=O.layerIds.map((B=>T.getLayer(B))).filter(Boolean);if(R.length!==0){O.layers=R,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map((B=>R.filter((V=>V.id===B))[0])));for(const B of R)A[B.id]=O}}return A})(n.buckets,u?.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const T=this.buckets[v];if(T instanceof c.ah){if(this.hasSymbolBuckets=!0,!d)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const T=this.buckets[v];if(T instanceof c.ah&&T.hasRTLText){this.hasRTLText=!0,ae().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(v).queryRadius(T))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),this.dashPositions=n.dashPositions}else this.collisionBoxArray=new c.ag}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const d in this.buckets){const v=this.buckets[d];v.uploadPending()&&v.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,d,v,T,A,O,R,B,V,X){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:T,scale:A,tileSize:this.tileSize,pixelPosMatrix:V,transform:R,params:O,queryPadding:this.queryPadding*B,getElevation:X},n,u,d):{}}querySourceFeatures(n,u){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const v=d.loadVTLayers(),T=u&&u.sourceLayer?u.sourceLayer:"",A=v[c.ai]||v[T];if(!A)return;const O=c.aj(u?.filter,u?.globalState),{z:R,x:B,y:V}=this.tileID.canonical,X={z:R,x:B,y:V};for(let Y=0;Y<A.length;Y++){const re=A.feature(Y);if(O.needGeometry){const pe=c.ak(re,!0);if(!O.filter(new c.H(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!O.filter(new c.H(this.tileID.overscaledZ),re))continue;const oe=d.getId(re,T),he=new c.al(re,R,B,V,oe);he.tile=X,n.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const d=c.am(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let v=!1;if(this.expirationTime>d)v=!1;else if(u)if(this.expirationTime<u)v=!0;else{const T=this.expirationTime-u;T?this.expirationTime=d+Math.max(T,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const T=this.buckets[v],A=T.layers[0].sourceLayer||c.ai,O=d[A],R=n[A];if(!O||!R||Object.keys(R).length===0)continue;T.update(R,O,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const B=u&&u.style&&u.style.getLayer(v);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(T)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<W()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(n){this.symbolFadeHoldUntil=W()+n}setDependencies(n,u){const d={};for(const v of u)d[v]=!0;this.dependencies[n]=d}hasDependency(n,u){for(const d of n){const v=this.dependencies[d];if(v){for(const T of u)if(v[T])return!0}}return!1}}class Ze{constructor(){this.state={},this.stateChanges={},this.deletedStates={},this.revision=0}updateState(n,u,d){const v=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][v]=this.stateChanges[n][v]||{},c.e(this.stateChanges[n][v],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const T in this.state[n])T!==v&&(this.deletedStates[n][T]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][v]===null){this.deletedStates[n][v]={};for(const T in this.state[n][v])d[T]||(this.deletedStates[n][v][T]=null)}else for(const T in d)this.deletedStates[n]&&this.deletedStates[n][v]&&this.deletedStates[n][v][T]===null&&delete this.deletedStates[n][v][T]}removeFeatureState(n,u,d){if(this.deletedStates[n]===null)return;const v=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&u!==void 0)this.deletedStates[n][v]!==null&&(this.deletedStates[n][v]=this.deletedStates[n][v]||{},this.deletedStates[n][v][d]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][v])for(d in this.deletedStates[n][v]={},this.stateChanges[n][v])this.deletedStates[n][v][d]=null;else this.deletedStates[n][v]=null;else this.deletedStates[n]=null}getState(n,u){const d=String(u),v=c.e({},(this.state[n]||{})[d],(this.stateChanges[n]||{})[d]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const T=this.deletedStates[n][u];if(T===null)return{};for(const A in T)delete v[A]}return v}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const d={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const T={};for(const A in this.stateChanges[v])this.state[v][A]||(this.state[v][A]={}),c.e(this.state[v][A],this.stateChanges[v][A]),T[A]=this.state[v][A];d[v]=T}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const T={};if(this.deletedStates[v]===null)for(const A in this.state[v])T[A]={},this.state[v][A]={};else for(const A in this.deletedStates[v]){if(this.deletedStates[v][A]===null)this.state[v][A]={};else for(const O of Object.keys(this.deletedStates[v][A]))delete this.state[v][A][O];T[A]=this.state[v][A]}d[v]=d[v]||{},c.e(d[v],T)}this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0&&(this.revision++,n.setFeatureState(d,u))}}const Ne=89.25;function Ve(w,n){const u=c.an(n.lat,-c.ao,c.ao);return new c.P(c.Y(n.lng)*w,c.X(u)*w)}function _t(w,n){return new c.a9(n.x/w,n.y/w).toLngLat()}function Xe(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(c.ap(90-w.pitch)),Math.tan(c.ap(Ne-w.pitch)))}function Me(w,n){const u=w.canonical,d=n/c.aq(u.z),v=u.x+Math.pow(2,u.z)*w.wrap,T=c.ar(new Float64Array(16));return c.O(T,T,[v*d,u.y*d,0]),c.Q(T,T,[d/c.a5,d/c.a5,1]),T}function qt(w,n,u,d,v){const T=c.a9.fromLngLat(w,n),A=v*c.as(1,w.lat),{x:O,y:R,z:B}=hr(u,d);return new c.a9(T.x+A*-O,T.y+A*-R,T.z+A*-B)}function hr(w,n){const u=c.ap(w),d=c.ap(n),v=Math.cos(-u),T=Math.sin(u);return{x:T*Math.sin(d),y:-T*Math.cos(d),z:v}}function Yt(w,n,u){const d=n.intersectsFrustum(w);if(!u||d===0)return d;const v=n.intersectsPlane(u);return v===0?0:d===2&&v===2?2:1}function lr(w,n,u){let d=0;const v=(u-n)/10;for(let T=0;T<10;T++)d+=v*Math.pow(Math.cos(n+(T+.5)/10*(u-n)),w);return d}function rr(w,n){return function(u,d,v,T,A){const O=2*((w-1)/c.at(Math.cos(c.ap(Ne-A))/Math.cos(c.ap(Ne)))-1),R=Math.acos(v/T),B=2*lr(O-1,0,c.ap(A/2)),V=Math.min(c.ap(Ne),R+c.ap(A/2)),X=lr(O-1,Math.min(V,R-c.ap(A/2)),V),Y=Math.atan(d/v),re=Math.hypot(d,v);let oe=u;return oe+=c.at(T/re/Math.max(.5,Math.cos(c.ap(A/2)))),oe+=O*c.at(Math.cos(Y))/2,oe-=c.at(Math.max(1,X/B/n))/2,oe}}const mr=rr(9.314,3);function Bn(w,n){const u=(n.roundZoom?Math.round:Math.floor)(w.zoom+c.at(w.tileSize/n.tileSize));return Math.max(0,u)}function nn(w,n){const u=w.getCameraFrustum(),d=w.getClippingPlane(),v=w.screenPointToMercatorCoordinate(w.getCameraPoint()),T=c.a9.fromLngLat(w.center,w.elevation);v.z=T.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;const A=w.getCoveringTilesDetailsProvider(),O=A.allowVariableZoom(w,n),R=Bn(w,n),B=n.minzoom||0,V=n.maxzoom!==void 0?n.maxzoom:w.maxZoom,X=Math.min(Math.max(0,R),V),Y=Math.pow(2,X),re=[Y*v.x,Y*v.y,0],oe=[Y*T.x,Y*T.y,0],he=Math.hypot(T.x-v.x,T.y-v.y),pe=Math.abs(T.z-v.z),de=Math.hypot(he,pe),xe=Pe=>({zoom:0,x:0,y:0,wrap:Pe,fullyVisible:!1}),Ee=[],ve=[];if(w.renderWorldCopies&&A.allowWorldCopies())for(let Pe=1;Pe<=3;Pe++)Ee.push(xe(-Pe)),Ee.push(xe(Pe));for(Ee.push(xe(0));Ee.length>0;){const Pe=Ee.pop(),De=Pe.x,we=Pe.y;let Re=Pe.fullyVisible;const Qe={x:De,y:we,z:Pe.zoom},Ye=A.getTileBoundingVolume(Qe,Pe.wrap,w.elevation,n);if(!Re){const Dt=Yt(u,Ye,d);if(Dt===0)continue;Re=Dt===2}const He=A.distanceToTile2d(v.x,v.y,Qe,Ye);let Je=R;O&&(Je=(n.calculateTileZoom||mr)(w.zoom+c.at(w.tileSize/n.tileSize),He,pe,de,w.fov)),Je=(n.roundZoom?Math.round:Math.floor)(Je),Je=Math.max(0,Je);const Ct=Math.min(Je,V);if(Pe.wrap=A.getWrap(T,Qe,Pe.wrap),Pe.zoom>=Ct){if(Pe.zoom<B)continue;const Dt=X-Pe.zoom,ut=re[0]-.5-(De<<Dt),Zt=re[1]-.5-(we<<Dt),vr=n.reparseOverscaled?Math.max(Pe.zoom,Je):Pe.zoom;ve.push({tileID:new c.a2(Pe.zoom===V?vr:Pe.zoom,Pe.wrap,Pe.zoom,De,we),distanceSq:c.au([oe[0]-.5-De,oe[1]-.5-we]),tileDistanceToCamera:Math.sqrt(ut*ut+Zt*Zt)})}else for(let Dt=0;Dt<4;Dt++)Ee.push({zoom:Pe.zoom+1,x:(De<<1)+Dt%2,y:(we<<1)+(Dt>>1),wrap:Pe.wrap,fullyVisible:Re})}return ve.sort(((Pe,De)=>Pe.distanceSq-De.distanceSq)).map((Pe=>Pe.tileID))}const hn=c.aa.fromPoints([new c.P(0,0),new c.P(c.a5,c.a5)]);function ui(w){return w==="raster"||w==="image"||w==="video"}function an(w,n,u,d,v,T,A){if(!n.hasData())return!1;const{tileID:O,fadingRole:R,fadingDirection:B,fadingParentID:V}=n;if(R===_e.Base&&B===Te.Incoming&&V)return u[V.key]=V,!0;const X=Math.max(O.overscaledZ-v,T);for(let Y=O.overscaledZ-1;Y>=X;Y--){const re=O.scaledTo(Y),oe=w.getLoadedTile(re);if(oe)return n.setCrossFadeLogic({fadingRole:_e.Base,fadingDirection:Te.Incoming,fadingParentID:oe.tileID,fadeEndTime:d+A}),oe.setCrossFadeLogic({fadingRole:_e.Parent,fadingDirection:Te.Departing,fadeEndTime:d+A}),u[re.key]=re,!0}return!1}function Et(w,n,u,d,v,T){if(!n.hasData())return!1;const A=n.tileID.children(v);let O=jr(w,n,A,u,d,v,T);if(O)return!0;for(const R of A)jr(w,n,R.children(v),u,d,v,T)&&(O=!0);return O}function jr(w,n,u,d,v,T,A){if(u[0].overscaledZ>=T)return!1;let O=!1;for(const R of u){const B=w.getLoadedTile(R);if(!B)continue;const{fadingRole:V,fadingDirection:X,fadingParentID:Y}=B;V===_e.Base&&X===Te.Departing&&Y||(B.setCrossFadeLogic({fadingRole:_e.Base,fadingDirection:Te.Departing,fadingParentID:n.tileID,fadeEndTime:v+A}),n.setCrossFadeLogic({fadingRole:_e.Parent,fadingDirection:Te.Incoming,fadeEndTime:v+A})),d[R.key]=R,O=!0}return O}function fn(w,n,u,d){const v=w.tileID;return!!w.selfFading||!w.hasData()&&!!n.has(v)&&(w.setSelfFadeLogic(u+d),!0)}function ya(w,n){var u;w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let d=n.tileID.canonical.x-w.tileID.canonical.x;const v=n.tileID.canonical.y-w.tileID.canonical.y,T=Math.pow(2,w.tileID.canonical.z),A=n.tileID.key;d===0&&v===0||Math.abs(v)>1||(Math.abs(d)>1&&(Math.abs(d+T)===1?d+=T:Math.abs(d-T)===1&&(d-=T)),n.dem&&w.dem&&(w.dem.backfillBorder(n.dem,d,v),!((u=w.neighboringTiles)===null||u===void 0)&&u[A]&&(w.neighboringTiles[A].backfilled=!0)))}class Cn{constructor(){this._tiles={}}handleWrapJump(n){const u={};for(const d in this._tiles){const v=this._tiles[d];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+n),u[v.tileID.key]=v}this._tiles=u}setFeatureState(n,u){for(const d in this._tiles)this._tiles[d].setFeatureState(n,u)}getAllTiles(){return Object.values(this._tiles)}getAllIds(n=!1){return n?Object.values(this._tiles).map((u=>u.tileID)).sort(c.aw).map((u=>u.key)):Object.keys(this._tiles)}getTileById(n){return this._tiles[n]}setTile(n,u){this._tiles[n]=u}deleteTileById(n){delete this._tiles[n]}getLoadedTile(n){const u=this.getTileById(n.key);return u?.hasData()?u:null}isIdRenderable(n,u=!1){var d;return(d=this.getTileById(n))===null||d===void 0?void 0:d.isRenderable(u)}getRenderableIds(n=0,u){const d=[];for(const v of this.getAllIds())this.isIdRenderable(v,u)&&d.push(this.getTileById(v));return u?d.sort(((v,T)=>{const A=v.tileID,O=T.tileID,R=new c.P(A.canonical.x,A.canonical.y)._rotate(-n),B=new c.P(O.canonical.x,O.canonical.y)._rotate(-n);return A.overscaledZ-O.overscaledZ||B.y-R.y||B.x-R.x})).map((v=>v.tileID.key)):d.map((v=>v.tileID)).sort(c.aw).map((v=>v.key))}}class xt extends c.E{constructor(n,u,d){super(),this.id=n,this.dispatcher=d,this.on("data",(v=>this._dataHandler(v))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((v,T,A,O)=>{const R=new(ws(T.type))(v,T,A,O);if(R.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${R.id}`);return R})(n,u,d,this),this._inViewTiles=new Cn,this._outOfViewCache=new c.ax(0,(v=>this._unloadTile(v))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ze,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){for(const u of this._inViewTiles.getAllTiles())u.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n),this._inViewTiles=new Cn}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n of this._inViewTiles.getAllTiles())if(n.state!=="loaded"&&n.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,d){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,d)}catch(v){n.state="errored",v.status!==404?this._source.fire(new c.k(v,{tile:n})):this.update(this.transform,this.terrain)}}))}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const u of this._inViewTiles.getAllTiles())u.upload(n),u.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(n){var u;return this._inViewTiles.getRenderableIds((u=this.transform)===null||u===void 0?void 0:u.bearingInRadians,n)}hasRenderableParent(n){const u=n.overscaledZ-1;if(u>=this._source.minzoom){const d=this.getLoadedTile(n.scaledTo(u));if(d)return this._inViewTiles.isIdRenderable(d.tileID.key)}return!1}reload(n,u=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const d of this._inViewTiles.getAllIds()){const v=this._inViewTiles.getTileById(d);u&&!this._source.shouldReloadTile(v,u)||(n?this._reloadTile(d,"expired"):v.state!=="errored"&&this._reloadTile(d,"reloading"))}}}_reloadTile(n,u){return c._(this,void 0,void 0,(function*(){const d=this._inViewTiles.getTileById(n);d&&(d.state!=="loading"&&(d.state=u),yield this._loadTile(d,n,u))}))}_tileLoaded(n,u,d){n.timeAdded=W(),n.selfFading&&(n.fadeEndTime=n.timeAdded+this._rasterFadeDuration),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&(function(v,T){var A,O;const R=T.getRenderableIds();for(const B of R){if(!v.neighboringTiles||!v.neighboringTiles[B])continue;const V=T.getTileById(B);v.neighboringTiles[B].backfilled||ya(v,V),!((O=(A=V.neighboringTiles)===null||A===void 0?void 0:A[v.tileID.key])===null||O===void 0)&&O.backfilled||ya(V,v)}})(n,this._inViewTiles),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:n,coord:n.tileID}))}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._inViewTiles.getTileById(n)}_retainLoadedChildren(n,u){const d=this._getLoadedDescendents(u),v=new Set;for(const T of u){const A=d[T.key];if(!A?.length){v.add(T);continue}const O=T.overscaledZ+xt.maxOverzooming,R=A.filter((X=>X.tileID.overscaledZ<=O));if(!R.length){v.add(T);continue}const B=Math.min(...R.map((X=>X.tileID.overscaledZ))),V=R.filter((X=>X.tileID.overscaledZ===B)).map((X=>X.tileID));for(const X of V)n[X.key]=X;this._areDescendentsComplete(V,B,T.overscaledZ)||v.add(T)}return v}_getLoadedDescendents(n){var u;const d={};for(const v of this._inViewTiles.getAllTiles().filter((T=>T.hasData())))for(const T of n)v.tileID.isChildOf(T)&&(d[u=T.key]||(d[u]=[])).push(v);return d}_areDescendentsComplete(n,u,d){return n.length===1&&n[0].isOverscaled()?n[0].overscaledZ===u:Math.pow(4,u-d)===n.length}getLoadedTile(n){return this._inViewTiles.getLoadedTile(n)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,d=Math.ceil(n.height/this._source.tileSize)+1,v=Math.floor(u*d*(this._maxTileCacheZoomLevels===null?c.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._outOfViewCache.setMaxSize(T)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);this._prevLng=n,u&&(this._inViewTiles.handleWrapJump(u),this._resetTileReloadTimers())}update(n,u){if(!this._sourceLoaded||this._paused)return;let d;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((R=>new c.a2(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y))):(d=nn(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?n.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter((R=>this._source.hasTile(R))))):d=[],this.usedForTerrain&&(d=this._addTerrainIdealTiles(d));const v=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,v&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=Bn(n,this._source),A=this._updateRetainedTiles(d,T),O=ui(this._source.type);O&&this._rasterFadeDuration>0&&!u&&(function(R,B,V,X,Y,re,oe){const he=W(),pe=c.av(B);for(const de of B){const xe=R.getTileById(de.key);xe.fadingDirection!==Te.Departing&&xe.fadeOpacity!==0||xe.resetFadeLogic(),an(R,xe,V,he,X,Y,oe)||Et(R,xe,V,he,re,oe)||fn(xe,pe,he,oe)||xe.resetFadeLogic()}})(this._inViewTiles,d,A,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),O?this._cleanUpRasterTiles(A):this._cleanUpVectorTiles(A)}_cleanUpRasterTiles(n){for(const u of this._inViewTiles.getAllIds())n[u]||this._removeTile(u)}_cleanUpVectorTiles(n){for(const u of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(u);n[u]?d.clearSymbolFadeHold():d.hasSymbolBuckets?d.holdingForSymbolFade()?d.symbolFadeFinished()&&this._removeTile(u):d.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(u)}}_addTerrainIdealTiles(n){const u=[];for(const d of n)if(d.canonical.z>this._source.minzoom){const v=d.scaledTo(d.canonical.z-1);u.push(v);const T=d.scaledTo(Math.max(this._source.minzoom,Math.min(d.canonical.z,5)));u.push(T)}return n.concat(u)}releaseSymbolFadeTiles(){for(const n of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(n).holdingForSymbolFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var d;const v=new Set;for(const B of n)this._addTile(B).hasData()||v.add(B);const T=n.reduce(((B,V)=>(B[V.key]=V,B)),{}),A=this._retainLoadedChildren(T,v),O={},R=Math.max(u-xt.maxUnderzooming,this._source.minzoom);for(const B of A){let V=this._inViewTiles.getTileById(B.key),X=V?.wasRequested();for(let Y=B.overscaledZ-1;Y>=R;--Y){const re=B.scaledTo(Y);if(O[re.key])break;if(O[re.key]=!0,V=this.getTile(re),!V&&X&&(V=this._addTile(re)),V){const oe=V.hasData();if((oe||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||X)&&(T[re.key]=re),X=V.wasRequested(),oe)break}}}return T}_addTile(n){let u=this._inViewTiles.getTileById(n.key);if(u)return u;u=this._outOfViewCache.getAndRemove(n),u&&(u.resetFadeLogic(),this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null));const d=u;return u||(u=new qe(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._inViewTiles.setTile(n.key,u),d||this._source.fire(new c.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){this._clearTileReloadTimer(n);const d=u.getExpiryTimeout();d&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),d))}_clearTileReloadTimer(n){const u=this._timers[n];u&&(clearTimeout(u),delete this._timers[n])}_resetTileReloadTimers(){for(const n in this._timers)clearTimeout(this._timers[n]),delete this._timers[n];for(const n of this._inViewTiles.getAllIds()){const u=this._inViewTiles.getTileById(n);this._setTileReloadTimer(n,u)}}refreshTiles(n){for(const u of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(u);(this._inViewTiles.isIdRenderable(u)||d.state=="errored")&&n.some((v=>v.equals(d.tileID.canonical)))&&this._reloadTile(u,"expired")}}_removeTile(n){const u=this._inViewTiles.getTileById(n);u&&(u.uses--,this._inViewTiles.deleteTileById(n),this._clearTileReloadTimer(n),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._outOfViewCache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){n.dataType==="source"&&(n.sourceDataType!=="metadata"?n.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(n.sourceDataChanged,n.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n of this._inViewTiles.getAllIds())this._removeTile(n);this._outOfViewCache.reset()}tilesIn(n,u,d){const v=[],T=this.transform;if(!T)return v;const A=T.getCoveringTilesDetailsProvider().allowWorldCopies(),O=d?T.getCameraQueryGeometry(n):n,R=re=>T.screenPointToMercatorCoordinate(re,this.terrain),B=this.transformBbox(n,R,!A),V=this.transformBbox(O,R,!A),X=this.getIds(),Y=c.aa.fromPoints(V);for(let re=0;re<X.length;re++){const oe=this._inViewTiles.getTileById(X[re]);if(oe.holdingForSymbolFade())continue;const he=A?[oe.tileID]:[oe.tileID.unwrapTo(-1),oe.tileID.unwrapTo(0)],pe=Math.pow(2,T.zoom-oe.tileID.overscaledZ),de=u*oe.queryPadding*c.a5/oe.tileSize/pe;for(const xe of he){const Ee=Y.map((ve=>xe.getTilePoint(new c.a9(ve.x,ve.y))));if(Ee.expandBy(de),Ee.intersects(hn)){const ve=B.map((De=>xe.getTilePoint(De))),Pe=V.map((De=>xe.getTilePoint(De)));v.push({tile:oe,tileID:A?xe:xe.unwrapTo(0),queryGeometry:ve,cameraQueryGeometry:Pe,scale:pe})}}}return v}transformBbox(n,u,d){let v=n.map(u);if(d){const T=c.aa.fromPoints(n);T.shrinkBy(.001*Math.min(T.width(),T.height()));const A=T.map(u);c.aa.fromPoints(v).covers(A)||(v=v.map((O=>O.x>.5?new c.a9(O.x-1,O.y,O.z):O)))}return v}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map((d=>this._inViewTiles.getTileById(d).tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){return!!this._source.hasTransition()||!(!ui(this._source.type)||!(function(n,u){if(u<=0)return!1;const d=W();for(const v of n.getAllTiles())if(v.fadeEndTime>=d)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(n){this._rasterFadeDuration=n}setFeatureState(n,u,d){this._state.updateState(n=n||c.ai,u,d)}removeFeatureState(n,u,d){this._state.removeFeatureState(n=n||c.ai,u,d)}getFeatureState(n,u){return this._state.getState(n=n||c.ai,u)}setDependencies(n,u,d){const v=this._inViewTiles.getTileById(n);v&&v.setDependencies(u,d)}reloadTilesForDependencies(n,u){for(const d of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(d).hasDependency(n,u)&&this._reloadTile(d,"reloading");this._outOfViewCache.filter((d=>!d.hasDependency(n,u)))}areTilesLoaded(){for(const n of this._inViewTiles.getAllTiles())if(n.state!=="loaded"&&n.state!=="errored")return!1;return!0}}xt.maxUnderzooming=10,xt.maxOverzooming=3;class ur{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.an(n,0,1);let u=1,d=this._distances[u];const v=n*this.paddedLength+this.padding;for(;d<v&&u<this._distances.length;)d=this._distances[++u];const T=u-1,A=this._distances[T],O=d-A,R=O>0?(v-A)/O:0;return this.points[T].mult(1-R).add(this.points[u].mult(R))}}function sr(w,n){let u=!0;return w==="always"||w!=="never"&&n!=="never"||(u=!1),u}class Ra{constructor(n,u,d){const v=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(u/d);for(let A=0;A<this.xCellCount*this.yCellCount;A++)v.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,d,v,T){this._forEachCell(u,d,v,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(T)}insertCircle(n,u,d,v){this._forEachCell(u-v,d-v,u+v,d+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(d),this.circles.push(v)}_insertBoxCell(n,u,d,v,T,A){this.boxCells[T].push(A)}_insertCircleCell(n,u,d,v,T,A){this.circleCells[T].push(A)}_query(n,u,d,v,T,A,O){if(d<0||n>this.width||v<0||u>this.height)return[];const R=[];if(n<=0&&u<=0&&this.width<=d&&this.height<=v){if(T)return[{key:null,x1:n,y1:u,x2:d,y2:v}];for(let B=0;B<this.boxKeys.length;B++)R.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const V=this.circles[3*B],X=this.circles[3*B+1],Y=this.circles[3*B+2];R.push({key:this.circleKeys[B],x1:V-Y,y1:X-Y,x2:V+Y,y2:X+Y})}}else this._forEachCell(n,u,d,v,this._queryCell,R,{hitTest:T,overlapMode:A,seenUids:{box:{},circle:{}}},O);return R}query(n,u,d,v){return this._query(n,u,d,v,!1,null)}hitTest(n,u,d,v,T,A){return this._query(n,u,d,v,!0,T,A).length>0}hitTestCircle(n,u,d,v,T){const A=n-d,O=n+d,R=u-d,B=u+d;if(O<0||A>this.width||B<0||R>this.height)return!1;const V=[];return this._forEachCell(A,R,O,B,this._queryCellCircle,V,{hitTest:!0,overlapMode:v,circle:{x:n,y:u,radius:d},seenUids:{box:{},circle:{}}},T),V.length>0}_queryCell(n,u,d,v,T,A,O,R){const{seenUids:B,hitTest:V,overlapMode:X}=O,Y=this.boxCells[T];if(Y!==null){const oe=this.bboxes;for(const he of Y)if(!B.box[he]){B.box[he]=!0;const pe=4*he,de=this.boxKeys[he];if(n<=oe[pe+2]&&u<=oe[pe+3]&&d>=oe[pe+0]&&v>=oe[pe+1]&&(!R||R(de))&&(!V||!sr(X,de.overlapMode))&&(A.push({key:de,x1:oe[pe],y1:oe[pe+1],x2:oe[pe+2],y2:oe[pe+3]}),V))return!0}}const re=this.circleCells[T];if(re!==null){const oe=this.circles;for(const he of re)if(!B.circle[he]){B.circle[he]=!0;const pe=3*he,de=this.circleKeys[he];if(this._circleAndRectCollide(oe[pe],oe[pe+1],oe[pe+2],n,u,d,v)&&(!R||R(de))&&(!V||!sr(X,de.overlapMode))){const xe=oe[pe],Ee=oe[pe+1],ve=oe[pe+2];if(A.push({key:de,x1:xe-ve,y1:Ee-ve,x2:xe+ve,y2:Ee+ve}),V)return!0}}}return!1}_queryCellCircle(n,u,d,v,T,A,O,R){const{circle:B,seenUids:V,overlapMode:X}=O,Y=this.boxCells[T];if(Y!==null){const oe=this.bboxes;for(const he of Y)if(!V.box[he]){V.box[he]=!0;const pe=4*he,de=this.boxKeys[he];if(this._circleAndRectCollide(B.x,B.y,B.radius,oe[pe+0],oe[pe+1],oe[pe+2],oe[pe+3])&&(!R||R(de))&&!sr(X,de.overlapMode))return A.push(!0),!0}}const re=this.circleCells[T];if(re!==null){const oe=this.circles;for(const he of re)if(!V.circle[he]){V.circle[he]=!0;const pe=3*he,de=this.circleKeys[he];if(this._circlesCollide(oe[pe],oe[pe+1],oe[pe+2],B.x,B.y,B.radius)&&(!R||R(de))&&!sr(X,de.overlapMode))return A.push(!0),!0}}}_forEachCell(n,u,d,v,T,A,O,R){const B=this._convertToXCellCoord(n),V=this._convertToYCellCoord(u),X=this._convertToXCellCoord(d),Y=this._convertToYCellCoord(v);for(let re=B;re<=X;re++)for(let oe=V;oe<=Y;oe++)if(T.call(this,n,u,d,v,this.xCellCount*oe+re,A,O,R))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,d,v,T,A){const O=v-n,R=T-u,B=d+A;return B*B>O*O+R*R}_circleAndRectCollide(n,u,d,v,T,A,O){const R=(A-v)/2,B=Math.abs(n-(v+R));if(B>R+d)return!1;const V=(O-T)/2,X=Math.abs(u-(T+V));if(X>V+d)return!1;if(B<=R||X<=V)return!0;const Y=B-R,re=X-V;return Y*Y+re*re<=d*d}}function Zs(w,n,u){const d=c.N();if(!w){const{vecSouth:X,vecEast:Y}=gr(n),re=C();re[0]=Y[0],re[1]=Y[1],re[2]=X[0],re[3]=X[1],v=re,(V=(A=(T=re)[0])*(B=T[3])-(R=T[2])*(O=T[1]))&&(v[0]=B*(V=1/V),v[1]=-O*V,v[2]=-R*V,v[3]=A*V),d[0]=re[0],d[1]=re[1],d[4]=re[2],d[5]=re[3]}var v,T,A,O,R,B,V;return c.Q(d,d,[1/u,1/u,1]),d}function Ss(w,n,u,d){if(w){const v=c.N();if(!n){const{vecSouth:T,vecEast:A}=gr(u);v[0]=A[0],v[1]=A[1],v[4]=T[0],v[5]=T[1]}return c.Q(v,v,[d,d,1]),v}return u.pixelsToClipSpaceMatrix}function gr(w){const n=Math.cos(w.rollInRadians),u=Math.sin(w.rollInRadians),d=Math.cos(w.pitchInRadians),v=Math.cos(w.bearingInRadians),T=Math.sin(w.bearingInRadians),A=c.aC();A[0]=-v*d*u-T*n,A[1]=-T*d*u+v*n;const O=c.aD(A);O<1e-9?c.aE(A):c.aF(A,A,1/O);const R=c.aC();R[0]=v*d*n-T*u,R[1]=T*d*n+v*u;const B=c.aD(R);return B<1e-9?c.aE(R):c.aF(R,R,1/B),{vecEast:R,vecSouth:A}}function Ts(w,n,u,d){let v;d?(v=[w,n,d(w,n),1],c.aH(v,v,u)):(v=[w,n,0,1],ei(v,v,u));const T=v[3];return{point:new c.P(v[0]/T,v[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function ja(w,n){return .5+w/n*.5}function Xo(w,n){return w.x>=-n[0]&&w.x<=n[0]&&w.y>=-n[1]&&w.y<=n[1]}function va(w,n,u,d,v,T,A,O,R,B,V,X,Y){const re=u?w.textSizeData:w.iconSizeData,oe=c.ay(re,n.transform.zoom),he=[256/n.width*2+1,256/n.height*2+1],pe=u?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;pe.clear();const de=w.lineVertexArray,xe=u?w.text.placedSymbolArray:w.icon.placedSymbolArray,Ee=n.transform.width/n.transform.height;let ve=!1;for(let Pe=0;Pe<xe.length;Pe++){const De=xe.get(Pe);if(De.hidden||De.writingMode===c.az.vertical&&!ve){Zi(De.numGlyphs,pe);continue}ve=!1;const we=new c.P(De.anchorX,De.anchorY),Re={getElevation:Y,pitchedLabelPlaneMatrix:d,lineVertexArray:de,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:we,unwrappedTileID:R,width:B,height:V,translation:X},Qe=El(De.anchorX,De.anchorY,Re);if(!Xo(Qe.point,he)){Zi(De.numGlyphs,pe);continue}const Ye=ja(n.transform.cameraToCenterDistance,Qe.signedDistanceFromCamera),He=c.aA(re,oe,De),Je=T?He*n.transform.getPitchedTextCorrection(De.anchorX,De.anchorY,R)/Ye:He*Ye,Ct=Tl({projectionContext:Re,pitchedLabelPlaneMatrixInverse:v,symbol:De,fontSize:Je,flip:!1,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Ee,rotateToLine:O});ve=Ct.useVertical,(Ct.notEnoughRoom||ve||Ct.needsFlipping&&Tl({projectionContext:Re,pitchedLabelPlaneMatrixInverse:v,symbol:De,fontSize:Je,flip:!0,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Ee,rotateToLine:O}).notEnoughRoom)&&Zi(De.numGlyphs,pe)}u?w.text.dynamicLayoutVertexBuffer.updateData(pe):w.icon.dynamicLayoutVertexBuffer.updateData(pe)}function Ir(w,n,u,d,v,T,A,O){const R=T.glyphStartIndex+T.numGlyphs,B=T.lineStartIndex,V=T.lineStartIndex+T.lineLength,X=n.getoffsetX(T.glyphStartIndex),Y=n.getoffsetX(R-1),re=Jo(w*X,u,d,v,T.segment,B,V,O,A);if(!re)return null;const oe=Jo(w*Y,u,d,v,T.segment,B,V,O,A);return oe?O.projectionCache.anyProjectionOccluded?null:{first:re,last:oe}:null}function Dn(w,n,u,d){return w===c.az.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*d?{useVertical:!0}:(w===c.az.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function Tl(w){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:u,symbol:d,fontSize:v,flip:T,keepUpright:A,glyphOffsetArray:O,dynamicLayoutVertexArray:R,aspectRatio:B,rotateToLine:V}=w,X=v/24,Y=d.lineOffsetX*X,re=d.lineOffsetY*X;let oe;if(d.numGlyphs>1){const he=d.glyphStartIndex+d.numGlyphs,pe=d.lineStartIndex,de=d.lineStartIndex+d.lineLength,xe=Ir(X,O,Y,re,T,d,V,n);if(!xe)return{notEnoughRoom:!0};const Ee=Ko(xe.first.point.x,xe.first.point.y,n,u),ve=Ko(xe.last.point.x,xe.last.point.y,n,u);if(A&&!T){const Pe=Dn(d.writingMode,Ee,ve,B);if(Pe)return Pe}oe=[xe.first];for(let Pe=d.glyphStartIndex+1;Pe<he-1;Pe++){const De=Jo(X*O.getoffsetX(Pe),Y,re,T,d.segment,pe,de,n,V);if(!De)return{notEnoughRoom:!0};oe.push(De)}oe.push(xe.last)}else{if(A&&!T){const pe=zi(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,de=d.lineStartIndex+d.segment+1,xe=new c.P(n.lineVertexArray.getx(de),n.lineVertexArray.gety(de)),Ee=zi(xe.x,xe.y,n),ve=Ee.signedDistanceFromCamera>0?Ee.point:Gr(n.tileAnchorPoint,xe,pe,1,n),Pe=Ko(pe.x,pe.y,n,u),De=Ko(ve.x,ve.y,n,u),we=Dn(d.writingMode,Pe,De,B);if(we)return we}const he=Jo(X*O.getoffsetX(d.glyphStartIndex),Y,re,T,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,n,V);if(!he||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};oe=[he]}for(const he of oe)c.aG(R,he.point,he.angle);return{}}function Gr(w,n,u,d,v){const T=w.add(w.sub(n)._unit()),A=zi(T.x,T.y,v).point,O=u.sub(A);return u.add(O._mult(d/O.mag()))}function Ur(w,n,u){const d=n.projectionCache;if(d.projections[w])return d.projections[w];const v=new c.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),T=zi(v.x,v.y,n);if(T.signedDistanceFromCamera>0)return d.projections[w]=T.point,d.anyProjectionOccluded=d.anyProjectionOccluded||T.isOccluded,T.point;const A=w-u.direction;return Gr(u.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(A),n.lineVertexArray.gety(A)),v,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function zi(w,n,u){const d=w+u.translation[0],v=n+u.translation[1];let T;return u.pitchWithMap?(T=Ts(d,v,u.pitchedLabelPlaneMatrix,u.getElevation),T.isOccluded=!1):(T=u.transform.projectTileCoordinates(d,v,u.unwrappedTileID,u.getElevation),T.point.x=(.5*T.point.x+.5)*u.width,T.point.y=(.5*-T.point.y+.5)*u.height),T}function Ko(w,n,u,d){if(u.pitchWithMap){const v=[w,n,0,1];return c.aH(v,v,d),u.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],u.unwrappedTileID,u.getElevation).point}return{x:w/u.width*2-1,y:1-n/u.height*2}}function El(w,n,u){return u.transform.projectTileCoordinates(w,n,u.unwrappedTileID,u.getElevation)}function ho(w,n,u){return w._unit()._perp()._mult(n*u)}function Qo(w,n,u,d,v,T,A,O,R){if(O.projectionCache.offsets[w])return O.projectionCache.offsets[w];const B=u.add(n);if(w+R.direction<d||w+R.direction>=v)return O.projectionCache.offsets[w]=B,B;const V=Ur(w+R.direction,O,R),X=ho(V.sub(u),A,R.direction),Y=u.add(X),re=V.add(X);return O.projectionCache.offsets[w]=c.aI(T,B,Y,re)||B,O.projectionCache.offsets[w]}function Jo(w,n,u,d,v,T,A,O,R){const B=d?w-n:w+n;let V=B>0?1:-1,X=0;d&&(V*=-1,X=Math.PI),V<0&&(X+=Math.PI);let Y,re=V>0?T+v:T+v+1;O.projectionCache.cachedAnchorPoint?Y=O.projectionCache.cachedAnchorPoint:(Y=zi(O.tileAnchorPoint.x,O.tileAnchorPoint.y,O).point,O.projectionCache.cachedAnchorPoint=Y);let oe,he,pe=Y,de=Y,xe=0,Ee=0;const ve=Math.abs(B),Pe=[];let De;for(;xe+Ee<=ve;){if(re+=V,re<T||re>=A)return null;xe+=Ee,de=pe,he=oe;const Qe={absOffsetX:ve,direction:V,distanceFromAnchor:xe,previousVertex:de};if(pe=Ur(re,O,Qe),u===0)Pe.push(de),De=pe.sub(de);else{let Ye;const He=pe.sub(de);Ye=He.mag()===0?ho(Ur(re+V,O,Qe).sub(pe),u,V):ho(He,u,V),he||(he=de.add(Ye)),oe=Qo(re,Ye,pe,T,A,he,u,O,Qe),Pe.push(he),De=oe.sub(he)}Ee=De.mag()}const we=De._mult((ve-xe)/Ee)._add(he||de),Re=X+Math.atan2(pe.y-de.y,pe.x-de.x);return Pe.push(we),{point:we,angle:R?Re:0,path:Pe}}const Al=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Zi(w,n){for(let u=0;u<w;u++){const d=n.length;n.resize(d+4),n.float32.set(Al,3*d)}}function ei(w,n,u){const d=n[0],v=n[1];return w[0]=u[0]*d+u[4]*v+u[12],w[1]=u[1]*d+u[5]*v+u[13],w[3]=u[3]*d+u[7]*v+u[15],w}const ti=100;class Zd{constructor(n,u=new Ra(n.width+200,n.height+200,25),d=new Ra(n.width+200,n.height+200,25)){this.transform=n,this.grid=u,this.ignoredGrid=d,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ti,this.screenBottomBoundary=n.height+ti,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,d,v,T,A,O,R,B,V,X,Y){const re=this.projectAndGetPerspectiveRatio(n.anchorPointX+R[0],n.anchorPointY+R[1],T,V,Y),oe=d*re.perspectiveRatio;let he;if(A||O)he=this._projectCollisionBox(n,oe,v,T,A,O,R,re,V,X,Y);else{const De=re.x+(X?X.x*oe:0),we=re.y+(X?X.y*oe:0);he={allPointsOccluded:!1,box:[De+n.x1*oe,we+n.y1*oe,De+n.x2*oe,we+n.y2*oe]}}const[pe,de,xe,Ee]=he.box,ve=A?he.allPointsOccluded:re.isOccluded;let Pe=ve;return Pe||(Pe=re.perspectiveRatio<this.perspectiveRatioCutoff),Pe||(Pe=!this.isInsideGrid(pe,de,xe,Ee)),Pe||u!=="always"&&this.grid.hitTest(pe,de,xe,Ee,u,B)?{box:[pe,de,xe,Ee],placeable:!1,offscreen:!1,occluded:ve}:{box:[pe,de,xe,Ee],placeable:!0,offscreen:this.isOffscreen(pe,de,xe,Ee),occluded:ve}}placeCollisionCircles(n,u,d,v,T,A,O,R,B,V,X,Y,re,oe){const he=[],pe=new c.P(u.anchorX,u.anchorY),de=this.getPerspectiveRatio(pe.x,pe.y,A,oe),xe=(B?T*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,A)/de:T*de)/c.aM,Ee={getElevation:oe,pitchedLabelPlaneMatrix:O,lineVertexArray:d,pitchWithMap:B,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pe,unwrappedTileID:A,width:this.transform.width,height:this.transform.height,translation:re},ve=Ir(xe,v,u.lineOffsetX*xe,u.lineOffsetY*xe,!1,u,!1,Ee);let Pe=!1,De=!1,we=!0;if(ve){const Re=.5*X*de+Y,Qe=new c.P(-100,-100),Ye=new c.P(this.screenRightBoundary,this.screenBottomBoundary),He=new ur,Je=ve.first,Ct=ve.last;let Dt=[];for(let vr=Je.path.length-1;vr>=1;vr--)Dt.push(Je.path[vr]);for(let vr=1;vr<Ct.path.length;vr++)Dt.push(Ct.path[vr]);const ut=2.5*Re;if(B){const vr=this.projectPathToScreenSpace(Dt,Ee);Dt=vr.some((Xr=>Xr.signedDistanceFromCamera<=0))?[]:vr.map((Xr=>Xr.point))}let Zt=[];if(Dt.length>0){const vr=Dt[0].clone(),Xr=Dt[0].clone();for(let vn=1;vn<Dt.length;vn++)vr.x=Math.min(vr.x,Dt[vn].x),vr.y=Math.min(vr.y,Dt[vn].y),Xr.x=Math.max(Xr.x,Dt[vn].x),Xr.y=Math.max(Xr.y,Dt[vn].y);Zt=vr.x>=Qe.x&&Xr.x<=Ye.x&&vr.y>=Qe.y&&Xr.y<=Ye.y?[Dt]:Xr.x<Qe.x||vr.x>Ye.x||Xr.y<Qe.y||vr.y>Ye.y?[]:c.aJ([Dt],Qe.x,Qe.y,Ye.x,Ye.y)}for(const vr of Zt){He.reset(vr,.25*Re);let Xr=0;Xr=He.length<=.5*Re?1:Math.ceil(He.paddedLength/ut)+1;for(let vn=0;vn<Xr;vn++){const dn=vn/Math.max(Xr-1,1),Sn=He.lerp(dn),tn=Sn.x+ti,fi=Sn.y+ti;he.push(tn,fi,Re,0);const jn=tn-Re,Di=fi-Re,Vn=tn+Re,qn=fi+Re;if(we=we&&this.isOffscreen(jn,Di,Vn,qn),De=De||this.isInsideGrid(jn,Di,Vn,qn),n!=="always"&&this.grid.hitTestCircle(tn,fi,Re,n,V)&&(Pe=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Pe}}}}return{circles:!R&&Pe||!De||de<this.perspectiveRatioCutoff?[]:he,offscreen:we,collisionDetected:Pe}}projectPathToScreenSpace(n,u){const d=(function(v,T){const A=c.N();return c.aB(A,T.pitchedLabelPlaneMatrix),v.map((O=>{const R=Ts(O.x,O.y,A,T.getElevation),B=T.transform.projectTileCoordinates(R.point.x,R.point.y,T.unwrappedTileID,T.getElevation);return B.point.x=(.5*B.point.x+.5)*T.width,B.point.y=(.5*-B.point.y+.5)*T.height,B}))})(n,u);return(function(v){let T=0,A=0,O=0,R=0;for(let B=0;B<v.length;B++)v[B].isOccluded?(O=B+1,R=0):(R++,R>A&&(A=R,T=O));return v.slice(T,T+A)})(d)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],d=new c.aa;for(const X of n){const Y=new c.P(X.x+ti,X.y+ti);d.extend(Y),u.push(Y)}const{minX:v,minY:T,maxX:A,maxY:O}=d,R=this.grid.query(v,T,A,O).concat(this.ignoredGrid.query(v,T,A,O)),B={},V={};for(const X of R){const Y=X.key;if(B[Y.bucketInstanceId]===void 0&&(B[Y.bucketInstanceId]={}),B[Y.bucketInstanceId][Y.featureIndex])continue;const re=[new c.P(X.x1,X.y1),new c.P(X.x2,X.y1),new c.P(X.x2,X.y2),new c.P(X.x1,X.y2)];c.aK(u,re)&&(B[Y.bucketInstanceId][Y.featureIndex]=!0,V[Y.bucketInstanceId]===void 0&&(V[Y.bucketInstanceId]=[]),V[Y.bucketInstanceId].push(Y.featureIndex))}return V}insertCollisionBox(n,u,d,v,T,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:T,collisionGroupID:A,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,d,v,T,A){const O=d?this.ignoredGrid:this.grid,R={bucketInstanceId:v,featureIndex:T,collisionGroupID:A,overlapMode:u};for(let B=0;B<n.length;B+=4)O.insertCircle(R,n[B],n[B+1],n[B+2])}projectAndGetPerspectiveRatio(n,u,d,v,T){if(T){let A;v?(A=[n,u,v(n,u),1],c.aH(A,A,T)):(A=[n,u,0,1],ei(A,A,T));const O=A[3];return{x:(A[0]/O+1)/2*this.transform.width+ti,y:(-A[1]/O+1)/2*this.transform.height+ti,perspectiveRatio:.5+this.transform.cameraToCenterDistance/O*.5,isOccluded:!1,signedDistanceFromCamera:O}}{const A=this.transform.projectTileCoordinates(n,u,d,v);return{x:(A.point.x+1)/2*this.transform.width+ti,y:(1-A.point.y)/2*this.transform.height+ti,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5,isOccluded:A.isOccluded,signedDistanceFromCamera:A.signedDistanceFromCamera}}}getPerspectiveRatio(n,u,d,v){const T=this.transform.projectTileCoordinates(n,u,d,v);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(n,u,d,v){return d<ti||n>=this.screenRightBoundary||v<ti||u>this.screenBottomBoundary}isInsideGrid(n,u,d,v){return d>=0&&n<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=c.ar([]);return c.O(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,d,v,T,A,O,R,B,V,X){let Y=1,re=0,oe=0,he=1;const pe=n.anchorPointX+O[0],de=n.anchorPointY+O[1];if(A&&!T){const Dt=this.projectAndGetPerspectiveRatio(pe+1,de,v,B,X),ut=Dt.x-R.x,Zt=Math.atan((Dt.y-R.y)/ut)+(ut<0?Math.PI:0),vr=Math.sin(Zt),Xr=Math.cos(Zt);Y=Xr,re=vr,oe=-vr,he=Xr}else if(!A&&T){const Dt=gr(this.transform);Y=Dt.vecEast[0],re=Dt.vecEast[1],oe=Dt.vecSouth[0],he=Dt.vecSouth[1]}let xe=R.x,Ee=R.y,ve=u;T&&(xe=pe,Ee=de,ve=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),ve*=this.transform.getPitchedTextCorrection(pe,de,v),V||(ve*=c.an(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),V&&(xe+=Y*V.x*ve+oe*V.y*ve,Ee+=re*V.x*ve+he*V.y*ve);const Pe=n.x1*ve,De=n.x2*ve,we=(Pe+De)/2,Re=n.y1*ve,Qe=n.y2*ve,Ye=(Re+Qe)/2,He=[{offsetX:Pe,offsetY:Re},{offsetX:we,offsetY:Re},{offsetX:De,offsetY:Re},{offsetX:De,offsetY:Ye},{offsetX:De,offsetY:Qe},{offsetX:we,offsetY:Qe},{offsetX:Pe,offsetY:Qe},{offsetX:Pe,offsetY:Ye}];let Je=[];for(const{offsetX:Dt,offsetY:ut}of He)Je.push(new c.P(xe+Y*Dt+oe*ut,Ee+re*Dt+he*ut));let Ct=!1;if(T){const Dt=Je.map((ut=>this.projectAndGetPerspectiveRatio(ut.x,ut.y,v,B,X)));Ct=Dt.some((ut=>!ut.isOccluded)),Je=Dt.map((ut=>new c.P(ut.x,ut.y)))}else Ct=!0;return{box:c.aL(Je),allPointsOccluded:!Ct}}}class pu{constructor(n,u,d,v){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):v&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Ml{constructor(n,u,d,v,T){this.text=new pu(n?n.text:null,u,d,T),this.icon=new pu(n?n.icon:null,u,v,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hs{constructor(n,u,d){this.text=n,this.icon=u,this.skipFade=d}}class Af{constructor(n,u,d,v,T){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=d,this.bucketIndex=v,this.tileID=T}}class Hi{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:d=>d.collisionGroupID===u}}return this.collisionGroups[n]}}function Pl(w,n,u,d,v){const{horizontalAlign:T,verticalAlign:A}=c.aS(w);return new c.P(-(T-.5)*n+d[0]*v,-(A-.5)*u+d[1]*v)}class es{constructor(n,u,d,v,T){this.transform=n.clone(),this.terrain=u,this.collisionIndex=new Zd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Hi(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(d,v)=>u.getElevation(n,d,v):null}getBucketParts(n,u,d,v){const T=d.getBucket(u),A=d.latestFeatureIndex;if(!T||!A||u.id!==T.layerIds[0])return;const O=d.collisionBoxArray,R=T.layers[0].layout,B=T.layers[0].paint,V=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),X=d.tileSize/c.a5,Y=d.tileID.toUnwrapped(),re=R.get("text-rotation-alignment")==="map",oe=c.aN(d,1,this.transform.zoom),he=c.aO(this.collisionIndex.transform,d,B.get("text-translate"),B.get("text-translate-anchor")),pe=c.aO(this.collisionIndex.transform,d,B.get("icon-translate"),B.get("icon-translate-anchor")),de=Zs(re,this.transform,oe);this.retainedQueryData[T.bucketInstanceId]=new Af(T.bucketInstanceId,A,T.sourceLayerIndex,T.index,d.tileID);const xe={bucket:T,layout:R,translationText:he,translationIcon:pe,unwrappedTileID:Y,pitchedLabelPlaneMatrix:de,scale:V,textPixelRatio:X,holdingForFade:d.holdingForSymbolFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:c.ay(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(v)for(const Ee of T.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Pe,symbolInstanceEnd:De}=Ee;n.push({sortKey:ve,symbolInstanceStart:Pe,symbolInstanceEnd:De,parameters:xe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:xe})}attemptAnchorPlacement(n,u,d,v,T,A,O,R,B,V,X,Y,re,oe,he,pe,de,xe,Ee,ve){const Pe=c.aP[n.textAnchor],De=[n.textOffset0,n.textOffset1],we=Pl(Pe,d,v,De,T),Re=this.collisionIndex.placeCollisionBox(u,Y,R,B,V,O,A,pe,X.predicate,Ee,we,ve);if((!xe||this.collisionIndex.placeCollisionBox(xe,Y,R,B,V,O,A,de,X.predicate,Ee,we,ve).placeable)&&Re.placeable){let Qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[re.crossTileID]&&this.prevPlacement.placements[re.crossTileID]&&this.prevPlacement.placements[re.crossTileID].text&&(Qe=this.prevPlacement.variableOffsets[re.crossTileID].anchor),re.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[re.crossTileID]={textOffset:De,width:d,height:v,anchor:Pe,textBoxScale:T,prevAnchor:Qe},this.markUsedJustification(oe,Pe,re,he),oe.allowVerticalPlacement&&(this.markUsedOrientation(oe,he,re),this.placedOrientations[re.crossTileID]=he),{shift:we,placedGlyphBoxes:Re}}}placeLayerBucketPart(n,u,d){const{bucket:v,layout:T,translationText:A,translationIcon:O,unwrappedTileID:R,pitchedLabelPlaneMatrix:B,textPixelRatio:V,holdingForFade:X,collisionBoxArray:Y,partiallyEvaluatedTextSize:re,collisionGroup:oe}=n.parameters,he=T.get("text-optional"),pe=T.get("icon-optional"),de=c.aQ(T,"text-overlap","text-allow-overlap"),xe=de==="always",Ee=c.aQ(T,"icon-overlap","icon-allow-overlap"),ve=Ee==="always",Pe=T.get("text-rotation-alignment")==="map",De=T.get("text-pitch-alignment")==="map",we=T.get("icon-text-fit")!=="none",Re=T.get("symbol-z-order")==="viewport-y",Qe=xe&&(ve||!v.hasIconData()||pe),Ye=ve&&(xe||!v.hasTextData()||he);!v.collisionArrays&&Y&&v.deserializeCollisionBoxes(Y);const He=this.retainedQueryData[v.bucketInstanceId].tileID,Je=this._getTerrainElevationFunc(He),Ct=this.transform.getFastPathSimpleProjectionMatrix(He),Dt=(ut,Zt,vr)=>{var Xr,vn;if(u[ut.crossTileID])return;if(X)return void(this.placements[ut.crossTileID]=new Hs(!1,!1,!1));let dn=!1,Sn=!1,tn=!0,fi=null,jn={box:null,placeable:!1,offscreen:null,occluded:!1},Di={placeable:!1},Vn=null,qn=null,Yi=null,js=0,us=0,Aa=0;Zt.textFeatureIndex?js=Zt.textFeatureIndex:ut.useRuntimeCollisionCircles&&(js=ut.featureIndex),Zt.verticalTextFeatureIndex&&(us=Zt.verticalTextFeatureIndex);const cl=Zt.textBox;if(cl){const Xi=un=>{let Tn=c.az.horizontal;if(v.allowVerticalPlacement&&!un&&this.prevPlacement){const Za=this.prevPlacement.placedOrientations[ut.crossTileID];Za&&(this.placedOrientations[ut.crossTileID]=Za,Tn=Za,this.markUsedOrientation(v,Tn,ut))}return Tn},Eo=(un,Tn)=>{if(v.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Zt.verticalTextBox){for(const Za of v.writingModes)if(Za===c.az.vertical?(jn=Tn(),Di=jn):jn=un(),jn&&jn.placeable)break}else jn=un()},Ga=ut.textAnchorOffsetStartIndex,Ki=ut.textAnchorOffsetEndIndex;if(Ki===Ga){const un=(Tn,Za)=>{const di=this.collisionIndex.placeCollisionBox(Tn,de,V,He,R,De,Pe,A,oe.predicate,Je,void 0,Ct);return di&&di.placeable&&(this.markUsedOrientation(v,Za,ut),this.placedOrientations[ut.crossTileID]=Za),di};Eo((()=>un(cl,c.az.horizontal)),(()=>{const Tn=Zt.verticalTextBox;return v.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Tn?un(Tn,c.az.vertical):{box:null,offscreen:null}})),Xi(jn&&jn.placeable)}else{let un=c.aP[(vn=(Xr=this.prevPlacement)===null||Xr===void 0?void 0:Xr.variableOffsets[ut.crossTileID])===null||vn===void 0?void 0:vn.anchor];const Tn=(di,ad,Zl)=>{const wm=di.x2-di.x1,Hl=di.y2-di.y1,od=ut.textBoxScale,fp=we&&Ee==="never"?ad:null;let Ha=null,cs=de==="never"?1:2,sd="never";un&&cs++;for(let ld=0;ld<cs;ld++){for(let Dc=Ga;Dc<Ki;Dc++){const ud=v.textAnchorOffsets.get(Dc);if(un&&ud.textAnchor!==un)continue;const Oc=this.attemptAnchorPlacement(ud,di,wm,Hl,od,Pe,De,V,He,R,oe,sd,ut,v,Zl,A,O,fp,Je);if(Oc&&(Ha=Oc.placedGlyphBoxes,Ha&&Ha.placeable))return dn=!0,fi=Oc.shift,Ha}un?un=null:sd=de}return d&&!Ha&&(Ha={box:this.collisionIndex.placeCollisionBox(cl,"always",V,He,R,De,Pe,A,oe.predicate,Je,void 0,Ct).box,offscreen:!1,placeable:!1,occluded:!1}),Ha};Eo((()=>Tn(cl,Zt.iconBox,c.az.horizontal)),(()=>{const di=Zt.verticalTextBox;return v.allowVerticalPlacement&&(!jn||!jn.placeable)&&ut.numVerticalGlyphVertices>0&&di?Tn(di,Zt.verticalIconBox,c.az.vertical):{box:null,occluded:!0,offscreen:null}})),jn&&(dn=jn.placeable,tn=jn.offscreen);const Za=Xi(jn&&jn.placeable);if(!dn&&this.prevPlacement){const di=this.prevPlacement.variableOffsets[ut.crossTileID];di&&(this.variableOffsets[ut.crossTileID]=di,this.markUsedJustification(v,di.anchor,ut,Za))}}}if(Vn=jn,dn=Vn&&Vn.placeable,tn=Vn&&Vn.offscreen,ut.useRuntimeCollisionCircles&&ut.centerJustifiedTextSymbolIndex>=0){const Xi=v.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),Eo=c.aA(v.textSizeData,re,Xi),Ga=T.get("text-padding");qn=this.collisionIndex.placeCollisionCircles(de,Xi,v.lineVertexArray,v.glyphOffsetArray,Eo,R,B,d,De,oe.predicate,ut.collisionCircleDiameter,Ga,A,Je),qn.circles.length&&qn.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),dn=xe||qn.circles.length>0&&!qn.collisionDetected,tn=tn&&qn.offscreen}if(Zt.iconFeatureIndex&&(Aa=Zt.iconFeatureIndex),Zt.iconBox){const Xi=Eo=>this.collisionIndex.placeCollisionBox(Eo,Ee,V,He,R,De,Pe,O,oe.predicate,Je,we&&fi?fi:void 0,Ct);Di&&Di.placeable&&Zt.verticalIconBox?(Yi=Xi(Zt.verticalIconBox),Sn=Yi.placeable):(Yi=Xi(Zt.iconBox),Sn=Yi.placeable),tn=tn&&Yi.offscreen}const Cc=he||ut.numHorizontalGlyphVertices===0&&ut.numVerticalGlyphVertices===0,hl=pe||ut.numIconVertices===0;Cc||hl?hl?Cc||(Sn=Sn&&dn):dn=Sn&&dn:Sn=dn=Sn&&dn;const Gl=Sn&&Yi.placeable;if(dn&&Vn.placeable&&this.collisionIndex.insertCollisionBox(Vn.box,de,T.get("text-ignore-placement"),v.bucketInstanceId,Di&&Di.placeable&&us?us:js,oe.ID),Gl&&this.collisionIndex.insertCollisionBox(Yi.box,Ee,T.get("icon-ignore-placement"),v.bucketInstanceId,Aa,oe.ID),qn&&dn&&this.collisionIndex.insertCollisionCircles(qn.circles,de,T.get("text-ignore-placement"),v.bucketInstanceId,js,oe.ID),d&&this.storeCollisionData(v.bucketInstanceId,vr,Zt,Vn,Yi,qn),ut.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ut.crossTileID]=new Hs((dn||Qe)&&!Vn?.occluded,(Sn||Ye)&&!Yi?.occluded,tn||v.justReloaded),u[ut.crossTileID]=!0};if(Re){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ut=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Zt=ut.length-1;Zt>=0;--Zt){const vr=ut[Zt];Dt(v.symbolInstances.get(vr),v.collisionArrays[vr],vr)}}else for(let ut=n.symbolInstanceStart;ut<n.symbolInstanceEnd;ut++)Dt(v.symbolInstances.get(ut),v.collisionArrays[ut],ut);v.justReloaded=!1}storeCollisionData(n,u,d,v,T,A){if(d.textBox||d.iconBox){let O,R;this.collisionBoxArrays.has(n)?O=this.collisionBoxArrays.get(n):(O=new Map,this.collisionBoxArrays.set(n,O)),O.has(u)?R=O.get(u):(R={text:null,icon:null},O.set(u,R)),d.textBox&&(R.text=v.box),d.iconBox&&(R.icon=T.box)}if(A){let O=this.collisionCircleArrays[n];O===void 0&&(O=this.collisionCircleArrays[n]=[]);for(let R=0;R<A.circles.length;R+=4)O.push(A.circles[R+0]-ti),O.push(A.circles[R+1]-ti),O.push(A.circles[R+2]),O.push(A.collisionDetected?1:0)}}markUsedJustification(n,u,d,v){let T;T=v===c.az.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.aR(u)];const A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const O of A)O>=0&&(n.text.placedSymbolArray.get(O).crossTileID=T>=0&&O!==T?0:d.crossTileID)}markUsedOrientation(n,u,d){const v=u===c.az.horizontal||u===c.az.horizontalOnly?u:0,T=u===c.az.vertical?u:0,A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const O of A)n.text.placedSymbolArray.get(O).placedOrientation=v;d.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let d=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const v=u?u.symbolFadeChange(n):1,T=u?u.opacities:{},A=u?u.variableOffsets:{},O=u?u.placedOrientations:{};for(const R in this.placements){const B=this.placements[R],V=T[R];V?(this.opacities[R]=new Ml(V,v,B.text,B.icon),d=d||B.text!==V.text.placed||B.icon!==V.icon.placed):(this.opacities[R]=new Ml(null,v,B.text,B.icon,B.skipFade),d=d||B.text||B.icon)}for(const R in T){const B=T[R];if(!this.opacities[R]){const V=new Ml(B,v,!1,!1);V.isHidden()||(this.opacities[R]=V,d=d||B.text.placed||B.icon.placed)}}for(const R in A)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=A[R]);for(const R in O)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=O[R]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const d={};for(const v of u){const T=v.getBucket(n);T&&v.latestFeatureIndex&&n.id===T.layerIds[0]&&this.updateBucketOpacities(T,v.tileID,d,v.collisionBoxArray)}}updateBucketOpacities(n,u,d,v){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const T=n.layers[0],A=T.layout,O=new Ml(null,0,!1,!1,!0),R=A.get("text-allow-overlap"),B=A.get("icon-allow-overlap"),V=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=A.get("text-rotation-alignment")==="map",Y=A.get("text-pitch-alignment")==="map",re=A.get("icon-text-fit")!=="none",oe=new Ml(null,0,R&&(B||!n.hasIconData()||A.get("icon-optional")),B&&(R||!n.hasTextData()||A.get("text-optional")),!0);!n.collisionArrays&&v&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(v);const he=(de,xe,Ee)=>{for(let ve=0;ve<xe/4;ve++)de.opacityVertexArray.emplaceBack(Ee);de.hasVisibleVertices=de.hasVisibleVertices||Ee!==Nt},pe=this.collisionBoxArrays.get(n.bucketInstanceId);for(let de=0;de<n.symbolInstances.length;de++){const xe=n.symbolInstances.get(de),{numHorizontalGlyphVertices:Ee,numVerticalGlyphVertices:ve,crossTileID:Pe}=xe;let De=this.opacities[Pe];d[Pe]?De=O:De||(De=oe,this.opacities[Pe]=De),d[Pe]=!0;const we=xe.numIconVertices>0,Re=this.placedOrientations[xe.crossTileID],Qe=Re===c.az.vertical,Ye=Re===c.az.horizontal||Re===c.az.horizontalOnly;if(Ee>0||ve>0){const Je=Pt(De.text);he(n.text,Ee,Qe?Nt:Je),he(n.text,ve,Ye?Nt:Je);const Ct=De.text.isHidden();[xe.rightJustifiedTextSymbolIndex,xe.centerJustifiedTextSymbolIndex,xe.leftJustifiedTextSymbolIndex].forEach((Zt=>{Zt>=0&&(n.text.placedSymbolArray.get(Zt).hidden=Ct||Qe?1:0)})),xe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(xe.verticalPlacedTextSymbolIndex).hidden=Ct||Ye?1:0);const Dt=this.variableOffsets[xe.crossTileID];Dt&&this.markUsedJustification(n,Dt.anchor,xe,Re);const ut=this.placedOrientations[xe.crossTileID];ut&&(this.markUsedJustification(n,"left",xe,ut),this.markUsedOrientation(n,ut,xe))}if(we){const Je=Pt(De.icon),Ct=!(re&&xe.verticalPlacedIconSymbolIndex&&Qe);xe.placedIconSymbolIndex>=0&&(he(n.icon,xe.numIconVertices,Ct?Je:Nt),n.icon.placedSymbolArray.get(xe.placedIconSymbolIndex).hidden=De.icon.isHidden()),xe.verticalPlacedIconSymbolIndex>=0&&(he(n.icon,xe.numVerticalIconVertices,Ct?Nt:Je),n.icon.placedSymbolArray.get(xe.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const He=pe&&pe.has(de)?pe.get(de):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Je=n.collisionArrays[de];if(Je){let Ct=new c.P(0,0);if(Je.textBox||Je.verticalTextBox){let Dt=!0;if(V){const ut=this.variableOffsets[Pe];ut?(Ct=Pl(ut.anchor,ut.width,ut.height,ut.textOffset,ut.textBoxScale),X&&Ct._rotate(Y?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Dt=!1}if(Je.textBox||Je.verticalTextBox){let ut;Je.textBox&&(ut=Qe),Je.verticalTextBox&&(ut=Ye),jo(n.textCollisionBox.collisionVertexArray,De.text.placed,!Dt||ut,He.text,Ct.x,Ct.y)}}if(Je.iconBox||Je.verticalIconBox){const Dt=!!(!Ye&&Je.verticalIconBox);let ut;Je.iconBox&&(ut=Dt),Je.verticalIconBox&&(ut=!Dt),jo(n.iconCollisionBox.collisionVertexArray,De.icon.placed,ut,He.icon,re?Ct.x:0,re?Ct.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const d=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function jo(w,n,u,d,v,T){d&&d.length!==0||(d=[0,0,0,0]);const A=d[0]-ti,O=d[1]-ti,R=d[2]-ti,B=d[3]-ti;w.emplaceBack(n?1:0,u?1:0,v||0,T||0,A,O),w.emplaceBack(n?1:0,u?1:0,v||0,T||0,R,O),w.emplaceBack(n?1:0,u?1:0,v||0,T||0,R,B),w.emplaceBack(n?1:0,u?1:0,v||0,T||0,A,B)}const ri=Math.pow(2,25),fh=Math.pow(2,24),Cl=Math.pow(2,17),fo=Math.pow(2,16),Mf=Math.pow(2,9),Ws=Math.pow(2,8),Fe=Math.pow(2,1);function Pt(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const n=w.placed?1:0,u=Math.floor(127*w.opacity);return u*ri+n*fh+u*Cl+n*fo+u*Mf+n*Ws+u*Fe+n}const Nt=0;class Qt{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,d,v,T){const A=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(A,v,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort(((O,R)=>O.sortKey-R.sortKey)));this._currentPartIndex<A.length;)if(u.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,T())return!0;return!1}}class Ot{constructor(n,u,d,v,T,A,O,R){this.placement=new es(n,u,A,O,R),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(n,u,d){const v=W(),T=()=>!this._forceFullPlacement&&W()-v>2;for(;this._currentPlacementIndex>=0;){const A=u[n[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=O)&&(!A.maxzoom||A.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Qt(A)),this._inProgressLayer.continuePlacement(d[A.source],this.placement,this._showCollisionBoxes,A,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const nr=512/c.a5/2;class Gt{constructor(n,u,d){this.tileID=n,this.bucketInstanceId=d,this._symbolsByKey={};const v=new Map;for(let T=0;T<u.length;T++){const A=u.get(T),O=A.key,R=v.get(O);R?R.push(A):v.set(O,[A])}for(const[T,A]of v){const O={positions:A.map((R=>({x:Math.floor(R.anchorX*nr),y:Math.floor(R.anchorY*nr)}))),crossTileIDs:A.map((R=>R.crossTileID))};if(O.positions.length>128){const R=new c.aT(O.positions.length,16,Uint16Array);for(const{x:B,y:V}of O.positions)R.add(B,V);R.finish(),delete O.positions,O.index=R}this._symbolsByKey[T]=O}}getScaledCoordinates(n,u){const{x:d,y:v,z:T}=this.tileID.canonical,{x:A,y:O,z:R}=u.canonical,B=nr/Math.pow(2,R-T),V=(O*c.a5+n.anchorY)*B,X=v*c.a5*nr;return{x:Math.floor((A*c.a5+n.anchorX)*B-d*c.a5*nr),y:Math.floor(V-X)}}findMatches(n,u,d){const v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let T=0;T<n.length;T++){const A=n.get(T);if(A.crossTileID)continue;const O=this._symbolsByKey[A.key];if(!O)continue;const R=this.getScaledCoordinates(A,u);if(O.index){const B=O.index.range(R.x-v,R.y-v,R.x+v,R.y+v).sort();for(const V of B){const X=O.crossTileIDs[V];if(!d[X]){d[X]=!0,A.crossTileID=X;break}}}else if(O.positions)for(let B=0;B<O.positions.length;B++){const V=O.positions[B],X=O.crossTileIDs[B];if(Math.abs(V.x-R.x)<=v&&Math.abs(V.y-R.y)<=v&&!d[X]){d[X]=!0,A.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:n})=>n))}}class Yr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const d in this.indexes){const v=this.indexes[d],T={};for(const A in v){const O=v[A];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+u),T[O.tileID.key]=O}this.indexes[d]=T}this.lng=n}addBucket(n,u,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let T=0;T<u.symbolInstances.length;T++)u.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const v=this.usedCrossTileIDs[n.overscaledZ];for(const T in this.indexes){const A=this.indexes[T];if(Number(T)>n.overscaledZ)for(const O in A){const R=A[O];R.tileID.isChildOf(n)&&R.findMatches(u.symbolInstances,n,v)}else{const O=A[n.scaledTo(Number(T)).key];O&&O.findMatches(u.symbolInstances,n,v)}}for(let T=0;T<u.symbolInstances.length;T++){const A=u.symbolInstances.get(T);A.crossTileID||(A.crossTileID=d.generate(),v[A.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Gt(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const d of u.getCrossTileIDsLists())for(const v of d)delete this.usedCrossTileIDs[n][v]}removeStaleBuckets(n){let u=!1;for(const d in this.indexes){const v=this.indexes[d];for(const T in v)n[v[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,v[T]),delete v[T],u=!0)}return u}}class on{constructor(){this.layerIndexes={},this.crossTileIDs=new Yr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,d){let v=this.layerIndexes[n.id];v===void 0&&(v=this.layerIndexes[n.id]=new xr);let T=!1;const A={};v.handleWrapJump(d);for(const O of u){const R=O.getBucket(n);R&&n.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(O.tileID,R,this.crossTileIDs)&&(T=!0),A[R.bucketInstanceId]=!0)}return v.removeStaleBuckets(A)&&(T=!0),T}pruneUnusedLayers(n){const u={};n.forEach((d=>{u[d]=!0}));for(const d in this.layerIndexes)u[d]||delete this.layerIndexes[d]}}var Mr="void main() {fragColor=vec4(1.0);}";const Lr={prelude:Wt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Wt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Wt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Wt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Wt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Wt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Wt(Mr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Wt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Wt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Wt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Wt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Wt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Wt(Mr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Wt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Wt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Wt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Wt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Wt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Wt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Wt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Wt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Wt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Wt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy/16.0;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Wt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Wt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Wt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Wt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Wt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Wt(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Wt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Wt(w,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=n.match(/in ([\w]+) ([\w]+)/g),v=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=T?T.concat(v):v,O={};return{fragmentSource:w=w.replace(u,((R,B,V,X,Y)=>(O[Y]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
in ${V} ${X} ${Y};
#else
uniform ${V} ${X} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${V} ${X} ${Y} = u_${Y};
#endif
`))),vertexSource:n=n.replace(u,((R,B,V,X,Y)=>{const re=X==="float"?"vec2":"vec4",oe=Y.match(/color/)?"color":re;return O[Y]?B==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${V} ${re} a_${Y};
out ${V} ${X} ${Y};
#else
uniform ${V} ${X} u_${Y};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${V} ${X} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${oe}(a_${Y}, u_${Y}_t);
#else
    ${V} ${X} ${Y} = u_${Y};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${V} ${re} a_${Y};
#else
uniform ${V} ${X} u_${Y};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${V} ${X} ${Y} = a_${Y};
#else
    ${V} ${X} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${V} ${X} ${Y} = unpack_mix_${oe}(a_${Y}, u_${Y}_t);
#else
    ${V} ${X} ${Y} = u_${Y};
#endif
`})),staticAttributes:d,staticUniforms:A}}class Zn{constructor(n,u,d){this.vertexBuffer=n,this.indexBuffer=u,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Nr=c.aU([{name:"a_pos",type:"Int16",components:2}]);const ki="#define PROJECTION_MERCATOR",ni="mercator";class La{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return ni}get shaderDefine(){return ki}get shaderPreludeCode(){return Lr.projectionMercator}get vertexShaderPreludeCode(){return Lr.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,u,d,v,T){if(this._cachedMesh)return this._cachedMesh;const A=new c.aW;A.emplaceBack(0,0),A.emplaceBack(c.a5,0),A.emplaceBack(0,c.a5),A.emplaceBack(c.a5,c.a5);const O=n.createVertexBuffer(A,Nr.members),R=c.aX.simpleSegment(0,0,4,2),B=new c.aY;B.emplaceBack(1,0,2),B.emplaceBack(1,2,3);const V=n.createIndexBuffer(B);return this._cachedMesh=new Zn(O,V,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class wn{constructor(n=0,u=0,d=0,v=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(d)||d<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=d,this.right=v}interpolate(n,u,d){return u.top!=null&&n.top!=null&&(this.top=c.G.number(n.top,u.top,d)),u.bottom!=null&&n.bottom!=null&&(this.bottom=c.G.number(n.bottom,u.bottom,d)),u.left!=null&&n.left!=null&&(this.left=c.G.number(n.left,u.left,d)),u.right!=null&&n.right!=null&&(this.right=c.G.number(n.right,u.right,d)),this}getCenter(n,u){const d=c.an((this.left+n-this.right)/2,0,n),v=c.an((this.top+u-this.bottom)/2,0,u);return new c.P(d,v)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new wn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Zr(w,n){if(!w.renderWorldCopies||w.lngRange)return;const u=n.lng-w.center.lng;n.lng+=u>180?-360:u<-180?360:0}function Na(w){return Math.max(0,Math.floor(w))}class gi{constructor(n,u){var d;this.applyConstrain=(v,T)=>this._constrainOverride!==null?this._constrainOverride(v,T):this._callbacks.defaultConstrain(v,T),this._callbacks=n,this._tileSize=512,this._renderWorldCopies=u?.renderWorldCopies===void 0||!!u?.renderWorldCopies,this._minZoom=u?.minZoom||0,this._maxZoom=u?.maxZoom||22,this._minPitch=u?.minPitch==null?0:u?.minPitch,this._maxPitch=u?.maxPitch==null?60:u?.maxPitch,this._constrainOverride=(d=u?.constrainOverride)!==null&&d!==void 0?d:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Na(this._zoom),this._scale=c.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new wn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,u,d){this._constrainOverride=n.constrainOverride,this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=Na(this._zoom),this._scale=c.aq(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new wn(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!d&&n.autoCalculateNearFarZ,u&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get constrainOverride(){return this._constrainOverride}setConstrainOverride(n){n===void 0&&(n=null),this._constrainOverride!==n&&(this._constrainOverride=n,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const u=c.W(n,-180,180)*Math.PI/180;var d,v,T,A,O,R,B,V,X;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=C(),d=this._rotationMatrix,T=-this._bearingInRadians,A=(v=this._rotationMatrix)[0],O=v[1],R=v[2],B=v[3],V=Math.sin(T),X=Math.cos(T),d[0]=A*X+R*V,d[1]=O*X+B*V,d[2]=A*-V+R*X,d[3]=O*-V+B*X)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const u=c.an(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const u=n/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aZ(this._fovInRadians)}setFov(n){n=c.an(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=c.ap(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const u=this.applyConstrain(this._center,n).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=c.aq(u),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,u){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,d){this._unmodified=!1,this._edgeInsets.interpolate(n,u,d),this.constrainInternal(),this._calcMatrices()}resize(n,u,d=!0){this._width=n,this._height=u,d&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Tr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-c.ao,c.ao])}getCameraQueryGeometry(n,u){if(u.length===1)return[u[0],n];{const{minX:d,minY:v,maxX:T,maxY:A}=c.aa.fromPoints(u).extend(n);return[new c.P(d,v),new c.P(T,v),new c.P(T,A),new c.P(d,A),new c.P(d,v)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:d}=this.applyConstrain(this.center,this.zoom);this.setCenter(u),this.setZoom(d),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=c.ar(new Float64Array(16));c.Q(n,n,[this._width/2,-this._height/2,1]),c.O(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=c.ar(new Float64Array(16)),c.Q(n,n,[1,-1,1]),c.O(n,n,[-1,-1,0]),c.Q(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,u,d,v){const T=d!==void 0?d:this.bearing,A=v=v!==void 0?v:this.pitch,{distanceToCenter:O,clampedElevation:R}=this._distanceToCenterFromAltElevationPitch(u,this.elevation,A),{x:B,y:V}=hr(A,T),X=c.a9.fromLngLat(n,u);let Y,re,oe=c.a_(1,X.y),he=0;do{if(he+=1,he>10)break;re=O/oe,Y=new c.a9(X.x+B*re,X.y+V*re),oe=1/Y.meterInMercatorCoordinateUnits()}while(Math.abs(O-re*oe)>1e-12);return{center:Y.toLngLat(),elevation:R,zoom:c.at(this.height/2/Math.tan(this.fovInRadians/2)/re/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const u=1/this.worldSize,d=c.as(1,this.center.lat)*this.worldSize,v=c.a9.fromLngLat(this.center,this.elevation),T=v.x/u,A=v.y/u,O=v.z/u,R=this.pitch,B=this.bearing,{x:V,y:X,z:Y}=hr(R,B),re=this.cameraToCenterDistance,oe=T+re*-V,he=A+re*-X,pe=O+re*Y,{distanceToCenter:de,clampedElevation:xe}=this._distanceToCenterFromAltElevationPitch(pe/d,n,R),Ee=de*d,ve=new c.a9((oe+V*Ee)*u,(he+X*Ee)*u,0).toLngLat(),Pe=c.as(1,ve.lat),De=c.at(this.height/2/Math.tan(this.fovInRadians/2)/de/Pe/this.tileSize);this._elevation=xe,this._center=ve,this.setZoom(De)}_distanceToCenterFromAltElevationPitch(n,u,d){const v=-Math.cos(c.ap(d)),T=n-u;let A,O=u;return v*T>=0||Math.abs(v)<.1?(A=1e4,O=n+A*v):A=-T/v,{distanceToCenter:A,clampedElevation:O}}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=c.as(1,this.center.lat)*this.worldSize;return qt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const u=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/u,n.canonical.y/u,1/u/c.a5,1/u/c.a5]}}class ci{constructor(n,u){this.min=n,this.max=u,this.center=c.a$([],c.b0([],this.min,this.max),.5)}quadrant(n){const u=[n%2==0,n<2],d=c.b1(this.min),v=c.b1(this.max);for(let T=0;T<u.length;T++)d[T]=u[T]?this.min[T]:this.center[T],v[T]=u[T]?this.center[T]:this.max[T];return v[2]=this.max[2],new ci(d,v)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let u=!0;for(let d=0;d<n.planes.length;d++){const v=this.intersectsPlane(n.planes[d]);if(v===0)return 0;v===1&&(u=!1)}return u?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let u=n[3],d=n[3];for(let v=0;v<3;v++)n[v]>0?(u+=n[v]*this.min[v],d+=n[v]*this.max[v]):(d+=n[v]*this.min[v],u+=n[v]*this.max[v]);return u>=0?2:d<0?0:1}}class Ai{distanceToTile2d(n,u,d,v){const T=v.distanceX([n,u]),A=v.distanceY([n,u]);return Math.hypot(T,A)}getWrap(n,u,d){return d}getTileBoundingVolume(n,u,d,v){var T,A;let O=0,R=0;if(v?.terrain){const V=new c.a2(n.z,u,n.z,n.x,n.y),X=v.terrain.getMinMaxElevation(V);O=(T=X.minElevation)!==null&&T!==void 0?T:Math.min(0,d),R=(A=X.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}const B=1<<n.z;return new ci([u+n.x/B,n.y/B,O],[u+(n.x+1)/B,(n.y+1)/B,R])}allowVariableZoom(n,u){const d=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,v=c.an(78.5-d/2,0,60);return!!u.terrain||n.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class Jr{constructor(n,u,d){this.points=n,this.planes=u,this.aabb=d}static fromInvProjectionMatrix(n,u=1,d=0,v,T){const A=T?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],O=Math.pow(2,d),R=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Y=>(function(re,oe,he,pe){const de=c.aH([],re,oe),xe=1/de[3]/he*pe;return c.b6(de,de,[xe,xe,1/de[3],xe])})(Y,n,u,O)));v&&(function(Y,re,oe,he){const pe=he?4:0,de=he?0:4;let xe=0;const Ee=[],ve=[];for(let we=0;we<4;we++){const Re=c.b2([],Y[we+de],Y[we+pe]),Qe=c.b7(Re);c.a$(Re,Re,1/Qe),Ee.push(Qe),ve.push(Re)}for(let we=0;we<4;we++){const Re=c.b8(Y[we+pe],ve[we],oe);xe=Re!==null&&Re>=0?Math.max(xe,Re):Math.max(xe,Ee[we])}const Pe=(function(we,Re){const Qe=c.b2([],we[Re[0]],we[Re[1]]),Ye=c.b2([],we[Re[2]],we[Re[1]]),He=[0,0,0,0];return c.b3(He,c.b4([],Qe,Ye)),He[3]=-c.b5(He,we[Re[0]]),He})(Y,re),De=(function(we,Re){const Qe=c.b9(we),Ye=c.ba([],we,1/Qe),He=c.b2([],Re,c.a$([],Ye,c.b5(Re,Ye))),Je=c.b9(He);if(Je>0){const Ct=Math.sqrt(1-Ye[3]*Ye[3]),Dt=c.a$([],Ye,-Ye[3]),ut=c.b0([],Dt,c.a$([],He,Ct/Je));return c.bb(Re,ut)}return null})(oe,Pe);if(De!==null){const we=De/c.b5(ve[0],Pe);xe=Math.min(xe,we)}for(let we=0;we<4;we++){const Re=Math.min(xe,Ee[we]);Y[we+de]=[Y[we+pe][0]+ve[we][0]*Re,Y[we+pe][1]+ve[we][1]*Re,Y[we+pe][2]+ve[we][2]*Re,1]}})(R,A[0],v,T);const B=A.map((Y=>{const re=c.b2([],R[Y[0]],R[Y[1]]),oe=c.b2([],R[Y[2]],R[Y[1]]),he=c.b3([],c.b4([],re,oe)),pe=-c.b5(he,R[Y[1]]);return he.concat(pe)})),V=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],X=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Y of R)for(let re=0;re<3;re++)V[re]=Math.min(V[re],Y[re]),X[re]=Math.max(X[re],Y[re]);return new Jr(R,B,new ci(V,X))}}class kr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,d){return this._helper.interpolatePadding(n,u,d)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,d=!0){this._helper.resize(n,u,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,u){}constructor(n){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(u,d)=>{d=c.an(+d,this.minZoom,this.maxZoom);const v={center:new c.V(u.lng,u.lat),zoom:d};let T=this._helper._lngRange;if(!this._helper._renderWorldCopies&&T===null){const ve=179.9999999999;T=[-ve,ve]}const A=this.tileSize*c.aq(v.zoom);let O=0,R=A,B=0,V=A,X=0,Y=0;const{x:re,y:oe}=this.size;if(this._helper._latRange){const ve=this._helper._latRange;O=c.X(ve[1])*A,R=c.X(ve[0])*A,R-O<oe&&(X=oe/(R-O))}T&&(B=c.W(c.Y(T[0])*A,0,A),V=c.W(c.Y(T[1])*A,0,A),V<B&&(V+=A),V-B<re&&(Y=re/(V-B)));const{x:he,y:pe}=Ve(A,u);let de,xe;const Ee=Math.max(Y||0,X||0);if(Ee){const ve=new c.P(Y?(V+B)/2:he,X?(R+O)/2:pe);return v.center=_t(A,ve).wrap(),v.zoom+=c.at(Ee),v}if(this._helper._latRange){const ve=oe/2;pe-ve<O&&(xe=O+ve),pe+ve>R&&(xe=R-ve)}if(T){const ve=(B+V)/2;let Pe=he;this._helper._renderWorldCopies&&(Pe=c.W(he,ve-A/2,ve+A/2));const De=re/2;Pe-De<B&&(de=B+De),Pe+De>V&&(de=V-De)}if(de!==void 0||xe!==void 0){const ve=new c.P(de??he,xe??pe);v.center=_t(A,ve).wrap()}return v},this.applyConstrain=(u,d)=>this._helper.applyConstrain(u,d),this._helper=new gi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,d)=>this.defaultConstrain(u,d)},n),this._coveringTilesDetailsProvider=new Ai}clone(){const n=new kr;return n.apply(this,!1),n}apply(n,u,d){this._helper.apply(n,u,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const u=[new c.bc(0,n)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new c.P(0,0)),v=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),T=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),A=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),O=Math.floor(Math.min(d.x,v.x,T.x,A.x)),R=Math.floor(Math.max(d.x,v.x,T.x,A.x)),B=1;for(let V=O-B;V<=R+B;V++)V!==0&&u.push(new c.bc(V,n))}return u}getCameraFrustum(){return Jr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const u=this.screenPointToLocation(this.centerPoint,n),d=n?n.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(n,u){const d=c.as(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(u,d),T=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),A=c.a9.fromLngLat(n),O=new c.a9(A.x-(v.x-T.x),A.y-(v.y-T.y));this.setCenter(O?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,u){return u?this.coordinatePoint(c.a9.fromLngLat(n),u.getElevationForLngLat(n,this),this._pixelMatrix3D):this.coordinatePoint(c.a9.fromLngLat(n))}screenPointToLocation(n,u){var d;return(d=this.screenPointToMercatorCoordinate(n,u))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(n,u){if(u){const d=u.pointCoordinate(n);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,u){const d=u||0,v=[n.x,n.y,0,1],T=[n.x,n.y,1,1];c.aH(v,v,this._pixelMatrixInverse),c.aH(T,T,this._pixelMatrixInverse);const A=v[3],O=T[3],R=v[1]/A,B=T[1]/O,V=v[2]/A,X=T[2]/O,Y=V===X?0:(d-V)/(X-V);return new c.a9(c.G.number(v[0]/A,T[0]/O,Y)/this.worldSize,c.G.number(R,B,Y)/this.worldSize,d)}coordinatePoint(n,u=0,d=this._pixelMatrix){const v=[n.x*this.worldSize,n.y*this.worldSize,u,1];return c.aH(v,v,d),new c.P(v[0]/v[3],v[1]/v[3])}getBounds(){const n=Math.max(0,this._helper._height/2-Xe(this));return new Tr().extend(this.screenPointToLocation(new c.P(0,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,n))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(n,u){return u?u.pointCoordinate(n)!=null:n.y>this.height/2-Xe(this)}calculatePosMatrix(n,u=!1,d){var v;const T=(v=n.key)!==null&&v!==void 0?v:c.bd(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),A=u?this._alignedPosMatrixCache:this._posMatrixCache;if(A.has(T)){const B=A.get(T);return d?B.f32:B.f64}const O=Me(n,this.worldSize);c.S(O,u?this._alignedProjMatrix:this._viewProjMatrix,O);const R={f64:O,f32:new Float32Array(O)};return A.set(T,R),d?R.f32:R.f64}calculateFogMatrix(n){const u=n.key,d=this._fogMatrixCacheF32;if(d.has(u))return d.get(u);const v=Me(n,this.worldSize);return c.S(v,this._fogMatrix,v),d.set(u,new Float32Array(v)),d.get(u)}calculateCenterFromCameraLngLatAlt(n,u,d,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,d,v)}_calculateNearFarZIfNeeded(n,u,d){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),T=n-v*this._helper._pixelPerMeter/Math.cos(u),A=v<0?T:n,O=Math.PI/2+this.pitchInRadians,R=c.ap(this.fov)*(Math.abs(Math.cos(c.ap(this.roll)))*this.height+Math.abs(Math.sin(c.ap(this.roll)))*this.width)/this.height*(.5+d.y/this.height),B=Math.sin(R)*A/Math.sin(c.an(Math.PI-O-R,.01,Math.PI-.01)),V=Xe(this),X=Math.atan(V/this._helper.cameraToCenterDistance),Y=c.ap(.75),re=X>Y?2*X*(.5+d.y/(2*V)):Y,oe=Math.sin(re)*A/Math.sin(c.an(Math.PI-O-re,.01,Math.PI-.01)),he=Math.min(B,oe);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*he+A),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,u=Ve(this.worldSize,this.center),d=u.x,v=u.y;this._helper._pixelPerMeter=c.as(1,this.center.lat)*this.worldSize;const T=c.ap(Math.min(this.pitch,Ne)),A=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(T));let O;this._calculateNearFarZIfNeeded(A,T,n),O=new Float64Array(16),c.be(O,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aB(this._invProjMatrix,O),O[8]=2*-n.x/this._helper._width,O[9]=2*n.y/this._helper._height,this._projectionMatrix=c.bf(O),c.Q(O,O,[1,-1,1]),c.O(O,O,[0,0,-this._helper.cameraToCenterDistance]),c.bg(O,O,-this.rollInRadians),c.bh(O,O,this.pitchInRadians),c.bg(O,O,-this.bearingInRadians),c.O(O,O,[-d,-v,0]),this._mercatorMatrix=c.Q([],O,[this.worldSize,this.worldSize,this.worldSize]),c.Q(O,O,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,O),c.O(O,O,[0,0,-this.elevation]),this._viewProjMatrix=O,this._invViewProjMatrix=c.aB([],O);const R=[0,0,-1,1];c.aH(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),c.be(this._fogMatrix,this.fovInRadians,this.width/this.height,A,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,c.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.O(this._fogMatrix,this._fogMatrix,[-d,-v,0]),c.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,O);const B=this._helper._width%2/2,V=this._helper._height%2/2,X=Math.cos(this.bearingInRadians),Y=Math.sin(-this.bearingInRadians),re=d-Math.round(d)+X*B+Y*V,oe=v-Math.round(v)+X*V+Y*B,he=new Float64Array(O);if(c.O(he,he,[re>.5?re-1:re,oe>.5?oe-1:oe,0]),this._alignedProjMatrix=he,O=c.aB(new Float64Array(16),this._pixelMatrix),!O)throw new Error("failed to invert matrix");this._pixelMatrixInverse=O,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new c.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.aH(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=c.as(1,this.center.lat)*this.worldSize;return qt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,u){const d=c.a9.fromLngLat(n),v=[d.x*this.worldSize,d.y*this.worldSize,u,1];return c.aH(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(n){const{overscaledTileID:u,aligned:d,applyTerrainMatrix:v}=n,T=this._helper.getMercatorTileCoordinates(u),A=u?this.calculatePosMatrix(u,d,!0):null;let O;return O=u&&u.terrainRttPosMatrix32f&&v?u.terrainRttPosMatrix32f:A||c.bi(),{mainMatrix:O,tileMercatorCoords:T,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:O}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,u,d){return 1}transformLightDirection(n){return c.b1(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,u,d,v){const T=this.calculatePosMatrix(d);let A;v?(A=[n,u,v(n,u),1],c.aH(A,A,T)):(A=[n,u,0,1],ei(A,A,T));const O=A[3];return{point:new c.P(A[0]/O,A[1]/O),signedDistanceFromCamera:O,isOccluded:!1}}populateCache(n){for(const u of n)this.calculatePosMatrix(u)}getMatrixForModel(n,u){const d=c.a9.fromLngLat(n,u),v=d.meterInMercatorCoordinateUnits(),T=c.bj();return c.O(T,T,[d.x,d.y,d.z]),c.bg(T,T,Math.PI),c.bh(T,T,Math.PI/2),c.Q(T,T,[-v,v,v]),T}getProjectionDataForCustomLayer(n=!0){const u=new c.a2(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:n}),v=Me(u,this.worldSize);c.S(v,this._viewProjMatrix,v),d.tileMercatorCoords=[0,0,1,1];const T=[c.a5,c.a5,this.worldSize/this._helper.pixelsPerMeter],A=c.bk();return c.Q(A,v,T),d.fallbackMatrix=A,d.mainMatrix=A,d}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function Ri(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Es(w){if(w.useSlerp)if(w.k<1){const n=c.bl(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),u=c.bl(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),d=new Float64Array(4);c.bm(d,n,u,w.k);const v=c.bn(d);w.tr.setRoll(v.roll),w.tr.setPitch(v.pitch),w.tr.setBearing(v.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(c.G.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(c.G.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(c.G.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function dh(w,n,u,d,v){const T=v.padding,A=Ve(v.worldSize,u.getNorthWest()),O=Ve(v.worldSize,u.getNorthEast()),R=Ve(v.worldSize,u.getSouthEast()),B=Ve(v.worldSize,u.getSouthWest()),V=c.ap(-d),X=A.rotate(V),Y=O.rotate(V),re=R.rotate(V),oe=B.rotate(V),he=new c.P(Math.max(X.x,Y.x,oe.x,re.x),Math.max(X.y,Y.y,oe.y,re.y)),pe=new c.P(Math.min(X.x,Y.x,oe.x,re.x),Math.min(X.y,Y.y,oe.y,re.y)),de=he.sub(pe),xe=(v.width-(T.left+T.right+n.left+n.right))/de.x,Ee=(v.height-(T.top+T.bottom+n.top+n.bottom))/de.y;if(Ee<0||xe<0)return void Ri();const ve=Math.min(c.at(v.scale*Math.min(xe,Ee)),w.maxZoom),Pe=c.P.convert(w.offset),De=new c.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(c.ap(d)),we=Pe.add(De).mult(v.scale/c.aq(ve));return{center:_t(v.worldSize,A.add(R).div(2).sub(we)),zoom:ve,bearing:d}}class Ys{get useGlobeControls(){return!1}handlePanInertia(n,u){const d=n.mag(),v=Math.abs(Xe(u));return{easingOffset:n.mult(Math.min(.75*v/d,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(n,u){n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta),n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta)}handleMapControlsPan(n,u,d){n.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(d,n.around)}cameraForBoxAndBearing(n,u,d,v,T){return dh(n,u,d,v,T)}handleJumpToCenterZoom(n,u){n.zoom!==(u.zoom!==void 0?+u.zoom:n.zoom)&&n.setZoom(+u.zoom),u.center!==void 0&&n.setCenter(c.V.convert(u.center))}handleEaseTo(n,u){const d=n.zoom,v=n.padding,T={roll:n.roll,pitch:n.pitch,bearing:n.bearing},A={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},O=u.zoom!==void 0,R=!n.isPaddingEqual(u.padding);let B=!1;const V=O?+u.zoom:n.zoom;let X=n.centerPoint.add(u.offsetAsPoint);const Y=n.screenPointToLocation(X),{center:re,zoom:oe}=n.applyConstrain(c.V.convert(u.center||Y),V??d);Zr(n,re);const he=Ve(n.worldSize,Y),pe=Ve(n.worldSize,re).sub(he),de=c.aq(oe-d);return B=oe!==d,{easeFunc:xe=>{if(B&&n.setZoom(c.G.number(d,oe,xe)),c.bo(T,A)||Es({startEulerAngles:T,endEulerAngles:A,tr:n,k:xe,useSlerp:T.roll!=A.roll}),R&&(n.interpolatePadding(v,u.padding,xe),X=n.centerPoint.add(u.offsetAsPoint)),u.around)n.setLocationAtPoint(u.around,u.aroundPoint);else{const Ee=c.aq(n.zoom-d),ve=oe>d?Math.min(2,de):Math.max(.5,de),Pe=Math.pow(ve,1-xe),De=_t(n.worldSize,he.add(pe.mult(xe*Pe)).mult(Ee));n.setLocationAtPoint(n.renderWorldCopies?De.wrap():De,X)}},isZooming:B,elevationCenter:re}}handleFlyTo(n,u){const d=u.zoom!==void 0,v=n.zoom,T=n.applyConstrain(c.V.convert(u.center||u.locationAtOffset),d?+u.zoom:v),A=T.center,O=T.zoom;Zr(n,A);const R=Ve(n.worldSize,u.locationAtOffset),B=Ve(n.worldSize,A).sub(R),V=B.mag(),X=c.aq(O-v);let Y;if(u.minZoom!==void 0){const re=Math.min(+u.minZoom,v,O),oe=n.applyConstrain(A,re).zoom;Y=c.aq(oe-v)}return{easeFunc:(re,oe,he,pe)=>{n.setZoom(re===1?O:v+c.at(oe));const de=re===1?A:_t(n.worldSize,R.add(B.mult(he)).mult(oe));n.setLocationAtPoint(n.renderWorldCopies?de.wrap():de,pe)},scaleOfZoom:X,targetCenter:A,scaleOfMinZoom:Y,pixelPathLength:V}}}class sn{constructor(n,u,d){this.blendFunction=n,this.blendColor=u,this.mask=d}}sn.Replace=[1,0],sn.disabled=new sn(sn.Replace,c.bp.transparent,[!1,!1,!1,!1]),sn.unblended=new sn(sn.Replace,c.bp.transparent,[!0,!0,!0,!0]),sn.alphaBlended=new sn([1,771],c.bp.transparent,[!0,!0,!0,!0]);const Xs=2305;class Dr{constructor(n,u,d){this.enable=n,this.mode=u,this.frontFace=d}}Dr.disabled=new Dr(!1,1029,Xs),Dr.backCCW=new Dr(!0,1029,Xs),Dr.frontCCW=new Dr(!0,1028,Xs);class br{constructor(n,u,d){this.func=n,this.mask=u,this.range=d}}br.ReadOnly=!1,br.ReadWrite=!0,br.disabled=new br(519,br.ReadOnly,[0,1]);const ph=7680;class Br{constructor(n,u,d,v,T,A){this.test=n,this.ref=u,this.mask=d,this.fail=v,this.depthFail=T,this.pass=A}}Br.disabled=new Br({func:519,mask:0},0,0,ph,ph,ph);const fc=new WeakMap;function Ba(w){var n;if(fc.has(w))return fc.get(w);{const u=(n=w.getParameter(w.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return fc.set(w,u),u}}class mu{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const u=n.context,d=u.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const v=new c.aW;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const T=new c.aY;T.emplaceBack(0,1,2),this._fullscreenTriangle=new Zn(u.createVertexBuffer(v,Nr.members),u.createIndexBuffer(T),c.aX.simpleSegment(0,0,v.length,T.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(d.TEXTURE1);const A=d.createTexture();d.bindTexture(d.TEXTURE_2D,A),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(A),Ba(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,u){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,u=n.gl;n.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,u){const d=this._cachedRenderContext.context,v=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:c.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,v.TRIANGLES,br.disabled,Br.disabled,sn.unblended,Dr.disabled,((T,A)=>({u_input:T,u_output_expected:A}))(n,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Ba(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const T=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:T}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Ba(n)){const u=n.clientWaitSync(this._readbackQueue.sync,0,0);if(u===n.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=mu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let u=0;return u+=n[0]/256,u+=n[1]/65536,u+=n[2]/16777216,n[3]<127&&(u=-u),u/128}}const Pf=c.a5/128;function Cf(w,n){const u=w.granularity!==void 0?Math.max(w.granularity,1):1,d=u+(w.generateBorders?2:0),v=u+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),T=d+1,A=v+1,O=w.generateBorders?-1:0,R=w.generateBorders||w.extendToNorthPole?-1:0,B=u+(w.generateBorders?1:0),V=u+(w.generateBorders||w.extendToSouthPole?1:0),X=T*A,Y=d*v*6,re=T*A>65536;if(re&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const oe=re||n==="32bit",he=new Int16Array(2*X);let pe=0;for(let Ee=R;Ee<=V;Ee++)for(let ve=O;ve<=B;ve++){let Pe=ve/u*c.a5;ve===-1&&(Pe=-Pf),ve===u+1&&(Pe=c.a5+Pf);let De=Ee/u*c.a5;Ee===-1&&(De=w.extendToNorthPole?c.br:-Pf),Ee===u+1&&(De=w.extendToSouthPole?c.bs:c.a5+Pf),he[pe++]=Pe,he[pe++]=De}const de=oe?new Uint32Array(Y):new Uint16Array(Y);let xe=0;for(let Ee=0;Ee<v;Ee++)for(let ve=0;ve<d;ve++){const Pe=ve+1+Ee*T,De=ve+(Ee+1)*T,we=ve+1+(Ee+1)*T;de[xe++]=ve+Ee*T,de[xe++]=De,de[xe++]=Pe,de[xe++]=Pe,de[xe++]=De,de[xe++]=we}return{vertices:he.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:oe}}const Df=new c.aV({fill:new c.bt(128,2),line:new c.bt(512,0),tile:new c.bt(128,32),stencil:new c.bt(128,1),circle:3});class um{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Lr.projectionGlobe}get vertexShaderPreludeCode(){return Lr.projectionMercator.vertexSource}get subdivisionGranularity(){return Df}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new mu(n));const u=c.X(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(u,d),T=W();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=T);const A=Math.min(Math.max((T-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bv(A))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,u,d,v,T){const A=(T==="stencil"?Df.stencil:Df.tile).getGranularityForZoomLevel(u.z);return this._getMesh(n,{granularity:A,generateBorders:d,extendToNorthPole:u.y===0&&v,extendToSouthPole:u.y===(1<<u.z)-1&&v})}_getMesh(n,u){const d=this._getMeshKey(u);if(d in this._tileMeshCache)return this._tileMeshCache[d];const v=(function(T,A){const O=Cf(A,"16bit"),R=c.aW.deserialize({arrayBuffer:O.vertices,length:O.vertices.byteLength/2/2}),B=c.aY.deserialize({arrayBuffer:O.indices,length:O.indices.byteLength/2/3});return new Zn(T.createVertexBuffer(R,Nr.members),T.createIndexBuffer(B),c.aX.simpleSegment(0,0,R.length,B.length))})(n,u);return this._tileMeshCache[d]=v,v}recalculate(n){}hasTransition(){const n=W();let u=!1;return u=u||(n-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const cm=new c.t({type:new c.D(c.u.projection.type)});class _a extends c.E{constructor(n){super(),this._transitionable=new c.x(cm,void 0),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0)),this._mercatorProjection=new La,this._verticalPerspectiveProjection=new um}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof c.bw){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,u,d,v,T){return this.currentProjection.getMeshFromTileID(n,u,d,v,T)}setProjection(n){this._transitionable.setValue("type",n?.type||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Of(w){const n=gu(w.worldSize,w.center.lat);return 2*Math.PI*n}function Wi(w,n,u,d,v){const T=1/(1<<v),A=n/c.a5*T+d*T,O=c.bz((w/c.a5*T+u*T)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI,B=Math.cos(R),V=new Float64Array(3);return V[0]=Math.sin(O)*B,V[1]=Math.sin(R),V[2]=Math.cos(O)*B,V}function Mi(w){return(function(n,u){const d=Math.cos(u),v=new Float64Array(3);return v[0]=Math.sin(n)*d,v[1]=Math.sin(u),v[2]=Math.cos(n)*d,v})(w.lng*Math.PI/180,w.lat*Math.PI/180)}function gu(w,n){return w/(2*Math.PI)/Math.cos(n*Math.PI/180)}function Hd(w){const n=Math.asin(w[1])/Math.PI*180,u=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(u>1e-6){const d=w[0]/u,v=Math.acos(w[2]/u),T=(d>0?v:-v)/Math.PI*180;return new c.V(c.W(T,-180,180),n)}return new c.V(0,n)}function Ks(w){return Math.cos(w*Math.PI/180)}function ji(w,n){const u=Ks(w),d=Ks(n);return c.at(d/u)}function Wd(w,n){const u=w.rotate(n.bearingInRadians),d=n.zoom+ji(n.center.lat,0),v=c.bu(1/Ks(n.center.lat),1/Ks(Math.min(Math.abs(n.center.lat),60)),c.bx(d,7,3,0,1)),T=360/Of({worldSize:n.worldSize,center:{lat:n.center.lat}});return new c.V(n.center.lng-u.x*T*v,c.an(n.center.lat+u.y*T,-c.ao,c.ao))}function Yd(w){const n=.5*w,u=Math.sin(n),d=Math.cos(n);return Math.log(u+d)-Math.log(d-u)}function hm(w,n,u,d){const v=w.lat+u*d;if(Math.abs(u)>1){const T=(Math.sign(w.lat+u)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,A=Math.abs(w.lat+u)*Math.PI/180,O=Yd(T+d*(A-T)),R=Yd(T),B=Yd(A);return new c.V(w.lng+n*((O-R)/(B-R)),v)}return new c.V(w.lng+n*d,v)}class ty{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,u,d,v){const T=`${n.z}_${n.x}_${n.y}_${v?.terrain?"t":""}`,A=this._cache.get(T);if(A)return A;const O=this._cachePrevious.get(T);if(O)return this._cache.set(T,O),O;const R=this._boundingVolumeFactory(n,u,d,v);return this._cache.set(T,R),this._hadAnyChanges=!0,R}}class dc{constructor(n,u,d,v){this.min=d,this.max=v,this.points=n,this.planes=u}static fromAabb(n,u){const d=[];for(let v=0;v<8;v++)d.push([1&~v?n[0]:u[0],(v>>1&1)==1?u[1]:n[1],(v>>2&1)==1?u[2]:n[2]]);return new dc(d,[[-1,0,0,u[0]],[1,0,0,-n[0]],[0,-1,0,u[1]],[0,1,0,-n[1]],[0,0,-1,u[2]],[0,0,1,-n[2]]],n,u)}static fromCenterSizeAngles(n,u,d){const v=c.bB([],d[0],d[1],d[2]),T=c.bC([],[u[0],0,0],v),A=c.bC([],[0,u[1],0],v),O=c.bC([],[0,0,u[2]],v),R=[...n],B=[...n];for(let X=0;X<8;X++)for(let Y=0;Y<3;Y++){const re=n[Y]+T[Y]*(1&~X?-1:1)+A[Y]*((X>>1&1)==1?1:-1)+O[Y]*((X>>2&1)==1?1:-1);R[Y]=Math.min(R[Y],re),B[Y]=Math.max(B[Y],re)}const V=[];for(let X=0;X<8;X++){const Y=[...n];c.b0(Y,Y,c.a$([],T,1&~X?-1:1)),c.b0(Y,Y,c.a$([],A,(X>>1&1)==1?1:-1)),c.b0(Y,Y,c.a$([],O,(X>>2&1)==1?1:-1)),V.push(Y)}return new dc(V,[[...T,-c.b5(T,V[0])],[...A,-c.b5(A,V[0])],[...O,-c.b5(O,V[0])],[-T[0],-T[1],-T[2],-c.b5(T,V[7])],[-A[0],-A[1],-A[2],-c.b5(A,V[7])],[-O[0],-O[1],-O[2],-c.b5(O,V[7])]],R,B)}intersectsFrustum(n){let u=!0;const d=this.points.length,v=this.planes.length,T=n.planes.length,A=n.points.length;for(let O=0;O<T;O++){const R=n.planes[O];let B=0;for(let V=0;V<d;V++){const X=this.points[V];R[0]*X[0]+R[1]*X[1]+R[2]*X[2]+R[3]>=0&&B++}if(B===0)return 0;B<d&&(u=!1)}if(u)return 2;for(let O=0;O<v;O++){const R=this.planes[O];let B=0;for(let V=0;V<A;V++){const X=n.points[V];R[0]*X[0]+R[1]*X[1]+R[2]*X[2]+R[3]>=0&&B++}if(B===0)return 0}return 1}intersectsPlane(n){const u=this.points.length;let d=0;for(let v=0;v<u;v++){const T=this.points[v];n[0]*T[0]+n[1]*T[1]+n[2]*T[2]+n[3]>=0&&d++}return d===u?2:d===0?0:1}}function yu(w,n,u){const d=w-n;return d<0?-d:Math.max(0,d-u)}function mh(w,n,u,d,v){const T=w-u;let A;return A=T<0?Math.min(-T,1+T-v):T>1?Math.min(Math.max(T-v,0),1-T):0,Math.max(A,yu(n,d,v))}class If{constructor(){this._boundingVolumeCache=new ty(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,u,d,v){const T=1<<d.z,A=1/T,O=d.x/T,R=d.y/T;let B=2;return B=Math.min(B,mh(n,u,O,R,A)),B=Math.min(B,mh(n,u,O+.5,-R-A,A)),B=Math.min(B,mh(n,u,O+.5,2-R-A,A)),B}getWrap(n,u,d){const v=1<<u.z,T=1/v,A=u.x/v,O=yu(n.x,A,T),R=yu(n.x,A-1,T),B=yu(n.x,A+1,T),V=Math.min(O,R,B);return V===B?1:V===R?-1:0}allowVariableZoom(n,u){return Bn(n,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,u,d,v){return this._boundingVolumeCache.getTileBoundingVolume(n,u,d,v)}_computeTileBoundingVolume(n,u,d,v){var T,A;let O=0,R=0;if(v?.terrain){const B=new c.a2(n.z,u,n.z,n.x,n.y),V=v.terrain.getMinMaxElevation(B);O=(T=V.minElevation)!==null&&T!==void 0?T:Math.min(0,d),R=(A=V.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}if(O/=c.bE,R/=c.bE,O+=1,R+=1,n.z<=0)return dc.fromAabb([-R,-R,-R],[R,R,R]);if(n.z===1)return dc.fromAabb([n.x===0?-R:0,n.y===0?0:-R,-R],[n.x===0?0:R,n.y===0?R:0,R]);{const B=[Wi(0,0,n.x,n.y,n.z),Wi(c.a5,0,n.x,n.y,n.z),Wi(c.a5,c.a5,n.x,n.y,n.z),Wi(0,c.a5,n.x,n.y,n.z)],V=[];for(const He of B)V.push(c.a$([],He,R));if(R!==O)for(const He of B)V.push(c.a$([],He,O));n.y===0&&V.push([0,1,0]),n.y===(1<<n.z)-1&&V.push([0,-1,0]);const X=[1,1,1],Y=[-1,-1,-1];for(const He of V)for(let Je=0;Je<3;Je++)X[Je]=Math.min(X[Je],He[Je]),Y[Je]=Math.max(Y[Je],He[Je]);const re=Wi(c.a5/2,c.a5/2,n.x,n.y,n.z),oe=c.b4([],[0,1,0],re);c.b3(oe,oe);const he=c.b4([],re,oe);c.b3(he,he);const pe=c.b4([],B[2],B[1]);c.b3(pe,pe);const de=c.b4([],B[0],B[3]);c.b3(de,de),V.push(c.a$([],re,R)),n.y>=(1<<n.z)/2&&V.push(c.a$([],Wi(c.a5/2,0,n.x,n.y,n.z),R)),n.y<(1<<n.z)/2&&V.push(c.a$([],Wi(c.a5/2,c.a5,n.x,n.y,n.z),R));const xe=zf(re,V),Ee=zf(he,V),ve=[-re[0],-re[1],-re[2],xe.max],Pe=[re[0],re[1],re[2],-xe.min],De=[-he[0],-he[1],-he[2],Ee.max],we=[he[0],he[1],he[2],-Ee.min],Re=[...pe,0],Qe=[...de,0],Ye=[];return n.y===0?Ye.push(c.bD(Qe,Re,ve),c.bD(Qe,Re,Pe)):Ye.push(c.bD(De,Re,ve),c.bD(De,Re,Pe),c.bD(De,Qe,ve),c.bD(De,Qe,Pe)),n.y===(1<<n.z)-1?Ye.push(c.bD(Qe,Re,ve),c.bD(Qe,Re,Pe)):Ye.push(c.bD(we,Re,ve),c.bD(we,Re,Pe),c.bD(we,Qe,ve),c.bD(we,Qe,Pe)),new dc(Ye,[ve,Pe,De,we,Re,Qe],X,Y)}}}function zf(w,n){let u=1/0,d=-1/0;for(const v of n){const T=c.b5(w,v);u=Math.min(u,T),d=Math.max(d,T)}return{min:u,max:d}}class pc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,d){return this._helper.interpolatePadding(n,u,d)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u){this._helper.resize(n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(n){this._cachedClippingPlane=c.bF(),this._projectionMatrix=c.bj(),this._globeViewProjMatrix32f=c.bi(),this._globeViewProjMatrixNoCorrection=c.bj(),this._globeViewProjMatrixNoCorrectionInverted=c.bj(),this._globeProjMatrixInverted=c.bj(),this._cameraPosition=c.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(u,d)=>{const v=c.an(u.lat,-c.ao,c.ao),T=c.an(+d,this.minZoom+ji(0,v),this.maxZoom);return{center:new c.V(u.lng,v),zoom:T}},this.applyConstrain=(u,d)=>this._helper.applyConstrain(u,d),this._helper=new gi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,d)=>this.defaultConstrain(u,d)},n),this._coveringTilesDetailsProvider=new If}clone(){const n=new pc;return n.apply(this,!1),n}apply(n,u,d){this._globeLatitudeErrorCorrectionRadians=d||0,this._helper.apply(n,u)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=c.bA();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:u,applyGlobeMatrix:d}=n,v=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const u=this.pitchInRadians,d=this.cameraToCenterDistance/n,v=Math.sin(u)*d,T=Math.cos(u)*d+1,A=1/Math.sqrt(v*v+T*T)*1;let O=-v,R=T;const B=Math.sqrt(O*O+R*R);O/=B,R/=B;const V=[0,O,R];c.bG(V,V,[0,0,0],-this.bearingInRadians),c.bH(V,V,[0,0,0],-1*this.center.lat*Math.PI/180),c.bI(V,V,[0,0,0],this.center.lng*Math.PI/180);const X=1/c.b7(V);return c.a$(V,V,X),[...V,-A*X]}isLocationOccluded(n){return!this.isSurfacePointVisible(Mi(n))}transformLightDirection(n){const u=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,v=Math.cos(d),T=[Math.sin(u)*v,Math.sin(d),Math.cos(u)*v],A=[T[2],0,-T[0]],O=[0,0,0];c.b4(O,A,T),c.b3(A,A),c.b3(O,O);const R=[0,0,0];return c.b3(R,[A[0]*n[0]+O[0]*n[1]+T[0]*n[2],A[1]*n[0]+O[1]*n[1]+T[1]*n[2],A[2]*n[0]+O[2]*n[1]+T[2]*n[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,u,d){const v=(function(O,R,B){const V=1/(1<<B.z);return new c.a9(O/c.a5*V+B.x*V,R/c.a5*V+B.y*V)})(n,u,d.canonical),T=(A=v.y,[c.bz(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI]);var A;return this.getCircleRadiusCorrection()/Math.cos(T[1])}projectTileCoordinates(n,u,d,v){const T=d.canonical,A=Wi(n,u,T.x,T.y,T.z),O=1+(v?v(n,u):0)/c.bE,R=[A[0]*O,A[1]*O,A[2]*O,1];c.aH(R,R,this._globeViewProjMatrixNoCorrection);const B=this._cachedClippingPlane,V=B[0]*A[0]+B[1]*A[1]+B[2]*A[2]+B[3]<0;return{point:new c.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:V}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=gu(this.worldSize,this.center.lat),u=c.bk(),d=c.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),c.be(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;u[8]=2*-v.x/this._helper._width,u[9]=2*v.y/this._helper._height,this._projectionMatrix=c.bf(u),this._globeProjMatrixInverted=c.bk(),c.aB(this._globeProjMatrixInverted,u),c.O(u,u,[0,0,-this.cameraToCenterDistance]),c.bg(u,u,this.rollInRadians),c.bh(u,u,-this.pitchInRadians),c.bg(u,u,this.bearingInRadians),c.O(u,u,[0,0,-n]);const T=c.bA();T[0]=n,T[1]=n,T[2]=n,c.bh(d,u,this.center.lat*Math.PI/180),c.bJ(d,d,-this.center.lng*Math.PI/180),c.Q(d,d,T),this._globeViewProjMatrixNoCorrection=d,c.bh(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bJ(u,u,-this.center.lng*Math.PI/180),c.Q(u,u,T),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=c.bk(),c.aB(this._globeViewProjMatrixNoCorrectionInverted,d);const A=c.bA();this._cameraPosition=c.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/n,c.bG(this._cameraPosition,this._cameraPosition,A,-this.rollInRadians),c.bH(this._cameraPosition,this._cameraPosition,A,this.pitchInRadians),c.bG(this._cameraPosition,this._cameraPosition,A,-this.bearingInRadians),c.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bH(this._cameraPosition,this._cameraPosition,A,-this.center.lat*Math.PI/180),c.bI(this._cameraPosition,this._cameraPosition,A,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const O=c.bf(this._globeViewProjMatrixNoCorrectionInverted);c.Q(O,O,[1,1,-1]),this._cachedFrustum=Jr.fromInvProjectionMatrix(O,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){c.w("calculateFogMatrix is not supported on globe projection.");const u=c.bk();return c.ar(u),u}getVisibleUnwrappedCoordinates(n){return[new c.bc(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=Mi(n);c.a$(d,d,1+u/c.bE);const v=c.bF();return c.aH(v,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(n){}getBounds(){const n=.5*this.width,u=.5*this.height,d=[new c.P(0,0),new c.P(n,0),new c.P(this.width,0),new c.P(this.width,u),new c.P(this.width,this.height),new c.P(n,this.height),new c.P(0,this.height),new c.P(0,u)],v=[];for(const X of d)v.push(this.unprojectScreenPoint(X));let T=0,A=0,O=0,R=0;const B=this.center;for(const X of v){const Y=c.bK(B.lng,X.lng),re=c.bK(B.lat,X.lat);Y<A&&(A=Y),Y>T&&(T=Y),re<R&&(R=re),re>O&&(O=re)}const V=[B.lng+A,B.lat+R,B.lng+T,B.lat+O];return this.isSurfacePointOnScreen([0,1,0])&&(V[3]=90,V[0]=-180,V[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(V[1]=-90,V[0]=-180,V[2]=180),new Tr(V)}calculateCenterFromCameraLngLatAlt(n,u,d,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,d,v)}setLocationAtPoint(n,u){const d=Mi(this.unprojectScreenPoint(u)),v=Mi(n),T=c.bA();c.bL(T);const A=c.bA();c.bI(A,d,T,-this.center.lng*Math.PI/180),c.bH(A,A,T,this.center.lat*Math.PI/180);const O=v[0]*v[0]+v[2]*v[2],R=A[0]*A[0];if(O<R)return;const B=Math.sqrt(O-R),V=-B,X=c.bM(v[0],v[2],A[0],B),Y=c.bM(v[0],v[2],A[0],V),re=c.bA();c.bI(re,v,T,-X);const oe=c.bM(re[1],re[2],A[1],A[2]),he=c.bA();c.bI(he,v,T,-Y);const pe=c.bM(he[1],he[2],A[1],A[2]),de=.5*Math.PI,xe=oe>=-de&&oe<=de,Ee=pe>=-de&&pe<=de;let ve,Pe;if(xe&&Ee){const Qe=this.center.lng*Math.PI/180,Ye=this.center.lat*Math.PI/180;c.bN(X,Qe)+c.bN(oe,Ye)<c.bN(Y,Qe)+c.bN(pe,Ye)?(ve=X,Pe=oe):(ve=Y,Pe=pe)}else if(xe)ve=X,Pe=oe;else{if(!Ee)return;ve=Y,Pe=pe}const De=ve/Math.PI*180,we=Pe/Math.PI*180,Re=this.center.lat;this.setCenter(new c.V(De,c.an(we,-90,90))),this.setZoom(this.zoom+ji(Re,this.center.lat))}locationToScreenPoint(n,u){const d=Mi(n);if(u){const v=u.getElevationForLngLatZoom(n,this._helper._tileZoom);c.a$(d,d,1+v/c.bE)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(n){const u=c.bF();return c.aH(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new c.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,u){if(u){const d=u.pointCoordinate(n);if(d)return d}return c.a9.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,u){var d;return(d=this.screenPointToMercatorCoordinate(n,u))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(n,u){const d=this._cameraPosition,v=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(d,v)}getRayDirectionFromPixel(n){const u=c.bF();u[0]=n.x/this.width*2-1,u[1]=-1*(n.y/this.height*2-1),u[2]=1,u[3]=1,c.aH(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const d=c.bA();d[0]=u[0]-this._cameraPosition[0],d[1]=u[1]-this._cameraPosition[1],d[2]=u[2]-this._cameraPosition[2];const v=c.bA();return c.b3(v,d),v}isSurfacePointVisible(n){const u=this._cachedClippingPlane;return u[0]*n[0]+u[1]*n[1]+u[2]*n[2]+u[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const u=c.bF();return c.aH(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(n,u){const d=c.b5(n,u),v=c.bA(),T=c.bA();c.a$(T,u,d),c.b2(v,n,T);const A=1-c.b5(v,v);if(A<0)return null;const O=c.b5(n,n)-1,R=-d+(d<0?1:-1)*Math.sqrt(A),B=O/R,V=R;return{tMin:Math.min(B,V),tMax:Math.max(B,V)}}unprojectScreenPoint(n){const u=this._cameraPosition,d=this.getRayDirectionFromPixel(n),v=this.rayPlanetIntersection(u,d);if(v){const V=c.bA();c.b0(V,u,[d[0]*v.tMin,d[1]*v.tMin,d[2]*v.tMin]);const X=c.bA();return c.b3(X,V),Hd(X)}const T=this._cachedClippingPlane,A=T[0]*d[0]+T[1]*d[1]+T[2]*d[2],O=-c.bb(T,u)/A,R=c.bA();if(O>0)c.b0(R,u,[d[0]*O,d[1]*O,d[2]*O]);else{const V=c.bA();c.b0(V,u,[2*d[0],2*d[1],2*d[2]]);const X=c.bb(this._cachedClippingPlane,V);c.b2(R,V,[this._cachedClippingPlane[0]*X,this._cachedClippingPlane[1]*X,this._cachedClippingPlane[2]*X])}const B=(function(V){const X=c.bA();return X[0]=V[0]*-V[3],X[1]=V[1]*-V[3],X[2]=V[2]*-V[3],{center:X,radius:Math.sqrt(1-V[3]*V[3])}})(T);return Hd((function(V,X,Y){const re=c.bA();c.b2(re,Y,V);const oe=c.bA();return c.by(oe,V,re,X/c.b9(re)),oe})(B.center,B.radius,R))}getMatrixForModel(n,u){const d=c.V.convert(n),v=1/c.bE,T=c.bj();return c.bJ(T,T,d.lng/180*Math.PI),c.bh(T,T,-d.lat/180*Math.PI),c.O(T,T,[0,0,1+u/c.bE]),c.bh(T,T,.5*Math.PI),c.Q(T,T,[v,v,v]),T}getProjectionDataForCustomLayer(n=!0){const u=this.getProjectionData({overscaledTileID:new c.a2(0,0,0,0,0),applyGlobeMatrix:n});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(n){}}class xa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,d){return this._helper.interpolatePadding(n,u,d)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,d=!0){this._helper.resize(n,u,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,u){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(n){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(u,d)=>this.currentTransform.defaultConstrain(u,d),this.applyConstrain=(u,d)=>this._helper.applyConstrain(u,d),this._helper=new gi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,d)=>this.defaultConstrain(u,d)},n),this._globeness=1,this._mercatorTransform=new kr,this._verticalPerspectiveTransform=new pc}clone(){const n=new xa;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this,!1),n}apply(n,u){this._helper.apply(n,u),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const u=this._mercatorTransform.getProjectionData(n),d=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:u.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return c.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,u,d){const v=this._mercatorTransform.getPitchedTextCorrection(n,u,d),T=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,u,d);return c.bu(v,T,this._globeness)}projectTileCoordinates(n,u,d,v){return this.currentTransform.projectTileCoordinates(n,u,d,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){return this.currentTransform.lngLatToCameraDepth(n,u)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(n,u,d,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,d,v)}setLocationAtPoint(n,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,u),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(n,u),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(n,u){return this.currentTransform.locationToScreenPoint(n,u)}screenPointToMercatorCoordinate(n,u){return this.currentTransform.screenPointToMercatorCoordinate(n,u)}screenPointToLocation(n,u){return this.currentTransform.screenPointToLocation(n,u)}isPointOnMapSurface(n,u){return this.currentTransform.isPointOnMapSurface(n,u)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,u){return this.currentTransform.getMatrixForModel(n,u)}getProjectionDataForCustomLayer(n=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return u;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return d.fallbackMatrix=u.mainMatrix,d}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class ba{get useGlobeControls(){return!0}handlePanInertia(n,u){const d=Wd(n,u);return Math.abs(d.lng-u.center.lng)>180&&(d.lng=u.center.lng+179.5*Math.sign(d.lng-u.center.lng)),{easingCenter:d,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,u){const d=n.around,v=u.screenPointToLocation(d);n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta);const T=u.zoom;n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta);const A=u.zoom-T;if(A===0)return;const O=c.bK(u.center.lng,v.lng),R=O/(Math.abs(O/180)+1),B=c.bK(u.center.lat,v.lat),V=u.getRayDirectionFromPixel(d),X=u.cameraPosition,Y=-1*c.b5(X,V),re=c.bA();c.b0(re,X,[V[0]*Y,V[1]*Y,V[2]*Y]);const oe=c.b7(re)-1,he=Math.exp(.5*-Math.max(oe-.3,0)),pe=gu(u.worldSize,u.center.lat)/Math.min(u.width,u.height),de=c.bx(pe,.9,.5,1,.25),xe=(1-c.aq(-A))*Math.min(he,de),Ee=u.center.lat,ve=u.zoom,Pe=new c.V(u.center.lng+R*xe,c.an(u.center.lat+B*xe,-c.ao,c.ao));u.setLocationAtPoint(v,d);const De=u.center,we=c.bx(Math.abs(O),45,85,0,1),Re=c.bx(pe,.75,.35,0,1),Qe=Math.pow(Math.max(we,Re),.25),Ye=c.bK(De.lng,Pe.lng),He=c.bK(De.lat,Pe.lat);u.setCenter(new c.V(De.lng+Ye*Qe,De.lat+He*Qe).wrap()),u.setZoom(ve+ji(Ee,u.center.lat))}handleMapControlsPan(n,u,d){if(!n.panDelta)return;const v=u.center.lat,T=u.zoom;u.setCenter(Wd(n.panDelta,u).wrap()),u.setZoom(T+ji(v,u.center.lat))}cameraForBoxAndBearing(n,u,d,v,T){const A=dh(n,u,d,v,T),O=u.left/T.width*2-1,R=(T.width-u.right)/T.width*2-1,B=u.top/T.height*-2+1,V=(T.height-u.bottom)/T.height*-2+1,X=c.bK(d.getWest(),d.getEast())<0,Y=X?d.getEast():d.getWest(),re=X?d.getWest():d.getEast(),oe=Math.max(d.getNorth(),d.getSouth()),he=Math.min(d.getNorth(),d.getSouth()),pe=Y+.5*c.bK(Y,re),de=oe+.5*c.bK(oe,he),xe=T.clone();xe.setCenter(A.center),xe.setBearing(A.bearing),xe.setPitch(0),xe.setRoll(0),xe.setZoom(A.zoom);const Ee=xe.modelViewProjectionMatrix,ve=[Mi(d.getNorthWest()),Mi(d.getNorthEast()),Mi(d.getSouthWest()),Mi(d.getSouthEast()),Mi(new c.V(re,de)),Mi(new c.V(Y,de)),Mi(new c.V(pe,oe)),Mi(new c.V(pe,he))],Pe=Mi(A.center);let De=Number.POSITIVE_INFINITY;for(const we of ve)O<0&&(De=ba.getLesserNonNegativeNonNull(De,ba.solveVectorScale(we,Pe,Ee,"x",O))),R>0&&(De=ba.getLesserNonNegativeNonNull(De,ba.solveVectorScale(we,Pe,Ee,"x",R))),B>0&&(De=ba.getLesserNonNegativeNonNull(De,ba.solveVectorScale(we,Pe,Ee,"y",B))),V<0&&(De=ba.getLesserNonNegativeNonNull(De,ba.solveVectorScale(we,Pe,Ee,"y",V)));if(Number.isFinite(De)&&De!==0)return A.zoom=xe.zoom+c.at(De),A;Ri()}handleJumpToCenterZoom(n,u){const d=n.center.lat,v=n.applyConstrain(u.center?c.V.convert(u.center):n.center,n.zoom).center;n.setCenter(v.wrap());const T=u.zoom!==void 0?+u.zoom:n.zoom+ji(d,v.lat);n.zoom!==T&&n.setZoom(T)}handleEaseTo(n,u){const d=n.zoom,v=n.center,T=n.padding,A={roll:n.roll,pitch:n.pitch,bearing:n.bearing},O={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},R=u.zoom!==void 0,B=!n.isPaddingEqual(u.padding);let V=!1;const X=u.center?c.V.convert(u.center):v,Y=n.applyConstrain(X,d).center;Zr(n,Y);const re=n.clone();re.setCenter(Y),re.setZoom(R?+u.zoom:d+ji(v.lat,X.lat)),re.setBearing(u.bearing);const oe=new c.P(c.an(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),c.an(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));re.setLocationAtPoint(Y,oe);const he=(u.offset&&u.offsetAsPoint.mag())>0?re.center:Y,pe=R?+u.zoom:d+ji(v.lat,he.lat),de=d+ji(v.lat,0),xe=pe+ji(he.lat,0),Ee=c.bK(v.lng,he.lng),ve=c.bK(v.lat,he.lat),Pe=c.aq(xe-de);return V=pe!==d,{easeFunc:De=>{if(c.bo(A,O)||Es({startEulerAngles:A,endEulerAngles:O,tr:n,k:De,useSlerp:A.roll!=O.roll}),B&&n.interpolatePadding(T,u.padding,De),u.around)c.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(u.around,u.aroundPoint);else{const we=xe>de?Math.min(2,Pe):Math.max(.5,Pe),Re=Math.pow(we,1-De),Qe=hm(v,Ee,ve,De*Re);n.setCenter(Qe.wrap())}if(V){const we=c.G.number(de,xe,De)+ji(0,n.center.lat);n.setZoom(we)}},isZooming:V,elevationCenter:he}}handleFlyTo(n,u){const d=u.zoom!==void 0,v=n.center,T=n.zoom,A=n.padding,O=!n.isPaddingEqual(u.padding),R=n.applyConstrain(c.V.convert(u.center||u.locationAtOffset),T).center,B=d?+u.zoom:n.zoom+ji(n.center.lat,R.lat),V=n.clone();V.setCenter(R),V.setZoom(B),V.setBearing(u.bearing);const X=new c.P(c.an(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),c.an(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));V.setLocationAtPoint(R,X);const Y=V.center;Zr(n,Y);const re=(function(ve,Pe,De){const we=Mi(Pe),Re=Mi(De),Qe=c.b5(we,Re),Ye=Math.acos(Qe),He=Of(ve);return Ye/(2*Math.PI)*He})(n,v,Y),oe=T+ji(v.lat,0),he=B+ji(Y.lat,0),pe=c.aq(he-oe);let de;if(typeof u.minZoom=="number"){const ve=+u.minZoom+ji(Y.lat,0),Pe=Math.min(ve,oe,he)+ji(0,Y.lat),De=n.applyConstrain(Y,Pe).zoom+ji(Y.lat,0);de=c.aq(De-oe)}const xe=c.bK(v.lng,Y.lng),Ee=c.bK(v.lat,Y.lat);return{easeFunc:(ve,Pe,De,we)=>{const Re=hm(v,xe,Ee,De);O&&n.interpolatePadding(A,u.padding,ve);const Qe=ve===1?Y:Re;n.setCenter(Qe.wrap());const Ye=oe+c.at(Pe);n.setZoom(ve===1?B:Ye+ji(0,Qe.lat))},scaleOfZoom:pe,targetCenter:Y,scaleOfMinZoom:de,pixelPathLength:re}}static solveVectorScale(n,u,d,v,T){const A=v==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],O=[d[3],d[7],d[11],d[15]],R=n[0]*A[0]+n[1]*A[1]+n[2]*A[2],B=n[0]*O[0]+n[1]*O[1]+n[2]*O[2],V=u[0]*A[0]+u[1]*A[1]+u[2]*A[2],X=u[0]*O[0]+u[1]*O[1]+u[2]*O[2];return V+T*B===R+T*X||O[3]*(R-V)+A[3]*(X-B)+R*X==V*B?null:(V+A[3]-T*X-T*O[3])/(V-R-T*X+T*B)}static getLesserNonNegativeNonNull(n,u){return u!==null&&u>=0&&u<n?u:n}}class kf{constructor(n){this._globe=n,this._mercatorCameraHelper=new Ys,this._verticalPerspectiveCameraHelper=new ba}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,u){return this.currentHelper.handlePanInertia(n,u)}handleMapControlsRollPitchBearingZoom(n,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,u)}handleMapControlsPan(n,u,d){this.currentHelper.handleMapControlsPan(n,u,d)}cameraForBoxAndBearing(n,u,d,v,T){return this.currentHelper.cameraForBoxAndBearing(n,u,d,v,T)}handleJumpToCenterZoom(n,u){this.currentHelper.handleJumpToCenterZoom(n,u)}handleEaseTo(n,u){return this.currentHelper.handleEaseTo(n,u)}handleFlyTo(n,u){return this.currentHelper.handleFlyTo(n,u)}}const Qs=(w,n)=>c.B(w,n&&n.filter((u=>u.identifier!=="source.canvas"))),mc=c.bO();class Rf extends c.E{constructor(n,u={}){var d,v;super(),this._rtlPluginLoaded=()=>{for(const A in this.tileManagers){const O=this.tileManagers[A].getSource().type;O!=="vector"&&O!=="geojson"||this.tileManagers[A].reload()}},this.map=n,this.dispatcher=new tr(ft(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",((A,O)=>this.getGlyphs(A,O))),this.dispatcher.registerMessageHandler("GI",((A,O)=>this.getImages(A,O))),this.dispatcher.registerMessageHandler("GDA",((A,O)=>this.getDashes(A,O))),this.imageManager=new Ge,this.imageManager.setEventedParent(this);const T=((d=n._container)===null||d===void 0?void 0:d.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new at(n._requestManager,u.localIdeographFontFamily,T),this.lineAtlas=new Be(256,512),this.crossTileSymbolIndex=new on,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",c.bP()),ae().on(je,this._rtlPluginLoaded),this.on("data",(A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const O=this.tileManagers[A.sourceId];if(!O)return;const R=O.getSource();if(R&&R.vectorLayerIds)for(const B in this._layers){const V=this._layers[B];V.source===R.id&&this._validateLayer(V)}}))}_setInitialValues(){var n;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new c.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((n=this.crossTileSymbolIndex)===null||n===void 0?void 0:n.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(n,u){var d,v,T;this._checkLoaded();const A=u===null?(T=(v=(d=this.stylesheet.state)===null||d===void 0?void 0:d[n])===null||v===void 0?void 0:v.default)!==null&&T!==void 0?T:null:u;if(c.bR(A,this._globalState[n]))return this;this._globalState[n]=A,this._applyGlobalStateChanges([n])}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const u=[];for(const d in n)!c.bR(this._globalState[d],n[d].default)&&(u.push(d),this._globalState[d]=n[d].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(n){if(n.length===0)return;const u=new Set,d={};for(const v of n){d[v]=this._globalState[v];for(const T in this._layers){const A=this._layers[T],O=A.getLayoutAffectingGlobalStateRefs(),R=A.getPaintAffectingGlobalStateRefs(),B=A.getVisibilityAffectingGlobalStateRefs();if(O.has(v)&&u.add(A.source),R.has(v))for(const{name:V,value:X}of R.get(v))this._updatePaintProperty(A,V,X);B?.has(v)&&(A.recalculateVisibility(),this._updateLayer(A))}}this.dispatcher.broadcast("UGS",d);for(const v in this.tileManagers)u.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(n,u={},d){this.fire(new c.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const v=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;c.j(v,this._loadStyleRequest).then((A=>{this._loadStyleRequest=null,this._load(A.data,u,d)})).catch((A=>{this._loadStyleRequest=null,A&&!T.signal.aborted&&this.fire(new c.k(A))}))}loadJSON(n,u={},d){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,G.frameAsync(this._frameRequest,this.map._ownerWindow).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,d)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(mc,{validate:!1})}_load(n,u,d){var v,T;let A=u.transformStyle?u.transformStyle(d,n):n;if(!u.validate||!Qs(this,c.C(A))){A=Object.assign({},A),this._loaded=!0,this.stylesheet=A;for(const O in A.sources)this.addSource(O,A.sources[O],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new Ut(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new nt(this.stylesheet.sky),this.map.setTerrain((T=this.stylesheet.terrain)!==null&&T!==void 0?T:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var n,u,d;const v=c.bS(this.stylesheet.layers);this.setGlobalState((n=this.stylesheet.state)!==null&&n!==void 0?n:null),this.dispatcher.broadcast("SL",v),this._order=v.map((T=>T.id)),this._layers={},this._serializedLayers=null;for(const T of v){const A=c.bT(T,this._globalState);if(A.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=A,c.bU(A)&&this.tileManagers[A.source]){const O=(d=(u=T.paint)===null||u===void 0?void 0:u["raster-fade-duration"])!==null&&d!==void 0?d:A.paint.get("raster-fade-duration");this.tileManagers[A.source].setRasterFadeDuration(O)}}}_loadSprite(n,u=!1,d=void 0){this.imageManager.setLoaded(!1);const v=new AbortController;let T;this._spriteRequest=v,(function(A,O,R,B){return c._(this,void 0,void 0,(function*(){const V=gt(A),X=R>1?"@2x":"",Y={},re={};for(const{id:oe,url:he}of V){const pe=O.transformRequest(yt(he,X,".json"),"SpriteJSON");Y[oe]=c.j(pe,B);const de=O.transformRequest(yt(he,X,".png"),"SpriteImage");re[oe]=Oe.getImage(de,B)}return yield Promise.all([...Object.values(Y),...Object.values(re)]),(function(oe,he){return c._(this,void 0,void 0,(function*(){const pe={};for(const de in oe){pe[de]={};const xe=G.getImageCanvasContext((yield he[de]).data),Ee=(yield oe[de]).data;for(const ve in Ee){const{width:Pe,height:De,x:we,y:Re,sdf:Qe,pixelRatio:Ye,stretchX:He,stretchY:Je,content:Ct,textFitWidth:Dt,textFitHeight:ut}=Ee[ve];pe[de][ve]={data:null,pixelRatio:Ye,sdf:Qe,stretchX:He,stretchY:Je,content:Ct,textFitWidth:Dt,textFitHeight:ut,spriteData:{width:Pe,height:De,x:we,y:Re,context:xe}}}}return pe}))})(Y,re)}))})(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((A=>{if(this._spriteRequest=null,A)for(const O in A){this._spritesImagesIds[O]=[];const R=this._spritesImagesIds[O]?this._spritesImagesIds[O].filter((B=>!(B in A))):[];for(const B of R)this.imageManager.removeImage(B),this._changedImages[B]=!0;for(const B in A[O]){const V=O==="default"?B:`${O}:${B}`;this._spritesImagesIds[O].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,A[O][B],!1):this.imageManager.addImage(V,A[O][B]),u&&(this._changedImages[V]=!0)}}})).catch((A=>{this._spriteRequest=null,T=A,v.signal.aborted||this.fire(new c.k(T))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),d&&d(T)}))}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(n){const u=this.tileManagers[n.source];if(!u)return;const d=n.sourceLayer;if(!d)return;const v=u.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.k(new Error(`Source layer "${d}" does not exist on source "${v.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.tileManagers)if(!this.tileManagers[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,u=!1){const d=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u?c.bV(d):d);const v=[];for(const T of n)if(d[T]){const A=u?c.bV(d[T]):d[T];v.push(A)}return v}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const d of u){const v=this._layers[d];v.type!=="custom"&&(n[d]=v.serialize())}return n}hasTransitions(){var n,u,d;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const v in this.tileManagers)if(this.tileManagers[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const v=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(v.length||T.length)&&this._updateWorkerLayers(v,T);for(const A in this._updatedSources){const O=this._updatedSources[A];if(O==="reload")this._reloadSource(A);else{if(O!=="clear")throw new Error(`Invalid action ${O}`);this._clearSource(A)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const d={};for(const v in this.tileManagers){const T=this.tileManagers[v];d[v]=T.used,T.used=!1}for(const v of this._order){const T=this._layers[v];T.recalculate(n,this._availableImages),!T.isHidden(n.zoom)&&T.source&&(this.tileManagers[T.source].used=!0)}for(const v in d){const T=this.tileManagers[v];!!d[v]!=!!T.used&&T.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,u&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.tileManagers)this.tileManagers[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.tileManagers)this.tileManagers[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var d;this._checkLoaded();const v=this.serialize();if(n=u.transformStyle?u.transformStyle(v,n):n,((d=u.validate)===null||d===void 0||d)&&Qs(this,c.C(n)))return!1;(n=c.bV(n)).layers=c.bS(n.layers);const T=c.bW(v,n),A=this._getOperationsToPerform(T);if(A.unimplemented.length>0)throw new Error(`Unimplemented: ${A.unimplemented.join(", ")}.`);if(A.operations.length===0)return!1;for(const O of A.operations)O();return this.stylesheet=n,this._serializedLayers=null,this.fire(new c.l("style.load",{style:this})),!0}_getOperationsToPerform(n){const u=[],d=[];for(const v of n)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,v.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,v.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,v.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,v.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,v.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,v.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,v.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,v.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,v.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,v.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,v.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,v.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,v.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,v.args)));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,v.args)));break;case"setTransition":u.push((()=>{}));break;default:d.push(v.command)}return{operations:u,unimplemented:d}}addImage(n,u){if(this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,d={}){if(this._checkLoaded(),this.tileManagers[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(c.C.source,`sources.${n}`,u,null,d))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const v=this.tileManagers[n]=new xt(n,u,this.dispatcher);v.style=this,v.setEventedParent(this,(()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:n}))),v.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.tileManagers[n]===void 0)throw new Error(`There is no source with this ID=${n}`);for(const d in this._layers)if(this._layers[d].source===n)return this.fire(new c.k(new Error(`Source "${n}" cannot be removed while layer "${d}" is using it.`)));const u=this.tileManagers[n];delete this.tileManagers[n],delete this._updatedSources[n],u.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.tileManagers[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const d=this.tileManagers[n].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(u),this._changed=!0}getSource(n){return this.tileManagers[n]&&this.tileManagers[n].getSource()}addLayer(n,u,d={}){this._checkLoaded();const v=n.id;if(this.getLayer(v))return void this.fire(new c.k(new Error(`Layer "${v}" already exists on this map.`)));let T;if(n.type==="custom"){if(Qs(this,c.bX(n)))return;T=c.bT(n,this._globalState)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(v,n.source),n=c.bV(n),n=c.e(n,{source:v})),this._validate(c.C.layer,`layers.${v}`,n,{arrayIndex:-1},d))return;T=c.bT(n,this._globalState),this._validateLayer(T),T.setEventedParent(this,{layer:{id:v}})}const A=u?this._order.indexOf(u):this._order.length;if(u&&A===-1)this.fire(new c.k(new Error(`Cannot add layer "${v}" before non-existing layer "${u}".`)));else{if(this._order.splice(A,0,v),this._layerOrderChanged=!0,this._layers[v]=T,this._removedLayers[v]&&T.source&&T.type!=="custom"){const O=this._removedLayers[v];delete this._removedLayers[v],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.tileManagers[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const d=this._order.indexOf(n);this._order.splice(d,1);const v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new c.k(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(v,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const d=this._order.indexOf(n);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,d){this._checkLoaded();const v=this.getLayer(n);v?v.minzoom===u&&v.maxzoom===d||(u!=null&&(v.minzoom=u),d!=null&&(v.maxzoom=d),this._updateLayer(v)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,d={}){this._checkLoaded();const v=this.getLayer(n);if(v){if(!c.bR(v.filter,u))return u==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(c.C.filter,`layers.${v.id}.filter`,u,null,d)||(v.setFilter(c.bV(u)),this._updateLayer(v)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.bV(this.getLayer(n).filter)}setLayoutProperty(n,u,d,v={}){this._checkLoaded();const T=this.getLayer(n);T?c.bR(T.getLayoutProperty(u),d)||(T.setLayoutProperty(u,d,v),this._updateLayer(T)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const d=this.getLayer(n);if(d)return d.getLayoutProperty(u);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,d,v={}){this._checkLoaded();const T=this.getLayer(n);T?c.bR(T.getPaintProperty(u),d)||this._updatePaintProperty(T,u,d,v):this.fire(new c.k(new Error(`Cannot style non-existing layer "${n}".`)))}_updatePaintProperty(n,u,d,v={}){n.setPaintProperty(u,d,v)&&this._updateLayer(n),c.bU(n)&&u==="raster-fade-duration"&&this.tileManagers[n.source].setRasterFadeDuration(d),this._changed=!0,this._updatedPaintProps[n.id]=!0,this._serializedLayers=null}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const d=n.source,v=n.sourceLayer,T=this.tileManagers[d];if(T===void 0)return void this.fire(new c.k(new Error(`The source '${d}' does not exist in the map's style.`)));const A=T.getSource().type;A==="geojson"&&v?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||v?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),T.setFeatureState(v,n.id,u)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const d=n.source,v=this.tileManagers[d];if(v===void 0)return void this.fire(new c.k(new Error(`The source '${d}' does not exist in the map's style.`)));const T=v.getSource().type,A=T==="vector"?n.sourceLayer:void 0;T!=="vector"||A?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(A,n.id,u):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,d=n.sourceLayer,v=this.tileManagers[u];if(v!==void 0)return v.getSource().type!=="vector"||d?(n.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(d,n.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.bY(this.tileManagers,(T=>T.serialize())),u=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,v=this.stylesheet;return c.bZ({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:n,layers:u,terrain:d},(T=>T!==void 0))}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.tileManagers[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.tileManagers[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=A=>this._layers[A].type==="fill-extrusion",d={},v=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(u(O)){d[O]=A;for(const R of n){const B=R[O];if(B)for(const V of B)v.push(V)}}}v.sort(((A,O)=>O.intersectionZ-A.intersectionZ));const T=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(u(O))for(let R=v.length-1;R>=0;R--){const B=v[R].feature;if(d[B.layer.id]<A)break;T.push(B),v.pop()}else for(const R of n){const B=R[O];if(B)for(const V of B)T.push(V.feature)}}return T}queryRenderedFeatures(n,u,d){u&&u.filter&&this._validate(c.C.filter,"queryRenderedFeatures.filter",u.filter,null,u);const v={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const B of u.layers){const V=this._layers[B];if(!V)return this.fire(new c.k(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];v[V.source]=!0}}const T=[];u.availableImages=this._availableImages;const A=this._serializedAllLayers(),O=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,R=Object.assign(Object.assign({},u),{layers:O,globalState:this._globalState});for(const B in this.tileManagers)u.layers&&!v[B]||T.push(gn(this.tileManagers[B],this._layers,A,n,R,d,this.map.terrain?(V,X,Y)=>this.map.terrain.getElevation(V,X,Y):void 0));return this.placement&&T.push((function(B,V,X,Y,re,oe,he){const pe={},de=oe.queryRenderedSymbols(Y),xe=[];for(const Ee of Object.keys(de).map(Number))xe.push(he[Ee]);xe.sort(fr);for(const Ee of xe){const ve=Ee.featureIndex.lookupSymbolFeatures(de[Ee.bucketInstanceId],V,Ee.bucketIndex,Ee.sourceLayerIndex,{filterSpec:re.filter,globalState:re.globalState},re.layers,re.availableImages,B);for(const Pe in ve){const De=pe[Pe]=pe[Pe]||[],we=ve[Pe];we.sort(((Re,Qe)=>{const Ye=Ee.featureSortOrder;if(Ye){const He=Ye.indexOf(Re.featureIndex);return Ye.indexOf(Qe.featureIndex)-He}return Qe.featureIndex-Re.featureIndex}));for(const Re of we)De.push(Re)}}return(function(Ee,ve,Pe){for(const De in Ee)for(const we of Ee[De])Sr(we,Pe[ve[De].source]);return Ee})(pe,B,X)})(this._layers,A,this.tileManagers,n,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(n,u){u?.filter&&this._validate(c.C.filter,"querySourceFeatures.filter",u.filter,null,u);const d=this.tileManagers[n];return d?(function(v,T){const A=v.getRenderableIds().map((B=>v.getTileByID(B))),O=[],R={};for(let B=0;B<A.length;B++){const V=A[B],X=V.tileID.canonical.key;R[X]||(R[X]=!0,V.querySourceFeatures(O,T))}return O})(d,u?Object.assign(Object.assign({},u),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const d=this.light.getLight();let v=!1;for(const A in n)if(!c.bR(n[A],d[A])){v=!0;break}if(!v)return;const T={now:W(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(T)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.stylesheet.projection=n,this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,u={}){this._checkLoaded();const d=this.getSky();let v=!1;if(!n&&!d)return;if(n&&!d)v=!0;else if(!n&&d)v=!0;else for(const A in n)if(!c.bR(n[A],d[A])){v=!0;break}if(!v)return;const T={now:W(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,u),this.sky.updateTransitions(T)}_setProjectionInternal(n){const u=(function(d,v){const T={constrainOverride:v};if(Array.isArray(d)){const A=new _a({type:d});return{projection:A,transform:new xa(T),cameraHelper:new kf(A)}}switch(d){case"mercator":return{projection:new La,transform:new kr(T),cameraHelper:new Ys};case"globe":{const A=new _a({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:A,transform:new xa(T),cameraHelper:new kf(A)}}case"vertical-perspective":return{projection:new um,transform:new pc(T),cameraHelper:new ba};default:return c.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new La,transform:new kr(T),cameraHelper:new Ys}}})(n,this.map.transformConstrain);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const d in this.tileManagers)this.tileManagers[d].reload()}_validate(n,u,d,v,T={}){return(!T||T.validate!==!1)&&Qs(this,n.call(c.C,c.e({key:u,style:this.serialize(),value:d,styleSpec:c.u},v)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ae().off(je,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.tileManagers){const d=this.tileManagers[u];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.tileManagers[n].clearTiles()}_reloadSource(n){this.tileManagers[n].resume(),this.tileManagers[n].reload()}_updateSources(n){for(const u in this.tileManagers)this.tileManagers[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.tileManagers)this._reloadSource(n)}_updatePlacement(n,u,d,v,T=!1){let A=!1,O=!1;const R={};for(const B of this._order){const V=this._layers[B];if(V.type!=="symbol")continue;if(!R[V.source]){const Y=this.tileManagers[V.source];R[V.source]=Y.getRenderableIds(!0).map((re=>Y.getTileByID(re))).sort(((re,oe)=>oe.tileID.overscaledZ-re.tileID.overscaledZ||(re.tileID.isLessThan(oe.tileID)?-1:1)))}const X=this.crossTileSymbolIndex.addLayer(V,R[V.source],n.center.lng);A=A||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(W(),n.zoom))&&(this.pauseablePlacement=new Ot(n,this.map.terrain,this._order,T,u,d,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(W()),O=!0),A&&this.pauseablePlacement.placement.setStale()),O||A)for(const B of this._order){const V=this._layers[B];V.type==="symbol"&&this.placement.updateLayerOpacities(V,R[V.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(W())}_releaseSymbolFadeTiles(){for(const n in this.tileManagers)this.tileManagers[n].releaseSymbolFadeTiles()}getImages(n,u){return c._(this,void 0,void 0,(function*(){const d=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const v=this.tileManagers[u.source];return v&&v.setDependencies(u.tileID.key,u.type,u.icons),d}))}getGlyphs(n,u){return c._(this,void 0,void 0,(function*(){const d=yield this.glyphManager.getGlyphs(u.stacks),v=this.tileManagers[u.source];return v&&v.setDependencies(u.tileID.key,u.type,[""]),d}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(c.C.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}getDashes(n,u){return c._(this,void 0,void 0,(function*(){const d={};for(const[v,T]of Object.entries(u.dashes))d[v]=this.lineAtlas.getDash(T.dasharray,T.round);return d}))}addSprite(n,u,d={},v){this._checkLoaded();const T=[{id:n,url:u}],A=[...gt(this.stylesheet.sprite),...T];this._validate(c.C.sprite,"sprite",A,null,d)||(this.stylesheet.sprite=A,this._loadSprite(T,!0,v))}removeSprite(n){this._checkLoaded();const u=gt(this.stylesheet.sprite);if(u.find((d=>d.id===n))){if(this._spritesImagesIds[n])for(const d of this._spritesImagesIds[n])this.imageManager.removeImage(d),this._changedImages[d]=!0;u.splice(u.findIndex((d=>d.id===n)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return gt(this.stylesheet.sprite)}setSprite(n,u={},d){this._checkLoaded(),n&&this._validate(c.C.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,d):(this._unloadSprite(),d&&d(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const n in this.tileManagers){const u=this.tileManagers[n];u.setEventedParent(null),u.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const n in this._layers){const u=this._layers[n];u.setEventedParent(null),u.onRemove&&u.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var gh=c.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class fm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,d,v,T,A,O,R,B){this.context=n;let V=this.boundPaintVertexBuffers.length!==v.length;for(let X=0;!V&&X<v.length;X++)this.boundPaintVertexBuffers[X]!==v[X]&&(V=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==d||V||this.boundIndexBuffer!==T||this.boundVertexOffset!==A||this.boundDynamicVertexBuffer!==O||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==B?this.freshBind(u,d,v,T,A,O,R,B):(n.bindVertexArray.set(this.vao),O&&O.bind(),T&&T.dynamicDraw&&T.bind(),R&&R.bind(),B&&B.bind())}freshBind(n,u,d,v,T,A,O,R){const B=n.numAttributes,V=this.context,X=V.gl;this.vao&&this.destroy(),this.vao=V.createVertexArray(),V.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=v,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=R,u.enableAttributes(X,n);for(const Y of d)Y.enableAttributes(X,n);A&&A.enableAttributes(X,n),O&&O.enableAttributes(X,n),R&&R.enableAttributes(X,n),u.bind(),u.setVertexAttribPointers(X,n,T);for(const Y of d)Y.bind(),Y.setVertexAttribPointers(X,n,T);A&&(A.bind(),A.setVertexAttribPointers(X,n,T)),v&&v.bind(),O&&(O.bind(),O.setVertexAttribPointers(X,n,T)),R&&(R.bind(),R.setVertexAttribPointers(X,n,T)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ts=(w,n,u,d,v)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:n,u_fog_color:u?u.properties.get("fog-color"):c.bp.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:u?u.calculateFogBlendOpacity(d):0,u_horizon_color:u?u.properties.get("horizon-color"):c.bp.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),ry={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function yh(w){const n=[];for(let u=0;u<w.length;u++){if(w[u]===null)continue;const d=w[u].split(" ");n.push(d.pop())}return n}class ny{constructor(n,u,d,v,T,A,O,R,B=[]){const V=n.gl;this.program=V.createProgram();const X=yh(u.staticAttributes),Y=d?d.getBinderAttributes():[],re=X.concat(Y),oe=Lr.prelude.staticUniforms?yh(Lr.prelude.staticUniforms):[],he=O.staticUniforms?yh(O.staticUniforms):[],pe=u.staticUniforms?yh(u.staticUniforms):[],de=d?d.getBinderUniforms():[],xe=oe.concat(he).concat(pe).concat(de),Ee=[];for(const Ye of xe)Ee.indexOf(Ye)<0&&Ee.push(Ye);const ve=d?d.defines():[];Ba(V)&&ve.unshift("#version 300 es"),T&&ve.push("#define OVERDRAW_INSPECTOR;"),A&&ve.push("#define TERRAIN3D;"),R&&ve.push(R),B&&ve.push(...B);let Pe=ve.concat(Lr.prelude.fragmentSource,O.fragmentSource,u.fragmentSource).join(`
`),De=ve.concat(Lr.prelude.vertexSource,O.vertexSource,u.vertexSource).join(`
`);Ba(V)||(Pe=(function(Ye){return Ye.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Pe),De=(function(Ye){return Ye.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(De));const we=V.createShader(V.FRAGMENT_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(we,Pe),V.compileShader(we),!V.getShaderParameter(we,V.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${V.getShaderInfoLog(we)}`);V.attachShader(this.program,we);const Re=V.createShader(V.VERTEX_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Re,De),V.compileShader(Re),!V.getShaderParameter(Re,V.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${V.getShaderInfoLog(Re)}`);V.attachShader(this.program,Re),this.attributes={};const Qe={};this.numAttributes=re.length;for(let Ye=0;Ye<this.numAttributes;Ye++)re[Ye]&&(V.bindAttribLocation(this.program,Ye,re[Ye]),this.attributes[re[Ye]]=Ye);if(V.linkProgram(this.program),!V.getProgramParameter(this.program,V.LINK_STATUS))throw new Error(`Program failed to link: ${V.getProgramInfoLog(this.program)}`);V.deleteShader(Re),V.deleteShader(we);for(let Ye=0;Ye<Ee.length;Ye++){const He=Ee[Ye];if(He&&!Qe[He]){const Je=V.getUniformLocation(this.program,He);Je&&(Qe[He]=Je)}}this.fixedUniforms=v(n,Qe),this.terrainUniforms=((Ye,He)=>({u_depth:new c.b_(Ye,He.u_depth),u_terrain:new c.b_(Ye,He.u_terrain),u_terrain_dim:new c.bq(Ye,He.u_terrain_dim),u_terrain_matrix:new c.c0(Ye,He.u_terrain_matrix),u_terrain_unpack:new c.c1(Ye,He.u_terrain_unpack),u_terrain_exaggeration:new c.bq(Ye,He.u_terrain_exaggeration)}))(n,Qe),this.projectionUniforms=((Ye,He)=>({u_projection_matrix:new c.c0(Ye,He.u_projection_matrix),u_projection_tile_mercator_coords:new c.c1(Ye,He.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.c1(Ye,He.u_projection_clipping_plane),u_projection_transition:new c.bq(Ye,He.u_projection_transition),u_projection_fallback_matrix:new c.c0(Ye,He.u_projection_fallback_matrix)}))(n,Qe),this.binderUniforms=d?d.getUniforms(n,Qe):[]}draw(n,u,d,v,T,A,O,R,B,V,X,Y,re,oe,he,pe,de,xe,Ee){const ve=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(d),n.setStencilMode(v),n.setColorMode(T),n.setCullFace(A),R){n.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,R.depthTexture),n.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,R.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(R[De])}if(B)for(const De in B)this.projectionUniforms[ry[De]].set(B[De]);if(O)for(const De in this.fixedUniforms)this.fixedUniforms[De].set(O[De]);pe&&pe.setUniforms(n,this.binderUniforms,oe,{zoom:he});let Pe=0;switch(u){case ve.LINES:Pe=2;break;case ve.TRIANGLES:Pe=3;break;case ve.LINE_STRIP:Pe=1}for(const De of re.get()){const we=De.vaos||(De.vaos={});(we[V]||(we[V]=new fm)).bind(n,this,X,pe?pe.getPaintVertexBuffers():[],Y,De.vertexOffset,de,xe,Ee),ve.drawElements(u,De.primitiveLength*Pe,ve.UNSIGNED_SHORT,De.primitiveOffset*Pe*2)}}}function jf(w,n,u){const d=1/c.aN(u,1,n.transform.tileZoom),v=Math.pow(2,u.tileID.overscaledZ),T=u.tileSize*Math.pow(2,n.transform.tileZoom)/v,A=T*(u.tileID.canonical.x+u.tileID.wrap*v),O=T*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[d,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[A>>16,O>>16],u_pixel_coord_lower:[65535&A,65535&O]}}const vh=(w,n,u,d)=>{const v=w.style.light,T=v.properties.get("position"),A=[T.x,T.y,T.z],O=c.c4();v.properties.get("anchor")==="viewport"&&c.c5(O,w.transform.bearingInRadians),c.c6(A,A,O);const R=w.transform.transformLightDirection(A),B=v.properties.get("color");return{u_lightpos:A,u_lightpos_globe:R,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[B.r,B.g,B.b],u_vertical_gradient:+n,u_opacity:u,u_fill_translate:d}},gc=(w,n,u,d,v,T,A)=>c.e(vh(w,n,u,d),jf(T,w,A),{u_height_factor:-Math.pow(2,v.overscaledZ)/A.tileSize/8}),vu=(w,n,u,d)=>c.e(jf(n,w,u),{u_fill_translate:d}),dm=(w,n)=>({u_world:w,u_fill_translate:n}),_h=(w,n,u,d,v)=>c.e(vu(w,n,u,v),{u_world:d}),Dl=(w,n,u,d,v)=>{const T=w.transform;let A,O,R=0;if(u.paint.get("circle-pitch-alignment")==="map"){const B=c.aN(n,1,T.zoom);A=!0,O=[B,B],R=B/(c.a5*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*v}else A=!1,O=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+A,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:O,u_globe_extrude_scale:R,u_translate:d}},Xd=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),Lf=w=>({u_viewport_size:[w.width,w.height]}),Ol=(w,n=1)=>({u_color:w,u_overlay:0,u_overlay_scale:n}),Kd=(w,n,u,d)=>{const v=c.aN(w,1,n)/(c.a5*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:c.aN(w,1,n),u_intensity:u,u_globe_extrude_scale:v}},yc=(w,n,u,d)=>{const v=c.N();c.c7(v,0,w.width,w.height,0,0,1);const T=w.context.gl;return{u_matrix:v,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:u,u_color_ramp:d,u_opacity:n.paint.get("heatmap-opacity")}},pm=(w,n,u)=>{const d=u.paint.get("hillshade-accent-color");let v;switch(u.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const T=u.getIlluminationProperties();for(let A=0;A<T.directionRadians.length;A++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(T.directionRadians[A]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:mm(0,n.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:T.altitudeRadians,u_azimuths:T.directionRadians,u_accent:d,u_method:v,u_highlights:T.highlightColor,u_shadows:T.shadowColor}},iy=(w,n)=>{const u=n.stride,d=c.N();return c.c7(d,0,c.a5,-c.a5,0,0,1),c.O(d,d,[0,-c.a5,0]),{u_matrix:d,u_image:1,u_dimension:[u,u],u_zoom:w.overscaledZ,u_unpack:n.getUnpackVector()}};function mm(w,n){const u=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new c.a9(0,d/u).toLngLat().lat,new c.a9(0,(d+1)/u).toLngLat().lat]}const gm=(w,n,u=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:w.paint.get("color-relief-opacity")}),xh=(w,n,u,d)=>{const v=w.transform;return{u_translation:bh(w,n,u),u_ratio:d/c.aN(n,1,v.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Qd=(w,n,u,d,v)=>c.e(xh(w,n,u,d),{u_image:0,u_image_height:v}),Fa=(w,n,u,d,v)=>{const T=w.transform,A=vc(n,T);return{u_translation:bh(w,n,u),u_texsize:n.imageAtlasTexture.size,u_ratio:d/c.aN(n,1,T.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[A,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Il=(w,n,u,d,v)=>{const T=vc(n,w.transform);return c.e(xh(w,n,u,d),{u_tileratio:T,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image:0,u_mix:v.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})},As=(w,n,u,d,v,T)=>{const A=vc(n,w.transform);return c.e(xh(w,n,u,d),{u_image:0,u_image_height:T,u_tileratio:A,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image_dash:1,u_mix:v.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})};function vc(w,n){return 1/c.aN(w,1,n.tileZoom)}function bh(w,n,u){return c.aO(w.transform,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Nf=(w,n,u,d,v)=>{return{u_tl_parent:w,u_scale_parent:n,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(A=d.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(T=d.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Bf(d.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var T,A};function Bf(w){w*=Math.PI/180;const n=Math.sin(w),u=Math.cos(w);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const Ff=(w,n,u,d,v,T,A,O,R,B,V,X,Y)=>{const re=A.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:re.width/re.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_label_plane_matrix:O,u_coord_matrix:R,u_is_text:+V,u_pitch_with_map:+d,u_is_along_line:v,u_is_variable_anchor:T,u_texsize:X,u_texture:0,u_translation:B,u_pitched_scale:Y}},po=(w,n,u,d,v,T,A,O,R,B,V,X,Y,re)=>{const oe=A.transform;return c.e(Ff(w,n,u,d,v,T,A,O,R,B,V,X,re),{u_gamma_scale:d?Math.cos(oe.pitch*Math.PI/180)*oe.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:1})},wh=(w,n,u,d,v,T,A,O,R,B,V,X,Y)=>c.e(po(w,n,u,d,v,T,A,O,R,B,!0,V,0,Y),{u_texsize_icon:X,u_texture_icon:1}),Sh=(w,n)=>({u_opacity:w,u_color:n}),Jd=(w,n,u,d,v)=>c.e((function(T,A,O,R){const B=O.imageManager.getPattern(T.from.toString()),V=O.imageManager.getPattern(T.to.toString()),{width:X,height:Y}=O.imageManager.getPixelSize(),re=Math.pow(2,R.tileID.overscaledZ),oe=R.tileSize*Math.pow(2,O.transform.tileZoom)/re,he=oe*(R.tileID.canonical.x+R.tileID.wrap*re),pe=oe*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[X,Y],u_mix:A.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/c.aN(R,1,O.transform.tileZoom),u_pixel_coord_upper:[he>>16,pe>>16],u_pixel_coord_lower:[65535&he,65535&pe]}})(u,v,n,d),{u_opacity:w}),ep=(w,n)=>{},_u={fillExtrusion:(w,n)=>({u_lightpos:new c.c2(w,n.u_lightpos),u_lightpos_globe:new c.c2(w,n.u_lightpos_globe),u_lightintensity:new c.bq(w,n.u_lightintensity),u_lightcolor:new c.c2(w,n.u_lightcolor),u_vertical_gradient:new c.bq(w,n.u_vertical_gradient),u_opacity:new c.bq(w,n.u_opacity),u_fill_translate:new c.c3(w,n.u_fill_translate)}),fillExtrusionPattern:(w,n)=>({u_lightpos:new c.c2(w,n.u_lightpos),u_lightpos_globe:new c.c2(w,n.u_lightpos_globe),u_lightintensity:new c.bq(w,n.u_lightintensity),u_lightcolor:new c.c2(w,n.u_lightcolor),u_vertical_gradient:new c.bq(w,n.u_vertical_gradient),u_height_factor:new c.bq(w,n.u_height_factor),u_opacity:new c.bq(w,n.u_opacity),u_fill_translate:new c.c3(w,n.u_fill_translate),u_image:new c.b_(w,n.u_image),u_texsize:new c.c3(w,n.u_texsize),u_pixel_coord_upper:new c.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(w,n.u_pixel_coord_lower),u_scale:new c.c2(w,n.u_scale),u_fade:new c.bq(w,n.u_fade)}),fill:(w,n)=>({u_fill_translate:new c.c3(w,n.u_fill_translate)}),fillPattern:(w,n)=>({u_image:new c.b_(w,n.u_image),u_texsize:new c.c3(w,n.u_texsize),u_pixel_coord_upper:new c.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(w,n.u_pixel_coord_lower),u_scale:new c.c2(w,n.u_scale),u_fade:new c.bq(w,n.u_fade),u_fill_translate:new c.c3(w,n.u_fill_translate)}),fillOutline:(w,n)=>({u_world:new c.c3(w,n.u_world),u_fill_translate:new c.c3(w,n.u_fill_translate)}),fillOutlinePattern:(w,n)=>({u_world:new c.c3(w,n.u_world),u_image:new c.b_(w,n.u_image),u_texsize:new c.c3(w,n.u_texsize),u_pixel_coord_upper:new c.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(w,n.u_pixel_coord_lower),u_scale:new c.c2(w,n.u_scale),u_fade:new c.bq(w,n.u_fade),u_fill_translate:new c.c3(w,n.u_fill_translate)}),circle:(w,n)=>({u_camera_to_center_distance:new c.bq(w,n.u_camera_to_center_distance),u_scale_with_map:new c.b_(w,n.u_scale_with_map),u_pitch_with_map:new c.b_(w,n.u_pitch_with_map),u_extrude_scale:new c.c3(w,n.u_extrude_scale),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_globe_extrude_scale:new c.bq(w,n.u_globe_extrude_scale),u_translate:new c.c3(w,n.u_translate)}),collisionBox:(w,n)=>({u_pixel_extrude_scale:new c.c3(w,n.u_pixel_extrude_scale)}),collisionCircle:(w,n)=>({u_viewport_size:new c.c3(w,n.u_viewport_size)}),debug:(w,n)=>({u_color:new c.b$(w,n.u_color),u_overlay:new c.b_(w,n.u_overlay),u_overlay_scale:new c.bq(w,n.u_overlay_scale)}),depth:ep,clippingMask:ep,heatmap:(w,n)=>({u_extrude_scale:new c.bq(w,n.u_extrude_scale),u_intensity:new c.bq(w,n.u_intensity),u_globe_extrude_scale:new c.bq(w,n.u_globe_extrude_scale)}),heatmapTexture:(w,n)=>({u_matrix:new c.c0(w,n.u_matrix),u_world:new c.c3(w,n.u_world),u_image:new c.b_(w,n.u_image),u_color_ramp:new c.b_(w,n.u_color_ramp),u_opacity:new c.bq(w,n.u_opacity)}),hillshade:(w,n)=>({u_image:new c.b_(w,n.u_image),u_latrange:new c.c3(w,n.u_latrange),u_exaggeration:new c.bq(w,n.u_exaggeration),u_altitudes:new c.c9(w,n.u_altitudes),u_azimuths:new c.c9(w,n.u_azimuths),u_accent:new c.b$(w,n.u_accent),u_method:new c.b_(w,n.u_method),u_shadows:new c.c8(w,n.u_shadows),u_highlights:new c.c8(w,n.u_highlights)}),hillshadePrepare:(w,n)=>({u_matrix:new c.c0(w,n.u_matrix),u_image:new c.b_(w,n.u_image),u_dimension:new c.c3(w,n.u_dimension),u_zoom:new c.bq(w,n.u_zoom),u_unpack:new c.c1(w,n.u_unpack)}),colorRelief:(w,n)=>({u_image:new c.b_(w,n.u_image),u_unpack:new c.c1(w,n.u_unpack),u_dimension:new c.c3(w,n.u_dimension),u_elevation_stops:new c.b_(w,n.u_elevation_stops),u_color_stops:new c.b_(w,n.u_color_stops),u_color_ramp_size:new c.b_(w,n.u_color_ramp_size),u_opacity:new c.bq(w,n.u_opacity)}),line:(w,n)=>({u_translation:new c.c3(w,n.u_translation),u_ratio:new c.bq(w,n.u_ratio),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new c.c3(w,n.u_units_to_pixels)}),lineGradient:(w,n)=>({u_translation:new c.c3(w,n.u_translation),u_ratio:new c.bq(w,n.u_ratio),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new c.c3(w,n.u_units_to_pixels),u_image:new c.b_(w,n.u_image),u_image_height:new c.bq(w,n.u_image_height)}),linePattern:(w,n)=>({u_translation:new c.c3(w,n.u_translation),u_texsize:new c.c3(w,n.u_texsize),u_ratio:new c.bq(w,n.u_ratio),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_image:new c.b_(w,n.u_image),u_units_to_pixels:new c.c3(w,n.u_units_to_pixels),u_scale:new c.c2(w,n.u_scale),u_fade:new c.bq(w,n.u_fade)}),lineSDF:(w,n)=>({u_translation:new c.c3(w,n.u_translation),u_ratio:new c.bq(w,n.u_ratio),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new c.c3(w,n.u_units_to_pixels),u_image:new c.b_(w,n.u_image),u_mix:new c.bq(w,n.u_mix),u_tileratio:new c.bq(w,n.u_tileratio),u_crossfade_from:new c.bq(w,n.u_crossfade_from),u_crossfade_to:new c.bq(w,n.u_crossfade_to),u_lineatlas_width:new c.bq(w,n.u_lineatlas_width),u_lineatlas_height:new c.bq(w,n.u_lineatlas_height)}),lineGradientSDF:(w,n)=>({u_translation:new c.c3(w,n.u_translation),u_ratio:new c.bq(w,n.u_ratio),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new c.c3(w,n.u_units_to_pixels),u_image:new c.b_(w,n.u_image),u_image_height:new c.bq(w,n.u_image_height),u_tileratio:new c.bq(w,n.u_tileratio),u_crossfade_from:new c.bq(w,n.u_crossfade_from),u_crossfade_to:new c.bq(w,n.u_crossfade_to),u_image_dash:new c.b_(w,n.u_image_dash),u_mix:new c.bq(w,n.u_mix),u_lineatlas_width:new c.bq(w,n.u_lineatlas_width),u_lineatlas_height:new c.bq(w,n.u_lineatlas_height)}),raster:(w,n)=>({u_tl_parent:new c.c3(w,n.u_tl_parent),u_scale_parent:new c.bq(w,n.u_scale_parent),u_buffer_scale:new c.bq(w,n.u_buffer_scale),u_fade_t:new c.bq(w,n.u_fade_t),u_opacity:new c.bq(w,n.u_opacity),u_image0:new c.b_(w,n.u_image0),u_image1:new c.b_(w,n.u_image1),u_brightness_low:new c.bq(w,n.u_brightness_low),u_brightness_high:new c.bq(w,n.u_brightness_high),u_saturation_factor:new c.bq(w,n.u_saturation_factor),u_contrast_factor:new c.bq(w,n.u_contrast_factor),u_spin_weights:new c.c2(w,n.u_spin_weights),u_coords_top:new c.c1(w,n.u_coords_top),u_coords_bottom:new c.c1(w,n.u_coords_bottom)}),symbolIcon:(w,n)=>({u_is_size_zoom_constant:new c.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(w,n.u_is_size_feature_constant),u_size_t:new c.bq(w,n.u_size_t),u_size:new c.bq(w,n.u_size),u_camera_to_center_distance:new c.bq(w,n.u_camera_to_center_distance),u_pitch:new c.bq(w,n.u_pitch),u_rotate_symbol:new c.b_(w,n.u_rotate_symbol),u_aspect_ratio:new c.bq(w,n.u_aspect_ratio),u_fade_change:new c.bq(w,n.u_fade_change),u_label_plane_matrix:new c.c0(w,n.u_label_plane_matrix),u_coord_matrix:new c.c0(w,n.u_coord_matrix),u_is_text:new c.b_(w,n.u_is_text),u_pitch_with_map:new c.b_(w,n.u_pitch_with_map),u_is_along_line:new c.b_(w,n.u_is_along_line),u_is_variable_anchor:new c.b_(w,n.u_is_variable_anchor),u_texsize:new c.c3(w,n.u_texsize),u_texture:new c.b_(w,n.u_texture),u_translation:new c.c3(w,n.u_translation),u_pitched_scale:new c.bq(w,n.u_pitched_scale)}),symbolSDF:(w,n)=>({u_is_size_zoom_constant:new c.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(w,n.u_is_size_feature_constant),u_size_t:new c.bq(w,n.u_size_t),u_size:new c.bq(w,n.u_size),u_camera_to_center_distance:new c.bq(w,n.u_camera_to_center_distance),u_pitch:new c.bq(w,n.u_pitch),u_rotate_symbol:new c.b_(w,n.u_rotate_symbol),u_aspect_ratio:new c.bq(w,n.u_aspect_ratio),u_fade_change:new c.bq(w,n.u_fade_change),u_label_plane_matrix:new c.c0(w,n.u_label_plane_matrix),u_coord_matrix:new c.c0(w,n.u_coord_matrix),u_is_text:new c.b_(w,n.u_is_text),u_pitch_with_map:new c.b_(w,n.u_pitch_with_map),u_is_along_line:new c.b_(w,n.u_is_along_line),u_is_variable_anchor:new c.b_(w,n.u_is_variable_anchor),u_texsize:new c.c3(w,n.u_texsize),u_texture:new c.b_(w,n.u_texture),u_gamma_scale:new c.bq(w,n.u_gamma_scale),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_is_halo:new c.b_(w,n.u_is_halo),u_translation:new c.c3(w,n.u_translation),u_pitched_scale:new c.bq(w,n.u_pitched_scale)}),symbolTextAndIcon:(w,n)=>({u_is_size_zoom_constant:new c.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b_(w,n.u_is_size_feature_constant),u_size_t:new c.bq(w,n.u_size_t),u_size:new c.bq(w,n.u_size),u_camera_to_center_distance:new c.bq(w,n.u_camera_to_center_distance),u_pitch:new c.bq(w,n.u_pitch),u_rotate_symbol:new c.b_(w,n.u_rotate_symbol),u_aspect_ratio:new c.bq(w,n.u_aspect_ratio),u_fade_change:new c.bq(w,n.u_fade_change),u_label_plane_matrix:new c.c0(w,n.u_label_plane_matrix),u_coord_matrix:new c.c0(w,n.u_coord_matrix),u_is_text:new c.b_(w,n.u_is_text),u_pitch_with_map:new c.b_(w,n.u_pitch_with_map),u_is_along_line:new c.b_(w,n.u_is_along_line),u_is_variable_anchor:new c.b_(w,n.u_is_variable_anchor),u_texsize:new c.c3(w,n.u_texsize),u_texsize_icon:new c.c3(w,n.u_texsize_icon),u_texture:new c.b_(w,n.u_texture),u_texture_icon:new c.b_(w,n.u_texture_icon),u_gamma_scale:new c.bq(w,n.u_gamma_scale),u_device_pixel_ratio:new c.bq(w,n.u_device_pixel_ratio),u_is_halo:new c.b_(w,n.u_is_halo),u_translation:new c.c3(w,n.u_translation),u_pitched_scale:new c.bq(w,n.u_pitched_scale)}),background:(w,n)=>({u_opacity:new c.bq(w,n.u_opacity),u_color:new c.b$(w,n.u_color)}),backgroundPattern:(w,n)=>({u_opacity:new c.bq(w,n.u_opacity),u_image:new c.b_(w,n.u_image),u_pattern_tl_a:new c.c3(w,n.u_pattern_tl_a),u_pattern_br_a:new c.c3(w,n.u_pattern_br_a),u_pattern_tl_b:new c.c3(w,n.u_pattern_tl_b),u_pattern_br_b:new c.c3(w,n.u_pattern_br_b),u_texsize:new c.c3(w,n.u_texsize),u_mix:new c.bq(w,n.u_mix),u_pattern_size_a:new c.c3(w,n.u_pattern_size_a),u_pattern_size_b:new c.c3(w,n.u_pattern_size_b),u_scale_a:new c.bq(w,n.u_scale_a),u_scale_b:new c.bq(w,n.u_scale_b),u_pixel_coord_upper:new c.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.c3(w,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bq(w,n.u_tile_units_to_pixels)}),terrain:(w,n)=>({u_texture:new c.b_(w,n.u_texture),u_ele_delta:new c.bq(w,n.u_ele_delta),u_fog_matrix:new c.c0(w,n.u_fog_matrix),u_fog_color:new c.b$(w,n.u_fog_color),u_fog_ground_blend:new c.bq(w,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bq(w,n.u_fog_ground_blend_opacity),u_horizon_color:new c.b$(w,n.u_horizon_color),u_horizon_fog_blend:new c.bq(w,n.u_horizon_fog_blend),u_is_globe_mode:new c.bq(w,n.u_is_globe_mode)}),terrainDepth:(w,n)=>({u_ele_delta:new c.bq(w,n.u_ele_delta)}),terrainCoords:(w,n)=>({u_texture:new c.b_(w,n.u_texture),u_terrain_coords_id:new c.bq(w,n.u_terrain_coords_id),u_ele_delta:new c.bq(w,n.u_ele_delta)}),projectionErrorMeasurement:(w,n)=>({u_input:new c.bq(w,n.u_input),u_output_expected:new c.bq(w,n.u_output_expected)}),atmosphere:(w,n)=>({u_sun_pos:new c.c2(w,n.u_sun_pos),u_atmosphere_blend:new c.bq(w,n.u_atmosphere_blend),u_globe_position:new c.c2(w,n.u_globe_position),u_globe_radius:new c.bq(w,n.u_globe_radius),u_inv_proj_matrix:new c.c0(w,n.u_inv_proj_matrix)}),sky:(w,n)=>({u_sky_color:new c.b$(w,n.u_sky_color),u_horizon_color:new c.b$(w,n.u_horizon_color),u_horizon:new c.c3(w,n.u_horizon),u_horizon_normal:new c.c3(w,n.u_horizon_normal),u_sky_horizon_blend:new c.bq(w,n.u_sky_horizon_blend),u_sky_blend:new c.bq(w,n.u_sky_blend)})};class xu{constructor(n,u,d){this.context=n;const v=n.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const tp={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class rp{constructor(n,u,d,v){this.length=u.length,this.attributes=d,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=n;const T=n.gl;this.buffer=T.createBuffer(),n.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let d=0;d<this.attributes.length;d++){const v=u.attributes[this.attributes[d].name];v!==void 0&&n.enableVertexAttribArray(v)}}setVertexAttribPointers(n,u,d){for(let v=0;v<this.attributes.length;v++){const T=this.attributes[v],A=u.attributes[T.name];A!==void 0&&n.vertexAttribPointer(A,T.components,n[tp[T.type]],!1,this.itemSize,T.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Cr{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Th extends Cr{getDefault(){return c.bp.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Eh extends Cr{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Uf extends Cr{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class bu extends Cr{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ah extends Cr{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class _c extends Cr{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mo extends Cr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class np extends Cr{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Vf extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class go extends Cr{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Ms extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class wa extends Cr{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Js extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class wu extends Cr{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Su extends Cr{getDefault(){return c.bp.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Mh extends Cr{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class zl extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Lo extends Cr{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class ip extends Cr{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class xc extends Cr{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class wr extends Cr{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class qf extends Cr{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class yo extends Cr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class $f extends Cr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class vo extends Cr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class ym extends Cr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Gf extends Cr{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class kl extends Cr{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const d=this.gl;Ba(d)?d.bindVertexArray(n):(u=d.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class ap extends Cr{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Zf extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class bc extends Cr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Rl extends Cr{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class Sa extends Rl{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class jl extends Rl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Tu extends Rl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Ll="Framebuffer is not complete";class Nl{constructor(n,u,d,v,T){this.context=n,this.width=u,this.height=d;const A=n.gl,O=this.framebuffer=A.createFramebuffer();if(this.colorAttachment=new Sa(n,O),v)this.depthAttachment=T?new Tu(n,O):new jl(n,O);else if(T)throw new Error("Stencil cannot be set without depth");if(A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error(Ll)}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const d=this.depthAttachment.get();d&&n.deleteRenderbuffer(d)}n.deleteFramebuffer(this.framebuffer)}}class ra{constructor(n){var u,d;if(this.gl=n,this.clearColor=new Th(this),this.clearDepth=new Eh(this),this.clearStencil=new Uf(this),this.colorMask=new bu(this),this.depthMask=new Ah(this),this.stencilMask=new _c(this),this.stencilFunc=new mo(this),this.stencilOp=new np(this),this.stencilTest=new Vf(this),this.depthRange=new go(this),this.depthTest=new Ms(this),this.depthFunc=new wa(this),this.blend=new Js(this),this.blendFunc=new wu(this),this.blendColor=new Su(this),this.blendEquation=new Mh(this),this.cullFace=new zl(this),this.cullFaceSide=new Lo(this),this.frontFace=new ip(this),this.program=new xc(this),this.activeTexture=new wr(this),this.viewport=new qf(this),this.bindFramebuffer=new yo(this),this.bindRenderbuffer=new $f(this),this.bindTexture=new vo(this),this.bindVertexBuffer=new ym(this),this.bindElementBuffer=new Gf(this),this.bindVertexArray=new kl(this),this.pixelStoreUnpack=new ap(this),this.pixelStoreUnpackPremultiplyAlpha=new Zf(this),this.pixelStoreUnpackFlipY=new bc(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Ba(n)){this.HALF_FLOAT=n.HALF_FLOAT;const v=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:v?.RGBA16F_EXT,this.RGB16F=(d=n.RGB16F)!==null&&d!==void 0?d:v?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const v=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new xu(this,n,u)}createVertexBuffer(n,u,d){return new rp(this,n,u,d)}createRenderbuffer(n,u,d){const v=this.gl,T=v.createRenderbuffer();return this.bindRenderbuffer.set(T),v.renderbufferStorage(v.RENDERBUFFER,n,u,d),this.bindRenderbuffer.set(null),T}createFramebuffer(n,u,d,v){return new Nl(this,n,u,d,v)}clear({color:n,depth:u,stencil:d}){const v=this.gl;let T=0;n&&(T|=v.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(T|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),d!==void 0&&(T|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),v.clear(T)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.bR(n.blendFunction,sn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Ba(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return Ba(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let yi;function rs(w,n,u,d,v){const T=w.context,A=w.transform,O=T.gl,R=w.useProgram("collisionBox"),B=[];let V=0,X=0;for(let de=0;de<d.length;de++){const xe=d[de],Ee=n.getTile(xe).getBucket(u);if(!Ee)continue;const ve=v?Ee.textCollisionBox:Ee.iconCollisionBox,Pe=Ee.collisionCircleArray;Pe.length>0&&(B.push({circleArray:Pe,circleOffset:X,coord:xe}),V+=Pe.length/4,X=V),ve&&R.draw(T,O.LINES,br.disabled,Br.disabled,w.colorModeForRenderPass(),Dr.disabled,Xd(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(xe),A.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,w.transform.zoom,null,null,ve.collisionVertexBuffer)}if(!v||!B.length)return;const Y=w.useProgram("collisionCircle"),re=new c.ca;re.resize(4*V),re._trim();let oe=0;for(const de of B)for(let xe=0;xe<de.circleArray.length/4;xe++){const Ee=4*xe,ve=de.circleArray[Ee+0],Pe=de.circleArray[Ee+1],De=de.circleArray[Ee+2],we=de.circleArray[Ee+3];re.emplace(oe++,ve,Pe,De,we,0),re.emplace(oe++,ve,Pe,De,we,1),re.emplace(oe++,ve,Pe,De,we,2),re.emplace(oe++,ve,Pe,De,we,3)}(!yi||yi.length<2*V)&&(yi=(function(de){const xe=2*de,Ee=new c.cc;Ee.resize(xe),Ee._trim();for(let ve=0;ve<xe;ve++){const Pe=6*ve;Ee.uint16[Pe+0]=4*ve+0,Ee.uint16[Pe+1]=4*ve+1,Ee.uint16[Pe+2]=4*ve+2,Ee.uint16[Pe+3]=4*ve+2,Ee.uint16[Pe+4]=4*ve+3,Ee.uint16[Pe+5]=4*ve+0}return Ee})(V));const he=T.createIndexBuffer(yi,!0),pe=T.createVertexBuffer(re,c.cb.members,!0);for(const de of B){const xe=Lf(w.transform);Y.draw(T,O.TRIANGLES,br.disabled,Br.disabled,w.colorModeForRenderPass(),Dr.disabled,xe,w.style.map.terrain&&w.style.map.terrain.getTerrainData(de.coord),null,u.id,pe,he,c.aX.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,w.transform.zoom,null,null,null)}pe.destroy(),he.destroy()}const Ps=c.ar(new Float32Array(16));function Ua(w,n,u,d,v,T){const{horizontalAlign:A,verticalAlign:O}=c.aS(w);return new c.P((-(A-.5)*n/v+d[0])*T,(-(O-.5)*u/v+d[1])*T)}function el(w,n,u,d,v,T){const A=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let O=d.mult(T);u||(O=O.rotate(-v));const R=A.add(O);return Ts(R.x,R.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(u){const O=zi(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(w),R=Math.atan(O.y/O.x)+(O.x<0?Math.PI:0);return w.add(d.rotate(R))}return w.add(d)}function op(w,n,u,d,v,T,A,O,R,B,V,X){const Y=w.text.placedSymbolArray,re=w.text.dynamicLayoutVertexArray,oe=w.icon.dynamicLayoutVertexArray,he={};re.clear();for(let pe=0;pe<Y.length;pe++){const de=Y.get(pe),xe=de.hidden||!de.crossTileID||w.allowVerticalPlacement&&!de.placedOrientation?null:d[de.crossTileID];if(xe){const Ee=new c.P(de.anchorX,de.anchorY),ve={getElevation:X,width:v.width,height:v.height,pitchedLabelPlaneMatrix:T,pitchWithMap:u,transform:v,tileAnchorPoint:Ee,translation:B,unwrappedTileID:V},Pe=u?El(Ee.x,Ee.y,ve):zi(Ee.x,Ee.y,ve),De=ja(v.cameraToCenterDistance,Pe.signedDistanceFromCamera);let we=c.aA(w.textSizeData,O,de)*De/c.aM;u&&(we*=w.tilePixelRatio/A);const{width:Re,height:Qe,anchor:Ye,textOffset:He,textBoxScale:Je}=xe,Ct=Ua(Ye,Re,Qe,He,Je,we),Dt=v.getPitchedTextCorrection(Ee.x+B[0],Ee.y+B[1],V),ut=el(Pe.point,ve,n,Ct,-v.bearingInRadians,Dt),Zt=w.allowVerticalPlacement&&de.placedOrientation===c.az.vertical?Math.PI/2:0;for(let vr=0;vr<de.numGlyphs;vr++)c.aG(re,ut,Zt);R&&de.associatedIconIndex>=0&&(he[de.associatedIconIndex]={shiftedAnchor:ut,angle:Zt})}else Zi(de.numGlyphs,re)}if(R){oe.clear();const pe=w.icon.placedSymbolArray;for(let de=0;de<pe.length;de++){const xe=pe.get(de);if(xe.hidden)Zi(xe.numGlyphs,oe);else{const Ee=he[de];if(Ee)for(let ve=0;ve<xe.numGlyphs;ve++)c.aG(oe,Ee.shiftedAnchor,Ee.angle);else Zi(xe.numGlyphs,oe)}}w.icon.dynamicLayoutVertexBuffer.updateData(oe)}w.text.dynamicLayoutVertexBuffer.updateData(re)}function wc(w,n,u){return u.iconsInText&&n?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function Sc(w,n,u,d,v,T,A,O,R,B,V,X,Y){const re=w.context,oe=re.gl,he=w.transform,pe=O==="map",de=R==="map",xe=O!=="viewport"&&u.layout.get("symbol-placement")!=="point",Ee=pe&&!de&&!xe,ve=!u.layout.get("symbol-sort-key").isConstant();let Pe=!1;const De=w.getDepthModeForSublayer(0,br.ReadOnly),we=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Re=[],Qe=he.getCircleRadiusCorrection();for(const Ye of d){const He=n.getTile(Ye),Je=He.getBucket(u);if(!Je)continue;const Ct=v?Je.text:Je.icon;if(!Ct||!Ct.segments.get().length||!Ct.hasVisibleVertices)continue;const Dt=Ct.programConfigurations.get(u.id),ut=v||Je.sdfIcons,Zt=v?Je.textSizeData:Je.iconSizeData,vr=de||he.pitch!==0,Xr=w.useProgram(wc(ut,v,Je),Dt),vn=c.ay(Zt,he.zoom),dn=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Ye);let Sn,tn,fi,jn,Di=[0,0],Vn=null;if(v)tn=He.glyphAtlasTexture,fi=oe.LINEAR,Sn=He.glyphAtlasTexture.size,Je.iconsInText&&(Di=He.imageAtlasTexture.size,Vn=He.imageAtlasTexture,jn=vr||w.options.rotating||w.options.zooming||Zt.kind==="composite"||Zt.kind==="camera"?oe.LINEAR:oe.NEAREST);else{const un=u.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;tn=He.imageAtlasTexture,fi=ut||w.options.rotating||w.options.zooming||un||vr?oe.LINEAR:oe.NEAREST,Sn=He.imageAtlasTexture.size}const qn=c.aN(He,1,w.transform.zoom),Yi=Zs(pe,w.transform,qn),js=c.N();c.aB(js,Yi);const us=Ss(de,pe,w.transform,qn),Aa=c.aO(he,He,T,A),cl=he.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),Cc=we&&Je.hasTextData(),hl=u.layout.get("icon-text-fit")!=="none"&&Cc&&Je.hasIconData();if(xe){const un=w.style.map.terrain?(Za,di)=>w.style.map.terrain.getElevation(Ye,Za,di):null,Tn=u.layout.get("text-rotation-alignment")==="map";va(Je,w,v,Yi,js,de,B,Tn,Ye.toUnwrapped(),he.width,he.height,Aa,un)}const Gl=v&&we||hl,Xi=xe||Gl?Ps:de?Yi:w.transform.clipSpaceToPixelsMatrix,Eo=ut&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ga;Ga=ut?Je.iconsInText?wh(Zt.kind,vn,Ee,de,xe,Gl,w,Xi,us,Aa,Sn,Di,Qe):po(Zt.kind,vn,Ee,de,xe,Gl,w,Xi,us,Aa,v,Sn,0,Qe):Ff(Zt.kind,vn,Ee,de,xe,Gl,w,Xi,us,Aa,v,Sn,Qe);const Ki={program:Xr,buffers:Ct,uniformValues:Ga,projectionData:cl,atlasTexture:tn,atlasTextureIcon:Vn,atlasInterpolation:fi,atlasInterpolationIcon:jn,isSDF:ut,hasHalo:Eo};if(ve&&Je.canOverlap){Pe=!0;const un=Ct.segments.get();for(const Tn of un)Re.push({segments:new c.aX([Tn]),sortKey:Tn.sortKey,state:Ki,terrainData:dn})}else Re.push({segments:Ct.segments,sortKey:0,state:Ki,terrainData:dn})}Pe&&Re.sort(((Ye,He)=>Ye.sortKey-He.sortKey));for(const Ye of Re){const He=Ye.state;if(re.activeTexture.set(oe.TEXTURE0),He.atlasTexture.bind(He.atlasInterpolation,oe.CLAMP_TO_EDGE),He.atlasTextureIcon&&(re.activeTexture.set(oe.TEXTURE1),He.atlasTextureIcon&&He.atlasTextureIcon.bind(He.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),He.isSDF){const Je=He.uniformValues;He.hasHalo&&(Je.u_is_halo=1,Hf(He.buffers,Ye.segments,u,w,He.program,De,V,X,Je,He.projectionData,Ye.terrainData)),Je.u_is_halo=0}Hf(He.buffers,Ye.segments,u,w,He.program,De,V,X,He.uniformValues,He.projectionData,Ye.terrainData)}}function Hf(w,n,u,d,v,T,A,O,R,B,V){const X=d.context;v.draw(X,X.gl.TRIANGLES,T,A,O,Dr.backCCW,R,V,B,u.id,w.layoutVertexBuffer,w.indexBuffer,n,u.paint,d.transform.zoom,w.programConfigurations.get(u.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function Li(w,n,u,d,v){const T=w.context,A=T.gl,O=Br.disabled,R=new sn([A.ONE,A.ONE],c.bp.transparent,[!0,!0,!0,!0]),B=n.getBucket(u);if(!B)return;const V=d.key;let X=u.heatmapFbos.get(V);X||(X=Rr(T,n.tileSize,n.tileSize),u.heatmapFbos.set(V,X)),T.bindFramebuffer.set(X.framebuffer),T.viewport.set([0,0,n.tileSize,n.tileSize]),T.clear({color:c.bp.transparent});const Y=B.programConfigurations.get(u.id),re=w.useProgram("heatmap",Y,!v),oe=w.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=w.style.map.terrain.getTerrainData(d);re.draw(T,A.TRIANGLES,br.disabled,O,R,Dr.disabled,Kd(n,w.transform.zoom,u.paint.get("heatmap-intensity"),1),he,oe,u.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,u.paint,w.transform.zoom,Y)}function yn(w,n,u,d,v){const T=w.context,A=T.gl,O=w.transform;T.setColorMode(w.colorModeForRenderPass());const R=tl(T,n),B=u.key,V=n.heatmapFbos.get(B);if(!V)return;T.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,V.colorAttachment.get()),T.activeTexture.set(A.TEXTURE1),R.bind(A.LINEAR,A.CLAMP_TO_EDGE);const X=O.getProjectionData({overscaledTileID:u,applyTerrainMatrix:v,applyGlobeMatrix:!d});w.useProgram("heatmapTexture").draw(T,A.TRIANGLES,br.disabled,Br.disabled,w.colorModeForRenderPass(),Dr.disabled,yc(w,n,0,1),null,X,n.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,n.paint,O.zoom),V.destroy(),n.heatmapFbos.delete(B)}function Rr(w,n,u){var d,v;const T=w.gl,A=T.createTexture();T.bindTexture(T.TEXTURE_2D,A),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const O=(d=w.HALF_FLOAT)!==null&&d!==void 0?d:T.UNSIGNED_BYTE,R=(v=w.RGBA16F)!==null&&v!==void 0?v:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,R,n,u,0,T.RGBA,O,null);const B=w.createFramebuffer(n,u,!1,!1);return B.colorAttachment.set(A),B}function tl(w,n){return n.colorRampTexture||(n.colorRampTexture=new c.T(w,n.colorRamp,w.gl.RGBA)),n.colorRampTexture}function Va(w,n,u,d,v,T,A,O){let R=256;if(v.stepInterpolant){const B=n.getSource().maxzoom,V=A.canonical.z===B?Math.ceil(1<<w.transform.maxZoom-A.canonical.z):1;R=c.an(c.ce(T.maxLineLength/c.a5*1024*V),256,u.maxTextureSize)}return O.gradient=c.cf({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:R,image:O.gradient||void 0,clips:T.lineClipsArray}),O.texture?O.texture.update(O.gradient):O.texture=new c.T(u,O.gradient,d.RGBA),O.version=v.gradientVersion,O.texture}function Fn(w,n,u,d,v){w.activeTexture.set(n.TEXTURE0),u.imageAtlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),d.updatePaintBuffers(v)}function qa(w,n,u,d,v,T){(v||w.lineAtlas.dirty)&&(n.activeTexture.set(u.TEXTURE0),w.lineAtlas.bind(n)),d.updatePaintBuffers(T)}function $a(w,n,u,d,v,T,A){const O=T.gradients[v.id];let R=O.texture;v.gradientVersion!==O.version&&(R=Va(w,n,u,d,v,T,A,O)),u.activeTexture.set(d.TEXTURE0),R.bind(v.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE)}function Wf(w,n,u,d,v,T,A,O,R){const B=T.gradients[v.id];let V=B.texture;v.gradientVersion!==B.version&&(V=Va(w,n,u,d,v,T,A,B)),u.activeTexture.set(d.TEXTURE0),V.bind(v.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE),u.activeTexture.set(d.TEXTURE1),w.lineAtlas.bind(u),O.updatePaintBuffers(R)}function Cs(w,n,u,d,v){if(!u||!d||!d.imageAtlas)return;const T=d.imageAtlas.patternPositions;let A=T[u.to.toString()],O=T[u.from.toString()];if(!A&&O&&(A=O),!O&&A&&(O=A),!A||!O){const R=v.getPaintProperty(n);A=T[R],O=T[R]}A&&O&&w.setConstantPatternPositions(A,O)}function rl(w,n,u,d,v,T,A,O){const R=w.context.gl,B="fill-pattern",V=u.paint.get(B),X=V&&V.constantOr(1),Y=u.getCrossfadeParameters();let re,oe,he,pe,de;const xe=w.transform,Ee=u.paint.get("fill-translate"),ve=u.paint.get("fill-translate-anchor");A?(oe=X&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",re=R.LINES):(oe=X?"fillPattern":"fill",re=R.TRIANGLES);const Pe=V.constantOr(null);for(const De of d){const we=n.getTile(De);if(X&&!we.patternsLoaded())continue;const Re=we.getBucket(u);if(!Re)continue;const Qe=Re.programConfigurations.get(u.id),Ye=w.useProgram(oe,Qe),He=w.style.map.terrain&&w.style.map.terrain.getTerrainData(De);X&&(w.context.activeTexture.set(R.TEXTURE0),we.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Qe.updatePaintBuffers(Y)),Cs(Qe,B,Pe,we,u);const Je=xe.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Ct=c.aO(xe,we,Ee,ve);if(A){pe=Re.indexBuffer2,de=Re.segments2;const ut=[R.drawingBufferWidth,R.drawingBufferHeight];he=oe==="fillOutlinePattern"&&X?_h(w,Y,we,ut,Ct):dm(ut,Ct)}else pe=Re.indexBuffer,de=Re.segments,he=X?vu(w,Y,we,Ct):{u_fill_translate:Ct};const Dt=w.stencilModeForClipping(De);Ye.draw(w.context,re,v,Dt,T,Dr.backCCW,he,He,Je,u.id,Re.layoutVertexBuffer,pe,de,u.paint,w.transform.zoom,Qe)}}function Ds(w,n,u,d,v,T,A,O){const R=w.context,B=R.gl,V="fill-extrusion-pattern",X=u.paint.get(V),Y=X.constantOr(1),re=u.getCrossfadeParameters(),oe=u.paint.get("fill-extrusion-opacity"),he=X.constantOr(null),pe=w.transform;for(const de of d){const xe=n.getTile(de),Ee=xe.getBucket(u);if(!Ee)continue;const ve=w.style.map.terrain&&w.style.map.terrain.getTerrainData(de),Pe=Ee.programConfigurations.get(u.id),De=w.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",Pe);Y&&(w.context.activeTexture.set(B.TEXTURE0),xe.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Pe.updatePaintBuffers(re));const we=pe.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!O,applyTerrainMatrix:!0});Cs(Pe,V,he,xe,u);const Re=c.aO(pe,xe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Qe=u.paint.get("fill-extrusion-vertical-gradient"),Ye=Y?gc(w,Qe,oe,Re,de,re,xe):vh(w,Qe,oe,Re);De.draw(R,R.gl.TRIANGLES,v,T,A,Dr.backCCW,Ye,ve,we,u.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,u.paint,w.transform.zoom,Pe,w.style.map.terrain&&Ee.centroidVertexBuffer)}}function nl(w,n,u,d,v,T,A,O,R){var B;const V=w.style.projection,X=w.context,Y=w.transform,re=X.gl,oe=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],he=w.useProgram("hillshade",null,!1,oe),pe=!w.options.moving;for(const de of d){const xe=n.getTile(de),Ee=xe.fbo;if(!Ee)continue;const ve=V.getMeshFromTileID(X,de.canonical,O,!0,"raster"),Pe=(B=w.style.map.terrain)===null||B===void 0?void 0:B.getTerrainData(de);X.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Ee.colorAttachment.get());const De=Y.getProjectionData({overscaledTileID:de,aligned:pe,applyGlobeMatrix:!R,applyTerrainMatrix:!0});he.draw(X,re.TRIANGLES,T,v[de.overscaledZ],A,Dr.backCCW,pm(w,xe,u),Pe,De,u.id,ve.vertexBuffer,ve.indexBuffer,ve.segments)}}function il(w,n,u,d,v,T,A,O,R){var B;const V=w.style.projection,X=w.context,Y=w.transform,re=X.gl,oe=w.useProgram("colorRelief"),he=!w.options.moving;let pe=!0,de=0;for(const xe of d){const Ee=n.getTile(xe),ve=Ee.dem;if(pe){const Ye=re.getParameter(re.MAX_TEXTURE_SIZE),{elevationTexture:He,colorTexture:Je}=u.getColorRampTextures(X,Ye,ve.getUnpackVector());X.activeTexture.set(re.TEXTURE1),He.bind(re.NEAREST,re.CLAMP_TO_EDGE),X.activeTexture.set(re.TEXTURE4),Je.bind(re.LINEAR,re.CLAMP_TO_EDGE),pe=!1,de=He.size[0]}if(!ve||!ve.data)continue;const Pe=ve.stride,De=ve.getPixels();if(X.activeTexture.set(re.TEXTURE0),X.pixelStoreUnpackPremultiplyAlpha.set(!1),Ee.demTexture=Ee.demTexture||w.getTileTexture(Pe),Ee.demTexture){const Ye=Ee.demTexture;Ye.update(De,{premultiply:!1}),Ye.bind(re.LINEAR,re.CLAMP_TO_EDGE)}else Ee.demTexture=new c.T(X,De,re.RGBA,{premultiply:!1}),Ee.demTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const we=V.getMeshFromTileID(X,xe.canonical,O,!0,"raster"),Re=(B=w.style.map.terrain)===null||B===void 0?void 0:B.getTerrainData(xe),Qe=Y.getProjectionData({overscaledTileID:xe,aligned:he,applyGlobeMatrix:!R,applyTerrainMatrix:!0});oe.draw(X,re.TRIANGLES,T,v[xe.overscaledZ],A,Dr.backCCW,gm(u,Ee.dem,de),Re,Qe,u.id,we.vertexBuffer,we.indexBuffer,we.segments)}}const ns=[new c.P(0,0),new c.P(c.a5,0),new c.P(c.a5,c.a5),new c.P(0,c.a5)];function _o(w,n,u,d,v,T,A,O,R=!1,B=!1){const V=d[d.length-1].overscaledZ,X=w.context,Y=X.gl,re=w.useProgram("raster"),oe=w.transform,he=w.style.projection,pe=w.colorModeForRenderPass(),de=!w.options.moving,xe=u.paint.get("raster-opacity"),Ee=u.paint.get("raster-resampling"),ve=u.paint.get("raster-fade-duration"),Pe=!!w.style.map.terrain;for(const De of d){const we=w.getDepthModeForSublayer(De.overscaledZ-V,xe===1?br.ReadWrite:br.ReadOnly,Y.LESS),Re=n.getTile(De),Qe=Ee==="nearest"?Y.NEAREST:Y.LINEAR;X.activeTexture.set(Y.TEXTURE0),Re.texture.bind(Qe,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),X.activeTexture.set(Y.TEXTURE1);const{parentTile:Ye,parentScaleBy:He,parentTopLeft:Je,fadeValues:Ct}=al(Re,n,ve,Pe);Re.fadeOpacity=Ct.tileOpacity,Ye?(Ye.fadeOpacity=Ct.parentTileOpacity,Ye.texture.bind(Qe,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST)):Re.texture.bind(Qe,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Re.texture.useMipmap&&X.extTextureFilterAnisotropic&&w.transform.pitch>w.options.anisotropicFilterPitch&&Y.texParameterf(Y.TEXTURE_2D,X.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,X.extTextureFilterAnisotropicMax);const Dt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(De),ut=oe.getProjectionData({overscaledTileID:De,aligned:de,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Zt=Nf(Je,He,Ct.fadeMix,u,O),vr=he.getMeshFromTileID(X,De.canonical,T,A,"raster");re.draw(X,Y.TRIANGLES,we,v?v[De.overscaledZ]:Br.disabled,pe,R?Dr.frontCCW:Dr.backCCW,Zt,Dt,ut,u.id,vr.vertexBuffer,vr.indexBuffer,vr.segments)}}function al(w,n,u,d){const v={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(u===0||d)return v;if(w.fadingParentID){const T=n.getLoadedTile(w.fadingParentID);if(!T)return v;const A=Math.pow(2,T.tileID.overscaledZ-w.tileID.overscaledZ),O=[w.tileID.canonical.x*A%1,w.tileID.canonical.y*A%1],R=(function(B,V,X){const Y=W(),re=(Y-V.timeAdded)/X,oe=B.fadingDirection===Te.Incoming,he=c.an((Y-B.timeAdded)/X,0,1),pe=c.an(1-re,0,1),de=oe?he:pe;return{tileOpacity:de,parentTileOpacity:oe?pe:he,fadeMix:{opacity:1,mix:1-de}}})(w,T,u);return{parentTile:T,parentScaleBy:A,parentTopLeft:O,fadeValues:R}}if(w.selfFading){const T=(function(A,O){const R=(W()-A.timeAdded)/O,B=c.an(R,0,1);return{tileOpacity:B,fadeMix:{opacity:B,mix:0}}})(w,u);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:T}}return v}const Os=new c.bp(1,0,0,1),Yf=new c.bp(0,1,0,1),Xf=new c.bp(0,0,1,1),xo=new c.bp(1,0,1,1),Ph=new c.bp(0,1,1,1);function ol(w,n,u,d){Bl(w,0,n+u/2,w.transform.width,u,d)}function Pi(w,n,u,d){Bl(w,n-u/2,0,u,w.transform.height,d)}function Bl(w,n,u,d,v,T){const A=w.context,O=A.gl;O.enable(O.SCISSOR_TEST),O.scissor(n*w.pixelRatio,u*w.pixelRatio,d*w.pixelRatio,v*w.pixelRatio),A.clear({color:T}),O.disable(O.SCISSOR_TEST)}function sp(w,n,u){const d=w.context,v=d.gl,T=w.useProgram("debug"),A=br.disabled,O=Br.disabled,R=w.colorModeForRenderPass(),B="$debug",V=w.style.map.terrain&&w.style.map.terrain.getTerrainData(u);d.activeTexture.set(v.TEXTURE0);const X=n.getTileByID(u.key).latestRawTileData,Y=Math.floor((X&&X.byteLength||0)/1024),re=n.getTile(u).tileSize,oe=512/Math.min(re,512)*(u.overscaledZ/w.transform.zoom)*.5;let he=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(he+=` => ${u.overscaledZ}`),(function(de,xe){de.initDebugOverlayCanvas();const Ee=de.debugOverlayCanvas,ve=de.context.gl,Pe=de.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,Ee.width,Ee.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(xe,5,5),Pe.strokeText(xe,5,5),de.debugOverlayTexture.update(Ee),de.debugOverlayTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)})(w,`${he} ${Y}kB`);const pe=w.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(d,v.TRIANGLES,A,O,sn.alphaBlended,Dr.disabled,Ol(c.bp.transparent,oe),null,pe,B,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),T.draw(d,v.LINE_STRIP,A,O,R,Dr.disabled,Ol(c.bp.red),V,pe,B,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function lp(w,n,u,d){const{isRenderingGlobe:v}=d,T=w.context,A=T.gl,O=w.transform,R=w.colorModeForRenderPass(),B=w.getDepthModeFor3D(),V=w.useProgram("terrain");T.bindFramebuffer.set(null),T.viewport.set([0,0,w.width,w.height]);for(const X of u){const Y=n.getTerrainMesh(X.tileID),re=w.renderToTexture.getTexture(X),oe=n.getTerrainData(X.tileID);T.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,re.texture);const he=n.getMeshFrameDelta(O.zoom),pe=O.calculateFogMatrix(X.tileID.toUnwrapped()),de=ts(he,pe,w.style.sky,O.pitch,v),xe=O.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});V.draw(T,A.TRIANGLES,B,Br.disabled,R,Dr.backCCW,de,oe,xe,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}function up(w,n){if(!n.mesh){const u=new c.aW;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const d=new c.aY;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),n.mesh=new Zn(w.createVertexBuffer(u,Nr.members),w.createIndexBuffer(d),c.aX.simpleSegment(0,0,u.length,d.length))}return n.mesh}class vm{constructor(n,u){this.context=new ra(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=xt.maxOverzooming+xt.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new on}resize(n,u,d){if(this.width=Math.floor(n*d),this.height=Math.floor(u*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const n=this.context,u=new c.aW;u.emplaceBack(0,0),u.emplaceBack(c.a5,0),u.emplaceBack(0,c.a5),u.emplaceBack(c.a5,c.a5),this.tileExtentBuffer=n.createVertexBuffer(u,Nr.members),this.tileExtentSegments=c.aX.simpleSegment(0,0,4,2);const d=new c.aW;d.emplaceBack(0,0),d.emplaceBack(c.a5,0),d.emplaceBack(0,c.a5),d.emplaceBack(c.a5,c.a5),this.debugBuffer=n.createVertexBuffer(d,Nr.members),this.debugSegments=c.aX.simpleSegment(0,0,4,5);const v=new c.ch;v.emplaceBack(0,0,0,0),v.emplaceBack(c.a5,0,c.a5,0),v.emplaceBack(0,c.a5,0,c.a5),v.emplaceBack(c.a5,c.a5,c.a5,c.a5),this.rasterBoundsBuffer=n.createVertexBuffer(v,gh.members),this.rasterBoundsSegments=c.aX.simpleSegment(0,0,4,2);const T=new c.aW;T.emplaceBack(0,0),T.emplaceBack(c.a5,0),T.emplaceBack(0,c.a5),T.emplaceBack(c.a5,c.a5),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(T,Nr.members),this.rasterBoundsSegmentsPosOnly=c.aX.simpleSegment(0,0,4,5);const A=new c.aW;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(A,Nr.members),this.viewportSegments=c.aX.simpleSegment(0,0,4,2);const O=new c.ci;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(O);const R=new c.aY;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(R);const B=this.context.gl;this.stencilClearMode=new Br({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.tileExtentMesh=new Zn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.N();c.c7(d,0,this.width,this.height,0,0,1),c.Q(d,d,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const v={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(n,u.TRIANGLES,br.disabled,this.stencilClearMode,sn.disabled,Dr.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u,d){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source,this.nextStencilID+u.length>256&&this.clearStencil();const v=this.context;v.setColorMode(sn.disabled),v.setDepthMode(br.disabled);const T={};for(const A of u)T[A.key]=this.nextStencilID++;this._renderTileMasks(T,u,d,!0),this._renderTileMasks(T,u,d,!1),this._tileClippingMaskIDs=T}_renderTileMasks(n,u,d,v){const T=this.context,A=T.gl,O=this.style.projection,R=this.transform,B=this.useProgram("clippingMask");for(const V of u){const X=n[V.key],Y=this.style.map.terrain&&this.style.map.terrain.getTerrainData(V),re=O.getMeshFromTileID(this.context,V.canonical,v,!0,"stencil"),oe=R.getProjectionData({overscaledTileID:V,applyGlobeMatrix:!d,applyTerrainMatrix:!0});B.draw(T,A.TRIANGLES,br.disabled,new Br({func:A.ALWAYS,mask:0},X,255,A.KEEP,A.KEEP,A.REPLACE),sn.disabled,d?Dr.disabled:Dr.backCCW,null,Y,oe,"$clipping",re.vertexBuffer,re.indexBuffer,re.segments)}}_renderTilesDepthBuffer(){const n=this.context,u=n.gl,d=this.style.projection,v=this.transform,T=this.useProgram("depth"),A=this.getDepthModeFor3D(),O=nn(v,{tileSize:v.tileSize});for(const R of O){const B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),V=d.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),X=v.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(n,u.TRIANGLES,A,Br.disabled,sn.disabled,Dr.backCCW,null,B,X,"$clipping",V.vertexBuffer,V.indexBuffer,V.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Br({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new Br({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const u=this.context.gl,d=n.sort(((A,O)=>O.overscaledZ-A.overscaledZ)),v=d[d.length-1].overscaledZ,T=d[0].overscaledZ-v+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const A={};for(let O=0;O<T;O++)A[O+v]=new Br({func:u.GEQUAL,mask:255},O+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=T,[A,d]}return[{[v]:Br.disabled},d]}stencilConfigForOverlapTwoPass(n){const u=this.context.gl,d=n.sort(((A,O)=>O.overscaledZ-A.overscaledZ)),v=d[d.length-1].overscaledZ,T=d[0].overscaledZ-v+1;if(this.clearStencil(),T>1){const A={},O={};for(let R=0;R<T;R++)A[R+v]=new Br({func:u.GREATER,mask:255},T+1+R,255,u.KEEP,u.KEEP,u.REPLACE),O[R+v]=new Br({func:u.GREATER,mask:255},1+R,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*T+1,[A,O,d]}return this.nextStencilID=3,[{[v]:new Br({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[v]:new Br({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},d]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new sn([n.CONSTANT_COLOR,n.ONE],new c.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?sn.unblended:sn.alphaBlended}getDepthModeForSublayer(n,u,d){if(!this.opaquePassEnabledForLayer())return br.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new br(d||this.context.gl.LEQUAL,u,[v,v])}getDepthModeFor3D(){return new br(this.context.gl.LEQUAL,br.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){var d,v;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(W()),this.imageManager.beginFrame();const T=this.style._order,A=this.style.tileManagers,O={},R={},B={},V={isRenderingToTexture:!1,isRenderingGlobe:((d=n.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const Y in A){const re=A[Y];re.used&&re.prepare(this.context),O[Y]=re.getVisibleCoordinates(!1),R[Y]=O[Y].slice().reverse(),B[Y]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Y=0;Y<T.length;Y++)if(this.style._layers[T[Y]].is3D()){this.opaquePassCutoff=Y;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Y of T){const re=this.style._layers[Y];if(!re.hasOffscreenPass()||re.isHidden(this.transform.zoom))continue;const oe=R[re.source];(re.type==="custom"||oe.length)&&this.renderLayer(this,A[re.source],re,oe,V)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:Y=>this.useProgram(Y)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?c.bp.black:c.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Y,re){const oe=Y.context,he=oe.gl,pe=((De,we,Re)=>{const Qe=Math.cos(we.rollInRadians),Ye=Math.sin(we.rollInRadians),He=Xe(we),Je=we.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:De.properties.get("sky-color"),u_horizon_color:De.properties.get("horizon-color"),u_horizon:[(we.width/2-He*Ye)*Re,(we.height/2+He*Qe)*Re],u_horizon_normal:[-Ye,Qe],u_sky_horizon_blend:De.properties.get("sky-horizon-blend")*we.height/2*Re,u_sky_blend:Je}})(re,Y.style.map.transform,Y.pixelRatio),de=new br(he.LEQUAL,br.ReadWrite,[0,1]),xe=Br.disabled,Ee=Y.colorModeForRenderPass(),ve=Y.useProgram("sky"),Pe=up(oe,re);ve.draw(oe,he.TRIANGLES,de,xe,Ee,Dr.disabled,pe,null,void 0,"sky",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const Y=this.style._layers[T[this.currentLayer]],re=A[Y.source],oe=O[Y.source];this._renderTileClippingMasks(Y,oe,!1),this.renderLayer(this,re,Y,oe,V)}this.renderPass="translucent";let X=!1;for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const Y=this.style._layers[T[this.currentLayer]],re=A[Y.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Y,V))continue;this.opaquePassEnabledForLayer()||X||(X=!0,V.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const oe=(Y.type==="symbol"?B:R)[Y.source];this._renderTileClippingMasks(Y,O[Y.source],!!this.renderToTexture),this.renderLayer(this,re,Y,oe,V)}if(V.isRenderingGlobe&&(function(Y,re,oe){const he=Y.context,pe=he.gl,de=Y.useProgram("atmosphere"),xe=new br(pe.LEQUAL,br.ReadOnly,[0,1]),Ee=Y.transform,ve=(function(Je,Ct){const Dt=Je.properties.get("position"),ut=[-Dt.x,-Dt.y,-Dt.z],Zt=c.ar(new Float64Array(16));return Je.properties.get("anchor")==="map"&&(c.bg(Zt,Zt,Ct.rollInRadians),c.bh(Zt,Zt,-Ct.pitchInRadians),c.bg(Zt,Zt,Ct.bearingInRadians),c.bh(Zt,Zt,Ct.center.lat*Math.PI/180),c.bJ(Zt,Zt,-Ct.center.lng*Math.PI/180)),c.cg(ut,ut,Zt),ut})(oe,Y.transform),Pe=Ee.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),De=re.properties.get("atmosphere-blend")*Pe.projectionTransition;if(De===0)return;const we=gu(Ee.worldSize,Ee.center.lat),Re=Ee.inverseProjectionMatrix,Qe=new Float64Array(4);Qe[3]=1,c.aH(Qe,Qe,Ee.modelViewProjectionMatrix),Qe[0]/=Qe[3],Qe[1]/=Qe[3],Qe[2]/=Qe[3],Qe[3]=1,c.aH(Qe,Qe,Re),Qe[0]/=Qe[3],Qe[1]/=Qe[3],Qe[2]/=Qe[3],Qe[3]=1;const Ye=((Je,Ct,Dt,ut,Zt)=>({u_sun_pos:Je,u_atmosphere_blend:Ct,u_globe_position:Dt,u_globe_radius:ut,u_inv_proj_matrix:Zt}))(ve,De,[Qe[0],Qe[1],Qe[2]],we,Re),He=up(he,re);de.draw(he,pe.TRIANGLES,xe,Br.disabled,sn.alphaBlended,Dr.disabled,Ye,null,null,"atmosphere",He.vertexBuffer,He.indexBuffer,He.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Y=(function(re,oe){let he=null;const pe=Object.values(re._layers).flatMap((ve=>ve.source&&!ve.isHidden(oe)?[re.tileManagers[ve.source]]:[])),de=pe.filter((ve=>ve.getSource().type==="vector")),xe=pe.filter((ve=>ve.getSource().type!=="vector")),Ee=ve=>{(!he||he.getSource().maxzoom<ve.getSource().maxzoom)&&(he=ve)};return de.forEach((ve=>Ee(ve))),he||xe.forEach((ve=>Ee(ve))),he})(this.style,this.transform.zoom);Y&&(function(re,oe,he){for(let pe=0;pe<he.length;pe++)sp(re,oe,he[pe])})(this,Y,Y.getVisibleCoordinates())}this.options.showPadding&&(function(Y){const re=Y.transform.padding;ol(Y,Y.transform.height-(re.top||0),3,Os),ol(Y,re.bottom||0,3,Yf),Pi(Y,re.left||0,3,Xf),Pi(Y,Y.transform.width-(re.right||0),3,xo);const oe=Y.transform.centerPoint;(function(he,pe,de,xe){Bl(he,pe-1,de-10,2,20,xe),Bl(he,pe-10,de-1,20,2,xe)})(Y,oe.x,Y.transform.height-oe.y,Ph)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=n?!c.cj(u,d):!c.ck(u,d)),v||(v=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(c.cl(u,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(T,A){const O=T.context,R=O.gl,B=T.transform,V=sn.unblended,X=new br(R.LEQUAL,br.ReadWrite,[0,1]),Y=A.tileManager.getRenderableTiles(),re=T.useProgram("terrainDepth");O.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:c.bp.transparent,depth:1});for(const oe of Y){const he=A.getTerrainMesh(oe.tileID),pe=A.getTerrainData(oe.tileID),de=B.getProjectionData({overscaledTileID:oe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xe={u_ele_delta:A.getMeshFrameDelta(B.zoom)};re.draw(O,R.TRIANGLES,X,Br.disabled,V,Dr.backCCW,xe,pe,de,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain),(function(T,A){const O=T.context,R=O.gl,B=T.transform,V=sn.unblended,X=new br(R.LEQUAL,br.ReadWrite,[0,1]),Y=A.getCoordsTexture(),re=A.tileManager.getRenderableTiles(),oe=T.useProgram("terrainCoords");O.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:c.bp.transparent,depth:1}),A.coordsIndex=[];for(const he of re){const pe=A.getTerrainMesh(he.tileID),de=A.getTerrainData(he.tileID);O.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,Y.texture);const xe={u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(B.zoom)},Ee=B.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});oe.draw(O,R.TRIANGLES,X,Br.disabled,V,Dr.backCCW,xe,de,Ee,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments),A.coordsIndex.push(he.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain))}renderLayer(n,u,d,v,T){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(v||[]).length)&&(this.id=d.id,c.cm(d)?(function(A,O,R,B,V,X){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=X,re=Br.disabled,oe=A.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(he,pe,de,xe,Ee,ve,Pe,De,we){const Re=pe.transform,Qe=pe.style.map.terrain,Ye=Ee==="map",He=ve==="map";for(const Je of he){const Ct=xe.getTile(Je),Dt=Ct.getBucket(de);if(!Dt||!Dt.text||!Dt.text.segments.get().length)continue;const ut=c.ay(Dt.textSizeData,Re.zoom),Zt=c.aN(Ct,1,pe.transform.zoom),vr=Zs(Ye,pe.transform,Zt),Xr=de.layout.get("icon-text-fit")!=="none"&&Dt.hasIconData();if(ut){const vn=Math.pow(2,Re.zoom-Ct.tileID.overscaledZ),dn=Qe?(Sn,tn)=>Qe.getElevation(Je,Sn,tn):null;op(Dt,Ye,He,we,Re,vr,vn,ut,Xr,c.aO(Re,Ct,Pe,De),Je.toUnwrapped(),dn)}}})(B,A,R,O,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),V),R.paint.get("icon-opacity").constantOr(1)!==0&&Sc(A,O,R,B,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),re,oe,Y),R.paint.get("text-opacity").constantOr(1)!==0&&Sc(A,O,R,B,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),re,oe,Y),O.map.showCollisionBoxes&&(rs(A,O,R,B,!0),rs(A,O,R,B,!1))})(n,u,d,v,this.style.placement.variableOffsets,T):c.cn(d)?(function(A,O,R,B,V){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:X}=V,Y=R.paint.get("circle-opacity"),re=R.paint.get("circle-stroke-width"),oe=R.paint.get("circle-stroke-opacity"),he=!R.layout.get("circle-sort-key").isConstant();if(Y.constantOr(1)===0&&(re.constantOr(1)===0||oe.constantOr(1)===0))return;const pe=A.context,de=pe.gl,xe=A.transform,Ee=A.getDepthModeForSublayer(0,br.ReadOnly),ve=Br.disabled,Pe=A.colorModeForRenderPass(),De=[],we=xe.getCircleRadiusCorrection();for(let Re=0;Re<B.length;Re++){const Qe=B[Re],Ye=O.getTile(Qe),He=Ye.getBucket(R);if(!He)continue;const Je=R.paint.get("circle-translate"),Ct=R.paint.get("circle-translate-anchor"),Dt=c.aO(xe,Ye,Je,Ct),ut=He.programConfigurations.get(R.id),Zt=A.useProgram("circle",ut),vr=He.layoutVertexBuffer,Xr=He.indexBuffer,vn=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Qe),dn={programConfiguration:ut,program:Zt,layoutVertexBuffer:vr,indexBuffer:Xr,uniformValues:Dl(A,Ye,R,Dt,we),terrainData:vn,projectionData:xe.getProjectionData({overscaledTileID:Qe,applyGlobeMatrix:!X,applyTerrainMatrix:!0})};if(he){const Sn=He.segments.get();for(const tn of Sn)De.push({segments:new c.aX([tn]),sortKey:tn.sortKey,state:dn})}else De.push({segments:He.segments,sortKey:0,state:dn})}he&&De.sort(((Re,Qe)=>Re.sortKey-Qe.sortKey));for(const Re of De){const{programConfiguration:Qe,program:Ye,layoutVertexBuffer:He,indexBuffer:Je,uniformValues:Ct,terrainData:Dt,projectionData:ut}=Re.state;Ye.draw(pe,de.TRIANGLES,Ee,ve,Pe,Dr.backCCW,Ct,Dt,ut,R.id,He,Je,Re.segments,R.paint,A.transform.zoom,Qe)}})(n,u,d,v,T):c.co(d)?(function(A,O,R,B,V){if(R.paint.get("heatmap-opacity")===0)return;const X=A.context,{isRenderingToTexture:Y,isRenderingGlobe:re}=V;if(A.style.map.terrain){for(const oe of B){const he=O.getTile(oe);O.hasRenderableParent(oe)||(A.renderPass==="offscreen"?Li(A,he,R,oe,re):A.renderPass==="translucent"&&yn(A,R,oe,Y,re))}X.viewport.set([0,0,A.width,A.height])}else A.renderPass==="offscreen"?(function(oe,he,pe,de){const xe=oe.context,Ee=xe.gl,ve=oe.transform,Pe=Br.disabled,De=new sn([Ee.ONE,Ee.ONE],c.bp.transparent,[!0,!0,!0,!0]);(function(we,Re,Qe){const Ye=we.gl;we.activeTexture.set(Ye.TEXTURE1),we.viewport.set([0,0,Re.width/4,Re.height/4]);let He=Qe.heatmapFbos.get(c.cd);He?(Ye.bindTexture(Ye.TEXTURE_2D,He.colorAttachment.get()),we.bindFramebuffer.set(He.framebuffer)):(He=Rr(we,Re.width/4,Re.height/4),Qe.heatmapFbos.set(c.cd,He))})(xe,oe,pe),xe.clear({color:c.bp.transparent});for(let we=0;we<de.length;we++){const Re=de[we];if(he.hasRenderableParent(Re))continue;const Qe=he.getTile(Re),Ye=Qe.getBucket(pe);if(!Ye)continue;const He=Ye.programConfigurations.get(pe.id),Je=oe.useProgram("heatmap",He),Ct=ve.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Dt=ve.getCircleRadiusCorrection();Je.draw(xe,Ee.TRIANGLES,br.disabled,Pe,De,Dr.backCCW,Kd(Qe,ve.zoom,pe.paint.get("heatmap-intensity"),Dt),null,Ct,pe.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,pe.paint,ve.zoom,He)}xe.viewport.set([0,0,oe.width,oe.height])})(A,O,R,B):A.renderPass==="translucent"&&(function(oe,he){const pe=oe.context,de=pe.gl;pe.setColorMode(oe.colorModeForRenderPass());const xe=he.heatmapFbos.get(c.cd);xe&&(pe.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,xe.colorAttachment.get()),pe.activeTexture.set(de.TEXTURE1),tl(pe,he).bind(de.LINEAR,de.CLAMP_TO_EDGE),oe.useProgram("heatmapTexture").draw(pe,de.TRIANGLES,br.disabled,Br.disabled,oe.colorModeForRenderPass(),Dr.disabled,yc(oe,he,0,1),null,null,he.id,oe.viewportBuffer,oe.quadTriangleIndexBuffer,oe.viewportSegments,he.paint,oe.transform.zoom))})(A,R)})(n,u,d,v,T):c.cp(d)?(function(A,O,R,B,V){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:X}=V,Y=R.paint.get("line-opacity"),re=R.paint.get("line-width");if(Y.constantOr(1)===0||re.constantOr(1)===0)return;const oe=A.getDepthModeForSublayer(0,br.ReadOnly),he=A.colorModeForRenderPass(),pe=R.paint.get("line-dasharray"),de=pe.constantOr(1),xe=R.paint.get("line-pattern"),Ee=xe.constantOr(1),ve=R.paint.get("line-gradient"),Pe=R.getCrossfadeParameters();let De;De=Ee?"linePattern":de&&ve?"lineGradientSDF":de?"lineSDF":ve?"lineGradient":"line";const we=A.context,Re=we.gl,Qe=A.transform;let Ye=!0;for(const He of B){const Je=O.getTile(He);if(Ee&&!Je.patternsLoaded())continue;const Ct=Je.getBucket(R);if(!Ct)continue;const Dt=Ct.programConfigurations.get(R.id),ut=A.context.program.get(),Zt=A.useProgram(De,Dt),vr=Ye||Zt.program!==ut,Xr=A.style.map.terrain&&A.style.map.terrain.getTerrainData(He),vn=xe.constantOr(null),dn=pe&&pe.constantOr(null);if(vn&&Je.imageAtlas){const Di=Je.imageAtlas,Vn=Di.patternPositions[vn.to.toString()],qn=Di.patternPositions[vn.from.toString()];Vn&&qn&&Dt.setConstantPatternPositions(Vn,qn)}else if(dn){const Di=R.layout.get("line-cap")==="round",Vn=A.lineAtlas.getDash(dn.to,Di),qn=A.lineAtlas.getDash(dn.from,Di);Dt.setConstantDashPositions(Vn,qn)}const Sn=Qe.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),tn=Qe.getPixelScale();let fi;Ee?(fi=Fa(A,Je,R,tn,Pe),Fn(we,Re,Je,Dt,Pe)):de&&ve?(fi=As(A,Je,R,tn,Pe,Ct.lineClipsArray.length),Wf(A,O,we,Re,R,Ct,He,Dt,Pe)):de?(fi=Il(A,Je,R,tn,Pe),qa(A,we,Re,Dt,vr,Pe)):ve?(fi=Qd(A,Je,R,tn,Ct.lineClipsArray.length),$a(A,O,we,Re,R,Ct,He)):fi=xh(A,Je,R,tn);const jn=A.stencilModeForClipping(He);Zt.draw(we,Re.TRIANGLES,oe,jn,he,Dr.disabled,fi,Xr,Sn,R.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,R.paint,A.transform.zoom,Dt,Ct.layoutVertexBuffer2),Ye=!1}})(n,u,d,v,T):c.cq(d)?(function(A,O,R,B,V){const X=R.paint.get("fill-color"),Y=R.paint.get("fill-opacity");if(Y.constantOr(1)===0)return;const{isRenderingToTexture:re}=V,oe=A.colorModeForRenderPass(),he=R.paint.get("fill-pattern"),pe=A.opaquePassEnabledForLayer()&&!he.constantOr(1)&&X.constantOr(c.bp.transparent).a===1&&Y.constantOr(0)===1?"opaque":"translucent";if(A.renderPass===pe){const de=A.getDepthModeForSublayer(1,A.renderPass==="opaque"?br.ReadWrite:br.ReadOnly);rl(A,O,R,B,de,oe,!1,re)}if(A.renderPass==="translucent"&&R.paint.get("fill-antialias")){const de=A.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,br.ReadOnly);rl(A,O,R,B,de,oe,!0,re)}})(n,u,d,v,T):c.cr(d)?(function(A,O,R,B,V){const X=R.paint.get("fill-extrusion-opacity");if(X===0)return;const{isRenderingToTexture:Y}=V;if(A.renderPass==="translucent"){const re=new br(A.context.gl.LEQUAL,br.ReadWrite,A.depthRangeFor3D);if(X!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))Ds(A,O,R,B,re,Br.disabled,sn.disabled,Y),Ds(A,O,R,B,re,A.stencilModeFor3D(),A.colorModeForRenderPass(),Y);else{const oe=A.colorModeForRenderPass();Ds(A,O,R,B,re,Br.disabled,oe,Y)}}})(n,u,d,v,T):c.cs(d)?(function(A,O,R,B,V){if(A.renderPass!=="offscreen"&&A.renderPass!=="translucent")return;const{isRenderingToTexture:X}=V,Y=A.context,re=A.style.projection.useSubdivision,oe=A.getDepthModeForSublayer(0,br.ReadOnly),he=A.colorModeForRenderPass();if(A.renderPass==="offscreen")(function(pe,de,xe,Ee,ve,Pe,De){const we=pe.context,Re=we.gl;for(const Qe of xe){const Ye=de.getTile(Qe),He=Ye.dem;if(!He||!He.data||!Ye.needsHillshadePrepare)continue;const Je=He.dim,Ct=He.stride,Dt=He.getPixels();if(we.activeTexture.set(Re.TEXTURE1),we.pixelStoreUnpackPremultiplyAlpha.set(!1),Ye.demTexture=Ye.demTexture||pe.getTileTexture(Ct),Ye.demTexture){const Zt=Ye.demTexture;Zt.update(Dt,{premultiply:!1}),Zt.bind(Re.NEAREST,Re.CLAMP_TO_EDGE)}else Ye.demTexture=new c.T(we,Dt,Re.RGBA,{premultiply:!1}),Ye.demTexture.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);we.activeTexture.set(Re.TEXTURE0);let ut=Ye.fbo;if(!ut){const Zt=new c.T(we,{width:Je,height:Je,data:null},Re.RGBA);Zt.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ut=Ye.fbo=we.createFramebuffer(Je,Je,!0,!1),ut.colorAttachment.set(Zt.texture)}we.bindFramebuffer.set(ut.framebuffer),we.viewport.set([0,0,Je,Je]),pe.useProgram("hillshadePrepare").draw(we,Re.TRIANGLES,ve,Pe,De,Dr.disabled,iy(Ye.tileID,He),null,null,Ee.id,pe.rasterBoundsBuffer,pe.quadTriangleIndexBuffer,pe.rasterBoundsSegments),Ye.needsHillshadePrepare=!1}})(A,O,B,R,oe,Br.disabled,he),Y.viewport.set([0,0,A.width,A.height]);else if(A.renderPass==="translucent")if(re){const[pe,de,xe]=A.stencilConfigForOverlapTwoPass(B);nl(A,O,R,xe,pe,oe,he,!1,X),nl(A,O,R,xe,de,oe,he,!0,X)}else{const[pe,de]=A.getStencilConfigForOverlapAndUpdateStencilID(B);nl(A,O,R,de,pe,oe,he,!1,X)}})(n,u,d,v,T):c.ct(d)?(function(A,O,R,B,V){if(A.renderPass!=="translucent"||!B.length)return;const{isRenderingToTexture:X}=V,Y=A.style.projection.useSubdivision,re=A.getDepthModeForSublayer(0,br.ReadOnly),oe=A.colorModeForRenderPass();if(Y){const[he,pe,de]=A.stencilConfigForOverlapTwoPass(B);il(A,O,R,de,he,re,oe,!1,X),il(A,O,R,de,pe,re,oe,!0,X)}else{const[he,pe]=A.getStencilConfigForOverlapAndUpdateStencilID(B);il(A,O,R,pe,he,re,oe,!1,X)}})(n,u,d,v,T):c.bU(d)?(function(A,O,R,B,V){if(A.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!B.length)return;const{isRenderingToTexture:X}=V,Y=O.getSource(),re=A.style.projection.useSubdivision;if(Y instanceof co)_o(A,O,R,B,null,!1,!1,Y.tileCoords,Y.flippedWindingOrder,X);else if(re){const[oe,he,pe]=A.stencilConfigForOverlapTwoPass(B);_o(A,O,R,pe,oe,!1,!0,ns,!1,X),_o(A,O,R,pe,he,!0,!0,ns,!1,X)}else{const[oe,he]=A.getStencilConfigForOverlapAndUpdateStencilID(B);_o(A,O,R,he,oe,!1,!0,ns,!1,X)}})(n,u,d,v,T):c.cu(d)?(function(A,O,R,B,V){const X=R.paint.get("background-color"),Y=R.paint.get("background-opacity");if(Y===0)return;const{isRenderingToTexture:re}=V,oe=A.context,he=oe.gl,pe=A.style.projection,de=A.transform,xe=de.tileSize,Ee=R.paint.get("background-pattern");if(A.isPatternMissing(Ee))return;const ve=!Ee&&X.a===1&&Y===1&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass!==ve)return;const Pe=Br.disabled,De=A.getDepthModeForSublayer(0,ve==="opaque"?br.ReadWrite:br.ReadOnly),we=A.colorModeForRenderPass(),Re=A.useProgram(Ee?"backgroundPattern":"background"),Qe=B||nn(de,{tileSize:xe,terrain:A.style.map.terrain});Ee&&(oe.activeTexture.set(he.TEXTURE0),A.imageManager.bind(A.context));const Ye=R.getCrossfadeParameters();for(const He of Qe){const Je=de.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),Ct=Ee?Jd(Y,A,Ee,{tileID:He,tileSize:xe},Ye):Sh(Y,X),Dt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(He),ut=pe.getMeshFromTileID(oe,He.canonical,!1,!0,"raster");Re.draw(oe,he.TRIANGLES,De,Pe,we,Dr.backCCW,Ct,Dt,Je,R.id,ut.vertexBuffer,ut.indexBuffer,ut.segments)}})(n,0,d,v,T):c.cv(d)&&(function(A,O,R,B){const{isRenderingGlobe:V}=B,X=A.context,Y=R.implementation,re=A.style.projection,oe=A.transform,he=oe.getProjectionDataForCustomLayer(V),pe={farZ:oe.farZ,nearZ:oe.nearZ,fov:oe.fov*Math.PI/180,modelViewProjectionMatrix:oe.modelViewProjectionMatrix,projectionMatrix:oe.projectionMatrix,shaderData:{variantName:re.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${re.shaderPreludeCode.vertexSource}`,define:re.shaderDefine},defaultProjectionData:he},de=Y.renderingMode?Y.renderingMode:"2d";if(A.renderPass==="offscreen"){const xe=Y.prerender;xe&&(A.setCustomLayerDefaults(),X.setColorMode(A.colorModeForRenderPass()),xe.call(Y,X.gl,pe),X.setDirty(),A.setBaseState())}else if(A.renderPass==="translucent"){A.setCustomLayerDefaults(),X.setColorMode(A.colorModeForRenderPass()),X.setStencilMode(Br.disabled);const xe=de==="3d"?A.getDepthModeFor3D():A.getDepthModeForSublayer(0,br.ReadOnly);X.setDepthMode(xe),Y.render(X.gl,pe),X.setDirty(),A.setBaseState(),X.bindFramebuffer.set(null)}})(n,0,d,T))}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),d=this.imageManager.getPattern(n.to.toString());return!u||!d}useProgram(n,u,d=!1,v=[]){this.cache=this.cache||{};const T=!!this.style.map.terrain,A=this.style.projection,O=d?Lr.projectionMercator:A.shaderPreludeCode,R=d?ki:A.shaderDefine,B=n+(u?u.cacheKey:"")+`/${d?ni:A.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(T?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[B]||(this.cache[B]=new ny(this.context,Lr[n],u,_u[n],this._showOverdrawInspector,T,O,R,v)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var n,u;if(this._tileTextures){for(const d in this._tileTextures){const v=this._tileTextures[d];if(v)for(const T of v)T.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((n=this.tileExtentMesh.vertexBuffer)===null||n===void 0||n.destroy()),this.tileExtentMesh&&((u=this.tileExtentMesh.indexBuffer)===null||u===void 0||u.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const d in this.cache){const v=this.cache[d];v&&v.program&&this.context.gl.deleteProgram(v.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}function ii(w,n){let u,d=!1,v=null,T=null;const A=()=>{v=null,d&&(w.apply(T,u),v=setTimeout(A,n),d=!1)};return(...O)=>(d=!0,T=this,u=O,v||A(),v)}class Eu{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let d;return u.split("&").map((v=>v.split("="))).forEach((v=>{v[0]===this._hashName&&(d=v)})),(d&&d[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:d,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const d=u.join("/");let v=d;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${d}`);let T=window.location.hash.replace(v,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let A=window.location.href.replace(/(#.+)?$/,T);A=A.replace("&&","&"),window.history.replaceState(window.history.state,null,A)},this._updateHash=ii(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const u=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,v=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),A=Math.round(u.lng*T)/T,O=Math.round(u.lat*T)/T,R=this._map.getBearing(),B=this._map.getPitch();let V="";if(V+=n?`/${A}/${O}/${d}`:`${d}/${O}/${A}`,(R||B)&&(V+="/"+Math.round(10*R)/10),B&&(V+=`/${Math.round(B)}`),this._hashName){const X=this._hashName;let Y=!1;const re=window.location.hash.slice(1).split("&").map((oe=>{const he=oe.split("=")[0];return he===X?(Y=!0,`${he}=${V}`):oe})).filter((oe=>oe));return Y||re.push(`${X}=${V}`),`#${re.join("&")}`}return`#${V}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new c.V(+n[2],+n[1])}catch{return!1}const u=+n[0],d=+(n[3]||0),v=+(n[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&d>=-180&&d<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const Is={linearity:.3,easing:c.cw(0,0,.3,1)},na=c.e({deceleration:2500,maxSpeed:1400},Is),bo=c.e({deceleration:20,maxSpeed:1400},Is),Au=c.e({deceleration:1e3,maxSpeed:360},Is),ia=c.e({deceleration:1e3,maxSpeed:90},Is),ay=c.e({deceleration:1e3,maxSpeed:360},Is);class _m{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:W(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=W();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)u.zoom+=T.zoomDelta||0,u.bearing+=T.bearingDelta||0,u.pitch+=T.pitchDelta||0,u.roll+=T.rollDelta||0,T.panDelta&&u.pan._add(T.panDelta),T.around&&(u.around=T.around),T.pinchAround&&(u.pinchAround=T.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){const T=is(u.pan.mag(),d,c.e({},na,n||{})),A=u.pan.mult(T.amount/u.pan.mag()),O=this._map.cameraHelper.handlePanInertia(A,this._map.transform);v.center=O.easingCenter,v.offset=O.easingOffset,Ch(v,T)}if(u.zoom){const T=is(u.zoom,d,bo),A=c.cx(this._map.transform.zoom+T.amount,this._map.getZoomSnap(),T.amount);v.zoom=A,Ch(v,T)}if(u.bearing){const T=is(u.bearing,d,Au);v.bearing=this._map.transform.bearing+c.an(T.amount,-179,179),Ch(v,T)}if(u.pitch){const T=is(u.pitch,d,ia);v.pitch=this._map.transform.pitch+T.amount,Ch(v,T)}if(u.roll){const T=is(u.roll,d,ay);v.roll=this._map.transform.roll+c.an(T.amount,-179,179),Ch(v,T)}if(v.zoom||v.bearing){const T=u.pinchAround===void 0?u.around:u.pinchAround;v.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),c.e(v,{noMoveStart:!0})}}function Ch(w,n){(!w.duration||w.duration<n.duration)&&(w.duration=n.duration,w.easing=n.easing)}function is(w,n,u){const{maxSpeed:d,linearity:v,deceleration:T}=u,A=c.an(w*v/(n/1e3),-d,d),O=Math.abs(A)/(T*v);return{easing:u.easing,duration:1e3*O,amount:A*(O/2)}}class Ci extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,d,v={}){d=d instanceof MouseEvent?d:new MouseEvent(n,d);const T=q.mousePos(u.getCanvas(),d),A=u.unproject(T);super(n,c.e({point:T,lngLat:A,originalEvent:d},v)),this._defaultPrevented=!1,this.target=u}}class Mu extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,d){const v=n==="touchend"?d.changedTouches:d.touches,T=q.touchPos(u.getCanvasContainer(),v),A=T.map((R=>u.unproject(R))),O=T.reduce(((R,B,V,X)=>R.add(B.div(X.length))),new c.P(0,0));super(n,{points:T,point:O,lngLats:A,lngLat:u.unproject(O),originalEvent:d}),this._defaultPrevented=!1}}class Dh extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,d){super(n,{originalEvent:d}),this._defaultPrevented=!1}}class xm{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Dh(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Ci(n.type,this._map,n))}mouseup(n){this._map.fire(new Ci(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Ci(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Ci(n.type,this._map,n))}mouseover(n){this._map.fire(new Ci(n.type,this._map,n))}mouseout(n){this._map.fire(new Ci(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Mu(n.type,this._map,n))}touchmove(n){this._map.fire(new Mu(n.type,this._map,n))}touchend(n){this._map.fire(new Mu(n.type,this._map,n))}touchcancel(n){this._map.fire(new Mu(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pu{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Ci(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Ci(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class as{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(c.P.convert(n),this._map.terrain)}}class wo{constructor(n,u){this._map=n,this._tr=new as(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(q.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const d=u;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=d,this._box||(this._box=q.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const T=Math.min(v.x,d.x),A=Math.max(v.x,d.x),O=Math.min(v.y,d.y),R=Math.max(v.y,d.y);q.setTransform(this._box,`translate(${T}px,${O}px)`),this._box.style.width=A-T+"px",this._box.style.height=R-O+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const d=this._startPos,v=u;if(this.reset(),q.suppressClick(),d.x!==v.x||d.y!==v.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:n})),{cameraAnimation:T=>T.fitScreenCoordinates(d,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new c.l(n,{originalEvent:u}))}}function jt(w,n){if(w.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${n.length}`);const u={};for(let d=0;d<w.length;d++)u[w[d].identifier]=n[d];return u}class cp{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=(function(v){const T=new c.P(0,0);for(const A of v)T._add(A);return T.div(v.length)})(u),this.touches=jt(d,u)))}touchmove(n,u,d){if(this.aborted||!this.centroid)return;const v=jt(d,u);for(const T in this.touches){const A=v[T];(!A||A.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(n,u,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Tc{constructor(n){this.singleTap=new cp(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,d){this.singleTap.touchstart(n,u,d)}touchmove(n,u,d){this.singleTap.touchmove(n,u,d)}touchend(n,u,d){const v=this.singleTap.touchend(n,u,d);if(v){const T=n.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(v)<30;if(T&&A||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Fl{constructor(n){this._tr=new as(n),this._zoomIn=new Tc({numTouches:1,numTaps:2}),this._zoomOut=new Tc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,d){this._zoomIn.touchstart(n,u,d),this._zoomOut.touchstart(n,u,d)}touchmove(n,u,d){this._zoomIn.touchmove(n,u,d),this._zoomOut.touchmove(n,u,d)}touchend(n,u,d){const v=this._zoomIn.touchend(n,u,d),T=this._zoomOut.touchend(n,u,d),A=this._tr;return v?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:c.cx(A.zoom+1,O.getZoomSnap()),around:A.unproject(v)},{originalEvent:n})}):T?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:c.cx(A.zoom-1,O.getZoomSnap()),around:A.unproject(T)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ta{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const v=Array.isArray(u)?u[0]:u;return!this._moved&&v.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(d,v))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&q.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ec=0,Kf=2,Ac={[Ec]:1,[Kf]:2};class os{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=q.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!(function(u,d){const v=Ac[d];return u.buttons===void 0||(u.buttons&v)!==v})(n,this._eventButton)}isValidEndEvent(n){return q.mouseButton(n)===this._eventButton}}class Oh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class Cu{constructor(n=new os({checkCorrectEvent:()=>!0}),u=new Oh){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(n,u,d){return n instanceof MouseEvent?u(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?d(n):void 0}startMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const Du=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=n=>{n.preventDefault()}};class hp{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,u,d){return this._calculateTransform(n,u,d)}touchmove(n,u,d){if(this._active){if(!this._shouldBePrevented(d.length))return n.preventDefault(),this._calculateTransform(n,u,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,u,d){this._calculateTransform(n,u,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,d){d.length>0&&(this._active=!0);const v=jt(d,u),T=new c.P(0,0),A=new c.P(0,0);let O=0;for(const B in v){const V=v[B],X=this._touches[B];X&&(T._add(V),A._add(V.sub(X)),O++,v[B]=V)}if(this._touches=v,this._shouldBePrevented(O)||!A.mag())return;const R=A.div(O);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,d){if(!this._firstTwoTouches)return;n.preventDefault();const[v,T]=this._firstTwoTouches,A=Ih(d,u,v),O=Ih(d,u,T);if(!A||!O)return;const R=this._aroundCenter?null:A.add(O).div(2);return this._move([A,O],R,n)}touchend(n,u,d){if(!this._firstTwoTouches)return;const[v,T]=this._firstTwoTouches,A=Ih(d,u,v),O=Ih(d,u,T);A&&O||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ih(w,n,u){for(let d=0;d<w.length;d++)if(w[d].identifier===u)return n[d]}function zs(w,n){return Math.log(w/n)/Math.LN2}class Qf extends sl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(zs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zs(this._distance,d),pinchAround:u}}}function zh(w,n){return 180*w.angleWith(n)/Math.PI}class ll extends sl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,d){const v=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zh(this._vector,v),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,d=zh(n,this._startVector);return Math.abs(d)<u}}function ks(w){return Math.abs(w.y)>Math.abs(w.x)}class So extends sl{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,d){super.touchstart(n,u,d),this._currentTouchCount=d.length}_start(n){this._lastPoints=n,ks(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=n[0].sub(this._lastPoints[0]),T=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,T,d.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,d){if(this._valid!==void 0)return this._valid;const v=n.mag()>=2,T=u.mag()>=2;if(!v&&!T)return;if(!v||!T)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const A=n.y>0==u.y>0;return ks(n)&&ks(u)&&A}}const ln={panStep:100,bearingStep:15,pitchStep:10};class Jf{constructor(n){this._tr=new as(n);const u=ln;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,d=0,v=0,T=0,A=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),T=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),T=1);break;case 38:n.shiftKey?v=1:(n.preventDefault(),A=-1);break;case 40:n.shiftKey?v=-1:(n.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(d=0,v=0),{cameraAnimation:O=>{const R=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:Ul,zoom:u?c.cx(R.zoom+u*(n.shiftKey?2:1),O.getZoomSnap()):R.zoom,bearing:R.bearing+d*this._bearingStep,pitch:R.pitch+v*this._pitchStep,offset:[-T*this._panStep,-A*this._panStep],center:R.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ul(w){return w*(2-w)}const ul=4.000244140625,ed=1/450;class td{constructor(n,u){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=n,this._tr=new as(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ed}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=W(),v=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,u!==0&&u%ul==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=q.mousePos(this._map.getCanvas(),n),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(c.V.convert(d.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const O=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=O),typeof this._targetZoom=="number"&&(this._targetZoom+=O)}if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>ul?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&R!==0&&(R=1/R);const B=typeof this._targetZoom!="number"?n.scale:c.aq(this._targetZoom),V=n.applyConstrain(n.getCameraLngLat(),c.at(B*R)).zoom,X=this._map.getZoomSnap();if(this._type==="wheel"&&X>0){const Y=c.cx(n.zoom,X);this._targetZoom=c.cx(V,X,V-Y)}else this._targetZoom=V;this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,d=this._startZoom,v=this._easing;let T,A=!1;if(this._type==="wheel"&&d&&v){const O=W()-this._lastWheelEventTime,R=Math.min((O+5)/200,1),B=v(R);T=c.G.number(d,u,B),R<1?this._frameId||(this._frameId=!0):A=!0}else T=u,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=T,{noInertia:!0,needsRenderFrame:!A,zoomDelta:T-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=c.cz;if(this._prevEase){const d=this._prevEase,v=(W()-d.start)/d.duration,T=d.easing(v+.01)-d.easing(v),A=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-A*A);u=c.cw(A,O,.25,1)}return this._prevEase={start:W(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Vl{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class kh{constructor(n){this._tr=new as(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:c.cx(this._tr.zoom+(n.shiftKey?-1:1),d.getZoomSnap()),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bm{constructor(){this._tap=new Tc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,d){if(!this._swipePoint)if(this._tapTime){const v=u[0],T=n.timeStamp-this._tapTime<500,A=this._tapPoint.dist(v)<30;T&&A?d.length>0&&(this._swipePoint=v,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(n,u,d)}touchmove(n,u,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const v=u[0],T=v.y-this._swipePoint.y;return this._swipePoint=v,n.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(n,u,d)}touchend(n,u,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const v=this._tap.touchend(n,u,d);v&&(this._tapTime=n.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class To{constructor(n,u,d){this._el=n,this._mousePan=u,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ou{constructor(n,u,d,v){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=u,this._mousePitch=d,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Bt{constructor(n,u,d,v){this._el=n,this._touchZoom=u,this._touchRotate=d,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Kt{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=q.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=u,this._container.appendChild(v);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=d,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(q.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,u){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:n,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Ea=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class rd extends c.l{}function Iu(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class ai{get _ownerDocument(){var n;return((n=this._el)===null||n===void 0?void 0:n.ownerDocument)||document}get _ownerWindow(){var n,u;return((u=(n=this._el)===null||n===void 0?void 0:n.ownerDocument)===null||u===void 0?void 0:u.defaultView)||window}constructor(n,u){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,T)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=v.type==="renderFrame"?void 0:v,O={needsRenderFrame:!1},R={},B={};for(const{handlerName:Y,handler:re,allowed:oe}of this._handlers){if(!re.isEnabled())continue;let he;if(this._blockedByActive(B,oe,Y))re.reset();else if(re[T||v.type]){if(c.cA(v,T||v.type)){const pe=q.mousePos(this._map.getCanvas(),v);he=re[T||v.type](v,pe)}else if(c.cB(v,T||v.type)){const pe=this._getMapTouches(v.touches),de=q.touchPos(this._map.getCanvas(),pe);he=re[T||v.type](v,de,pe)}else c.cC(T||v.type)||(he=re[T||v.type](v));this.mergeHandlerResult(O,R,he,Y,A),he&&he.needsRenderFrame&&this._triggerRenderFrame()}(he||re.isActive())&&(B[Y]=re)}const V={};for(const Y in this._previousActiveHandlers)B[Y]||(V[Y]=A);this._previousActiveHandlers=B,(Object.keys(V).length||Iu(O))&&(this._changes.push([O,R,V]),this._triggerRenderFrame()),(Object.keys(B).length||Iu(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=O;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _m(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[this._ownerDocument,"mousemove",{capture:!0}],[this._ownerDocument,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[this._ownerWindow,"blur",void 0]];for(const[v,T,A]of this._listeners)q.addEventListener(v,T,v===this._ownerDocument?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[n,u,d]of this._listeners)q.removeEventListener(n,u,n===this._ownerDocument?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(n){const u=this._map,d=u.getCanvasContainer();this._add("mapEvent",new xm(u,n));const v=u.boxZoom=new wo(u,n);this._add("boxZoom",v),n.interactive&&n.boxZoom&&v.enable();const T=u.cooperativeGestures=new Kt(u,n.cooperativeGestures);this._add("cooperativeGestures",T),n.cooperativeGestures&&T.enable();const A=new Fl(u),O=new kh(u);u.doubleClickZoom=new Vl(O,A),this._add("tapZoom",A),this._add("clickZoom",O),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const R=new bm;this._add("tapDragZoom",R);const B=u.touchPitch=new So(u);this._add("touchPitch",B),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const V=()=>u.project(u.getCenter()),X=(function({enable:ve,clickTolerance:Pe,aroundCenter:De=!0,minPixelCenterThreshold:we=100,rotateDegreesPerPixelMoved:Re=.8},Qe){const Ye=new os({checkCorrectEvent:He=>q.mouseButton(He)===0&&He.ctrlKey||q.mouseButton(He)===2&&!He.ctrlKey});return new Ta({clickTolerance:Pe,move:(He,Je)=>{const Ct=Qe();if(De&&Math.abs(Ct.y-He.y)>we)return{bearingDelta:c.cy(new c.P(He.x,Je.y),Je,Ct)};let Dt=(Je.x-He.x)*Re;return De&&Je.y<Ct.y&&(Dt=-Dt),{bearingDelta:Dt}},moveStateManager:Ye,enable:ve,assignEvents:Du})})(n,V),Y=(function({enable:ve,clickTolerance:Pe,pitchDegreesPerPixelMoved:De=-.5}){const we=new os({checkCorrectEvent:Re=>q.mouseButton(Re)===0&&Re.ctrlKey||q.mouseButton(Re)===2});return new Ta({clickTolerance:Pe,move:(Re,Qe)=>({pitchDelta:(Qe.y-Re.y)*De}),moveStateManager:we,enable:ve,assignEvents:Du})})(n),re=(function({enable:ve,clickTolerance:Pe,rollDegreesPerPixelMoved:De=.3},we){const Re=new os({checkCorrectEvent:Qe=>q.mouseButton(Qe)===2&&Qe.ctrlKey});return new Ta({clickTolerance:Pe,move:(Qe,Ye)=>{const He=we();let Je=(Ye.x-Qe.x)*De;return Ye.y<He.y&&(Je=-Je),{rollDelta:Je}},moveStateManager:Re,enable:ve,assignEvents:Du})})(n,V);u.dragRotate=new Ou(n,X,Y,re),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate","mouseRoll"]),this._add("mouseRoll",re,["mousePitch"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const oe=(function({enable:ve,clickTolerance:Pe}){const De=new os({checkCorrectEvent:we=>q.mouseButton(we)===0&&!we.ctrlKey});return new Ta({clickTolerance:Pe,move:(we,Re)=>({around:Re,panDelta:Re.sub(we)}),activateOnStart:!0,moveStateManager:De,enable:ve,assignEvents:Du})})(n),he=new hp(n,u);u.dragPan=new To(d,oe,he),this._add("mousePan",oe),this._add("touchPan",he,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const pe=new ll,de=new Qf;u.touchZoomRotate=new Bt(d,de,pe,R),this._add("touchRotate",pe,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate),this._add("blockableMapEvent",new Pu(u));const xe=u.scrollZoom=new td(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xe,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const Ee=u.keyboard=new Jf(u);this._add("keyboard",Ee),n.interactive&&n.keyboard&&u.keyboard.enable()}_add(n,u,d){this._handlers.push({handlerName:n,handler:u,allowed:d}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ea(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,d){for(const v in n)if(v!==d&&(!u||u.indexOf(v)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const d of n)this._el.contains(d.target)&&u.push(d);return u}mergeHandlerResult(n,u,d,v,T){if(!d)return;c.e(n,d);const A={handlerName:v,originalEvent:d.originalEvent||T};d.zoomDelta!==void 0&&(u.zoom=A),d.panDelta!==void 0&&(u.drag=A),d.rollDelta!==void 0&&(u.roll=A),d.pitchDelta!==void 0&&(u.pitch=A),d.bearingDelta!==void 0&&(u.rotate=A)}_applyChanges(){const n={},u={},d={};for(const[v,T,A]of this._changes)v.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(v.panDelta)),v.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(n.rollDelta=(n.rollDelta||0)+v.rollDelta),v.around!==void 0&&(n.around=v.around),v.pinchAround!==void 0&&(n.pinchAround=v.pinchAround),v.noInertia&&(n.noInertia=v.noInertia),c.e(u,T),c.e(d,A);this._updateMapTransform(n,u,d),this._changes=[]}_updateMapTransform(n,u,d){const v=this._map,T=v._getTransformForUpdate(),A=v.terrain;if(!(Iu(n)||A&&this._terrainMovement))return this._fireEvents(u,d,!0);v._stop(!0);let{panDelta:O,zoomDelta:R,bearingDelta:B,pitchDelta:V,rollDelta:X,around:Y,pinchAround:re}=n;re!==void 0&&(Y=re),Y=Y||v.transform.centerPoint,A&&!T.isPointOnMapSurface(Y)&&(Y=T.centerPoint);const oe={panDelta:O,zoomDelta:R,rollDelta:X,pitchDelta:V,bearingDelta:B,around:Y};this._map.cameraHelper.useGlobeControls&&!T.isPointOnMapSurface(Y)&&(Y=T.centerPoint);const he=Y.distSqr(T.centerPoint)<.01?T.center:T.screenPointToLocation(O?Y.sub(O):Y);this._handleMapControls({terrain:A,tr:T,deltasForHelper:oe,preZoomAroundLoc:he,combinedEventsInProgress:u,panDelta:O}),v._applyUpdatedTransform(T),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,d,!0)}_handleMapControls({terrain:n,tr:u,deltasForHelper:d,preZoomAroundLoc:v,combinedEventsInProgress:T,panDelta:A}){const O=this._map.cameraHelper;if(O.handleMapControlsRollPitchBearingZoom(d,u),n)return O.useGlobeControls?(this._terrainMovement||!T.drag&&!T.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void O.handleMapControlsPan(d,u,v)):this._terrainMovement||!T.drag&&!T.zoom?void(T.drag&&this._terrainMovement&&A?u.setCenter(u.screenPointToLocation(u.centerPoint.sub(A))):O.handleMapControlsPan(d,u,v)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void O.handleMapControlsPan(d,u,v));O.handleMapControlsPan(d,u,v)}_fireEvents(n,u,d){const v=Ea(this._eventsInProgress),T=Ea(n),A={};for(const X in n){const{originalEvent:Y}=n[X];this._eventsInProgress[X]||(A[`${X}start`]=Y),this._eventsInProgress[X]=n[X]}!v&&T&&this._fireEvent("movestart",T.originalEvent);for(const X in A)this._fireEvent(X,A[X]);T&&this._fireEvent("move",T.originalEvent);for(const X in n){const{originalEvent:Y}=n[X];this._fireEvent(X,Y)}const O={};let R;for(const X in this._eventsInProgress){const{handlerName:Y,originalEvent:re}=this._eventsInProgress[X];this._handlersById[Y].isActive()||(delete this._eventsInProgress[X],R=u[Y]||re,O[`${X}end`]=R)}for(const X in O)this._fireEvent(X,O[X]);const B=Ea(this._eventsInProgress),V=(v||T)&&!B;if(V&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const X=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&X.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(X)}if(d&&V){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;!X||!X.essential&&G.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:R})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(X.bearing||this._map.getBearing())&&(X.bearing=0),X.freezeElevation=!0,this._map.easeTo(X,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new c.l(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{delete this._frameId,this.handleEvent(new rd("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Hn extends c.E{constructor(n,u,d){super(),this._renderFrameCallback=()=>{const v=Math.min((W()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=d.bearingSnap,this._zoomSnap=d.zoomSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(n,u){n.apply(this.transform,!0),this.transform=n,this.cameraHelper=u}getCenter(){return new c.V(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,u){return this.jumpTo({elevation:n},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,u,d){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},u),d)}panTo(n,u,d){return this.easeTo(c.e({center:n},u),d)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,d){return this.easeTo(c.e({zoom:n},u),d)}zoomIn(n,u){return this.zoomTo(c.cx(this.getZoom()+1,this._zoomSnap),n,u),this}zoomOut(n,u){return this.zoomTo(c.cx(this.getZoom()-1,this._zoomSnap),n,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,u){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new c.l("movestart",u)).fire(new c.l("move",u)).fire(new c.l("moveend",u))),this}getBearing(){return this.transform.bearing}setZoomSnap(n){return this._zoomSnap=n,this}getZoomSnap(){return this._zoomSnap}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,d){return this.easeTo(c.e({bearing:n},u),d)}resetNorth(n,u){return this.rotateTo(0,c.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}getRoll(){return this.transform.roll}setRoll(n,u){return this.jumpTo({roll:n},u),this}cameraForBounds(n,u){n=Tr.convert(n).adjustAntiMeridian();const d=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),d,u)}_cameraForBoxAndBearing(n,u,d,v){const T={top:0,bottom:0,right:0,left:0};if(typeof(v=c.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const B=v.padding;v.padding={top:B,bottom:B,right:B,left:B}}const A=c.e(T,v.padding);v.padding=A;const O=this.transform,R=new Tr(n,u);return this.cameraHelper.cameraForBoxAndBearing(v,A,R,d,O)}fitBounds(n,u,d){return this._fitInternal(this.cameraForBounds(n,u),u,d)}fitScreenCoordinates(n,u,d,v,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(n)),this.transform.screenPointToLocation(c.P.convert(u)),d,v),v,T)}_fitInternal(n,u,d){return n?(delete(u=c.e(n,u)).padding,u.linear?this.easeTo(u,d):this.flyTo(u,d)):this}jumpTo(n,u){this.stop();const d=this._getTransformForUpdate();let v=!1,T=!1,A=!1;const O=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,n);const R=d.zoom!==O;return"elevation"in n&&d.elevation!==+n.elevation&&d.setElevation(+n.elevation),"bearing"in n&&d.bearing!==+n.bearing&&(v=!0,d.setBearing(+n.bearing)),"pitch"in n&&d.pitch!==+n.pitch&&(T=!0,d.setPitch(+n.pitch)),"roll"in n&&d.roll!==+n.roll&&(A=!0,d.setRoll(+n.roll)),n.padding==null||d.isPaddingEqual(n.padding)||d.setPadding(n.padding),this._applyUpdatedTransform(d),this.fire(new c.l("movestart",u)).fire(new c.l("move",u)),R&&this.fire(new c.l("zoomstart",u)).fire(new c.l("zoom",u)).fire(new c.l("zoomend",u)),v&&this.fire(new c.l("rotatestart",u)).fire(new c.l("rotate",u)).fire(new c.l("rotateend",u)),T&&this.fire(new c.l("pitchstart",u)).fire(new c.l("pitch",u)).fire(new c.l("pitchend",u)),A&&this.fire(new c.l("rollstart",u)).fire(new c.l("roll",u)).fire(new c.l("rollend",u)),this.fire(new c.l("moveend",u))}calculateCameraOptionsFromTo(n,u,d,v=0){const T=c.a9.fromLngLat(n,u),A=c.a9.fromLngLat(d,v),O=A.x-T.x,R=A.y-T.y,B=A.z-T.z,V=Math.hypot(O,R,B);if(V===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(O,R),Y=c.at(this.transform.cameraToCenterDistance/V/this.transform.tileSize),re=180*Math.atan2(O,-R)/Math.PI;let oe=180*Math.acos(X/V)/Math.PI;return oe=B<0?90-oe:90+oe,{center:A.toLngLat(),elevation:v,zoom:Y,pitch:oe,bearing:re}}calculateCameraOptionsFromCameraLngLatAltRotation(n,u,d,v,T){const A=this.transform.calculateCenterFromCameraLngLatAlt(n,u,d,v);return{center:A.center,elevation:A.elevation,zoom:A.zoom,bearing:d,pitch:v,roll:T}}easeTo(n,u){this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.cz},n)).animate===!1||!n.essential&&G.prefersReducedMotion)&&(n.duration=0);const d=this._getTransformForUpdate(),v=this.getBearing(),T=d.pitch,A=d.roll,O="bearing"in n?this._normalizeBearing(n.bearing,v):v,R="pitch"in n?+n.pitch:T,B="roll"in n?this._normalizeBearing(n.roll,A):A,V="padding"in n?n.padding:d.padding,X=c.P.convert(n.offset);let Y,re;n.around&&(Y=c.V.convert(n.around),re=d.locationToScreenPoint(Y));const oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(d,{bearing:O,pitch:R,roll:B,padding:V,around:Y,aroundPoint:re,offsetAsPoint:X,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||v!==O,this._pitching=this._pitching||R!==T,this._rolling=this._rolling||B!==A,this._padding=!d.isPaddingEqual(V),this._zooming=this._zooming||he.isZooming,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,oe),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease((pe=>{he.easeFunc(pe),this.terrain&&!n.freezeElevation&&this._updateElevation(pe),this._applyUpdatedTransform(d),this._fireMoveEvents(u)}),(pe=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,pe)}),n),this}_prepareEase(n,u,d={}){this._moving=!0,u||d.moving||this.fire(new c.l("movestart",n)),this._zooming&&!d.zooming&&this.fire(new c.l("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new c.l("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new c.l("pitchstart",n)),this._rolling&&!d.rolling&&this.fire(new c.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(d-(u-(d*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.setElevation(c.G.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const u=n.getCameraLngLat(),d=n.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(u,n.zoom):0;if(d<v){const T=this.calculateCameraOptionsFromTo(u,v,n.center,n.elevation);return{pitch:T.pitch,zoom:T.zoom}}return{}}_applyUpdatedTransform(n){const u=[];if(u.push((v=>this._elevateCameraIfInsideTerrain(v))),this.transformCameraUpdate&&u.push((v=>this.transformCameraUpdate(v))),!u.length)return;const d=n.clone();for(const v of u){const T=d.clone(),{center:A,zoom:O,roll:R,pitch:B,bearing:V,elevation:X}=v(T);A&&T.setCenter(A),X!==void 0&&T.setElevation(X),O!==void 0&&T.setZoom(O),R!==void 0&&T.setRoll(R),B!==void 0&&T.setPitch(B),V!==void 0&&T.setBearing(V),d.apply(T,!1)}this.transform.apply(d,!1)}_fireMoveEvents(n){this.fire(new c.l("move",n)),this._zooming&&this.fire(new c.l("zoom",n)),this._rotating&&this.fire(new c.l("rotate",n)),this._pitching&&this.fire(new c.l("pitch",n)),this._rolling&&this.fire(new c.l("roll",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const d=this._zooming,v=this._rotating,T=this._pitching,A=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new c.l("zoomend",n)),v&&this.fire(new c.l("rotateend",n)),T&&this.fire(new c.l("pitchend",n)),A&&this.fire(new c.l("rollend",n)),this.fire(new c.l("moveend",n))}flyTo(n,u){if(!n.essential&&G.prefersReducedMotion){const Je=c.U(n,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Je,u)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cz},n);const d=this._getTransformForUpdate(),v=d.bearing,T=d.pitch,A=d.roll,O=d.padding,R="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:T,V="roll"in n?this._normalizeBearing(n.roll,A):A,X="padding"in n?n.padding:d.padding,Y=c.P.convert(n.offset);let re=d.centerPoint.add(Y);const oe=d.screenPointToLocation(re),he=this.cameraHelper.handleFlyTo(d,{bearing:R,pitch:B,roll:V,padding:X,locationAtOffset:oe,offsetAsPoint:Y,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let pe=n.curve;const de=Math.max(d.width,d.height),xe=de/he.scaleOfZoom,Ee=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(pe=Math.sqrt(de/he.scaleOfMinZoom/Ee*2));const ve=pe*pe;function Pe(Je){const Ct=(xe*xe-de*de+(Je?-1:1)*ve*ve*Ee*Ee)/(2*(Je?xe:de)*ve*Ee);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function De(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function we(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Re=Pe(!1);let Qe=function(Je){return we(Re)/we(Re+pe*Je)},Ye=function(Je){return de*((we(Re)*(De(Ct=Re+pe*Je)/we(Ct))-De(Re))/ve)/Ee;var Ct},He=(Pe(!0)-Re)/pe;if(Math.abs(Ee)<2e-6||!isFinite(He)){if(Math.abs(de-xe)<1e-6)return this.easeTo(n,u);const Je=xe<de?-1:1;He=Math.abs(Math.log(xe/de))/pe,Ye=()=>0,Qe=Ct=>Math.exp(Je*pe*Ct)}return n.duration="duration"in n?+n.duration:1e3*He/("screenSpeed"in n?+n.screenSpeed/pe:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=v!==R,this._pitching=B!==T,this._rolling=V!==A,this._padding=!d.isPaddingEqual(X),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease((Je=>{const Ct=Je*He,Dt=1/Qe(Ct),ut=Ye(Ct);this._rotating&&d.setBearing(c.G.number(v,R,Je)),this._pitching&&d.setPitch(c.G.number(T,B,Je)),this._rolling&&d.setRoll(c.G.number(A,V,Je)),this._padding&&(d.interpolatePadding(O,X,Je),re=d.centerPoint.add(Y)),he.easeFunc(Je,Dt,ut,re),this.terrain&&!n.freezeElevation&&this._updateElevation(Je),this._applyUpdatedTransform(d),this._fireMoveEvents(u)}),(()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,u)}return n||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(n,u,d){d.animate===!1||d.duration===0?(n(1),u()):(this._easeStart=W(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=c.W(n,-180,180);const d=Math.abs(n-u);return Math.abs(n-360-u)<d&&(n-=360),Math.abs(n+360-u)<d&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLat(c.V.convert(n),this.transform):null}}const Wn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rh{constructor(n=Wn){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=q.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=q.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const d=this._map._getUIString(`AttributionControl.${u}`);n.title=d,n.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map((v=>typeof v!="string"?"":v))):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const u=this._map.style.tileManagers;for(const v in u){const T=u[v];if(T.used||T.usedForTerrain){const A=T.getSource();A.attribution&&n.indexOf(A.attribution)<0&&n.push(A.attribution)}}n=n.filter((v=>String(v).trim())),n.sort(((v,T)=>v.length-T.length)),n=n.filter(((v,T)=>{for(let A=T+1;A<n.length;A++)if(n[A].indexOf(v)>=0)return!1;return!0}));const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=q.sanitize(d),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Rs{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const d=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=q.create("div","maplibregl-ctrl");const u=q.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Pr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,d=u?this._queue.concat(u):this._queue;for(const v of d)if(v.id===n)return void(v.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const d of u)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var en=c.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Er extends c.E{constructor(n){super(),this._lastTilesetChange=W(),this.tileManager=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(n,u){this.tileManager.update(n,u),this._renderableTilesKeys=[];const d={};for(const v of nn(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.tileManager._source.calculateTileZoom}))d[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),c.c7(v.terrainRttPosMatrix32f,0,c.a5,c.a5,0,0,1),this._tiles[v.key]=new qe(v,this.tileSize),this._lastTilesetChange=W());for(const v in this._tiles)d[v]||delete this._tiles[v]}freeRtt(n){for(const u in this._tiles){const d=this._tiles[u];(!n||d.tileID.equals(n)||d.tileID.isChildOf(n)||n.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((n=>this.getTileByID(n)))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,u){return u?this._getTerrainCoordsForTileRanges(n,u):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const u={};for(const d of this._renderableTilesKeys){const v=this._tiles[d].tileID,T=n.clone(),A=c.bk();if(v.canonical.equals(n.canonical))c.c7(A,0,c.a5,c.a5,0,0,1);else if(v.canonical.isChildOf(n.canonical)){const O=v.canonical.z-n.canonical.z,R=v.canonical.x-(v.canonical.x>>O<<O),B=v.canonical.y-(v.canonical.y>>O<<O),V=c.a5>>O;c.c7(A,0,V,V,0,0,1),c.O(A,A,[-R*V,-B*V,0])}else{if(!n.canonical.isChildOf(v.canonical))continue;{const O=n.canonical.z-v.canonical.z,R=n.canonical.x-(n.canonical.x>>O<<O),B=n.canonical.y-(n.canonical.y>>O<<O),V=c.a5>>O;c.c7(A,0,c.a5,c.a5,0,0,1),c.O(A,A,[R*V,B*V,0]),c.Q(A,A,[1/2**O,1/2**O,0])}}T.terrainRttPosMatrix32f=new Float32Array(A),u[d]=T}return u}_getTerrainCoordsForTileRanges(n,u){const d={};for(const v of this._renderableTilesKeys){const T=this._tiles[v].tileID;if(!this._isWithinTileRanges(T,u))continue;const A=n.clone(),O=c.bk();if(T.canonical.z===n.canonical.z){const R=n.canonical.x-T.canonical.x+n.wrap*(1<<n.canonical.z),B=n.canonical.y-T.canonical.y;c.c7(O,0,c.a5,c.a5,0,0,1),c.O(O,O,[R*c.a5,B*c.a5,0])}else if(T.canonical.z>n.canonical.z){const R=T.canonical.z-n.canonical.z,B=T.canonical.x-(T.canonical.x>>R<<R)+n.wrap*(1<<T.canonical.z),V=T.canonical.y-(T.canonical.y>>R<<R),X=n.canonical.x-(T.canonical.x>>R),Y=n.canonical.y-(T.canonical.y>>R),re=c.a5>>R;c.c7(O,0,re,re,0,0,1),c.O(O,O,[-B*re+X*c.a5,-V*re+Y*c.a5,0])}else{const R=n.canonical.z-T.canonical.z,B=n.canonical.x-(n.canonical.x>>R<<R)+n.wrap*(1<<n.canonical.z),V=n.canonical.y-(n.canonical.y>>R<<R),X=(n.canonical.x>>R)-T.canonical.x,Y=(n.canonical.y>>R)-T.canonical.y,re=c.a5<<R;c.c7(O,0,re,re,0,0,1),c.O(O,O,[B*c.a5+X*re,V*c.a5+Y*re,0])}A.terrainRttPosMatrix32f=new Float32Array(O),d[v]=A}return d}getSourceTile(n,u){const d=this.tileManager._source;let v=n.overscaledZ-this.deltaZoom;if(v>d.maxzoom&&(v=d.maxzoom),v<d.minzoom)return;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(v).key);let T=this.findTileInCaches(this._sourceTileCache[n.key]);if(!T?.dem&&u)for(;v>=d.minzoom&&!T?.dem;)T=this.findTileInCaches(n.scaledTo(v--).key);return T}findTileInCaches(n){let u=this.tileManager.getTileByID(n);return u||(u=this.tileManager._outOfViewCache.getByKey(n),u)}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,u){const d=u[n.canonical.z];return!!d&&(n.wrap>d.minWrap||n.wrap<d.maxWrap||n.canonical.x>=d.minTileXWrapped&&n.canonical.x<=d.maxTileXWrapped&&n.canonical.y>=d.minTileY&&n.canonical.y<=d.maxTileY)}}class Rn{constructor(n,u,d){this._meshCache={},this.painter=n,this.tileManager=new Er(u),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,d,v=c.a5){var T;const A=n.normalizeCoordinates(u,d,v);if(!A)return 0;const O=this.getTerrainData(A.tileID),R=(T=O.tile)===null||T===void 0?void 0:T.dem;if(!R)return 0;const B=c.cD([],[A.x/v*c.a5,A.y/v*c.a5],O.u_terrain_matrix),V=[B[0]*R.dim,B[1]*R.dim],X=Math.floor(V[0]),Y=Math.floor(V[1]),re=V[0]-X,oe=V[1]-Y;return R.get(X,Y)*(1-re)*(1-oe)+R.get(X+1,Y)*re*(1-oe)+R.get(X,Y+1)*(1-re)*oe+R.get(X+1,Y+1)*re*oe}getElevationForLngLatZoom(n,u){if(!c.cE(u,n.wrap()))return 0;const{tileID:d,mercatorX:v,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(d,v%c.a5,T%c.a5,c.a5)}getElevationForLngLat(n,u){const d=nn(u,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let v=0;for(const T of d)T.canonical.z>v&&(v=Math.min(T.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(n,v)}getElevation(n,u,d,v=c.a5){return this.getDEMElevation(n,u,d,v)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const v=this.painter.context,T=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(v,T,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(v,new c.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ar([])}const u=this.tileManager.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const v=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new c.T(v,u.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),u.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const d=u&&u.toString()+u.tileID.key+n.key;if(d&&!this._demMatrixCache[d]){const v=this.tileManager.getSource().maxzoom;let T=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=v?T=n.canonical.z-v:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=n.canonical.x-(n.canonical.x>>T<<T),O=n.canonical.y-(n.canonical.y>>T<<T),R=c.cF(new Float64Array(16),[1/(c.a5<<T),1/(c.a5<<T),0]);c.O(R,R,[A*c.a5,O*c.a5,0]),this._demMatrixCache[n.key]={matrix:R,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,d=u.width/devicePixelRatio,v=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(u.context,{width:d,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(u.context,{width:d,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(d,v,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,d,v))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,A=0;T<this._coordsTextureSize;T++)for(let O=0;O<this._coordsTextureSize;O++,A+=4)u[A+0]=255&O,u[A+1]=255&T,u[A+2]=O>>8<<4|T>>8,u[A+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),v=new c.T(n,d,n.gl.RGBA,{premultiply:!1});return v.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),d=this.painter.context,v=d.gl,T=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),A=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),O=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(T,O-A-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),d.bindFramebuffer.set(null);const R=u[0]+(u[2]>>4<<8),B=u[1]+((15&u[2])<<8),V=this.coordsIndex[255-u[3]],X=V&&this.tileManager.getTileByID(V);if(!X)return null;const Y=this._coordsTextureSize,re=(1<<X.tileID.canonical.z)*Y;return new c.a9((X.tileID.canonical.x*Y+R)/re+X.tileID.wrap,(X.tileID.canonical.y*Y+B)/re,this.getElevation(X.tileID,R,B,Y))}depthAtPoint(n){const u=new Uint8Array(4),d=this.painter.context,v=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),d.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(n){var u;const d=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,v=d&&n.canonical.y===0,T=d&&n.canonical.y===(1<<n.canonical.z)-1,A=`m_${v?"n":""}_${T?"s":""}`;if(this._meshCache[A])return this._meshCache[A];const O=this.painter.context,R=new c.cG,B=new c.aY,V=this.meshSize,X=c.a5/V,Y=V*V;for(let we=0;we<=V;we++)for(let Re=0;Re<=V;Re++)R.emplaceBack(Re*X,we*X,0);for(let we=0;we<Y;we+=V+1)for(let Re=0;Re<V;Re++)B.emplaceBack(Re+we,V+Re+we+1,V+Re+we+2),B.emplaceBack(Re+we,V+Re+we+2,Re+we+1);const re=R.length,oe=re+(V+1),he=(V+1)*V,pe=v?c.br:0,de=v?0:1,xe=T?c.bs:c.a5,Ee=T?0:1;for(let we=0;we<=V;we++)R.emplaceBack(we*X,pe,de);for(let we=0;we<=V;we++)R.emplaceBack(we*X,xe,Ee);for(let we=0;we<V;we++)B.emplaceBack(he+we,oe+we,oe+we+1),B.emplaceBack(he+we,oe+we+1,he+we+1),B.emplaceBack(0+we,re+we+1,re+we),B.emplaceBack(0+we,0+we+1,re+we+1);const ve=R.length,Pe=ve+2*(V+1);for(const we of[0,1])for(let Re=0;Re<=V;Re++)for(const Qe of[0,1])R.emplaceBack(we*c.a5,Re*X,Qe);for(let we=0;we<2*V;we+=2)B.emplaceBack(ve+we,ve+we+1,ve+we+3),B.emplaceBack(ve+we,ve+we+3,ve+we+2),B.emplaceBack(Pe+we,Pe+we+3,Pe+we+1),B.emplaceBack(Pe+we,Pe+we+2,Pe+we+3);const De=new Zn(O.createVertexBuffer(R,en.members),O.createIndexBuffer(B),c.aX.simpleSegment(0,0,R.length,B.length));return this._meshCache[A]=De,De}getMeshFrameDelta(n){return 2*Math.PI*c.bE/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,u){var d;if(!c.cE(u,n.wrap()))return 0;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(d=this.getMinMaxElevation(v).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,d={minElevation:null,maxElevation:null};return u&&u.dem&&(d.minElevation=u.dem.min*this.exaggeration,d.maxElevation=u.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(n,u){const d=c.a9.fromLngLat(n.wrap()),v=(1<<u)*c.a5,T=d.x*v,A=d.y*v,O=Math.floor(T/c.a5),R=Math.floor(A/c.a5);return{tileID:new c.a2(u,0,u,O,R),mercatorX:T,mercatorY:A}}}class zu{constructor(n,u,d){this._context=n,this._size=u,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(d.texture),{id:n,fbo:u,texture:d,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>n.id!==u)),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((n=>!n.inUse))===!1}}const aa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ku{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new zu(n.context,30,u.tileManager.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){var d,v;this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=n._order.filter((T=>!n._layers[T].isHidden(u))),this._coordsAscending={};for(const T in n.tileManagers){this._coordsAscending[T]={};const A=n.tileManagers[T].getVisibleCoordinates(),O=n.tileManagers[T].getSource(),R=O instanceof co?O.terrainTileRanges:null;for(const B of A){const V=this.terrain.tileManager.getTerrainCoords(B,R);for(const X in V)this._coordsAscending[T][X]||(this._coordsAscending[T][X]=[]),this._coordsAscending[T][X].push(V[X])}}this._rttFingerprints={};for(const T of n._order){const A=n._layers[T],O=A.source;if(aa[A.type]&&!this._rttFingerprints[O]){this._rttFingerprints[O]={};const R=(v=(d=n.tileManagers[O])===null||d===void 0?void 0:d.getState().revision)!==null&&v!==void 0?v:0;for(const B in this._coordsAscending[O])this._rttFingerprints[O][B]=`${this._coordsAscending[O][B].map((V=>V.key)).sort().join()}#${R}`}}for(const T of this._renderableTiles)for(const A in this._rttFingerprints){const O=this._rttFingerprints[A][T.tileID.key];O&&O!==T.rttFingerprint[A]&&(T.rtt=[])}}renderLayer(n,u){if(n.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),v=n.type,T=this.painter,A=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(aa[v]&&(this._prevType&&aa[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(n.id),!A))return!0;if(aa[this._prevType]||aa[v]&&A){this._prevType=v;const O=this._stacks.length-1,R=this._stacks[O]||[];for(const B of this._renderableTiles){if(this.pool.isFull()&&(lp(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(B),B.rtt[O]){const X=this.pool.getObjectForId(B.rtt[O].id);if(X.stamp===B.rtt[O].stamp){this.pool.useObject(X);continue}}const V=this.pool.getOrCreateFreeObject();this.pool.useObject(V),this.pool.stampObject(V),B.rtt[O]={id:V.id,stamp:V.stamp},T.context.bindFramebuffer.set(V.fbo.framebuffer),T.context.clear({color:c.bp.transparent,stencil:0}),T.currentStencilSource=void 0;for(let X=0;X<R.length;X++){const Y=T.style._layers[R[X]],re=Y.source?this._coordsAscending[Y.source][B.tileID.key]:[B.tileID];T.context.viewport.set([0,0,V.fbo.width,V.fbo.height]),T._renderTileClippingMasks(Y,re,!0),T.renderLayer(T,T.style.tileManagers[Y.source],Y,re,d),Y.source&&(B.rttFingerprint[Y.source]=this._rttFingerprints[Y.source][B.tileID.key])}}return lp(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),aa[v]}return!1}}const Ru={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Drag to rotate map, click to reset north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ql=M,nd={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:Wn,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0,anisotropicFilterPitch:20},On={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class jh{constructor(n,u,d=!1){this.mousedown=T=>{this.startMove(T,q.mousePos(this.element,T)),q.addEventListener(window,"mousemove",this.mousemove),q.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.move(T,q.mousePos(this.element,T))},this.mouseup=T=>{this._rotatePitchHandler.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,T.targetTouches)[0],this.startMove(T,this._startPos),q.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,T.targetTouches)[0],this.move(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const v=new Cu;this._rotatePitchHandler=new Ta({clickTolerance:3,move:(T,A)=>{const O=u.getBoundingClientRect(),R=new c.P((O.bottom-O.top)/2,(O.right-O.left)/2);return{bearingDelta:c.cy(new c.P(T.x,A.y),A,R),pitchDelta:d?-.5*(A.y-T.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=n,q.addEventListener(u,"mousedown",this.mousedown),q.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(u,"touchcancel",this.reset)}startMove(n,u){this._rotatePitchHandler.dragStart(n,u),q.disableDrag()}move(n,u){const d=this.map,{bearingDelta:v,pitchDelta:T}=this._rotatePitchHandler.dragMove(n,u)||{};v&&d.setBearing(d.getBearing()+v),T&&d.setPitch(d.getPitch()+T)}off(){const n=this.element;q.removeEventListener(n,"mousedown",this.mousedown),q.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend),q.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(window,"mousemove",this.mousemove),q.removeEventListener(window,"mouseup",this.mouseup),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend)}}let ss;function Lh(w,n,u,d=!1){if(d||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return w?.wrap();const v=new c.V(w.lng,w.lat);if(w=new c.V(w.lng,w.lat),n){const T=new c.V(w.lng-360,w.lat),A=new c.V(w.lng+360,w.lat),O=u.locationToScreenPoint(w).distSqr(n);u.locationToScreenPoint(T).distSqr(n)<O?w=T:u.locationToScreenPoint(A).distSqr(n)<O&&(w=A)}for(;Math.abs(w.lng-u.center.lng)>180;){const T=u.locationToScreenPoint(w);if(T.x>=0&&T.y>=0&&T.x<=u.width&&T.y<=u.height)break;w.lng>u.center.lng?w.lng-=360:w.lng+=360}return w.lng!==v.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(w))?w:v}const Mc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function id(w,n,u){const d=w.classList;for(const v in Mc)d.remove(`maplibregl-${u}-anchor-${v}`);d.add(`maplibregl-${u}-anchor-${n}`)}class ju extends c.E{constructor(n){if(super(),this._onClick=u=>{this.fire(new c.l("click",{originalEvent:u}))},this._onKeyPress=u=>{const d=u.code,v=u.charCode||u.keyCode;d!=="Space"&&d!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=u=>{const d=u.originalEvent.target,v=this._element;this._popup&&(d===v||v.contains(d))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=Lh(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,`${Mc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${v}`),G.frameAsync(new AbortController,this._map._ownerWindow).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n?.opacity,n?.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div");const u=q.createNS("http://www.w3.org/2000/svg","svg"),d=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${d}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${d}`);const T=q.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const A=q.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const O=q.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"transform","translate(3.0, 29.0)"),O.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of R){const xe=q.createNS("http://www.w3.org/2000/svg","ellipse");xe.setAttributeNS(null,"opacity","0.04"),xe.setAttributeNS(null,"cx","10.5"),xe.setAttributeNS(null,"cy","5.80029008"),xe.setAttributeNS(null,"rx",de.rx),xe.setAttributeNS(null,"ry",de.ry),O.appendChild(xe)}const B=q.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=q.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const X=q.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const Y=q.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(Y);const re=q.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(6.0, 7.0)"),re.setAttributeNS(null,"fill","#FFFFFF");const oe=q.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=q.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const pe=q.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#FFFFFF"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962"),oe.appendChild(he),oe.appendChild(pe),A.appendChild(O),A.appendChild(B),A.appendChild(X),A.appendChild(re),A.appendChild(oe),u.appendChild(A),u.setAttributeNS(null,"height",d*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),id(this._element,this._anchor,"marker"),this._element.addEventListener("click",this._onClick),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.V.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const v=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,d;const v=(u=this._map)===null||u===void 0?void 0:u.terrain,T=this._map.transform.isLocationOccluded(this._lngLat);if(!v||T){const re=T?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==re&&(this._element.style.opacity=re))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const A=this._map,O=A.terrain.depthAtPoint(this._pos),R=A.terrain.getElevationForLngLat(this._lngLat,A.transform);if(A.transform.lngLatToCameraDepth(this._lngLat,R)-O<.006)return void(this._element.style.opacity=this._opacity);const B=-this._offset.y/A.transform.pixelsPerMeter,V=Math.sin(A.getPitch()*Math.PI/180)*B,X=A.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),Y=A.transform.lngLatToCameraDepth(this._lngLat,R+V)-X>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&Y&&this._popup.remove(),this._element.style.opacity=Y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return(this._opacity===void 0||n===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Nh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $l=0,hi=!1;const Un={maxWidth:100,unit:"metric"};function Lu(w,n,u){const d=u&&u.maxWidth||100,v=w._container.clientHeight/2,T=w._container.clientWidth/2,A=w.unproject([T-d/2,v]),O=w.unproject([T+d/2,v]),R=Math.round(w.project(O).x-w.project(A).x),B=Math.min(d,R,w._container.clientWidth),V=A.distanceTo(O);if(u&&u.unit==="imperial"){const X=3.2808*V;X>5280?ls(n,B,X/5280,w._getUIString("ScaleControl.Miles")):ls(n,B,X,w._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?ls(n,B,V/1852,w._getUIString("ScaleControl.NauticalMiles")):V>=1e3?ls(n,B,V/1e3,w._getUIString("ScaleControl.Kilometers")):ls(n,B,V,w._getUIString("ScaleControl.Meters"))}function ls(w,n,u,d){const v=(function(T){const A=Math.pow(10,`${Math.floor(T)}`.length-1);let O=T/A;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(R){const B=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*B)/B})(O),A*O})(u);w.style.width=n*(v/u)+"px",w.innerHTML=`${v}&nbsp;${d}`}const Nu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Bh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function No(w){if(w){if(typeof w=="number"){const n=Math.round(Math.abs(w)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,w),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-w),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(w,0),right:new c.P(-w,0)}}if(w instanceof c.P||Array.isArray(w)){const n=c.P.convert(w);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(w.center||[0,0]),top:c.P.convert(w.top||[0,0]),"top-left":c.P.convert(w["top-left"]||[0,0]),"top-right":c.P.convert(w["top-right"]||[0,0]),bottom:c.P.convert(w.bottom||[0,0]),"bottom-left":c.P.convert(w["bottom-left"]||[0,0]),"bottom-right":c.P.convert(w["bottom-right"]||[0,0]),left:c.P.convert(w.left||[0,0]),right:c.P.convert(w.right||[0,0])}}return No(new c.P(0,0))}const Pc=M;_.AJAXError=c.cJ,_.EXTENT=c.a5,_.Event=c.l,_.Evented=c.E,_.LngLat=c.V,_.MercatorCoordinate=c.a9,_.Point=c.P,_.addProtocol=c.cK,_.config=c.c,_.removeProtocol=c.cL,_.AttributionControl=Rh,_.BoxZoomHandler=wo,_.CanvasSource=ga,_.CooperativeGesturesHandler=Kt,_.DoubleClickZoomHandler=Vl,_.DragPanHandler=To,_.DragRotateHandler=Ou,_.EdgeInsets=wn,_.FullscreenControl=class extends c.E{constructor(w={}){var n;super(),this._onFullscreenChange=()=>{var u;let d=window.document.fullscreenElement||window.document.webkitFullscreenElement;for(;!((u=d?.shadowRoot)===null||u===void 0)&&u.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,this._pseudo=(n=w.pseudo)!==null&&n!==void 0&&n,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=q.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);q.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){this._pseudo?this._togglePseudoFullScreen():window.document.exitFullscreen?window.document.exitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._pseudo?this._togglePseudoFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},_.GeoJSONSource=ma,_.GeolocateControl=class extends c.E{constructor(w){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new c.V(n.coords.longitude,n.coords.latitude),d=n.coords.accuracy,v=this._map.getBearing(),T=c.e({bearing:v},this.options.fitBoundsOptions),A=Tr.fromLngLat(u,d);this._map.fitBounds(A,T,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new c.V(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&hi)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=q.create("button","maplibregl-ctrl-geolocate",this._container),q.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ju({element:this._dotElement}),this._circleElement=q.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ju({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const d=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},Nh,w)}onAdd(w){return this._map=w,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(n=!1){if(ss!==void 0&&!n)return ss;if(window.navigator.permissions===void 0)return ss=!!window.navigator.geolocation,ss;try{ss=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ss=!!window.navigator.geolocation}return ss}))})().then((n=>this._finishSetupUI(n))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$l=0,hi=!1}_isOutOfMapMaxBounds(w){const n=this._map.getMaxBounds(),u=w.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;const n=this._map.project(w),u=this._map.unproject([n.x+100,n.y]),d=w.distanceTo(u)/100,v=2*this._accuracy/d;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$l--,hi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$l++,$l>1?(w={maximumAge:6e5,timeout:0},hi=!0):(w=this.options.positionOptions,hi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},_.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;const n=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=q.create("button","maplibregl-ctrl-globe",this._container),q.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._map.on("projectiontransition",this._updateGlobeIcon),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._map.off("projectiontransition",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},_.Hash=Eu,_.ImageSource=co,_.KeyboardHandler=Jf,_.LngLatBounds=Tr,_.LogoControl=Rs,_.Map=class extends Hn{get _ownerWindow(){var w,n;return((n=(w=this._container)===null||w===void 0?void 0:w.ownerDocument)===null||n===void 0?void 0:n.defaultView)||window}constructor(w){var n,u;c.cH.mark(c.cI.create);const d=Object.assign(Object.assign(Object.assign({},nd),w),{canvasContextAttributes:Object.assign(Object.assign({},nd.canvasContextAttributes),w.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new kr,T=new Ys;d.minZoom!==void 0&&v.setMinZoom(d.minZoom),d.maxZoom!==void 0&&v.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&v.setMinPitch(d.minPitch),d.maxPitch!==void 0&&v.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&v.setRenderWorldCopies(d.renderWorldCopies),d.transformConstrain!==null&&v.setConstrainOverride(d.transformConstrain),super(v,T,{bearingSnap:d.bearingSnap,zoomSnap:d.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Pr,this._controls=[],this._mapId=c.af(),this._lostContextStyle={style:null,images:null},this._contextLost=O=>{if(O.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy(),this._lostContextStyle=this._getStyleAndImages(),this.style){for(const R of Object.values(this.style._layers))if(R.type==="custom"&&console.warn(`Custom layer with id '${R.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),R._listeners)for(const[B]of Object.entries(R._listeners))console.warn(`Custom layer with id '${R.id}' had event listeners for event '${B}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this.style.destroy(),this.style=null,this.fire(new c.l("webglcontextlost",{originalEvent:O}))}else this.fire(new c.l("webglcontextlost",{originalEvent:O}))},this._contextRestored=O=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new c.l("webglcontextrestored",{originalEvent:O}))},this._onMapScroll=O=>{if(O.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._zoomSnap=d.zoomSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ru),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this._zoomLevelsToOverscale=d.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=d.transformCameraUpdate,this.transformConstrain=d.transformConstrain,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,this.setAnisotropicFilterPitch(d.anisotropicFilterPitch),d.reduceMotion!==void 0&&(G.prefersReducedMotion=d.reduceMotion),this._imageQueueHandle=Oe.addThrottleControl((()=>this.isMoving())),this._requestManager=new rt(d.transformRequest),this._container=this._resolveContainer(d.container),d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"&&(this._ownerWindow.addEventListener("online",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new ai(this,d),this._hash=d.hash&&new Eu(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,c.e({},d.fitBoundsOptions,{duration:0}))));const A=typeof d.style=="string"||((u=(n=d.style)===null||n===void 0?void 0:n.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,A),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new Rh(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new Rs,d.logoPosition),this.on("style.load",(()=>{if(A||this._resizeTransform(),this.transform.unmodified){const O=c.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(O)}})),this.on("data",(O=>{this._update(O.dataType==="style"),this.fire(new c.l(`${O.dataType}data`,O))})),this.on("dataloading",(O=>{this.fire(new c.l(`${O.dataType}dataloading`,O))})),this.on("dataabort",(O=>{this.fire(new c.l("sourcedataabort",O))}))}_getMapId(){return this._mapId}setGlobalStateProperty(w,n){return this.style.setGlobalStateProperty(w,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,n){if(n===void 0&&(n=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=w.onAdd(this);this._controls.push(w);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(u,d.firstChild):d.appendChild(u),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(w);return n>-1&&this._controls.splice(n,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return nn(this.transform,w)}calculateCameraOptionsFromTo(w,n,u,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLat(u,this.transform)),super.calculateCameraOptionsFromTo(w,n,u,d)}resize(w,n=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(n);const u=!this._moving;return u&&(this.stop(),this.fire(new c.l("movestart",w)).fire(new c.l("move",w))),this.fire(new c.l("resize",w)),u&&this.fire(new c.l("moveend",w)),this}_resizeInternal(w=!0){const[n,u]=this._containerDimensions(),d=this._getClampedPixelRatio(n,u);if(this._resizeCanvas(n,u,d),this.painter.resize(n,u,d),this.painter.overLimit()){const v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];const T=this._getClampedPixelRatio(n,u);this._resizeCanvas(n,u,T),this.painter.resize(n,u,T)}this._resizeTransform(w)}_resizeTransform(w=!0){var n;const[u,d]=this._containerDimensions();this.transform.resize(u,d,w),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,d,w)}_getClampedPixelRatio(w,n){const{0:u,1:d}=this._maxCanvasSize,v=this.getPixelRatio(),T=w*v,A=n*v;return Math.min(T>u?u/T:1,A>d?d/A:1)*v}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Tr.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom){const n=this.transform.zoom,u=this._getTransformForUpdate();return u.setMinZoom(w),this._applyUpdatedTransform(u),this._update(),n!==this.transform.zoom&&this.fire(new c.l("zoomstart")).fire(new c.l("zoom")).fire(new c.l("zoomend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom){const n=this.transform.zoom,u=this._getTransformForUpdate();return u.setMaxZoom(w),this._applyUpdatedTransform(u),this._update(),n!==this.transform.zoom&&this.fire(new c.l("zoomstart")).fire(new c.l("zoom")).fire(new c.l("zoomend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch){const n=this.transform.pitch,u=this._getTransformForUpdate();return u.setMinPitch(w),this._applyUpdatedTransform(u),this._update(),n!==this.transform.pitch&&this.fire(new c.l("pitchstart")).fire(new c.l("pitch")).fire(new c.l("pitchend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch){const n=this.transform.pitch,u=this._getTransformForUpdate();return u.setMaxPitch(w),this._applyUpdatedTransform(u),this._update(),n!==this.transform.pitch&&this.fire(new c.l("pitchstart")).fire(new c.l("pitch")).fire(new c.l("pitchend")).fire(new c.l("movestart")).fire(new c.l("move")).fire(new c.l("moveend")),this}throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getAnisotropicFilterPitch(){return this._anisotropicFilterPitch}setAnisotropicFilterPitch(w){if((w=w??20)>180)throw new Error("anisotropicFilterPitch must be less than or equal to 180");if(w<0)throw new Error("anisotropicFilterPitch must be greater than or equal to 0");return this._anisotropicFilterPitch=w,this._update()}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}setTransformConstrain(w){return this.transform.setConstrainOverride(w),this._update()}project(w){return this.transform.locationToScreenPoint(c.V.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(c.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,n,u){if(w==="mouseenter"||w==="mouseover"){let d=!1;return{layers:n,listener:u,delegates:{mousemove:T=>{const A=n.filter((R=>this.getLayer(R))),O=A.length!==0?this.queryRenderedFeatures(T.point,{layers:A}):[];O.length?d||(d=!0,u.call(this,new Ci(w,this,T.originalEvent,{features:O}))):d=!1},mouseout:()=>{d=!1}}}}if(w==="mouseleave"||w==="mouseout"){let d=!1;return{layers:n,listener:u,delegates:{mousemove:A=>{const O=n.filter((R=>this.getLayer(R)));(O.length!==0?this.queryRenderedFeatures(A.point,{layers:O}):[]).length?d=!0:d&&(d=!1,u.call(this,new Ci(w,this,A.originalEvent)))},mouseout:A=>{d&&(d=!1,u.call(this,new Ci(w,this,A.originalEvent)))}}}}{const d=v=>{const T=n.filter((O=>this.getLayer(O))),A=T.length!==0?this.queryRenderedFeatures(v.point,{layers:T}):[];A.length&&(v.features=A,u.call(this,v),delete v.features)};return{layers:n,listener:u,delegates:{[w]:d}}}}_saveDelegatedListener(w,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(n)}_removeDelegatedListener(w,n,u){if(!this._delegatedListeners||!this._delegatedListeners[w])return;const d=this._delegatedListeners[w];for(let v=0;v<d.length;v++){const T=d[v];if(T.listener===u&&T.layers.length===n.length&&T.layers.every((A=>n.includes(A)))){for(const A in T.delegates)this.off(A,T.delegates[A]);return void d.splice(v,1)}}}on(w,n,u){if(u===void 0)return super.on(w,n);const d=typeof n=="string"?[n]:n,v=this._createDelegatedListener(w,d,u);this._saveDelegatedListener(w,v);for(const T in v.delegates)this.on(T,v.delegates[T]);return{unsubscribe:()=>{this._removeDelegatedListener(w,d,u)}}}once(w,n,u){if(u===void 0)return super.once(w,n);const d=typeof n=="string"?[n]:n,v=this._createDelegatedListener(w,d,u);for(const T in v.delegates){const A=v.delegates[T];v.delegates[T]=(...O)=>{this._removeDelegatedListener(w,d,u),A(...O)}}this._saveDelegatedListener(w,v);for(const T in v.delegates)this.once(T,v.delegates[T]);return this}off(w,n,u){return u===void 0?super.off(w,n):(this._removeDelegatedListener(w,typeof n=="string"?[n]:n,u),this)}queryRenderedFeatures(w,n){if(!this.style)return[];let u;const d=w instanceof c.P||Array.isArray(w),v=d?w:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(d?{}:w)||{},v instanceof c.P||typeof v[0]=="number")u=[c.P.convert(v)];else{const T=c.P.convert(v[0]),A=c.P.convert(v[1]);u=[T,new c.P(A.x,T.y),A,new c.P(T.x,A.y),T]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(w,n){return this.style.querySourceFeatures(w,n)}setStyle(w,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(w,n))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const n=this._locale[w];if(n==null)throw new Error(`Missing UI string '${w}'`);return n}_updateStyle(w,n){var u,d;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(w,n)));const v=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new Rf(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,n,v):this.style.loadJSON(w,n,v),this):((d=(u=this.style)===null||u===void 0?void 0:u.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Rf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,n){if(typeof w=="string"){const u=this._requestManager.transformRequest(w,"Style");c.j(u,new AbortController).then((d=>{this._updateDiff(d.data,n)})).catch((d=>{d&&this.fire(new c.k(d))}))}else typeof w=="object"&&this._updateDiff(w,n)}_updateDiff(w,n){try{this.style.setState(w,n)&&this._update(!0)}catch(u){c.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(w,n)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(w,n){return this._lazyInitEmptyStyle(),this.style.addSource(w,n),this._update(!0)}isSourceLoaded(w){const n=this.style&&this.style.tileManagers[w];if(n!==void 0)return n.loaded();this.fire(new c.k(new Error(`There is no tile manager with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const n=this.style.tileManagers[w.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const d=this.style._layers[u];d.type==="hillshade"&&d.source===w.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),d.type==="color-relief"&&d.source===w.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Rn(this.painter,n,w),this.painter.renderToTexture=new ku(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var d;u.dataType==="style"?this.terrain.tileManager.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((d=u.source)===null||d===void 0?void 0:d.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:w})),this}getTerrain(){var w,n;return(n=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const w=this.style&&this.style.tileManagers;for(const n of Object.values(w))if(!n.areTilesLoaded())return!1;return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,n,u){if(u){const d=this.getSource(u);if(!d)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);d.calculateTileZoom=rr(Math.max(1,w),Math.max(1,n))}else for(const d in this.style.tileManagers)this.style.tileManagers[d].getSource().calculateTileZoom=rr(Math.max(1,w),Math.max(1,n));return this._update(!0),this}refreshTiles(w,n){const u=this.style.tileManagers[w];if(!u)throw new Error(`There is no tile manager with ID "${w}", cannot refresh tile`);n===void 0?u.reload(!0):u.refreshTiles(n.map((d=>new c.ac(d.z,d.x,d.y))))}addImage(w,n,u={}){const{pixelRatio:d=1,sdf:v=!1,stretchX:T,stretchY:A,content:O,textFitWidth:R,textFitHeight:B}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:V,height:X,data:Y}=n,re=n;return this.style.addImage(w,{data:new c.R({width:V,height:X},new Uint8Array(Y)),pixelRatio:d,stretchX:T,stretchY:A,content:O,textFitWidth:R,textFitHeight:B,sdf:v,version:0,userImage:re}),re.onAdd&&re.onAdd(this,w),this}}{const{width:V,height:X,data:Y}=G.getImageData(n);this.style.addImage(w,{data:new c.R({width:V,height:X},Y),pixelRatio:d,stretchX:T,stretchY:A,content:O,textFitWidth:R,textFitHeight:B,sdf:v,version:0})}}updateImage(w,n){const u=this.style.getImage(w);if(!u)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=n instanceof HTMLImageElement||c.b(n)?G.getImageData(n):n,{width:v,height:T,data:A}=d;if(v===void 0||T===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==u.data.width||T!==u.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const O=!(n instanceof HTMLImageElement||c.b(n));return u.data.replace(A,O),this.style.updateImage(w,u),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return Oe.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,n){return this._lazyInitEmptyStyle(),this.style.addLayer(w,n),this._update(!0)}moveLayer(w,n){return this.style.moveLayer(w,n),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,n,u){return this.style.setLayerZoomRange(w,n,u),this._update(!0)}setFilter(w,n,u={}){return this.style.setFilter(w,n,u),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,n,u,d={}){return this.style.setPaintProperty(w,n,u,d),this._update(!0)}getPaintProperty(w,n){return this.style.getPaintProperty(w,n)}setLayoutProperty(w,n,u,d={}){return this.style.setLayoutProperty(w,n,u,d),this._update(!0)}getLayoutProperty(w,n){return this.style.getLayoutProperty(w,n)}setGlyphs(w,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,n,u,(d=>{d||this._update(!0)})),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,n,(u=>{u||this._update(!0)})),this}setLight(w,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,n){return this.style.setFeatureState(w,n),this._update()}removeFeatureState(w,n){return this.style.removeFeatureState(w,n),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,n=0;return this._container&&(w=this._container.clientWidth||400,n=this._container.clientHeight||300),[w,n]}_setupResizeObserver(){var w;let n=!1;const u=ii((v=>{this._trackResize&&!this._removed&&(this.resize(v),this.redraw())}),50),d=(w=this._ownerWindow.ResizeObserver)!==null&&w!==void 0?w:ResizeObserver;this._resizeObserver=new d((v=>{n?u(v):n=!0})),this._resizeObserver.observe(this._container)}_resolveContainer(w){if(typeof w=="string"){const n=document.getElementById(w);if(!n)throw new Error(`Container '${w}' not found.`);return n}if(w instanceof HTMLElement||w&&typeof w=="object"&&w.nodeType===1)return w;throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const n=this._canvasContainer=q.create("div","maplibregl-canvas-container",w);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=q.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),d=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],d);const v=this._controlContainer=q.create("div","maplibregl-control-container",w),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((A=>{T[A]=q.create("div",`maplibregl-ctrl-${A} `,v)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,n,u){this._canvas.width=Math.floor(u*w),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",(d=>{n={requestedAttributes:w},d&&(n.statusMessage=d.statusMessage,n.type=d.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!u){const d="Failed to initialize WebGL";throw n?(n.message=d,new Error(JSON.stringify(n))):new Error(d)}this.painter=new vm(u,this.transform),ue.testSupport(u)}migrateProjection(w,n){super.migrateProjection(w,n),this.painter.transform=w,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var n,u,d,v,T;const A=this._idleTriggered?this._fadeDuration:0,O=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,Y=W();this.style.zoomHistory.update(X,Y);const re=new c.H(X,{now:Y,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),oe=re.crossFadingFactor();oe===1&&oe===this._crossFadingFactor||(R=!0,this._crossFadingFactor=oe),this.style.update(re)}const B=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==O;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(T=this.style.projection)===null||T===void 0?void 0:T.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||B)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,B),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding,anisotropicFilterPitch:this.getAnisotropicFilterPitch()}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cH.mark(c.cI.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const V=this._sourcesDirty||this._styleDirty||this._placementDirty;return V||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,c.cH.mark(c.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&this._ownerWindow.removeEventListener("online",this._onWindowOnline,!1),Oe.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n?.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),q.remove(this._canvasContainer),q.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cH.remove(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,G.frame(this._frameRequest,(w=>{c.cH.recordStartOfFrameAt(w),this._frameRequest=null;try{this._render(w)}catch(n){if(!c.Z(n)&&!(function(u){return u.message===Ll})(n))throw n}}),(()=>{}),this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return ql}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},_.MapMouseEvent=Ci,_.MapTouchEvent=Mu,_.MapWheelEvent=Dh,_.Marker=ju,_.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),d=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,u)=>{const d=this._map._getUIString(`NavigationControl.${u}`);n.title=d,n.setAttribute("aria-label",d)},this.options=c.e({},On,w),this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(n=>this._map.zoomIn({},{originalEvent:n}))),q.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(n=>this._map.zoomOut({},{originalEvent:n}))),q.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})),this._compassIcon=q.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,n){const u=q.create("button",w,this._container);return u.type="button",u.addEventListener("click",n),u}},_.Popup=class extends c.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=q.create("div","maplibregl-popup",this._map.getContainer()),this._tip=q.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const A of this.options.className.split(" "))this._container.classList.add(A);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Lh(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const u=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const v=No(this.options.offset);if(!d){const A=this._container.offsetWidth,O=this._container.offsetHeight,R=(function(V){var X,Y,re,oe;return V?{top:(X=V.top)!==null&&X!==void 0?X:0,right:(Y=V.right)!==null&&Y!==void 0?Y:0,bottom:(re=V.bottom)!==null&&re!==void 0?re:0,left:(oe=V.left)!==null&&oe!==void 0?oe:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let B;B=u.y+v.bottom.y<O+R.top?["top"]:u.y>this._map.transform.height-O-R.bottom?["bottom"]:[],u.x<A/2+R.left?B.push("left"):u.x>this._map.transform.width-A/2-R.right&&B.push("right"),d=B.length===0?"bottom":B.join("-")}let T=u.add(v[d]);this.options.subpixelPositioning||(T=T.round()),q.setTransform(this._container,`${Mc[d]} translate(${T.x}px,${T.y}px)`),id(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Nu),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=c.V.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const n=document.createDocumentFragment(),u=document.createElement("body");let d;for(u.innerHTML=w;d=u.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}setPadding(w){this.options.padding=w,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Bh);w&&w.focus()}},_.RasterDEMTileSource=pa,_.RasterTileSource=ka,_.ScaleControl=class{constructor(w){this._onMove=()=>{Lu(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,Lu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Un),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},_.ScrollZoomHandler=td,_.Style=Rf,_.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=q.create("button","maplibregl-ctrl-terrain",this._container),q.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){q.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},_.TwoFingersTouchPitchHandler=So,_.TwoFingersTouchRotateHandler=ll,_.TwoFingersTouchZoomHandler=Qf,_.TwoFingersTouchZoomRotateHandler=Bt,_.VectorTileSource=bs,_.VideoSource=ta,_.addSourceType=(w,n)=>c._(void 0,void 0,void 0,(function*(){if(ws(w))throw new Error(`A source type called "${w}" already exists.`);((u,d)=>{du[u]=d})(w,n)})),_.clearPrewarmedResources=function(){const w=Vt;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(lt),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.createTileMesh=Cf,_.getMaxParallelImageRequests=function(){return c.c.MAX_PARALLEL_IMAGE_REQUESTS},_.getRTLTextPluginStatus=function(){return ae().getRTLTextPluginStatus()},_.getVersion=function(){return Pc},_.getWorkerCount=function(){return Ft.workerCount},_.getWorkerUrl=function(){return c.c.WORKER_URL},_.importScriptInWorkers=function(w){return pr().broadcast("IS",w)},_.isTimeFrozen=function(){return K.isFrozen()},_.now=W,_.prewarm=function(){ft().acquire(lt)},_.restoreNow=function(){K.restoreNow()},_.setMaxParallelImageRequests=function(w){c.c.MAX_PARALLEL_IMAGE_REQUESTS=w},_.setNow=function(w){K.setNow(w)},_.setRTLTextPlugin=function(w,n){return ae().setRTLTextPlugin(w,n)},_.setWorkerCount=function(w){Ft.workerCount=w},_.setWorkerUrl=function(w){c.c.WORKER_URL=w}}));var y=i;return y}))})(F0)),F0.exports}var i3=n3();const of=uh(i3),bg="https://gee-proxy-787413290356.us-east1.run.app";function nE({proxyEndpoint:e,defaultParams:t={},bands:i,clickQueryEndpoint:o,timeControl:m="none",defaultTime:y,colorRamp:_,defaultCenter:c=[-106.5,39.5],defaultZoom:M=5,height:C="450px",stationData:D}){const k=Z.useRef(null),F=Z.useRef(null),G=Z.useRef(null),K=Z.useRef(0),W=Z.useRef(null),[q,ue]=Z.useState(i?.[0]?.value??t.band??""),[me,ge]=Z.useState(.75),[be,ze]=Z.useState(y??""),[Ae,Oe]=Z.useState(!1),[rt,gt]=Z.useState(""),yt=Z.useCallback(async()=>{const tt=F.current;if(!(!tt||!tt.isStyleLoaded())&&!D){Oe(!0);try{const Ge=new URLSearchParams({...t});if(q&&Ge.set("band",q),m==="date"&&be)Ge.set("date",be);else if(m==="year-month"&&be){const[bt,Ut]=be.split("-");Ge.set("year",bt),Ge.set("month",Ut)}const Rt=`${e}?${Ge.toString()}`,kt=await(await fetch(Rt)).json();if(kt.error){gt(`Error: ${kt.error}`),Oe(!1);return}const Ue=kt.tileUrl;if(!Ue){gt("No tile URL returned"),Oe(!1);return}W.current&&(tt.getLayer(W.current)&&tt.removeLayer(W.current),tt.getSource(W.current)&&tt.removeSource(W.current));const at=`explorer-tile-${++K.current}`;tt.addSource(at,{type:"raster",tiles:[Ue],tileSize:256,maxzoom:12}),tt.addLayer({id:at,type:"raster",source:at,paint:{"raster-opacity":me}}),W.current=at;const pt=[];kt.band&&pt.push(`Band: ${kt.band}`),kt.date&&pt.push(`Date: ${kt.date}`),kt.year&&pt.push(`${kt.year}-${kt.month||""}`),gt(pt.join(" | ")||"Loaded")}catch(Ge){gt(`Fetch error: ${Ge.message}`)}finally{Oe(!1)}}},[e,t,q,m,be,me,D]);return Z.useEffect(()=>{if(!k.current||F.current)return;const tt=new of.Map({container:k.current,style:{version:8,sources:{carto:{type:"raster",tiles:["https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}@2x.png"],tileSize:256}},layers:[{id:"carto-base",type:"raster",source:"carto"}]},center:c,zoom:M});return tt.addControl(new of.NavigationControl,"top-left"),F.current=tt,tt.on("load",()=>{D&&(tt.addSource("stations",{type:"geojson",data:D}),tt.addLayer({id:"station-circles",type:"circle",source:"stations",paint:{"circle-radius":5,"circle-color":"#0369a1","circle-stroke-color":"#ffffff","circle-stroke-width":1.5}}),tt.on("click","station-circles",Ge=>{const Rt=Ge.features?.[0];if(!Rt)return;const zt=Rt.properties??{},kt=Rt.geometry.coordinates,Ue=Object.entries(zt).map(([at,pt])=>`<div style="font-size:12px"><strong>${at}:</strong> ${pt}</div>`).join("");new of.Popup({closeButton:!0,maxWidth:"260px"}).setLngLat(kt).setHTML(`<div style="font-family:system-ui;padding:4px">${Ue}</div>`).addTo(tt)}),tt.on("mouseenter","station-circles",()=>{tt.getCanvas().style.cursor="pointer"}),tt.on("mouseleave","station-circles",()=>{tt.getCanvas().style.cursor=""})),!D&&e&&setTimeout(()=>yt(),100)}),o&&!D&&tt.on("click",async Ge=>{const{lng:Rt,lat:zt}=Ge.lngLat;G.current?.remove(),Oe(!0);try{const kt=o.replace("{lng}",Rt.toFixed(5)).replace("{lat}",zt.toFixed(5)),at=await(await fetch(kt)).json();let pt=`<div style="font-family:system-ui;padding:4px">
            <div style="font-size:11px;color:#94a3b8;margin-bottom:6px">${zt.toFixed(4)}, ${Rt.toFixed(4)}</div>`;if(Array.isArray(at))pt+=`<div style="font-size:11px;color:#64748b">${at.length} records returned</div>`,at.slice(-3).forEach(Ut=>{pt+=`<div style="font-size:12px"><strong>${Ut.date}:</strong> ${Ut.value?.toFixed(3)??"N/A"}</div>`}),at.length>3&&(pt+=`<div style="font-size:10px;color:#94a3b8">...and ${at.length-3} more</div>`);else if(at.error)pt+=`<div style="font-size:12px;color:#ef4444">${at.error}</div>`;else{const bt=Object.entries(at).filter(([Ut])=>!["error","cached"].includes(Ut)).map(([Ut,Ce])=>{const nt=typeof Ce=="number"?Ce.toFixed(4):String(Ce);return`<div style="font-size:12px"><strong>${Ut}:</strong> ${nt}</div>`}).join("");pt+=bt||'<div style="font-size:12px;color:#94a3b8">No data at this location</div>'}pt+="</div>",G.current=new of.Popup({closeButton:!0,maxWidth:"300px"}).setLngLat(Ge.lngLat).setHTML(pt).addTo(tt)}catch{G.current=new of.Popup({closeButton:!0}).setLngLat(Ge.lngLat).setHTML('<div style="font-size:12px;color:#ef4444">Query failed</div>').addTo(tt)}finally{Oe(!1)}}),()=>{tt.remove(),F.current=null}},[]),Z.useEffect(()=>{F.current?.isStyleLoaded()&&!D&&yt()},[q,be]),Z.useEffect(()=>{const tt=F.current;!tt||!W.current||tt.getLayer(W.current)&&tt.setPaintProperty(W.current,"raster-opacity",me)},[me]),U.jsxs("div",{style:{position:"relative",width:"100%",height:C,borderRadius:8,overflow:"hidden",border:"1px solid #e2e8f0"},children:[U.jsx("div",{ref:k,style:{width:"100%",height:"100%"}}),Ae&&U.jsx("div",{style:{position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",background:"rgba(255,255,255,0.95)",padding:"6px 16px",borderRadius:6,fontSize:12,color:"#475569",boxShadow:"0 1px 4px rgba(0,0,0,0.1)"},children:"Loading tiles..."}),rt&&U.jsx("div",{style:{position:"absolute",bottom:8,left:8,background:"rgba(15,23,42,0.8)",padding:"4px 10px",borderRadius:4,fontSize:11,color:"#e2e8f0"},children:rt}),U.jsxs("div",{style:{position:"absolute",top:10,right:10,width:180,background:"rgba(255,255,255,0.95)",borderRadius:6,padding:"10px 12px",fontSize:12,color:"#475569",display:"flex",flexDirection:"column",gap:10,boxShadow:"0 1px 4px rgba(0,0,0,0.12)"},children:[i&&i.length>1&&U.jsxs("div",{children:[U.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#334155",display:"block",marginBottom:3},children:"Band"}),U.jsx("select",{value:q,onChange:tt=>ue(tt.target.value),style:{width:"100%",padding:"4px 6px",fontSize:12,border:"1px solid #cbd5e1",borderRadius:4,background:"#fff",color:"#334155"},children:i.map(tt=>U.jsx("option",{value:tt.value,children:tt.label},tt.value))})]}),m==="date"&&U.jsxs("div",{children:[U.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#334155",display:"block",marginBottom:3},children:"Date"}),U.jsx("input",{type:"date",value:be,onChange:tt=>ze(tt.target.value),style:{width:"100%",padding:"4px 6px",fontSize:12,border:"1px solid #cbd5e1",borderRadius:4}})]}),m==="year-month"&&U.jsxs("div",{children:[U.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#334155",display:"block",marginBottom:3},children:"Month"}),U.jsx("input",{type:"month",value:be,onChange:tt=>ze(tt.target.value),style:{width:"100%",padding:"4px 6px",fontSize:12,border:"1px solid #cbd5e1",borderRadius:4}})]}),!D&&U.jsxs("div",{children:[U.jsxs("label",{style:{fontSize:11,fontWeight:600,color:"#334155",display:"block",marginBottom:3},children:["Opacity: ",Math.round(me*100),"%"]}),U.jsx("input",{type:"range",min:20,max:100,value:Math.round(me*100),onChange:tt=>ge(Number(tt.target.value)/100),style:{width:"100%",accentColor:"#0369a1"}})]}),_&&U.jsxs("div",{children:[U.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#334155",display:"block",marginBottom:4},children:_.label}),U.jsx("div",{style:{height:10,borderRadius:3,width:"100%",background:`linear-gradient(90deg, ${_.colors.join(", ")})`}}),U.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"#94a3b8",marginTop:2},children:[U.jsxs("span",{children:[_.min," ",_.unit]}),U.jsxs("span",{children:[_.max," ",_.unit]})]})]}),o&&U.jsx("div",{style:{fontSize:10,color:"#94a3b8",borderTop:"1px solid #e2e8f0",paddingTop:6},children:"Click map to query pixel values"})]})]})}function a3({title:e,children:t,defaultOpen:i=!1}){const[o,m]=Z.useState(i);return U.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,marginBottom:8,overflow:"hidden"},children:[U.jsxs("button",{onClick:()=>m(!o),style:{width:"100%",padding:"10px 16px",background:o?"#f8fafc":"#fff",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:13,fontWeight:600,color:"#334155",textAlign:"left"},children:[e,U.jsx("span",{style:{fontSize:11,color:"#94a3b8",transform:o?"rotate(180deg)":"none",transition:"transform 0.2s"},children:""})]}),o&&U.jsx("div",{style:{padding:"0 16px 14px",fontSize:13,color:"#475569",lineHeight:1.7},children:t})]})}function wg({headers:e,rows:t}){return U.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,marginTop:8,marginBottom:8},children:[U.jsx("thead",{children:U.jsx("tr",{children:e.map((i,o)=>U.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"#f1f5f9",borderBottom:"1px solid #e2e8f0",fontWeight:600,color:"#334155"},children:i},o))})}),U.jsx("tbody",{children:t.map((i,o)=>U.jsx("tr",{children:i.map((m,y)=>U.jsx("td",{style:{padding:"5px 10px",borderBottom:"1px solid #f1f5f9",color:"#475569"},children:m},y))},o))})]})}const o3=[{id:"snodas",title:"SNODAS  Snow Data Assimilation System",provider:"NOAA / NOHRSC",resolution:"1 km",temporal:"Daily",coverage:"CONUS",dateRange:"2003 - present",geeCollection:"projects/climate-engine/snodas/daily",whatIsIt:`A modeled snow product that assimilates satellite, ground station, and weather model data into a single consistent daily grid. It's the best "current conditions" snapshot for the US.`,whatOneImageMeans:'A single SNODAS image for a given date shows the estimated snow state AT THAT MOMENT  not accumulated over time, not an average. The SWE band tells you "if you melted all the snow at this pixel right now, how many millimeters of water would you get?" The Snow Depth band tells you the physical depth of the snowpack in meters. These are instantaneous snapshots, not totals or rates.',bands:[{value:"SWE",label:"Snow Water Equivalent (mm)"},{value:"Snow_Depth",label:"Snow Depth (m)"}],proxyEndpoint:`${bg}/api/snow/tiles/snodas`,clickQueryEndpoint:`${bg}/api/snow/stats/snodas?lat={lat}&lon={lng}&start=2025-10-01&end=2026-02-26&band=SWE`,defaultParams:{band:"SWE",date:"2026-02-15"},timeControl:"date",defaultTime:"2026-02-15",colorRamp:{colors:["#f7fbff","#9ecae1","#3182bd","#08519c","#6a1b9a"],min:0,max:500,unit:"mm",label:"SWE"},detailSections:[{title:"Band Details",content:U.jsxs(U.Fragment,{children:[U.jsx(wg,{headers:["Band","Units","Description"],rows:[["SWE","meters","Snow Water Equivalent  depth of water if all snow melted"],["Snow_Depth","meters","Physical depth of the snowpack"]]}),U.jsxs("p",{children:["Pixel values are in ",U.jsx("strong",{children:"meters"})," (float). A SWE value of 0.15 means 150 mm of water equivalent. A Snow_Depth of 0.5 means 50 cm of snow on the ground. No scale factor needed."]})]})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"Not observation-only:"})," SNODAS is a modeled product that assimilates satellite, ground, and NWP data. It can disagree with point measurements."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"CONUS only:"})," No Alaska, Hawaii, or global coverage in GEE version."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Mountain bias:"})," Complex terrain (steep valleys, wind-loaded slopes) can produce SWE under/over-estimates at 1 km resolution."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Data gaps:"})," Occasional 1-2 day gaps, especially in early record (2003-2005)."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Starts 2003:"})," No climatological baseline before that date within this dataset alone."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:'Real-time and recent-historical SWE/snow depth mapping across CONUS. Best for answering "where is snow on the ground right now?" and "how much water is stored in the snowpack?"'})}]},{id:"era5",title:"ERA5-Land  ECMWF Reanalysis",provider:"ECMWF / Copernicus",resolution:"9 km",temporal:"Monthly aggregates (hourly available)",coverage:"Global",dateRange:"1950 - present",geeCollection:"ECMWF/ERA5_LAND/MONTHLY_AGGR",whatIsIt:"A global climate reanalysis product  a physics-based weather model run backwards through history, constrained by observations. It fills in the gaps where no measurements exist.",whatOneImageMeans:`A single ERA5-Land monthly image shows values AGGREGATED OVER THAT MONTH. The "snowfall_sum" band is the TOTAL METERS OF SNOW (water equivalent) that fell during that month  it's a flux, not a state. The "snow_depth" band is the average depth of snow on the ground during that month. The "snow_cover" band is the fraction (0-100%) covered by snow, averaged over the month. Key distinction: snowfall_sum is "how much fell" while snow_depth is "how much is sitting there."`,bands:[{value:"snowfall_sum",label:"Monthly Snowfall Total (m w.e.)"},{value:"snow_depth",label:"Mean Snow Depth (m)"},{value:"snow_cover",label:"Snow Cover Fraction (%)"}],proxyEndpoint:`${bg}/api/snow/tiles/era5`,clickQueryEndpoint:`${bg}/api/snow/stats/era5?lat={lat}&lon={lng}&start=2024-10-01&end=2025-04-01&band=snowfall_sum`,defaultParams:{band:"snowfall_sum",year:"2025",month:"01"},timeControl:"year-month",defaultTime:"2025-01",colorRamp:{colors:["#0d1b2a","#1b263b","#415a77","#778da9","#93c5fd","#a855f7","#e9d5ff"],min:0,max:.5,unit:"m w.e.",label:"Snowfall"},defaultCenter:[-20,50],defaultZoom:2,detailSections:[{title:"Band Details",content:U.jsxs(U.Fragment,{children:[U.jsx(wg,{headers:["Band","Units","Description"],rows:[["snowfall_sum","m water equiv.","Total snowfall for the month. A value of 0.025 = 25 mm snowfall."],["snow_depth","meters","Average depth of snow on ground during the month."],["snow_cover","fraction (0-1)","Fraction of grid cell covered by snow, averaged over month."],["snow_density","kg/m","Mass of snow per cubic meter in the snow layer."],["snow_albedo","fraction (0-1)","Fraction of solar radiation reflected by snow."],["snowmelt_sum","m water equiv.","Accumulated snowmelt for the month."],["temperature_of_snow_layer","Kelvin","Temperature of the snow layer."],["temperature_2m","Kelvin","2-meter air temperature (subtract 273.15 for C)."]]}),U.jsxs("p",{children:["Flow bands (with _sum suffix) are monthly totals. Non-flow bands are monthly averages. ",U.jsx("strong",{children:"Temperatures are in Kelvin"}),"  subtract 273.15 for C."]})]})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"Coarse resolution (9 km):"})," Misses fine-scale snow features  mountain valleys, urban heat islands, lake-effect bands."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Reanalysis artifacts:"})," Occasional negative snowfall values due to GRIB packing precision. Clamp to 0."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"3-month lag:"})," Not suitable for real-time applications."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Model-based:"})," Snow physics are modeled, not directly observed. Can diverge from ground truth in complex terrain."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Early data (1950s-1970s):"})," Fewer assimilated observations  less reliable."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:"Long-term global snow climatology (1950-present). Best for multi-decadal trend analysis, global comparisons, and gap-filling. The 75+ year record is unmatched."})}]},{id:"daymet",title:"Daymet V4  Daily Surface Weather",provider:"NASA / ORNL DAAC",resolution:"1 km",temporal:"Daily",coverage:"North America",dateRange:"1980 - 2024",geeCollection:"NASA/ORNL/DAYMET_V4",whatIsIt:"A station-interpolated daily weather dataset. Takes measurements from weather stations and interpolates them to a 1 km grid accounting for elevation and terrain. The longest continuous high-res daily record for North America.",whatOneImageMeans:'The tile endpoint aggregates by month. For "swe," you see the MEAN DAILY SWE during that month  the average snowpack state. For "prcp," the proxy computes TOTAL SNOWFALL for the month by summing precipitation only on days where minimum temperature was below freezing (tmin < 0C). This is an approximation  real snowfall depends on precipitation type, not just temperature. The "tmin" band shows average daily minimum temperature for the month.',bands:[{value:"swe",label:"Mean Daily SWE (mm)"},{value:"prcp",label:"Monthly Snowfall (mm, precip where tmin<0)"},{value:"tmin",label:"Mean Daily Min Temp (C)"}],proxyEndpoint:`${bg}/api/snow/tiles/daymet`,defaultParams:{band:"swe",year:"2024",month:"01"},timeControl:"year-month",defaultTime:"2024-01",colorRamp:{colors:["#f7fbff","#9ecae1","#3182bd","#08519c","#6a1b9a"],min:0,max:500,unit:"mm",label:"SWE"},detailSections:[{title:"Band Details",content:U.jsx(U.Fragment,{children:U.jsx(wg,{headers:["Band","Units","Description"],rows:[["swe","kg/m (= mm w.e.)","Snow Water Equivalent. Value of 200 = 200 mm SWE."],["prcp","mm/day","Daily total precipitation (all forms). Value of 25 = 25 mm precip."],["tmax","C","Daily maximum 2 m air temperature."],["tmin","C","Daily minimum 2 m air temperature."],["dayl","seconds","Duration of daylight."],["srad","W/m","Shortwave radiation flux density."],["vp","Pa","Water vapor pressure."]]})})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"Not real-time:"})," Annual release cycle means current-season data is unavailable. Latest year is 1-2 years behind."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Interpolated product:"})," Station-based interpolation can miss localized snowfall events in data-sparse regions."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"SWE is modeled:"})," Daymet SWE is derived from a simple snow model driven by precip/temp  not direct measurement."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"V4 improvements:"})," Corrected timing biases and high-elevation temperature issues from V3, but some mountain biases persist."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:"Long-term climatological analysis (1980-present). Ideal for computing 20-year, 30-year, or full-record normals of snowfall, SWE, and temperature. The deep time series is its primary advantage."})}]},{id:"modis",title:"MODIS MOD10A1  Snow Cover",provider:"NASA Terra/Aqua",resolution:"500 m",temporal:"Daily",coverage:"Global",dateRange:"2000 - present",geeCollection:"MODIS/061/MOD10A1",whatIsIt:"Satellite-derived snow cover from optical imagery. Uses the Normalized Difference Snow Index (NDSI) to distinguish snow from clouds, soil, and rock. The highest-resolution global daily snow product.",whatOneImageMeans:'The tile endpoint computes a MONTHLY MEAN of daily NDSI Snow Cover values. Each pixel in a raw daily image is either cloud-obscured (masked out) or a snow fraction 0-100% based on NDSI. The monthly composite averages all cloud-free observations. A pixel showing "60" means on average 60% of that pixel was snow-covered during cloud-free days that month. This is BINARY snow presence, not depth or water equivalent  MODIS cannot tell you HOW MUCH snow, only WHETHER there is snow.',bands:[{value:"NDSI_Snow_Cover",label:"NDSI Snow Cover (0-100%)"}],proxyEndpoint:`${bg}/api/snow/tiles/modis`,defaultParams:{band:"NDSI_Snow_Cover",year:"2025",month:"01"},timeControl:"year-month",defaultTime:"2025-01",colorRamp:{colors:["#8B4513","#D2B48C","#E0E0E0","#FFFFFF","#B0C4DE","#4682B4"],min:0,max:100,unit:"%",label:"Snow Cover"},detailSections:[{title:"Band Details",content:U.jsxs(U.Fragment,{children:[U.jsx(wg,{headers:["Band","Units","Description"],rows:[["NDSI_Snow_Cover","% (0-100)","NDSI snow cover percentage. Values >100 are class codes (cloud, night, ocean)."],["NDSI","dimensionless (0-10000)","Raw NDSI value. Divide by 10000 for true NDSI (-1 to +1 range)."],["Snow_Albedo_Daily_Tile","% (1-100)","Snow albedo percentage."],["NDSI_Snow_Cover_Basic_QA","bitmask","Quality flag (0=Best, 1=Good, 2=OK, 211=Night, 239=Ocean)."],["NDSI_Snow_Cover_Class","categorical","Class values: cloud=250, night=211, water=237."]]}),U.jsxs("p",{children:[U.jsx("strong",{children:"This is snow COVER (fractional), NOT snow DEPTH or SWE."})," It tells you where snow is, not how much."]})]})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"Cloud contamination:"})," Clouds are the #1 issue. Optical sensor = no data under clouds. Cloud fraction can exceed 50% in winter."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"No depth or SWE:"})," Only detects presence/absence of snow, not quantity."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Forest canopy:"})," Dense forest obscures underlying snow, causing underestimation."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Night data gaps:"})," No valid data in nighttime overpasses (polar winter = extended gaps)."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:'High-resolution spatial extent of snow cover (500 m). Best for answering "where is snow on the ground?" Excellent for snow cover area time series and for validating/masking other datasets.'})}]},{id:"snotel",title:"SNOTEL  Ground Station Network",provider:"USDA NRCS",resolution:"Point stations (~880)",temporal:"Hourly",coverage:"Western US Mountains",dateRange:"1980s - present",geeCollection:"N/A  REST API: wcc.sc.egov.usda.gov/reportGenerator/",whatIsIt:"Automated ground stations on snow pillows that physically weigh the snowpack. The gold standard for SWE measurement  everything else is validated against SNOTEL.",whatOneImageMeans:"Not an image  these are point measurements. Each station reports the weight of snow on its pillow (SWE), accumulated precipitation, and air temperature. A single reading tells you the exact SWE at that precise location and elevation. The limitation is spatial: ~880 stations across the entire western US, all at relatively high elevations, so they miss lowland and eastern snow entirely.",isStation:!0,bands:[],proxyEndpoint:"",defaultParams:{},timeControl:"none",defaultCenter:[-110,43],defaultZoom:5,detailSections:[{title:"Parameters (via API)",content:U.jsxs(U.Fragment,{children:[U.jsx(wg,{headers:["Code","Units","Description"],rows:[["WTEQ","inches","Snow Water Equivalent (pillow measurement)  THE gold standard."],["SNWD","inches","Snow Depth (ultrasonic sensor)."],["PREC","inches","Accumulated precipitation."],["PRCP","inches","Precipitation increment (daily)."],["TMAX","F","Maximum air temperature."],["TMIN","F","Minimum air temperature."],["TAVG","F","Average air temperature."]]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Units are imperial"})," (inches, F). Convert: 1 inch = 25.4 mm; F to C = (F - 32) x 5/9."]}),U.jsx("p",{style:{fontSize:11,fontFamily:"monospace",color:"#64748b",marginTop:8},children:"API pattern: https://wcc.sc.egov.usda.gov/reportGenerator/view_csv/customSingleStationReport/daily/{triplet}/{start},{end}/WTEQ::value,SNWD::value"})]})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"Point data only:"})," ~880 stations cannot represent continuous spatial fields. Interpolation required for mapping."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Western US bias:"})," No stations east of the Rockies. Zero coverage for Appalachians, Great Lakes, Northeast."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Elevation bias:"})," Stations are at mid-to-high elevations in key watersheds. Valley floors and extreme summits under-represented."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Pillow errors:"})," Snow bridging, ice layers, and vegetation can affect SWE readings (10-15% error)."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Wind effects:"})," Snow depth sensors can be affected by wind redistribution near the sensor."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:"Ground-truth validation of gridded products. Essential for time-series analysis at specific mountain locations. Gold-standard point SWE measurements for calibrating SNODAS, Daymet, and ERA5-Land."})}]},{id:"gridmet",title:"gridMET  Surface Meteorology",provider:"University of Idaho",resolution:"4 km",temporal:"Daily",coverage:"CONUS",dateRange:"1979 - present",geeCollection:"IDAHO_EPSCOR/GRIDMET",whatIsIt:"High-resolution surface meteorological dataset combining PRISM spatial patterns with NLDAS temporal patterns. Daily temperature, precipitation, wind, and humidity. No direct snow bands  snowfall must be derived from precipitation + temperature thresholds.",whatOneImageMeans:"gridMET has no snow-specific bands. A single image shows daily weather variables: precipitation (mm), min/max temperature (Kelvin), wind, humidity. To estimate snowfall, you filter precipitation to days where temperature is below freezing. This is an approximation  the rain/snow transition depends on atmospheric profile, not just surface temperature.",bands:[{value:"pr",label:"Precipitation (mm/day)"},{value:"tmmn",label:"Min Temperature (K, subtract 273.15 for C)"},{value:"tmmx",label:"Max Temperature (K)"}],proxyEndpoint:"",defaultParams:{},timeControl:"none",detailSections:[{title:"Band Details",content:U.jsx(U.Fragment,{children:U.jsx(wg,{headers:["Band","Units","Description"],rows:[["pr","mm/day","Daily total precipitation (all phases)."],["tmmn","Kelvin","Daily minimum temperature. Subtract 273.15 for C."],["tmmx","Kelvin","Daily maximum temperature."],["srad","W/m","Surface downward shortwave radiation."],["rmax / rmin","%","Max/min relative humidity."],["vs","m/s","Wind velocity at 10 m."],["sph","mass fraction","Specific humidity."]]})})},{title:"Known Limitations",content:U.jsxs("ul",{style:{margin:"4px 0",paddingLeft:20},children:[U.jsxs("li",{children:[U.jsx("strong",{children:"No snow-specific bands:"})," Must infer snowfall from precip when temperature is below a threshold."]}),U.jsx("li",{children:U.jsx("strong",{children:"CONUS only."})}),U.jsxs("li",{children:[U.jsx("strong",{children:"Blended product:"})," Combines PRISM spatial patterns with NLDAS temporal patterns. Edge artifacts possible."]}),U.jsxs("li",{children:[U.jsx("strong",{children:"Provisional data:"})," Recent data may be revised."]})]})},{title:"Best Use Case",content:U.jsx("p",{children:"Context dataset for temperature and precipitation. Best for deriving snowfall proxies when direct snow observations aren't available, and for providing meteorological context (wind, humidity, radiation) to snow analyses."})}]}],s3=[{q:"Where has the most snowfall right now?",datasets:"SNODAS (primary), MODIS + SNOTEL (validation)",method:"Load the latest SNODAS daily image. Map SWE values directly  higher SWE = more snow storage. Classify into bins (trace/light/moderate/heavy/extreme). SNOTEL stations provide ground-truth comparison. MODIS provides 500m optical confirmation of extent.",output:"Choropleth map of current SWE with value labels on hover. State/region rankings sidebar."},{q:"Timelapse of snowfall over this season",datasets:"SNODAS daily",method:"Load SNODAS SWE for each day Oct 1 to present. Composite to weekly means to reduce noise. Animate as a sequence. Fix palette to season's expected max (0-1.5 m SWE) so colors are comparable across frames.",output:"Animated map with play controls, week-by-week snow buildup. Cumulative SWE time series for key regions alongside."},{q:"How is this year comparing to previous years?",datasets:"SNODAS (current) + Daymet (historical baseline)",method:"Compute climatological mean + standard deviation of SWE for this date (e.g., 2003-2023). Subtract from current SNODAS. Express as Z-score: z = (current - mean) / std. Where mean = 0, mask out. Diverging color map centered on 0.",output:"Diverging anomaly map (blue = above normal, red = below normal). Click for current-vs-mean time series chart."},{q:"Timelapse of snowfall anomaly over time",datasets:"ERA5-Land (1950+) or Daymet (1980+)",method:"For each year, compute winter season total snowfall (Oct-Apr). Calculate long-term mean. Compute departure for each year. Animate year by year. Normalize to Z-scores. Optional: 3-year running mean to reduce noise.",output:"Animated anomaly map showing wet/dry snow years. Sparklines for key regions overlaid."},{q:"Historical snowfall  5/10/20 year averages, ranked",datasets:"Daymet V4 (1980-2024)",method:"Compute mean annual snowfall using temperature-threshold method: snowfall = precip where tmax < 2C. f(T) = (4-tmax)/4 for mixed precip. Compute for 5yr, 10yr, 20yr windows. Rank each pixel as percentile vs all CONUS pixels.",output:"Map with percentile coloring + toggle for time window. Click for rank + absolute values."},{q:"When does peak snowfall occur at each location?",datasets:"Daymet or SNODAS",method:"For each pixel, find the calendar month when SWE historically reaches maximum. Compute modal peak month across all years. Mask non-snow pixels (max SWE < 10 mm). Optional: compute peak day-of-year for finer resolution.",output:"Categorical map colored by month. Jan=dark blue through Jun=teal. Reveals the west-to-east and elevation-driven timing gradient."},{q:"How has peak season timing shifted over 5/10/20 years?",datasets:"Daymet (1980-2024), SNOTEL for validation",method:"For each pixel and year, find peak SWE date (DOY). Fit linear regression: peak_doy = b0 + b1*year. Slope = days/year shift. Test significance with Mann-Kendall. Negative slope = earlier peak (less snowpack persistence). Use Theil-Sen slope for outlier resistance.",output:"Diverging map: red = earlier peak (warming signal), blue = later peak. Stippling where p >= 0.05 (not significant). SNOTEL dots overlaid."}],l3=[{name:"Niwot Ridge",lat:40.05,lng:-105.59,elev:11300,state:"CO"},{name:"Berthoud Summit",lat:39.8,lng:-105.78,elev:11300,state:"CO"},{name:"Loveland Basin",lat:39.68,lng:-105.9,elev:11400,state:"CO"},{name:"Tower",lat:44.92,lng:-110.42,elev:6900,state:"WY"},{name:"Togwotee Pass",lat:43.76,lng:-110.08,elev:9580,state:"WY"},{name:"Stevens Pass",lat:47.74,lng:-121.09,elev:4060,state:"WA"},{name:"Paradise",lat:46.79,lng:-121.74,elev:5400,state:"WA"},{name:"Mt Hood Test Site",lat:45.33,lng:-121.72,elev:5400,state:"OR"},{name:"Snowbird",lat:40.56,lng:-111.65,elev:9640,state:"UT"},{name:"Tahoe City Cross",lat:39.17,lng:-120.15,elev:6740,state:"CA"},{name:"Mammoth Pass",lat:37.61,lng:-119.03,elev:9300,state:"CA"}];function u3({onClose:e}){return U.jsxs("div",{style:{position:"fixed",inset:0,zIndex:1e3,background:"#f8fafc",overflowY:"auto"},children:[U.jsxs("div",{style:{position:"sticky",top:0,zIndex:10,background:"#fff",borderBottom:"1px solid #e2e8f0",padding:"16px 32px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[U.jsxs("div",{children:[U.jsx("h1",{style:{margin:0,fontSize:22,fontWeight:700,color:"#0f172a"},children:"Data Methodology"}),U.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"#64748b"},children:"Interactive exploration of each dataset. Change bands, dates, click the map to query values. Expand dropdowns for full technical details."})]}),U.jsx("button",{onClick:e,style:{background:"none",border:"1px solid #cbd5e1",borderRadius:6,padding:"6px 14px",fontSize:13,color:"#475569",cursor:"pointer"},children:"Close"})]}),U.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"24px 32px"},children:[o3.map(t=>U.jsxs("section",{style:{marginBottom:56},children:[U.jsx("h2",{style:{fontSize:18,fontWeight:700,color:"#0f172a",margin:"0 0 4px"},children:t.title}),U.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:12},children:t.provider}),U.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:[`Resolution: ${t.resolution}`,`Temporal: ${t.temporal}`,`Coverage: ${t.coverage}`,`Record: ${t.dateRange}`].map((i,o)=>U.jsx("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:4,padding:"4px 10px",fontSize:11,color:"#475569"},children:i},o))}),U.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"14px 18px",marginBottom:12},children:[U.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#334155",marginBottom:4},children:"What is this dataset?"}),U.jsx("div",{style:{fontSize:13,color:"#475569",lineHeight:1.6},children:t.whatIsIt})]}),U.jsxs("div",{style:{background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:8,padding:"14px 18px",marginBottom:12},children:[U.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#1e40af",marginBottom:4},children:"What does a single image represent?"}),U.jsx("div",{style:{fontSize:13,color:"#1e3a5f",lineHeight:1.6},children:t.whatOneImageMeans})]}),U.jsxs("div",{style:{fontSize:11,color:"#94a3b8",marginBottom:12,fontFamily:"monospace"},children:["GEE: ",t.geeCollection]}),t.detailSections.map((i,o)=>U.jsx(a3,{title:i.title,children:i.content},o)),U.jsx("div",{style:{marginTop:12},children:t.isStation?U.jsx(nE,{proxyEndpoint:"",defaultParams:{},defaultCenter:t.defaultCenter??[-110,43],defaultZoom:t.defaultZoom??5,height:"420px",stationData:{type:"FeatureCollection",features:l3.map(i=>({type:"Feature",geometry:{type:"Point",coordinates:[i.lng,i.lat]},properties:{name:i.name,elevation_ft:i.elev,state:i.state}}))}}):t.proxyEndpoint?U.jsx(nE,{proxyEndpoint:t.proxyEndpoint,defaultParams:t.defaultParams,bands:t.bands.length>1?t.bands:void 0,clickQueryEndpoint:t.clickQueryEndpoint,timeControl:t.timeControl,defaultTime:t.defaultTime,colorRamp:t.colorRamp,defaultCenter:t.defaultCenter??[-106.5,39.5],defaultZoom:t.defaultZoom??5,height:"420px"}):U.jsx("div",{style:{height:120,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,color:"#94a3b8",border:"1px solid #e2e8f0"},children:"No tile endpoint configured for this dataset yet. Used as a context/derivation source."})})]},t.id)),U.jsxs("section",{style:{marginBottom:56},children:[U.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#0f172a",margin:"0 0 8px"},children:"Research Questions"}),U.jsx("p",{style:{fontSize:13,color:"#64748b",marginBottom:20,lineHeight:1.6,maxWidth:800},children:"These are the maps we want to build. Each specifies datasets, statistical approach, and output format. US-only for now."}),U.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:s3.map((t,i)=>U.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"16px 20px"},children:[U.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#0f172a",marginBottom:8},children:["Q",i+1,": ",t.q]}),U.jsxs("div",{style:{fontSize:12,color:"#0369a1",fontWeight:600,marginBottom:4},children:["Datasets: ",t.datasets]}),U.jsxs("div",{style:{fontSize:13,color:"#475569",lineHeight:1.6,marginBottom:6},children:[U.jsx("strong",{style:{color:"#334155"},children:"Method:"})," ",t.method]}),U.jsxs("div",{style:{fontSize:12,color:"#64748b",lineHeight:1.5},children:[U.jsx("strong",{style:{color:"#475569"},children:"Output:"})," ",t.output]})]},i))})]})]})]})}function aD(e){var t,i,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var m=e.length;for(t=0;t<m;t++)e[t]&&(i=aD(e[t]))&&(o&&(o+=" "),o+=i)}else for(i in e)e[i]&&(o&&(o+=" "),o+=i);return o}function Nn(){for(var e,t,i=0,o="",m=arguments.length;i<m;i++)(e=arguments[i])&&(t=aD(e))&&(o&&(o+=" "),o+=t);return o}var c3=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Z2(e){if(typeof e!="string")return!1;var t=c3;return t.includes(e)}var h3=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],f3=new Set(h3);function oD(e){return typeof e!="string"?!1:f3.has(e)}function sD(e){return typeof e=="string"&&e.startsWith("data-")}function bl(e){if(typeof e!="object"||e===null)return{};var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(oD(i)||sD(i))&&(t[i]=e[i]);return t}function Gv(e){if(e==null)return null;if(Z.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return bl(t)}return typeof e=="object"&&!Array.isArray(e)?bl(e):null}function Wo(e){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(oD(i)||sD(i)||Z2(i))&&(t[i]=e[i]);return t}function d3(e){return e==null?null:Z.isValidElement(e)?Wo(e.props):typeof e=="object"&&!Array.isArray(e)?Wo(e):null}var p3=["children","width","height","viewBox","className","style","title","desc"];function $w(){return $w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},$w.apply(null,arguments)}function m3(e,t){if(e==null)return{};var i,o,m=g3(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function g3(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var lD=Z.forwardRef((e,t)=>{var{children:i,width:o,height:m,viewBox:y,className:_,style:c,title:M,desc:C}=e,D=m3(e,p3),k=y||{width:o,height:m,x:0,y:0},F=Nn("recharts-surface",_);return Z.createElement("svg",$w({},Wo(D),{className:F,width:o,height:m,style:c,viewBox:"".concat(k.x," ").concat(k.y," ").concat(k.width," ").concat(k.height),ref:t}),Z.createElement("title",null,M),Z.createElement("desc",null,C),i)}),y3=["children","className"];function Gw(){return Gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Gw.apply(null,arguments)}function v3(e,t){if(e==null)return{};var i,o,m=_3(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function _3(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var Yo=Z.forwardRef((e,t)=>{var{children:i,className:o}=e,m=v3(e,y3),y=Nn("recharts-layer",o);return Z.createElement("g",Gw({className:y},Wo(m),{ref:t}),i)}),uD=nD(),x3=Z.createContext(null);function li(e){return function(){return e}}const cD=Math.cos,W0=Math.sin,cc=Math.sqrt,Y0=Math.PI,Zx=2*Y0,Zw=Math.PI,Hw=2*Zw,Bp=1e-6,b3=Hw-Bp;function hD(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function w3(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hD;const i=10**t;return function(o){this._+=o[0];for(let m=1,y=o.length;m<y;++m)this._+=Math.round(arguments[m]*i)/i+o[m]}}class S3{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hD:w3(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,o,m){this._append`Q${+t},${+i},${this._x1=+o},${this._y1=+m}`}bezierCurveTo(t,i,o,m,y,_){this._append`C${+t},${+i},${+o},${+m},${this._x1=+y},${this._y1=+_}`}arcTo(t,i,o,m,y){if(t=+t,i=+i,o=+o,m=+m,y=+y,y<0)throw new Error(`negative radius: ${y}`);let _=this._x1,c=this._y1,M=o-t,C=m-i,D=_-t,k=c-i,F=D*D+k*k;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(F>Bp)if(!(Math.abs(k*M-C*D)>Bp)||!y)this._append`L${this._x1=t},${this._y1=i}`;else{let G=o-_,K=m-c,W=M*M+C*C,q=G*G+K*K,ue=Math.sqrt(W),me=Math.sqrt(F),ge=y*Math.tan((Zw-Math.acos((W+F-q)/(2*ue*me)))/2),be=ge/me,ze=ge/ue;Math.abs(be-1)>Bp&&this._append`L${t+be*D},${i+be*k}`,this._append`A${y},${y},0,0,${+(k*G>D*K)},${this._x1=t+ze*M},${this._y1=i+ze*C}`}}arc(t,i,o,m,y,_){if(t=+t,i=+i,o=+o,_=!!_,o<0)throw new Error(`negative radius: ${o}`);let c=o*Math.cos(m),M=o*Math.sin(m),C=t+c,D=i+M,k=1^_,F=_?m-y:y-m;this._x1===null?this._append`M${C},${D}`:(Math.abs(this._x1-C)>Bp||Math.abs(this._y1-D)>Bp)&&this._append`L${C},${D}`,o&&(F<0&&(F=F%Hw+Hw),F>b3?this._append`A${o},${o},0,1,${k},${t-c},${i-M}A${o},${o},0,1,${k},${this._x1=C},${this._y1=D}`:F>Bp&&this._append`A${o},${o},0,${+(F>=Zw)},${k},${this._x1=t+o*Math.cos(y)},${this._y1=i+o*Math.sin(y)}`)}rect(t,i,o,m){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${o=+o}v${+m}h${-o}Z`}toString(){return this._}}function H2(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const o=Math.floor(i);if(!(o>=0))throw new RangeError(`invalid digits: ${i}`);t=o}return e},()=>new S3(t)}function W2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fD(e){this._context=e}fD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Hx(e){return new fD(e)}function dD(e){return e[0]}function pD(e){return e[1]}function mD(e,t){var i=li(!0),o=null,m=Hx,y=null,_=H2(c);e=typeof e=="function"?e:e===void 0?dD:li(e),t=typeof t=="function"?t:t===void 0?pD:li(t);function c(M){var C,D=(M=W2(M)).length,k,F=!1,G;for(o==null&&(y=m(G=_())),C=0;C<=D;++C)!(C<D&&i(k=M[C],C,M))===F&&((F=!F)?y.lineStart():y.lineEnd()),F&&y.point(+e(k,C,M),+t(k,C,M));if(G)return y=null,G+""||null}return c.x=function(M){return arguments.length?(e=typeof M=="function"?M:li(+M),c):e},c.y=function(M){return arguments.length?(t=typeof M=="function"?M:li(+M),c):t},c.defined=function(M){return arguments.length?(i=typeof M=="function"?M:li(!!M),c):i},c.curve=function(M){return arguments.length?(m=M,o!=null&&(y=m(o)),c):m},c.context=function(M){return arguments.length?(M==null?o=y=null:y=m(o=M),c):o},c}function w0(e,t,i){var o=null,m=li(!0),y=null,_=Hx,c=null,M=H2(C);e=typeof e=="function"?e:e===void 0?dD:li(+e),t=typeof t=="function"?t:li(t===void 0?0:+t),i=typeof i=="function"?i:i===void 0?pD:li(+i);function C(k){var F,G,K,W=(k=W2(k)).length,q,ue=!1,me,ge=new Array(W),be=new Array(W);for(y==null&&(c=_(me=M())),F=0;F<=W;++F){if(!(F<W&&m(q=k[F],F,k))===ue)if(ue=!ue)G=F,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),K=F-1;K>=G;--K)c.point(ge[K],be[K]);c.lineEnd(),c.areaEnd()}ue&&(ge[F]=+e(q,F,k),be[F]=+t(q,F,k),c.point(o?+o(q,F,k):ge[F],i?+i(q,F,k):be[F]))}if(me)return c=null,me+""||null}function D(){return mD().defined(m).curve(_).context(y)}return C.x=function(k){return arguments.length?(e=typeof k=="function"?k:li(+k),o=null,C):e},C.x0=function(k){return arguments.length?(e=typeof k=="function"?k:li(+k),C):e},C.x1=function(k){return arguments.length?(o=k==null?null:typeof k=="function"?k:li(+k),C):o},C.y=function(k){return arguments.length?(t=typeof k=="function"?k:li(+k),i=null,C):t},C.y0=function(k){return arguments.length?(t=typeof k=="function"?k:li(+k),C):t},C.y1=function(k){return arguments.length?(i=k==null?null:typeof k=="function"?k:li(+k),C):i},C.lineX0=C.lineY0=function(){return D().x(e).y(t)},C.lineY1=function(){return D().x(e).y(i)},C.lineX1=function(){return D().x(o).y(t)},C.defined=function(k){return arguments.length?(m=typeof k=="function"?k:li(!!k),C):m},C.curve=function(k){return arguments.length?(_=k,y!=null&&(c=_(y)),C):_},C.context=function(k){return arguments.length?(k==null?y=c=null:c=_(y=k),C):y},C}class gD{constructor(t,i){this._context=t,this._x=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,i){switch(t=+t,i=+i,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,i,t,i):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+i)/2,t,this._y0,t,i);break}}this._x0=t,this._y0=i}}function T3(e){return new gD(e,!0)}function E3(e){return new gD(e,!1)}const Y2={draw(e,t){const i=cc(t/Y0);e.moveTo(i,0),e.arc(0,0,i,0,Zx)}},A3={draw(e,t){const i=cc(t/5)/2;e.moveTo(-3*i,-i),e.lineTo(-i,-i),e.lineTo(-i,-3*i),e.lineTo(i,-3*i),e.lineTo(i,-i),e.lineTo(3*i,-i),e.lineTo(3*i,i),e.lineTo(i,i),e.lineTo(i,3*i),e.lineTo(-i,3*i),e.lineTo(-i,i),e.lineTo(-3*i,i),e.closePath()}},yD=cc(1/3),M3=yD*2,P3={draw(e,t){const i=cc(t/M3),o=i*yD;e.moveTo(0,-i),e.lineTo(o,0),e.lineTo(0,i),e.lineTo(-o,0),e.closePath()}},C3={draw(e,t){const i=cc(t),o=-i/2;e.rect(o,o,i,i)}},D3=.8908130915292852,vD=W0(Y0/10)/W0(7*Y0/10),O3=W0(Zx/10)*vD,I3=-cD(Zx/10)*vD,z3={draw(e,t){const i=cc(t*D3),o=O3*i,m=I3*i;e.moveTo(0,-i),e.lineTo(o,m);for(let y=1;y<5;++y){const _=Zx*y/5,c=cD(_),M=W0(_);e.lineTo(M*i,-c*i),e.lineTo(c*o-M*m,M*o+c*m)}e.closePath()}},o1=cc(3),k3={draw(e,t){const i=-cc(t/(o1*3));e.moveTo(0,i*2),e.lineTo(-o1*i,-i),e.lineTo(o1*i,-i),e.closePath()}},ou=-.5,su=cc(3)/2,Ww=1/cc(12),R3=(Ww/2+1)*3,j3={draw(e,t){const i=cc(t/R3),o=i/2,m=i*Ww,y=o,_=i*Ww+i,c=-y,M=_;e.moveTo(o,m),e.lineTo(y,_),e.lineTo(c,M),e.lineTo(ou*o-su*m,su*o+ou*m),e.lineTo(ou*y-su*_,su*y+ou*_),e.lineTo(ou*c-su*M,su*c+ou*M),e.lineTo(ou*o+su*m,ou*m-su*o),e.lineTo(ou*y+su*_,ou*_-su*y),e.lineTo(ou*c+su*M,ou*M-su*c),e.closePath()}};function L3(e,t){let i=null,o=H2(m);e=typeof e=="function"?e:li(e||Y2),t=typeof t=="function"?t:li(t===void 0?64:+t);function m(){let y;if(i||(i=y=o()),e.apply(this,arguments).draw(i,+t.apply(this,arguments)),y)return i=null,y+""||null}return m.type=function(y){return arguments.length?(e=typeof y=="function"?y:li(y),m):e},m.size=function(y){return arguments.length?(t=typeof y=="function"?y:li(+y),m):t},m.context=function(y){return arguments.length?(i=y??null,m):i},m}function X0(){}function K0(e,t,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6)}function _D(e){this._context=e}_D.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:K0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:K0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function N3(e){return new _D(e)}function xD(e){this._context=e}xD.prototype={areaStart:X0,areaEnd:X0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:K0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function B3(e){return new xD(e)}function bD(e){this._context=e}bD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(i,o):this._context.moveTo(i,o);break;case 3:this._point=4;default:K0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function F3(e){return new bD(e)}function wD(e){this._context=e}wD.prototype={areaStart:X0,areaEnd:X0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function U3(e){return new wD(e)}function iE(e){return e<0?-1:1}function aE(e,t,i){var o=e._x1-e._x0,m=t-e._x1,y=(e._y1-e._y0)/(o||m<0&&-0),_=(i-e._y1)/(m||o<0&&-0),c=(y*m+_*o)/(o+m);return(iE(y)+iE(_))*Math.min(Math.abs(y),Math.abs(_),.5*Math.abs(c))||0}function oE(e,t){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function s1(e,t,i){var o=e._x0,m=e._y0,y=e._x1,_=e._y1,c=(y-o)/3;e._context.bezierCurveTo(o+c,m+c*t,y-c,_-c*i,y,_)}function Q0(e){this._context=e}Q0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:s1(this,this._t0,oE(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,s1(this,oE(this,i=aE(this,e,t)),i);break;default:s1(this,this._t0,i=aE(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}};function SD(e){this._context=new TD(e)}(SD.prototype=Object.create(Q0.prototype)).point=function(e,t){Q0.prototype.point.call(this,t,e)};function TD(e){this._context=e}TD.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,i,o,m,y){this._context.bezierCurveTo(t,e,o,i,y,m)}};function V3(e){return new Q0(e)}function q3(e){return new SD(e)}function ED(e){this._context=e}ED.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),i===2)this._context.lineTo(e[1],t[1]);else for(var o=sE(e),m=sE(t),y=0,_=1;_<i;++y,++_)this._context.bezierCurveTo(o[0][y],m[0][y],o[1][y],m[1][y],e[_],t[_]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function sE(e){var t,i=e.length-1,o,m=new Array(i),y=new Array(i),_=new Array(i);for(m[0]=0,y[0]=2,_[0]=e[0]+2*e[1],t=1;t<i-1;++t)m[t]=1,y[t]=4,_[t]=4*e[t]+2*e[t+1];for(m[i-1]=2,y[i-1]=7,_[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)o=m[t]/y[t-1],y[t]-=o,_[t]-=o*_[t-1];for(m[i-1]=_[i-1]/y[i-1],t=i-2;t>=0;--t)m[t]=(_[t]-m[t+1])/y[t];for(y[i-1]=(e[i]+m[i-1])/2,t=0;t<i-1;++t)y[t]=2*e[t+1]-m[t+1];return[m,y]}function $3(e){return new ED(e)}function Wx(e,t){this._context=e,this._t=t}Wx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,t)}break}}this._x=e,this._y=t}};function G3(e){return new Wx(e,.5)}function Z3(e){return new Wx(e,0)}function H3(e){return new Wx(e,1)}function Jp(e,t){if((_=e.length)>1)for(var i=1,o,m,y=e[t[0]],_,c=y.length;i<_;++i)for(m=y,y=e[t[i]],o=0;o<c;++o)y[o][1]+=y[o][0]=isNaN(m[o][1])?m[o][0]:m[o][1]}function Yw(e){for(var t=e.length,i=new Array(t);--t>=0;)i[t]=t;return i}function W3(e,t){return e[t]}function Y3(e){const t=[];return t.key=e,t}function X3(){var e=li([]),t=Yw,i=Jp,o=W3;function m(y){var _=Array.from(e.apply(this,arguments),Y3),c,M=_.length,C=-1,D;for(const k of y)for(c=0,++C;c<M;++c)(_[c][C]=[0,+o(k,_[c].key,C,y)]).data=k;for(c=0,D=W2(t(_));c<M;++c)_[D[c]].index=c;return i(_,D),_}return m.keys=function(y){return arguments.length?(e=typeof y=="function"?y:li(Array.from(y)),m):e},m.value=function(y){return arguments.length?(o=typeof y=="function"?y:li(+y),m):o},m.order=function(y){return arguments.length?(t=y==null?Yw:typeof y=="function"?y:li(Array.from(y)),m):t},m.offset=function(y){return arguments.length?(i=y??Jp,m):i},m}function K3(e,t){if((o=e.length)>0){for(var i,o,m=0,y=e[0].length,_;m<y;++m){for(_=i=0;i<o;++i)_+=e[i][m][1]||0;if(_)for(i=0;i<o;++i)e[i][m][1]/=_}Jp(e,t)}}function Q3(e,t){if((m=e.length)>0){for(var i=0,o=e[t[0]],m,y=o.length;i<y;++i){for(var _=0,c=0;_<m;++_)c+=e[_][i][1]||0;o[i][1]+=o[i][0]=-c/2}Jp(e,t)}}function J3(e,t){if(!(!((_=e.length)>0)||!((y=(m=e[t[0]]).length)>0))){for(var i=0,o=1,m,y,_;o<y;++o){for(var c=0,M=0,C=0;c<_;++c){for(var D=e[t[c]],k=D[o][1]||0,F=D[o-1][1]||0,G=(k-F)/2,K=0;K<c;++K){var W=e[t[K]],q=W[o][1]||0,ue=W[o-1][1]||0;G+=q-ue}M+=k,C+=G*k}m[o-1][1]+=m[o-1][0]=i,M&&(i-=C/M)}m[o-1][1]+=m[o-1][0]=i,Jp(e,t)}}var l1={},u1={},lE;function ej(){return lE||(lE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==="__proto__"}e.isUnsafeProperty=t})(u1)),u1}var c1={},uE;function AD(){return uE||(uE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){switch(typeof i){case"number":case"symbol":return!1;case"string":return i.includes(".")||i.includes("[")||i.includes("]")}}e.isDeepKey=t})(c1)),c1}var h1={},cE;function X2(){return cE||(cE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="string"||typeof i=="symbol"?i:Object.is(i?.valueOf?.(),-0)?"-0":String(i)}e.toKey=t})(h1)),h1}var f1={},d1={},hE;function tj(){return hE||(hE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){if(i==null)return"";if(typeof i=="string")return i;if(Array.isArray(i))return i.map(t).join(",");const o=String(i);return o==="0"&&Object.is(Number(i),-0)?"-0":o}e.toString=t})(d1)),d1}var fE;function K2(){return fE||(fE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tj(),i=X2();function o(m){if(Array.isArray(m))return m.map(i.toKey);if(typeof m=="symbol")return[m];m=t.toString(m);const y=[],_=m.length;if(_===0)return y;let c=0,M="",C="",D=!1;for(m.charCodeAt(0)===46&&(y.push(""),c++);c<_;){const k=m[c];C?k==="\\"&&c+1<_?(c++,M+=m[c]):k===C?C="":M+=k:D?k==='"'||k==="'"?C=k:k==="]"?(D=!1,y.push(M),M=""):M+=k:k==="["?(D=!0,M&&(y.push(M),M="")):k==="."?M&&(y.push(M),M=""):M+=k,c++}return M&&y.push(M),y}e.toPath=o})(f1)),f1}var dE;function Q2(){return dE||(dE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ej(),i=AD(),o=X2(),m=K2();function y(c,M,C){if(c==null)return C;switch(typeof M){case"string":{if(t.isUnsafeProperty(M))return C;const D=c[M];return D===void 0?i.isDeepKey(M)?y(c,m.toPath(M),C):C:D}case"number":case"symbol":{typeof M=="number"&&(M=o.toKey(M));const D=c[M];return D===void 0?C:D}default:{if(Array.isArray(M))return _(c,M,C);if(Object.is(M?.valueOf(),-0)?M="-0":M=String(M),t.isUnsafeProperty(M))return C;const D=c[M];return D===void 0?C:D}}}function _(c,M,C){if(M.length===0)return C;let D=c;for(let k=0;k<M.length;k++){if(D==null||t.isUnsafeProperty(M[k]))return C;D=D[M[k]]}return D===void 0?C:D}e.get=y})(l1)),l1}var p1,pE;function rj(){return pE||(pE=1,p1=Q2().get),p1}var nj=rj();const Ng=uh(nj);var ij=4;function Ld(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ij,i=10**t,o=Math.round(e*i)/i;return Object.is(o,-0)?0:o}function $i(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.reduce((m,y,_)=>{var c=i[_-1];return typeof c=="string"?m+c+y:c!==void 0?m+Ld(c)+y:m+y},"")}var Vs=e=>e===0?0:e>0?1:-1,sc=e=>typeof e=="number"&&e!=+e,em=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Jt=e=>(typeof e=="number"||e instanceof Number)&&!sc(e),ih=e=>Jt(e)||typeof e=="string",aj=0,Cv=e=>{var t=++aj;return"".concat(e||"").concat(t)},lc=function(t,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Jt(t)&&typeof t!="string")return o;var y;if(em(t)){if(i==null)return o;var _=t.indexOf("%");y=i*parseFloat(t.slice(0,_))/100}else y=+t;return sc(y)&&(y=o),m&&i!=null&&y>i&&(y=i),y},MD=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,i={},o=0;o<t;o++)if(!i[String(e[o])])i[String(e[o])]=!0;else return!0;return!1};function Gn(e,t,i){return Jt(e)&&Jt(t)?Ld(e+i*(t-e)):t}function PD(e,t,i){if(!(!e||!e.length))return e.find(o=>o&&(typeof t=="function"?t(o):Ng(o,t))===i)}var Ei=e=>e===null||typeof e>"u",Zv=e=>Ei(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function qs(e){return e!=null}function Vd(){}var oj=["type","size","sizeType"];function Xw(){return Xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Xw.apply(null,arguments)}function mE(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function gE(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?mE(Object(i),!0).forEach(function(o){sj(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mE(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function sj(e,t,i){return(t=lj(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function lj(e){var t=uj(e,"string");return typeof t=="symbol"?t:t+""}function uj(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cj(e,t){if(e==null)return{};var i,o,m=hj(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function hj(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var CD={symbolCircle:Y2,symbolCross:A3,symbolDiamond:P3,symbolSquare:C3,symbolStar:z3,symbolTriangle:k3,symbolWye:j3},fj=Math.PI/180,dj=e=>{var t="symbol".concat(Zv(e));return CD[t]||Y2},pj=(e,t,i)=>{if(t==="area")return e;switch(i){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var o=18*fj;return 1.25*e*e*(Math.tan(o)-Math.tan(o*2)*Math.tan(o)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},mj=(e,t)=>{CD["symbol".concat(Zv(e))]=t},DD=e=>{var{type:t="circle",size:i=64,sizeType:o="area"}=e,m=cj(e,oj),y=gE(gE({},m),{},{type:t,size:i,sizeType:o}),_="circle";typeof t=="string"&&(_=t);var c=()=>{var F=dj(_),G=L3().type(F).size(pj(i,o,_)),K=G();if(K!==null)return K},{className:M,cx:C,cy:D}=y,k=Wo(y);return Jt(C)&&Jt(D)&&Jt(i)?Z.createElement("path",Xw({},k,{className:Nn("recharts-symbols",M),transform:"translate(".concat(C,", ").concat(D,")"),d:c()})):null};DD.registerSymbol=mj;var OD=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,J2=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(Z.isValidElement(e)&&(i=e.props),typeof i!="object"&&typeof i!="function")return null;var o={};return Object.keys(i).forEach(m=>{Z2(m)&&(o[m]=(y=>i[m](i,y)))}),o},gj=(e,t,i)=>o=>(e(t,i,o),null),eS=(e,t,i)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var o=null;return Object.keys(e).forEach(m=>{var y=e[m];Z2(m)&&typeof y=="function"&&(o||(o={}),o[m]=gj(y,t,i))}),o};function yE(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function yj(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(i),!0).forEach(function(o){vj(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yE(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function vj(e,t,i){return(t=_j(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _j(e){var t=xj(e,"string");return typeof t=="symbol"?t:t+""}function xj(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ro(e,t){var i=yj({},e),o=t,m=Object.keys(t),y=m.reduce((_,c)=>(_[c]===void 0&&o[c]!==void 0&&(_[c]=o[c]),_),i);return y}var m1={},g1={},vE;function bj(){return vE||(vE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,o){const m=new Map;for(let y=0;y<i.length;y++){const _=i[y],c=o(_,y,i);m.has(c)||m.set(c,_)}return Array.from(m.values())}e.uniqBy=t})(g1)),g1}var y1={},_E;function wj(){return _E||(_E=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,o){return function(...m){return i.apply(this,m.slice(0,o))}}e.ary=t})(y1)),y1}var v1={},xE;function ID(){return xE||(xE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i}e.identity=t})(v1)),v1}var _1={},x1={},b1={},bE;function Sj(){return bE||(bE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Number.isSafeInteger(i)&&i>=0}e.isLength=t})(b1)),b1}var wE;function tS(){return wE||(wE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sj();function i(o){return o!=null&&typeof o!="function"&&t.isLength(o.length)}e.isArrayLike=i})(x1)),x1}var w1={},SE;function Tj(){return SE||(SE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="object"&&i!==null}e.isObjectLike=t})(w1)),w1}var TE;function Ej(){return TE||(TE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tS(),i=Tj();function o(m){return i.isObjectLike(m)&&t.isArrayLike(m)}e.isArrayLikeObject=o})(_1)),_1}var S1={},T1={},EE;function Aj(){return EE||(EE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q2();function i(o){return function(m){return t.get(m,o)}}e.property=i})(T1)),T1}var E1={},A1={},M1={},P1={},AE;function zD(){return AE||(AE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i!==null&&(typeof i=="object"||typeof i=="function")}e.isObject=t})(P1)),P1}var C1={},ME;function kD(){return ME||(ME=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==null||typeof i!="object"&&typeof i!="function"}e.isPrimitive=t})(C1)),C1}var D1={},PE;function RD(){return PE||(PE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,o){return i===o||Number.isNaN(i)&&Number.isNaN(o)}e.isEqualsSameValueZero=t})(D1)),D1}var CE;function Mj(){return CE||(CE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zD(),i=kD(),o=RD();function m(D,k,F){return typeof F!="function"?m(D,k,()=>{}):y(D,k,function G(K,W,q,ue,me,ge){const be=F(K,W,q,ue,me,ge);return be!==void 0?!!be:y(K,W,G,ge)},new Map)}function y(D,k,F,G){if(k===D)return!0;switch(typeof k){case"object":return _(D,k,F,G);case"function":return Object.keys(k).length>0?y(D,{...k},F,G):o.isEqualsSameValueZero(D,k);default:return t.isObject(D)?typeof k=="string"?k==="":!0:o.isEqualsSameValueZero(D,k)}}function _(D,k,F,G){if(k==null)return!0;if(Array.isArray(k))return M(D,k,F,G);if(k instanceof Map)return c(D,k,F,G);if(k instanceof Set)return C(D,k,F,G);const K=Object.keys(k);if(D==null||i.isPrimitive(D))return K.length===0;if(K.length===0)return!0;if(G?.has(k))return G.get(k)===D;G?.set(k,D);try{for(let W=0;W<K.length;W++){const q=K[W];if(!i.isPrimitive(D)&&!(q in D)||k[q]===void 0&&D[q]!==void 0||k[q]===null&&D[q]!==null||!F(D[q],k[q],q,D,k,G))return!1}return!0}finally{G?.delete(k)}}function c(D,k,F,G){if(k.size===0)return!0;if(!(D instanceof Map))return!1;for(const[K,W]of k.entries()){const q=D.get(K);if(F(q,W,K,D,k,G)===!1)return!1}return!0}function M(D,k,F,G){if(k.length===0)return!0;if(!Array.isArray(D))return!1;const K=new Set;for(let W=0;W<k.length;W++){const q=k[W];let ue=!1;for(let me=0;me<D.length;me++){if(K.has(me))continue;const ge=D[me];let be=!1;if(F(ge,q,W,D,k,G)&&(be=!0),be){K.add(me),ue=!0;break}}if(!ue)return!1}return!0}function C(D,k,F,G){return k.size===0?!0:D instanceof Set?M([...D],[...k],F,G):!1}e.isMatchWith=m,e.isSetMatch=C})(M1)),M1}var DE;function jD(){return DE||(DE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Mj();function i(o,m){return t.isMatchWith(o,m,()=>{})}e.isMatch=i})(A1)),A1}var O1={},I1={},z1={},OE;function Pj(){return OE||(OE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Object.getOwnPropertySymbols(i).filter(o=>Object.prototype.propertyIsEnumerable.call(i,o))}e.getSymbols=t})(z1)),z1}var k1={},IE;function rS(){return IE||(IE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}e.getTag=t})(k1)),k1}var R1={},zE;function LD(){return zE||(zE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",i="[object String]",o="[object Number]",m="[object Boolean]",y="[object Arguments]",_="[object Symbol]",c="[object Date]",M="[object Map]",C="[object Set]",D="[object Array]",k="[object Function]",F="[object ArrayBuffer]",G="[object Object]",K="[object Error]",W="[object DataView]",q="[object Uint8Array]",ue="[object Uint8ClampedArray]",me="[object Uint16Array]",ge="[object Uint32Array]",be="[object BigUint64Array]",ze="[object Int8Array]",Ae="[object Int16Array]",Oe="[object Int32Array]",rt="[object BigInt64Array]",gt="[object Float32Array]",yt="[object Float64Array]";e.argumentsTag=y,e.arrayBufferTag=F,e.arrayTag=D,e.bigInt64ArrayTag=rt,e.bigUint64ArrayTag=be,e.booleanTag=m,e.dataViewTag=W,e.dateTag=c,e.errorTag=K,e.float32ArrayTag=gt,e.float64ArrayTag=yt,e.functionTag=k,e.int16ArrayTag=Ae,e.int32ArrayTag=Oe,e.int8ArrayTag=ze,e.mapTag=M,e.numberTag=o,e.objectTag=G,e.regexpTag=t,e.setTag=C,e.stringTag=i,e.symbolTag=_,e.uint16ArrayTag=me,e.uint32ArrayTag=ge,e.uint8ArrayTag=q,e.uint8ClampedArrayTag=ue})(R1)),R1}var j1={},kE;function Cj(){return kE||(kE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}e.isTypedArray=t})(j1)),j1}var RE;function ND(){return RE||(RE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pj(),i=rS(),o=LD(),m=kD(),y=Cj();function _(D,k){return c(D,void 0,D,new Map,k)}function c(D,k,F,G=new Map,K=void 0){const W=K?.(D,k,F,G);if(W!==void 0)return W;if(m.isPrimitive(D))return D;if(G.has(D))return G.get(D);if(Array.isArray(D)){const q=new Array(D.length);G.set(D,q);for(let ue=0;ue<D.length;ue++)q[ue]=c(D[ue],ue,F,G,K);return Object.hasOwn(D,"index")&&(q.index=D.index),Object.hasOwn(D,"input")&&(q.input=D.input),q}if(D instanceof Date)return new Date(D.getTime());if(D instanceof RegExp){const q=new RegExp(D.source,D.flags);return q.lastIndex=D.lastIndex,q}if(D instanceof Map){const q=new Map;G.set(D,q);for(const[ue,me]of D)q.set(ue,c(me,ue,F,G,K));return q}if(D instanceof Set){const q=new Set;G.set(D,q);for(const ue of D)q.add(c(ue,void 0,F,G,K));return q}if(typeof Buffer<"u"&&Buffer.isBuffer(D))return D.subarray();if(y.isTypedArray(D)){const q=new(Object.getPrototypeOf(D)).constructor(D.length);G.set(D,q);for(let ue=0;ue<D.length;ue++)q[ue]=c(D[ue],ue,F,G,K);return q}if(D instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&D instanceof SharedArrayBuffer)return D.slice(0);if(D instanceof DataView){const q=new DataView(D.buffer.slice(0),D.byteOffset,D.byteLength);return G.set(D,q),M(q,D,F,G,K),q}if(typeof File<"u"&&D instanceof File){const q=new File([D],D.name,{type:D.type});return G.set(D,q),M(q,D,F,G,K),q}if(typeof Blob<"u"&&D instanceof Blob){const q=new Blob([D],{type:D.type});return G.set(D,q),M(q,D,F,G,K),q}if(D instanceof Error){const q=new D.constructor;return G.set(D,q),q.message=D.message,q.name=D.name,q.stack=D.stack,q.cause=D.cause,M(q,D,F,G,K),q}if(D instanceof Boolean){const q=new Boolean(D.valueOf());return G.set(D,q),M(q,D,F,G,K),q}if(D instanceof Number){const q=new Number(D.valueOf());return G.set(D,q),M(q,D,F,G,K),q}if(D instanceof String){const q=new String(D.valueOf());return G.set(D,q),M(q,D,F,G,K),q}if(typeof D=="object"&&C(D)){const q=Object.create(Object.getPrototypeOf(D));return G.set(D,q),M(q,D,F,G,K),q}return D}function M(D,k,F=D,G,K){const W=[...Object.keys(k),...t.getSymbols(k)];for(let q=0;q<W.length;q++){const ue=W[q],me=Object.getOwnPropertyDescriptor(D,ue);(me==null||me.writable)&&(D[ue]=c(k[ue],ue,F,G,K))}}function C(D){switch(i.getTag(D)){case o.argumentsTag:case o.arrayTag:case o.arrayBufferTag:case o.dataViewTag:case o.booleanTag:case o.dateTag:case o.float32ArrayTag:case o.float64ArrayTag:case o.int8ArrayTag:case o.int16ArrayTag:case o.int32ArrayTag:case o.mapTag:case o.numberTag:case o.objectTag:case o.regexpTag:case o.setTag:case o.stringTag:case o.symbolTag:case o.uint8ArrayTag:case o.uint8ClampedArrayTag:case o.uint16ArrayTag:case o.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=_,e.cloneDeepWithImpl=c,e.copyProperties=M})(I1)),I1}var jE;function Dj(){return jE||(jE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ND();function i(o){return t.cloneDeepWithImpl(o,void 0,o,new Map,void 0)}e.cloneDeep=i})(O1)),O1}var LE;function Oj(){return LE||(LE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jD(),i=Dj();function o(m){return m=i.cloneDeep(m),y=>t.isMatch(y,m)}e.matches=o})(E1)),E1}var L1={},N1={},B1={},NE;function Ij(){return NE||(NE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ND(),i=rS(),o=LD();function m(y,_){return t.cloneDeepWith(y,(c,M,C,D)=>{const k=_?.(c,M,C,D);if(k!==void 0)return k;if(typeof y=="object"){if(i.getTag(y)===o.objectTag&&typeof y.constructor!="function"){const F={};return D.set(y,F),t.copyProperties(F,y,C,D),F}switch(Object.prototype.toString.call(y)){case o.numberTag:case o.stringTag:case o.booleanTag:{const F=new y.constructor(y?.valueOf());return t.copyProperties(F,y),F}case o.argumentsTag:{const F={};return t.copyProperties(F,y),F.length=y.length,F[Symbol.iterator]=y[Symbol.iterator],F}default:return}}})}e.cloneDeepWith=m})(B1)),B1}var BE;function zj(){return BE||(BE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ij();function i(o){return t.cloneDeepWith(o)}e.cloneDeep=i})(N1)),N1}var F1={},U1={},FE;function BD(){return FE||(FE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function i(o,m=Number.MAX_SAFE_INTEGER){switch(typeof o){case"number":return Number.isInteger(o)&&o>=0&&o<m;case"symbol":return!1;case"string":return t.test(o)}}e.isIndex=i})(U1)),U1}var V1={},UE;function kj(){return UE||(UE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rS();function i(o){return o!==null&&typeof o=="object"&&t.getTag(o)==="[object Arguments]"}e.isArguments=i})(V1)),V1}var VE;function Rj(){return VE||(VE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AD(),i=BD(),o=kj(),m=K2();function y(_,c){let M;if(Array.isArray(c)?M=c:typeof c=="string"&&t.isDeepKey(c)&&_?.[c]==null?M=m.toPath(c):M=[c],M.length===0)return!1;let C=_;for(let D=0;D<M.length;D++){const k=M[D];if((C==null||!Object.hasOwn(C,k))&&!((Array.isArray(C)||o.isArguments(C))&&i.isIndex(k)&&k<C.length))return!1;C=C[k]}return!0}e.has=y})(F1)),F1}var qE;function jj(){return qE||(qE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jD(),i=X2(),o=zj(),m=Q2(),y=Rj();function _(c,M){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=i.toKey(c);break}}return M=o.cloneDeep(M),function(C){const D=m.get(C,c);return D===void 0?y.has(C,c):M===void 0?D===void 0:t.isMatch(D,M)}}e.matchesProperty=_})(L1)),L1}var $E;function Lj(){return $E||($E=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ID(),i=Aj(),o=Oj(),m=jj();function y(_){if(_==null)return t.identity;switch(typeof _){case"function":return _;case"object":return Array.isArray(_)&&_.length===2?m.matchesProperty(_[0],_[1]):o.matches(_);case"string":case"symbol":case"number":return i.property(_)}}e.iteratee=y})(S1)),S1}var GE;function Nj(){return GE||(GE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bj(),i=wj(),o=ID(),m=Ej(),y=Lj();function _(c,M=o.identity){return m.isArrayLikeObject(c)?t.uniqBy(Array.from(c),i.ary(y.iteratee(M),1)):[]}e.uniqBy=_})(m1)),m1}var q1,ZE;function Bj(){return ZE||(ZE=1,q1=Nj().uniqBy),q1}var Fj=Bj();const HE=uh(Fj);function Uj(e,t,i){return t===!0?HE(e,i):typeof t=="function"?HE(e,t):e}var $1={exports:{}},G1={},Z1={exports:{}},H1={};var WE;function Vj(){if(WE)return H1;WE=1;var e=$g();function t(k,F){return k===F&&(k!==0||1/k===1/F)||k!==k&&F!==F}var i=typeof Object.is=="function"?Object.is:t,o=e.useState,m=e.useEffect,y=e.useLayoutEffect,_=e.useDebugValue;function c(k,F){var G=F(),K=o({inst:{value:G,getSnapshot:F}}),W=K[0].inst,q=K[1];return y(function(){W.value=G,W.getSnapshot=F,M(W)&&q({inst:W})},[k,G,F]),m(function(){return M(W)&&q({inst:W}),k(function(){M(W)&&q({inst:W})})},[k]),_(G),G}function M(k){var F=k.getSnapshot;k=k.value;try{var G=F();return!i(k,G)}catch{return!0}}function C(k,F){return F()}var D=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?C:c;return H1.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:D,H1}var YE;function qj(){return YE||(YE=1,Z1.exports=Vj()),Z1.exports}var XE;function $j(){if(XE)return G1;XE=1;var e=$g(),t=qj();function i(C,D){return C===D&&(C!==0||1/C===1/D)||C!==C&&D!==D}var o=typeof Object.is=="function"?Object.is:i,m=t.useSyncExternalStore,y=e.useRef,_=e.useEffect,c=e.useMemo,M=e.useDebugValue;return G1.useSyncExternalStoreWithSelector=function(C,D,k,F,G){var K=y(null);if(K.current===null){var W={hasValue:!1,value:null};K.current=W}else W=K.current;K=c(function(){function ue(Ae){if(!me){if(me=!0,ge=Ae,Ae=F(Ae),G!==void 0&&W.hasValue){var Oe=W.value;if(G(Oe,Ae))return be=Oe}return be=Ae}if(Oe=be,o(ge,Ae))return Oe;var rt=F(Ae);return G!==void 0&&G(Oe,rt)?(ge=Ae,Oe):(ge=Ae,be=rt)}var me=!1,ge,be,ze=k===void 0?null:k;return[function(){return ue(D())},ze===null?void 0:function(){return ue(ze())}]},[D,k,F,G]);var q=m(C,K[0],K[1]);return _(function(){W.hasValue=!0,W.value=q},[q]),M(q),q},G1}var KE;function Gj(){return KE||(KE=1,$1.exports=$j()),$1.exports}var Zj=Gj(),nS=Z.createContext(null),Hj=e=>e,ea=()=>{var e=Z.useContext(nS);return e?e.store.dispatch:Hj},U0=()=>{},Wj=()=>U0,Yj=(e,t)=>e===t;function dr(e){var t=Z.useContext(nS),i=Z.useMemo(()=>t?o=>{if(o!=null)return e(o)}:U0,[t,e]);return Zj.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Wj,t?t.store.getState:U0,t?t.store.getState:U0,i,Yj)}function Xj(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Kj(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Qj(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(i=>typeof i=="function")){const i=e.map(o=>typeof o=="function"?`function ${o.name||"unnamed"}()`:typeof o).join(", ");throw new TypeError(`${t}[${i}]`)}}var QE=e=>Array.isArray(e)?e:[e];function Jj(e){const t=Array.isArray(e[0])?e[0]:e;return Qj(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function eL(e,t){const i=[],{length:o}=e;for(let m=0;m<o;m++)i.push(e[m].apply(null,t));return i}var tL=class{constructor(e){this.value=e}deref(){return this.value}},rL=typeof WeakRef<"u"?WeakRef:tL,nL=0,JE=1;function S0(){return{s:nL,v:void 0,o:null,p:null}}function FD(e,t={}){let i=S0();const{resultEqualityCheck:o}=t;let m,y=0;function _(){let c=i;const{length:M}=arguments;for(let k=0,F=M;k<F;k++){const G=arguments[k];if(typeof G=="function"||typeof G=="object"&&G!==null){let K=c.o;K===null&&(c.o=K=new WeakMap);const W=K.get(G);W===void 0?(c=S0(),K.set(G,c)):c=W}else{let K=c.p;K===null&&(c.p=K=new Map);const W=K.get(G);W===void 0?(c=S0(),K.set(G,c)):c=W}}const C=c;let D;if(c.s===JE)D=c.v;else if(D=e.apply(null,arguments),y++,o){const k=m?.deref?.()??m;k!=null&&o(k,D)&&(D=k,y!==0&&y--),m=typeof D=="object"&&D!==null||typeof D=="function"?new rL(D):D}return C.s=JE,C.v=D,D}return _.clearCache=()=>{i=S0(),_.resetResultsCount()},_.resultsCount=()=>y,_.resetResultsCount=()=>{y=0},_}function iL(e,...t){const i=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,o=(...m)=>{let y=0,_=0,c,M={},C=m.pop();typeof C=="object"&&(M=C,C=m.pop()),Xj(C,`createSelector expects an output function after the inputs, but received: [${typeof C}]`);const D={...i,...M},{memoize:k,memoizeOptions:F=[],argsMemoize:G=FD,argsMemoizeOptions:K=[]}=D,W=QE(F),q=QE(K),ue=Jj(m),me=k(function(){return y++,C.apply(null,arguments)},...W),ge=G(function(){_++;const ze=eL(ue,arguments);return c=me.apply(null,ze),c},...q);return Object.assign(ge,{resultFunc:C,memoizedResultFunc:me,dependencies:ue,dependencyRecomputations:()=>_,resetDependencyRecomputations:()=>{_=0},lastResult:()=>c,recomputations:()=>y,resetRecomputations:()=>{y=0},memoize:k,argsMemoize:G})};return Object.assign(o,{withTypes:()=>o}),o}var st=iL(FD),aL=Object.assign((e,t=st)=>{Kj(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const i=Object.keys(e),o=i.map(y=>e[y]);return t(o,(...y)=>y.reduce((_,c,M)=>(_[i[M]]=c,_),{}))},{withTypes:()=>aL}),W1={},Y1={},X1={},eA;function oL(){return eA||(eA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(o){return typeof o=="symbol"?1:o===null?2:o===void 0?3:o!==o?4:0}const i=(o,m,y)=>{if(o!==m){const _=t(o),c=t(m);if(_===c&&_===0){if(o<m)return y==="desc"?1:-1;if(o>m)return y==="desc"?-1:1}return y==="desc"?c-_:_-c}return 0};e.compareValues=i})(X1)),X1}var K1={},Q1={},tA;function UD(){return tA||(tA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="symbol"||i instanceof Symbol}e.isSymbol=t})(Q1)),Q1}var rA;function sL(){return rA||(rA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UD(),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;function m(y,_){return Array.isArray(y)?!1:typeof y=="number"||typeof y=="boolean"||y==null||t.isSymbol(y)?!0:typeof y=="string"&&(o.test(y)||!i.test(y))||_!=null&&Object.hasOwn(_,y)}e.isKey=m})(K1)),K1}var nA;function lL(){return nA||(nA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oL(),i=sL(),o=K2();function m(y,_,c,M){if(y==null)return[];c=M?void 0:c,Array.isArray(y)||(y=Object.values(y)),Array.isArray(_)||(_=_==null?[null]:[_]),_.length===0&&(_=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(G=>String(G));const C=(G,K)=>{let W=G;for(let q=0;q<K.length&&W!=null;++q)W=W[K[q]];return W},D=(G,K)=>K==null||G==null?K:typeof G=="object"&&"key"in G?Object.hasOwn(K,G.key)?K[G.key]:C(K,G.path):typeof G=="function"?G(K):Array.isArray(G)?C(K,G):typeof K=="object"?K[G]:K,k=_.map(G=>(Array.isArray(G)&&G.length===1&&(G=G[0]),G==null||typeof G=="function"||Array.isArray(G)||i.isKey(G)?G:{key:G,path:o.toPath(G)}));return y.map(G=>({original:G,criteria:k.map(K=>D(K,G))})).slice().sort((G,K)=>{for(let W=0;W<k.length;W++){const q=t.compareValues(G.criteria[W],K.criteria[W],c[W]);if(q!==0)return q}return 0}).map(G=>G.original)}e.orderBy=m})(Y1)),Y1}var J1={},iA;function uL(){return iA||(iA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,o=1){const m=[],y=Math.floor(o),_=(c,M)=>{for(let C=0;C<c.length;C++){const D=c[C];Array.isArray(D)&&M<y?_(D,M+1):m.push(D)}};return _(i,0),m}e.flatten=t})(J1)),J1}var ew={},aA;function VD(){return aA||(aA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BD(),i=tS(),o=zD(),m=RD();function y(_,c,M){return o.isObject(M)&&(typeof c=="number"&&i.isArrayLike(M)&&t.isIndex(c)&&c<M.length||typeof c=="string"&&c in M)?m.isEqualsSameValueZero(M[c],_):!1}e.isIterateeCall=y})(ew)),ew}var oA;function cL(){return oA||(oA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lL(),i=uL(),o=VD();function m(y,..._){const c=_.length;return c>1&&o.isIterateeCall(y,_[0],_[1])?_=[]:c>2&&o.isIterateeCall(_[0],_[1],_[2])&&(_=[_[0]]),t.orderBy(y,i.flatten(_),["asc"])}e.sortBy=m})(W1)),W1}var tw,sA;function hL(){return sA||(sA=1,tw=cL().sortBy),tw}var fL=hL();const Yx=uh(fL);var qD=e=>e.legend.settings,dL=e=>e.legend.size,pL=e=>e.legend.payload;st([pL,qD],(e,t)=>{var{itemSorter:i}=t,o=e.flat(1);return i?Yx(o,i):o});var T0=1;function mL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,i]=Z.useState({height:0,left:0,top:0,width:0}),o=Z.useCallback(m=>{if(m!=null){var y=m.getBoundingClientRect(),_={height:y.height,left:y.left,top:y.top,width:y.width};(Math.abs(_.height-t.height)>T0||Math.abs(_.left-t.left)>T0||Math.abs(_.top-t.top)>T0||Math.abs(_.width-t.width)>T0)&&i({height:_.height,left:_.left,top:_.top,width:_.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,o]}function Oo(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var gL=typeof Symbol=="function"&&Symbol.observable||"@@observable",lA=gL,rw=()=>Math.random().toString(36).substring(7).split("").join("."),yL={INIT:`@@redux/INIT${rw()}`,REPLACE:`@@redux/REPLACE${rw()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${rw()}`},J0=yL;function iS(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function $D(e,t,i){if(typeof e!="function")throw new Error(Oo(2));if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(Oo(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(Oo(1));return i($D)(e,t)}let o=e,m=t,y=new Map,_=y,c=0,M=!1;function C(){_===y&&(_=new Map,y.forEach((q,ue)=>{_.set(ue,q)}))}function D(){if(M)throw new Error(Oo(3));return m}function k(q){if(typeof q!="function")throw new Error(Oo(4));if(M)throw new Error(Oo(5));let ue=!0;C();const me=c++;return _.set(me,q),function(){if(ue){if(M)throw new Error(Oo(6));ue=!1,C(),_.delete(me),y=null}}}function F(q){if(!iS(q))throw new Error(Oo(7));if(typeof q.type>"u")throw new Error(Oo(8));if(typeof q.type!="string")throw new Error(Oo(17));if(M)throw new Error(Oo(9));try{M=!0,m=o(m,q)}finally{M=!1}return(y=_).forEach(me=>{me()}),q}function G(q){if(typeof q!="function")throw new Error(Oo(10));o=q,F({type:J0.REPLACE})}function K(){const q=k;return{subscribe(ue){if(typeof ue!="object"||ue===null)throw new Error(Oo(11));function me(){const be=ue;be.next&&be.next(D())}return me(),{unsubscribe:q(me)}},[lA](){return this}}}return F({type:J0.INIT}),{dispatch:F,subscribe:k,getState:D,replaceReducer:G,[lA]:K}}function vL(e){Object.keys(e).forEach(t=>{const i=e[t];if(typeof i(void 0,{type:J0.INIT})>"u")throw new Error(Oo(12));if(typeof i(void 0,{type:J0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Oo(13))})}function GD(e){const t=Object.keys(e),i={};for(let y=0;y<t.length;y++){const _=t[y];typeof e[_]=="function"&&(i[_]=e[_])}const o=Object.keys(i);let m;try{vL(i)}catch(y){m=y}return function(_={},c){if(m)throw m;let M=!1;const C={};for(let D=0;D<o.length;D++){const k=o[D],F=i[k],G=_[k],K=F(G,c);if(typeof K>"u")throw c&&c.type,new Error(Oo(14));C[k]=K,M=M||K!==G}return M=M||o.length!==Object.keys(_).length,M?C:_}}function ex(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...o)=>t(i(...o)))}function _L(...e){return t=>(i,o)=>{const m=t(i,o);let y=()=>{throw new Error(Oo(15))};const _={getState:m.getState,dispatch:(M,...C)=>y(M,...C)},c=e.map(M=>M(_));return y=ex(...c)(m.dispatch),{...m,dispatch:y}}}function ZD(e){return iS(e)&&"type"in e&&typeof e.type=="string"}var HD=Symbol.for("immer-nothing"),uA=Symbol.for("immer-draftable"),_s=Symbol.for("immer-state");function nc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var _l=Object,Bg=_l.getPrototypeOf,tx="constructor",Xx="prototype",Kw="configurable",rx="enumerable",V0="writable",Dv="value",ff=e=>!!e&&!!e[_s];function uc(e){return e?WD(e)||Qx(e)||!!e[uA]||!!e[tx]?.[uA]||Jx(e)||eb(e):!1}var xL=_l[Xx][tx].toString(),cA=new WeakMap;function WD(e){if(!e||!aS(e))return!1;const t=Bg(e);if(t===null||t===_l[Xx])return!0;const i=_l.hasOwnProperty.call(t,tx)&&t[tx];if(i===Object)return!0;if(!Pg(i))return!1;let o=cA.get(i);return o===void 0&&(o=Function.toString.call(i),cA.set(i,o)),o===xL}function Kx(e,t,i=!0){Hv(e)===0?(i?Reflect.ownKeys(e):_l.keys(e)).forEach(m=>{t(m,e[m],e)}):e.forEach((o,m)=>t(m,o,e))}function Hv(e){const t=e[_s];return t?t.type_:Qx(e)?1:Jx(e)?2:eb(e)?3:0}var hA=(e,t,i=Hv(e))=>i===2?e.has(t):_l[Xx].hasOwnProperty.call(e,t),Qw=(e,t,i=Hv(e))=>i===2?e.get(t):e[t],nx=(e,t,i,o=Hv(e))=>{o===2?e.set(t,i):o===3?e.add(i):e[t]=i};function bL(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Qx=Array.isArray,Jx=e=>e instanceof Map,eb=e=>e instanceof Set,aS=e=>typeof e=="object",Pg=e=>typeof e=="function",nw=e=>typeof e=="boolean";function wL(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var af=e=>e.copy_||e.base_,oS=e=>e.modified_?e.copy_:e.base_;function Jw(e,t){if(Jx(e))return new Map(e);if(eb(e))return new Set(e);if(Qx(e))return Array[Xx].slice.call(e);const i=WD(e);if(t===!0||t==="class_only"&&!i){const o=_l.getOwnPropertyDescriptors(e);delete o[_s];let m=Reflect.ownKeys(o);for(let y=0;y<m.length;y++){const _=m[y],c=o[_];c[V0]===!1&&(c[V0]=!0,c[Kw]=!0),(c.get||c.set)&&(o[_]={[Kw]:!0,[V0]:!0,[rx]:c[rx],[Dv]:e[_]})}return _l.create(Bg(e),o)}else{const o=Bg(e);if(o!==null&&i)return{...e};const m=_l.create(o);return _l.assign(m,e)}}function sS(e,t=!1){return tb(e)||ff(e)||!uc(e)||(Hv(e)>1&&_l.defineProperties(e,{set:E0,add:E0,clear:E0,delete:E0}),_l.freeze(e),t&&Kx(e,(i,o)=>{sS(o,!0)},!1)),e}function SL(){nc(2)}var E0={[Dv]:SL};function tb(e){return e===null||!aS(e)?!0:_l.isFrozen(e)}var ix="MapSet",e2="Patches",fA="ArrayMethods",YD={};function tm(e){const t=YD[e];return t||nc(0,e),t}var dA=e=>!!YD[e],Ov,XD=()=>Ov,TL=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:dA(ix)?tm(ix):void 0,arrayMethodsPlugin_:dA(fA)?tm(fA):void 0});function pA(e,t){t&&(e.patchPlugin_=tm(e2),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function t2(e){r2(e),e.drafts_.forEach(EL),e.drafts_=null}function r2(e){e===Ov&&(Ov=e.parent_)}var mA=e=>Ov=TL(Ov,e);function EL(e){const t=e[_s];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function gA(e,t){t.unfinalizedDrafts_=t.drafts_.length;const i=t.drafts_[0];if(e!==void 0&&e!==i){i[_s].modified_&&(t2(t),nc(4)),uc(e)&&(e=yA(t,e));const{patchPlugin_:m}=t;m&&m.generateReplacementPatches_(i[_s].base_,e,t)}else e=yA(t,i);return AL(t,e,!0),t2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==HD?e:void 0}function yA(e,t){if(tb(t))return t;const i=t[_s];if(!i)return ax(t,e.handledSet_,e);if(!rb(i,e))return t;if(!i.modified_)return i.base_;if(!i.finalized_){const{callbacks_:o}=i;if(o)for(;o.length>0;)o.pop()(e);JD(i,e)}return i.copy_}function AL(e,t,i=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&sS(t,i)}function KD(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var rb=(e,t)=>e.scope_===t,ML=[];function QD(e,t,i,o){const m=af(e),y=e.type_;if(o!==void 0&&Qw(m,o,y)===t){nx(m,o,i,y);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;Kx(m,(M,C)=>{if(ff(C)){const D=c.get(C)||[];D.push(M),c.set(C,D)}})}const _=e.draftLocations_.get(t)??ML;for(const c of _)nx(m,c,i,y)}function PL(e,t,i){e.callbacks_.push(function(m){const y=t;if(!y||!rb(y,m))return;m.mapSetPlugin_?.fixSetContents(y);const _=oS(y);QD(e,y.draft_??y,_,i),JD(y,m)})}function JD(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:o}=t;if(o){const m=o.getPath(e);m&&o.generatePatches_(e,m,t)}KD(e)}}function CL(e,t,i){const{scope_:o}=e;if(ff(i)){const m=i[_s];rb(m,o)&&m.callbacks_.push(function(){q0(e);const _=oS(m);QD(e,i,_,t)})}else uc(i)&&e.callbacks_.push(function(){const y=af(e);e.type_===3?y.has(i)&&ax(i,o.handledSet_,o):Qw(y,t,e.type_)===i&&o.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&ax(Qw(e.copy_,t,e.type_),o.handledSet_,o)})}function ax(e,t,i){return!i.immer_.autoFreeze_&&i.unfinalizedDrafts_<1||ff(e)||t.has(e)||!uc(e)||tb(e)||(t.add(e),Kx(e,(o,m)=>{if(ff(m)){const y=m[_s];if(rb(y,i)){const _=oS(y);nx(e,o,_,e.type_),KD(y)}}else uc(m)&&ax(m,t,i)})),e}function DL(e,t){const i=Qx(e),o={type_:i?1:0,scope_:t?t.scope_:XD(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let m=o,y=ox;i&&(m=[o],y=Iv);const{revoke:_,proxy:c}=Proxy.revocable(m,y);return o.draft_=c,o.revoke_=_,[c,o]}var ox={get(e,t){if(t===_s)return e;let i=e.scope_.arrayMethodsPlugin_;const o=e.type_===1&&typeof t=="string";if(o&&i?.isArrayOperationMethod(t))return i.createMethodInterceptor(e,t);const m=af(e);if(!hA(m,t,e.type_))return OL(e,m,t);const y=m[t];if(e.finalized_||!uc(y)||o&&e.operationMethod&&i?.isMutatingArrayMethod(e.operationMethod)&&wL(t))return y;if(y===iw(e.base_,t)){q0(e);const _=e.type_===1?+t:t,c=i2(e.scope_,y,e,_);return e.copy_[_]=c}return y},has(e,t){return t in af(e)},ownKeys(e){return Reflect.ownKeys(af(e))},set(e,t,i){const o=eO(af(e),t);if(o?.set)return o.set.call(e.draft_,i),!0;if(!e.modified_){const m=iw(af(e),t),y=m?.[_s];if(y&&y.base_===i)return e.copy_[t]=i,e.assigned_.set(t,!1),!0;if(bL(i,m)&&(i!==void 0||hA(e.base_,t,e.type_)))return!0;q0(e),n2(e)}return e.copy_[t]===i&&(i!==void 0||t in e.copy_)||Number.isNaN(i)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=i,e.assigned_.set(t,!0),CL(e,t,i)),!0},deleteProperty(e,t){return q0(e),iw(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),n2(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const i=af(e),o=Reflect.getOwnPropertyDescriptor(i,t);return o&&{[V0]:!0,[Kw]:e.type_!==1||t!=="length",[rx]:o[rx],[Dv]:i[t]}},defineProperty(){nc(11)},getPrototypeOf(e){return Bg(e.base_)},setPrototypeOf(){nc(12)}},Iv={};for(let e in ox){let t=ox[e];Iv[e]=function(){const i=arguments;return i[0]=i[0][0],t.apply(this,i)}}Iv.deleteProperty=function(e,t){return Iv.set.call(this,e,t,void 0)};Iv.set=function(e,t,i){return ox.set.call(this,e[0],t,i,e[0])};function iw(e,t){const i=e[_s];return(i?af(i):e)[t]}function OL(e,t,i){const o=eO(t,i);return o?Dv in o?o[Dv]:o.get?.call(e.draft_):void 0}function eO(e,t){if(!(t in e))return;let i=Bg(e);for(;i;){const o=Object.getOwnPropertyDescriptor(i,t);if(o)return o;i=Bg(i)}}function n2(e){e.modified_||(e.modified_=!0,e.parent_&&n2(e.parent_))}function q0(e){e.copy_||(e.assigned_=new Map,e.copy_=Jw(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var IL=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(i,o,m)=>{if(Pg(i)&&!Pg(o)){const _=o;o=i;const c=this;return function(C=_,...D){return c.produce(C,k=>o.call(this,k,...D))}}Pg(o)||nc(6),m!==void 0&&!Pg(m)&&nc(7);let y;if(uc(i)){const _=mA(this),c=i2(_,i,void 0);let M=!0;try{y=o(c),M=!1}finally{M?t2(_):r2(_)}return pA(_,m),gA(y,_)}else if(!i||!aS(i)){if(y=o(i),y===void 0&&(y=i),y===HD&&(y=void 0),this.autoFreeze_&&sS(y,!0),m){const _=[],c=[];tm(e2).generateReplacementPatches_(i,y,{patches_:_,inversePatches_:c}),m(_,c)}return y}else nc(1,i)},this.produceWithPatches=(i,o)=>{if(Pg(i))return(c,...M)=>this.produceWithPatches(c,C=>i(C,...M));let m,y;return[this.produce(i,o,(c,M)=>{m=c,y=M}),m,y]},nw(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),nw(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),nw(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){uc(t)||nc(8),ff(t)&&(t=oc(t));const i=mA(this),o=i2(i,t,void 0);return o[_s].isManual_=!0,r2(i),o}finishDraft(t,i){const o=t&&t[_s];(!o||!o.isManual_)&&nc(9);const{scope_:m}=o;return pA(m,i),gA(void 0,m)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,i){let o;for(o=i.length-1;o>=0;o--){const y=i[o];if(y.path.length===0&&y.op==="replace"){t=y.value;break}}o>-1&&(i=i.slice(o+1));const m=tm(e2).applyPatches_;return ff(t)?m(t,i):this.produce(t,y=>m(y,i))}};function i2(e,t,i,o){const[m,y]=Jx(t)?tm(ix).proxyMap_(t,i):eb(t)?tm(ix).proxySet_(t,i):DL(t,i);return(i?.scope_??XD()).drafts_.push(m),y.callbacks_=i?.callbacks_??[],y.key_=o,i&&o!==void 0?PL(i,y,o):y.callbacks_.push(function(M){M.mapSetPlugin_?.fixSetContents(y);const{patchPlugin_:C}=M;y.modified_&&C&&C.generatePatches_(y,[],M)}),m}function oc(e){return ff(e)||nc(10,e),tO(e)}function tO(e){if(!uc(e)||tb(e))return e;const t=e[_s];let i,o=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,i=Jw(e,t.scope_.immer_.useStrictShallowCopy_),o=t.scope_.immer_.shouldUseStrictIteration()}else i=Jw(e,!0);return Kx(i,(m,y)=>{nx(i,m,tO(y))},o),t&&(t.finalized_=!1),i}var zL=new IL,rO=zL.produce;function nO(e){return({dispatch:i,getState:o})=>m=>y=>typeof y=="function"?y(i,o,e):m(y)}var kL=nO(),RL=nO,jL=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ex:ex.apply(null,arguments)};function cu(e,t){function i(...o){if(t){let m=t(...o);if(!m)throw new Error(xl(0));return{type:e,payload:m.payload,..."meta"in m&&{meta:m.meta},..."error"in m&&{error:m.error}}}return{type:e,payload:o[0]}}return i.toString=()=>`${e}`,i.type=e,i.match=o=>ZD(o)&&o.type===e,i}var iO=class xv extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,xv.prototype)}static get[Symbol.species](){return xv}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new xv(...t[0].concat(this)):new xv(...t.concat(this))}};function vA(e){return uc(e)?rO(e,()=>{}):e}function A0(e,t,i){return e.has(t)?e.get(t):e.set(t,i(t)).get(t)}function LL(e){return typeof e=="boolean"}var NL=()=>function(t){const{thunk:i=!0,immutableCheck:o=!0,serializableCheck:m=!0,actionCreatorCheck:y=!0}=t??{};let _=new iO;return i&&(LL(i)?_.push(kL):_.push(RL(i.extraArgument))),_},aO="RTK_autoBatch",Si=()=>e=>({payload:e,meta:{[aO]:!0}}),_A=e=>t=>{setTimeout(t,e)},oO=(e={type:"raf"})=>t=>(...i)=>{const o=t(...i);let m=!0,y=!1,_=!1;const c=new Set,M=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:_A(10):e.type==="callback"?e.queueNotification:_A(e.timeout),C=()=>{_=!1,y&&(y=!1,c.forEach(D=>D()))};return Object.assign({},o,{subscribe(D){const k=()=>m&&D(),F=o.subscribe(k);return c.add(D),()=>{F(),c.delete(D)}},dispatch(D){try{return m=!D?.meta?.[aO],y=!m,y&&(_||(_=!0,M(C))),o.dispatch(D)}finally{m=!0}}})},BL=e=>function(i){const{autoBatch:o=!0}=i??{};let m=new iO(e);return o&&m.push(oO(typeof o=="object"?o:void 0)),m};function FL(e){const t=NL(),{reducer:i=void 0,middleware:o,devTools:m=!0,preloadedState:y=void 0,enhancers:_=void 0}=e||{};let c;if(typeof i=="function")c=i;else if(iS(i))c=GD(i);else throw new Error(xl(1));let M;typeof o=="function"?M=o(t):M=t();let C=ex;m&&(C=jL({trace:!1,...typeof m=="object"&&m}));const D=_L(...M),k=BL(D);let F=typeof _=="function"?_(k):k();const G=C(...F);return $D(c,y,G)}function sO(e){const t={},i=[];let o;const m={addCase(y,_){const c=typeof y=="string"?y:y.type;if(!c)throw new Error(xl(28));if(c in t)throw new Error(xl(29));return t[c]=_,m},addAsyncThunk(y,_){return _.pending&&(t[y.pending.type]=_.pending),_.rejected&&(t[y.rejected.type]=_.rejected),_.fulfilled&&(t[y.fulfilled.type]=_.fulfilled),_.settled&&i.push({matcher:y.settled,reducer:_.settled}),m},addMatcher(y,_){return i.push({matcher:y,reducer:_}),m},addDefaultCase(y){return o=y,m}};return e(m),[t,i,o]}function UL(e){return typeof e=="function"}function VL(e,t){let[i,o,m]=sO(t),y;if(UL(e))y=()=>vA(e());else{const c=vA(e);y=()=>c}function _(c=y(),M){let C=[i[M.type],...o.filter(({matcher:D})=>D(M)).map(({reducer:D})=>D)];return C.filter(D=>!!D).length===0&&(C=[m]),C.reduce((D,k)=>{if(k)if(ff(D)){const G=k(D,M);return G===void 0?D:G}else{if(uc(D))return rO(D,F=>k(F,M));{const F=k(D,M);if(F===void 0){if(D===null)return D;throw Error("A case reducer on a non-draftable value must not return undefined")}return F}}return D},c)}return _.getInitialState=y,_}var qL="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",$L=(e=21)=>{let t="",i=e;for(;i--;)t+=qL[Math.random()*64|0];return t},GL=Symbol.for("rtk-slice-createasyncthunk");function ZL(e,t){return`${e}/${t}`}function HL({creators:e}={}){const t=e?.asyncThunk?.[GL];return function(o){const{name:m,reducerPath:y=m}=o;if(!m)throw new Error(xl(11));const _=(typeof o.reducers=="function"?o.reducers(YL()):o.reducers)||{},c=Object.keys(_),M={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},C={addCase(ge,be){const ze=typeof ge=="string"?ge:ge.type;if(!ze)throw new Error(xl(12));if(ze in M.sliceCaseReducersByType)throw new Error(xl(13));return M.sliceCaseReducersByType[ze]=be,C},addMatcher(ge,be){return M.sliceMatchers.push({matcher:ge,reducer:be}),C},exposeAction(ge,be){return M.actionCreators[ge]=be,C},exposeCaseReducer(ge,be){return M.sliceCaseReducersByName[ge]=be,C}};c.forEach(ge=>{const be=_[ge],ze={reducerName:ge,type:ZL(m,ge),createNotation:typeof o.reducers=="function"};KL(be)?JL(ze,be,C,t):XL(ze,be,C)});function D(){const[ge={},be=[],ze=void 0]=typeof o.extraReducers=="function"?sO(o.extraReducers):[o.extraReducers],Ae={...ge,...M.sliceCaseReducersByType};return VL(o.initialState,Oe=>{for(let rt in Ae)Oe.addCase(rt,Ae[rt]);for(let rt of M.sliceMatchers)Oe.addMatcher(rt.matcher,rt.reducer);for(let rt of be)Oe.addMatcher(rt.matcher,rt.reducer);ze&&Oe.addDefaultCase(ze)})}const k=ge=>ge,F=new Map,G=new WeakMap;let K;function W(ge,be){return K||(K=D()),K(ge,be)}function q(){return K||(K=D()),K.getInitialState()}function ue(ge,be=!1){function ze(Oe){let rt=Oe[ge];return typeof rt>"u"&&be&&(rt=A0(G,ze,q)),rt}function Ae(Oe=k){const rt=A0(F,be,()=>new WeakMap);return A0(rt,Oe,()=>{const gt={};for(const[yt,tt]of Object.entries(o.selectors??{}))gt[yt]=WL(tt,Oe,()=>A0(G,Oe,q),be);return gt})}return{reducerPath:ge,getSelectors:Ae,get selectors(){return Ae(ze)},selectSlice:ze}}const me={name:m,reducer:W,actions:M.actionCreators,caseReducers:M.sliceCaseReducersByName,getInitialState:q,...ue(y),injectInto(ge,{reducerPath:be,...ze}={}){const Ae=be??y;return ge.inject({reducerPath:Ae,reducer:W},ze),{...me,...ue(Ae,!0)}}};return me}}function WL(e,t,i,o){function m(y,..._){let c=t(y);return typeof c>"u"&&o&&(c=i()),e(c,..._)}return m.unwrapped=e,m}var Gs=HL();function YL(){function e(t,i){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...i}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...i){return t(...i)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,i){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:i}},asyncThunk:e}}function XL({type:e,reducerName:t,createNotation:i},o,m){let y,_;if("reducer"in o){if(i&&!QL(o))throw new Error(xl(17));y=o.reducer,_=o.prepare}else y=o;m.addCase(e,y).exposeCaseReducer(t,y).exposeAction(t,_?cu(e,_):cu(e))}function KL(e){return e._reducerDefinitionType==="asyncThunk"}function QL(e){return e._reducerDefinitionType==="reducerWithPrepare"}function JL({type:e,reducerName:t},i,o,m){if(!m)throw new Error(xl(18));const{payloadCreator:y,fulfilled:_,pending:c,rejected:M,settled:C,options:D}=i,k=m(e,y,D);o.exposeAction(t,k),_&&o.addCase(k.fulfilled,_),c&&o.addCase(k.pending,c),M&&o.addCase(k.rejected,M),C&&o.addMatcher(k.settled,C),o.exposeCaseReducer(t,{fulfilled:_||M0,pending:c||M0,rejected:M||M0,settled:C||M0})}function M0(){}var e5="task",lO="listener",uO="completed",lS="cancelled",t5=`task-${lS}`,r5=`task-${uO}`,a2=`${lO}-${lS}`,n5=`${lO}-${uO}`,nb=class{constructor(e){this.code=e,this.message=`${e5} ${lS} (reason: ${e})`}name="TaskAbortError";message},uS=(e,t)=>{if(typeof e!="function")throw new TypeError(xl(32))},sx=()=>{},cO=(e,t=sx)=>(e.catch(t),e),hO=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Zp=e=>{if(e.aborted)throw new nb(e.reason)};function fO(e,t){let i=sx;return new Promise((o,m)=>{const y=()=>m(new nb(e.reason));if(e.aborted){y();return}i=hO(e,y),t.finally(()=>i()).then(o,m)}).finally(()=>{i=sx})}var i5=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(i){return{status:i instanceof nb?"cancelled":"rejected",error:i}}finally{t?.()}},lx=e=>t=>cO(fO(e,t).then(i=>(Zp(e),i))),dO=e=>{const t=lx(e);return i=>t(new Promise(o=>setTimeout(o,i)))},{assign:zg}=Object,xA={},ib="listenerMiddleware",a5=(e,t)=>{const i=o=>hO(e,()=>o.abort(e.reason));return(o,m)=>{uS(o);const y=new AbortController;i(y);const _=i5(async()=>{Zp(e),Zp(y.signal);const c=await o({pause:lx(y.signal),delay:dO(y.signal),signal:y.signal});return Zp(y.signal),c},()=>y.abort(r5));return m?.autoJoin&&t.push(_.catch(sx)),{result:lx(e)(_),cancel(){y.abort(t5)}}}},o5=(e,t)=>{const i=async(o,m)=>{Zp(t);let y=()=>{};const c=[new Promise((M,C)=>{let D=e({predicate:o,effect:(k,F)=>{F.unsubscribe(),M([k,F.getState(),F.getOriginalState()])}});y=()=>{D(),C()}})];m!=null&&c.push(new Promise(M=>setTimeout(M,m,null)));try{const M=await fO(t,Promise.race(c));return Zp(t),M}finally{y()}};return(o,m)=>cO(i(o,m))},pO=e=>{let{type:t,actionCreator:i,matcher:o,predicate:m,effect:y}=e;if(t)m=cu(t).match;else if(i)t=i.type,m=i.match;else if(o)m=o;else if(!m)throw new Error(xl(21));return uS(y),{predicate:m,type:t,effect:y}},mO=zg(e=>{const{type:t,predicate:i,effect:o}=pO(e);return{id:$L(),effect:o,type:t,predicate:i,pending:new Set,unsubscribe:()=>{throw new Error(xl(22))}}},{withTypes:()=>mO}),bA=(e,t)=>{const{type:i,effect:o,predicate:m}=pO(t);return Array.from(e.values()).find(y=>(typeof i=="string"?y.type===i:y.predicate===m)&&y.effect===o)},o2=e=>{e.pending.forEach(t=>{t.abort(a2)})},s5=(e,t)=>()=>{for(const i of t.keys())o2(i);e.clear()},wA=(e,t,i)=>{try{e(t,i)}catch(o){setTimeout(()=>{throw o},0)}},gO=zg(cu(`${ib}/add`),{withTypes:()=>gO}),l5=cu(`${ib}/removeAll`),yO=zg(cu(`${ib}/remove`),{withTypes:()=>yO}),u5=(...e)=>{console.error(`${ib}/error`,...e)},Wv=(e={})=>{const t=new Map,i=new Map,o=G=>{const K=i.get(G)??0;i.set(G,K+1)},m=G=>{const K=i.get(G)??1;K===1?i.delete(G):i.set(G,K-1)},{extra:y,onError:_=u5}=e;uS(_);const c=G=>(G.unsubscribe=()=>t.delete(G.id),t.set(G.id,G),K=>{G.unsubscribe(),K?.cancelActive&&o2(G)}),M=G=>{const K=bA(t,G)??mO(G);return c(K)};zg(M,{withTypes:()=>M});const C=G=>{const K=bA(t,G);return K&&(K.unsubscribe(),G.cancelActive&&o2(K)),!!K};zg(C,{withTypes:()=>C});const D=async(G,K,W,q)=>{const ue=new AbortController,me=o5(M,ue.signal),ge=[];try{G.pending.add(ue),o(G),await Promise.resolve(G.effect(K,zg({},W,{getOriginalState:q,condition:(be,ze)=>me(be,ze).then(Boolean),take:me,delay:dO(ue.signal),pause:lx(ue.signal),extra:y,signal:ue.signal,fork:a5(ue.signal,ge),unsubscribe:G.unsubscribe,subscribe:()=>{t.set(G.id,G)},cancelActiveListeners:()=>{G.pending.forEach((be,ze,Ae)=>{be!==ue&&(be.abort(a2),Ae.delete(be))})},cancel:()=>{ue.abort(a2),G.pending.delete(ue)},throwIfCancelled:()=>{Zp(ue.signal)}})))}catch(be){be instanceof nb||wA(_,be,{raisedBy:"effect"})}finally{await Promise.all(ge),ue.abort(n5),m(G),G.pending.delete(ue)}},k=s5(t,i);return{middleware:G=>K=>W=>{if(!ZD(W))return K(W);if(gO.match(W))return M(W.payload);if(l5.match(W)){k();return}if(yO.match(W))return C(W.payload);let q=G.getState();const ue=()=>{if(q===xA)throw new Error(xl(23));return q};let me;try{if(me=K(W),t.size>0){const ge=G.getState(),be=Array.from(t.values());for(const ze of be){let Ae=!1;try{Ae=ze.predicate(W,ge,q)}catch(Oe){Ae=!1,wA(_,Oe,{raisedBy:"predicate"})}Ae&&D(ze,W,G,ue)}}}finally{q=xA}return me},startListening:M,stopListening:C,clearListeners:k}};function xl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var c5={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},vO=Gs({name:"chartLayout",initialState:c5,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var i,o,m,y;e.margin.top=(i=t.payload.top)!==null&&i!==void 0?i:0,e.margin.right=(o=t.payload.right)!==null&&o!==void 0?o:0,e.margin.bottom=(m=t.payload.bottom)!==null&&m!==void 0?m:0,e.margin.left=(y=t.payload.left)!==null&&y!==void 0?y:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:h5,setLayout:f5,setChartSize:d5,setScale:p5}=vO.actions,m5=vO.reducer;function _O(e,t,i){return Array.isArray(e)&&e&&t+i!==0?e.slice(t,i+1):e}function $r(e){return Number.isFinite(e)}function ah(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function SA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Dg(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?SA(Object(i),!0).forEach(function(o){g5(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):SA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function g5(e,t,i){return(t=y5(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y5(e){var t=v5(e,"string");return typeof t=="symbol"?t:t+""}function v5(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gi(e,t,i){return Ei(e)||Ei(t)?i:ih(t)?Ng(e,t,i):typeof t=="function"?t(e):i}var _5=(e,t,i)=>{if(t&&i){var{width:o,height:m}=i,{align:y,verticalAlign:_,layout:c}=t;if((c==="vertical"||c==="horizontal"&&_==="middle")&&y!=="center"&&Jt(e[y]))return Dg(Dg({},e),{},{[y]:e[y]+(o||0)});if((c==="horizontal"||c==="vertical"&&y==="center")&&_!=="middle"&&Jt(e[_]))return Dg(Dg({},e),{},{[_]:e[_]+(m||0)})}return e},hc=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",xO=(e,t,i,o)=>{if(o)return e.map(c=>c.coordinate);var m,y,_=e.map(c=>(c.coordinate===t&&(m=!0),c.coordinate===i&&(y=!0),c.coordinate));return m||_.push(t),y||_.push(i),_},bO=(e,t,i)=>{if(!e)return null;var{duplicateDomain:o,type:m,range:y,scale:_,realScaleType:c,isCategorical:M,categoricalDomain:C,tickCount:D,ticks:k,niceTicks:F,axisType:G}=e;if(!_)return null;var K=c==="scaleBand"&&_.bandwidth?_.bandwidth()/2:2,W=m==="category"&&_.bandwidth?_.bandwidth()/K:0;if(W=G==="angleAxis"&&y&&y.length>=2?Vs(y[0]-y[1])*2*W:W,k||F){var q=(k||F||[]).map((ue,me)=>{var ge=o?o.indexOf(ue):ue,be=_.map(ge);return $r(be)?{coordinate:be+W,value:ue,offset:W,index:me}:null}).filter(qs);return q}return M&&C?C.map((ue,me)=>{var ge=_.map(ue);return $r(ge)?{coordinate:ge+W,value:ue,index:me,offset:W}:null}).filter(qs):_.ticks&&D!=null?_.ticks(D).map((ue,me)=>{var ge=_.map(ue);return $r(ge)?{coordinate:ge+W,value:ue,index:me,offset:W}:null}).filter(qs):_.domain().map((ue,me)=>{var ge=_.map(ue);return $r(ge)?{coordinate:ge+W,value:o?o[ue]:ue,index:me,offset:W}:null}).filter(qs)},x5=(e,t)=>{if(!t||t.length!==2||!Jt(t[0])||!Jt(t[1]))return e;var i=Math.min(t[0],t[1]),o=Math.max(t[0],t[1]),m=[e[0],e[1]];return(!Jt(e[0])||e[0]<i)&&(m[0]=i),(!Jt(e[1])||e[1]>o)&&(m[1]=o),m[0]>o&&(m[0]=o),m[1]<i&&(m[1]=i),m},b5=e=>{var t,i=e.length;if(!(i<=0)){var o=(t=e[0])===null||t===void 0?void 0:t.length;if(!(o==null||o<=0))for(var m=0;m<o;++m)for(var y=0,_=0,c=0;c<i;++c){var M=e[c],C=M?.[m];if(C!=null){var D=C[1],k=C[0],F=sc(D)?k:D;F>=0?(C[0]=y,y+=F,C[1]=y):(C[0]=_,_+=F,C[1]=_)}}}},w5=e=>{var t,i=e.length;if(!(i<=0)){var o=(t=e[0])===null||t===void 0?void 0:t.length;if(!(o==null||o<=0))for(var m=0;m<o;++m)for(var y=0,_=0;_<i;++_){var c=e[_],M=c?.[m];if(M!=null){var C=sc(M[1])?M[0]:M[1];C>=0?(M[0]=y,y+=C,M[1]=y):(M[0]=0,M[1]=0)}}}},S5={sign:b5,expand:K3,none:Jp,silhouette:Q3,wiggle:J3,positive:w5},T5=(e,t,i)=>{var o,m=(o=S5[i])!==null&&o!==void 0?o:Jp,y=X3().keys(t).value((c,M)=>Number(Gi(c,M,0))).order(Yw).offset(m),_=y(e);return _.forEach((c,M)=>{c.forEach((C,D)=>{var k=Gi(e[D],t[M],0);Array.isArray(k)&&k.length===2&&Jt(k[0])&&Jt(k[1])&&(C[0]=k[0],C[1]=k[1])})}),_};function wO(e){return e==null?void 0:String(e)}function ux(e){var{axis:t,ticks:i,bandSize:o,entry:m,index:y,dataKey:_}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ei(m[t.dataKey])){var c=PD(i,"value",m[t.dataKey]);if(c)return c.coordinate+o/2}return i!=null&&i[y]?i[y].coordinate+o/2:null}var M=Gi(m,Ei(_)?t.dataKey:_),C=t.scale.map(M);return Jt(C)?C:null}var TA=e=>{var{axis:t,ticks:i,offset:o,bandSize:m,entry:y,index:_}=e;if(t.type==="category")return i[_]?i[_].coordinate+o:null;var c=Gi(y,t.dataKey,t.scale.domain()[_]);if(Ei(c))return null;var M=t.scale.map(c);return Jt(M)?M-m/2+o:null},E5=e=>{var{numericAxis:t}=e,i=t.scale.domain();if(t.type==="number"){var o=Math.min(i[0],i[1]),m=Math.max(i[0],i[1]);return o<=0&&m>=0?0:m<0?m:o}return i[0]},A5=e=>{var t=e.flat(2).filter(Jt);return[Math.min(...t),Math.max(...t)]},M5=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],P5=(e,t,i)=>{if(e!=null)return M5(Object.keys(e).reduce((o,m)=>{var y=e[m];if(!y)return o;var{stackedData:_}=y,c=_.reduce((M,C)=>{var D=_O(C,t,i),k=A5(D);return!$r(k[0])||!$r(k[1])?M:[Math.min(M[0],k[0]),Math.max(M[1],k[1])]},[1/0,-1/0]);return[Math.min(c[0],o[0]),Math.max(c[1],o[1])]},[1/0,-1/0]))},EA=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,AA=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ud=(e,t,i)=>{if(e&&e.scale&&e.scale.bandwidth){var o=e.scale.bandwidth();if(!i||o>0)return o}if(e&&t&&t.length>=2){for(var m=Yx(t,D=>D.coordinate),y=1/0,_=1,c=m.length;_<c;_++){var M=m[_],C=m[_-1];y=Math.min((M?.coordinate||0)-(C?.coordinate||0),y)}return y===1/0?0:y}return i?void 0:0};function MA(e){var{tooltipEntrySettings:t,dataKey:i,payload:o,value:m,name:y}=e;return Dg(Dg({},t),{},{dataKey:i,payload:o,value:m,name:y})}function Gg(e,t){if(e)return String(e);if(typeof t=="string")return t}var C5=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},D5=(e,t)=>t==="centric"?e.angle:e.radius,_f=e=>e.layout.width,xf=e=>e.layout.height,O5=e=>e.layout.scale,SO=e=>e.layout.margin,ab=st(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),ob=st(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),I5="data-recharts-item-index",z5="data-recharts-item-id",Yv=60;function PA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function P0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?PA(Object(i),!0).forEach(function(o){k5(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):PA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function k5(e,t,i){return(t=R5(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function R5(e){var t=j5(e,"string");return typeof t=="symbol"?t:t+""}function j5(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L5=e=>e.brush.height;function N5(e){var t=ob(e);return t.reduce((i,o)=>{if(o.orientation==="left"&&!o.mirror&&!o.hide){var m=typeof o.width=="number"?o.width:Yv;return i+m}return i},0)}function B5(e){var t=ob(e);return t.reduce((i,o)=>{if(o.orientation==="right"&&!o.mirror&&!o.hide){var m=typeof o.width=="number"?o.width:Yv;return i+m}return i},0)}function F5(e){var t=ab(e);return t.reduce((i,o)=>o.orientation==="top"&&!o.mirror&&!o.hide?i+o.height:i,0)}function U5(e){var t=ab(e);return t.reduce((i,o)=>o.orientation==="bottom"&&!o.mirror&&!o.hide?i+o.height:i,0)}var io=st([_f,xf,SO,L5,N5,B5,F5,U5,qD,dL],(e,t,i,o,m,y,_,c,M,C)=>{var D={left:(i.left||0)+m,right:(i.right||0)+y},k={top:(i.top||0)+_,bottom:(i.bottom||0)+c},F=P0(P0({},k),D),G=F.bottom;F.bottom+=o,F=_5(F,M,C);var K=e-F.left-F.right,W=t-F.top-F.bottom;return P0(P0({brushBottom:G},F),{},{width:Math.max(K,0),height:Math.max(W,0)})}),V5=st(io,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),cS=st(_f,xf,(e,t)=>({x:0,y:0,width:e,height:t})),q5=Z.createContext(null),ao=()=>Z.useContext(q5)!=null,sb=e=>e.brush,lb=st([sb,io,SO],(e,t,i)=>({height:e.height,x:Jt(e.x)?e.x:t.left,y:Jt(e.y)?e.y:t.top+t.height+t.brushBottom-(i?.bottom||0),width:Jt(e.width)?e.width:t.width})),aw={},ow={},sw={},CA;function $5(){return CA||(CA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,o,{signal:m,edges:y}={}){let _,c=null;const M=y!=null&&y.includes("leading"),C=y==null||y.includes("trailing"),D=()=>{c!==null&&(i.apply(_,c),_=void 0,c=null)},k=()=>{C&&D(),W()};let F=null;const G=()=>{F!=null&&clearTimeout(F),F=setTimeout(()=>{F=null,k()},o)},K=()=>{F!==null&&(clearTimeout(F),F=null)},W=()=>{K(),_=void 0,c=null},q=()=>{D()},ue=function(...me){if(m?.aborted)return;_=this,c=me;const ge=F==null;G(),M&&ge&&D()};return ue.schedule=G,ue.cancel=W,ue.flush=q,m?.addEventListener("abort",W,{once:!0}),ue}e.debounce=t})(sw)),sw}var DA;function G5(){return DA||(DA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$5();function i(o,m=0,y={}){typeof y!="object"&&(y={});const{leading:_=!1,trailing:c=!0,maxWait:M}=y,C=Array(2);_&&(C[0]="leading"),c&&(C[1]="trailing");let D,k=null;const F=t.debounce(function(...W){D=o.apply(this,W),k=null},m,{edges:C}),G=function(...W){return M!=null&&(k===null&&(k=Date.now()),Date.now()-k>=M)?(D=o.apply(this,W),k=Date.now(),F.cancel(),F.schedule(),D):(F.apply(this,W),D)},K=()=>(F.flush(),D);return G.cancel=F.cancel,G.flush=K,G}e.debounce=i})(ow)),ow}var OA;function Z5(){return OA||(OA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G5();function i(o,m=0,y={}){const{leading:_=!0,trailing:c=!0}=y;return t.debounce(o,m,{leading:_,maxWait:m,trailing:c})}e.throttle=i})(aw)),aw}var lw,IA;function H5(){return IA||(IA=1,lw=Z5().throttle),lw}var W5=H5();const Y5=uh(W5);var cx=function(t,i){for(var o=arguments.length,m=new Array(o>2?o-2:0),y=2;y<o;y++)m[y-2]=arguments[y];if(typeof console<"u"&&console.warn&&(i===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(i===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var _=0;console.warn(i.replace(/%s/g,()=>m[_++]))}},th={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},TO=(e,t,i)=>{var{width:o=th.width,height:m=th.height,aspect:y,maxHeight:_}=i,c=em(o)?e:Number(o),M=em(m)?t:Number(m);return y&&y>0&&(c?M=c/y:M&&(c=M*y),_&&M!=null&&M>_&&(M=_)),{calculatedWidth:c,calculatedHeight:M}},X5={width:0,height:0,overflow:"visible"},K5={width:0,overflowX:"visible"},Q5={height:0,overflowY:"visible"},J5={},eN=e=>{var{width:t,height:i}=e,o=em(t),m=em(i);return o&&m?X5:o?K5:m?Q5:J5};function tN(e){var{width:t,height:i,aspect:o}=e,m=t,y=i;return m===void 0&&y===void 0?(m=th.width,y=th.height):m===void 0?m=o&&o>0?void 0:th.width:y===void 0&&(y=o&&o>0?void 0:th.height),{width:m,height:y}}function s2(){return s2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},s2.apply(null,arguments)}function zA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function kA(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?zA(Object(i),!0).forEach(function(o){rN(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function rN(e,t,i){return(t=nN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function nN(e){var t=iN(e,"string");return typeof t=="symbol"?t:t+""}function iN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EO=Z.createContext(th.initialDimension);function aN(e){return ah(e.width)&&ah(e.height)}function AO(e){var{children:t,width:i,height:o}=e,m=Z.useMemo(()=>({width:i,height:o}),[i,o]);return aN(m)?Z.createElement(EO.Provider,{value:m},t):null}var hS=()=>Z.useContext(EO),oN=Z.forwardRef((e,t)=>{var{aspect:i,initialDimension:o=th.initialDimension,width:m,height:y,minWidth:_=th.minWidth,minHeight:c,maxHeight:M,children:C,debounce:D=th.debounce,id:k,className:F,onResize:G,style:K={}}=e,W=Z.useRef(null),q=Z.useRef();q.current=G,Z.useImperativeHandle(t,()=>W.current);var[ue,me]=Z.useState({containerWidth:o.width,containerHeight:o.height}),ge=Z.useCallback((rt,gt)=>{me(yt=>{var tt=Math.round(rt),Ge=Math.round(gt);return yt.containerWidth===tt&&yt.containerHeight===Ge?yt:{containerWidth:tt,containerHeight:Ge}})},[]);Z.useEffect(()=>{if(W.current==null||typeof ResizeObserver>"u")return Vd;var rt=Ge=>{var Rt,zt=Ge[0];if(zt!=null){var{width:kt,height:Ue}=zt.contentRect;ge(kt,Ue),(Rt=q.current)===null||Rt===void 0||Rt.call(q,kt,Ue)}};D>0&&(rt=Y5(rt,D,{trailing:!0,leading:!1}));var gt=new ResizeObserver(rt),{width:yt,height:tt}=W.current.getBoundingClientRect();return ge(yt,tt),gt.observe(W.current),()=>{gt.disconnect()}},[ge,D]);var{containerWidth:be,containerHeight:ze}=ue;cx(!i||i>0,"The aspect(%s) must be greater than zero.",i);var{calculatedWidth:Ae,calculatedHeight:Oe}=TO(be,ze,{width:m,height:y,aspect:i,maxHeight:M});return cx(Ae!=null&&Ae>0||Oe!=null&&Oe>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ae,Oe,m,y,_,c,i),Z.createElement("div",{id:k?"".concat(k):void 0,className:Nn("recharts-responsive-container",F),style:kA(kA({},K),{},{width:m,height:y,minWidth:_,minHeight:c,maxHeight:M}),ref:W},Z.createElement("div",{style:eN({width:m,height:y})},Z.createElement(AO,{width:Ae,height:Oe},C)))}),kg=Z.forwardRef((e,t)=>{var i=hS();if(ah(i.width)&&ah(i.height))return e.children;var{width:o,height:m}=tN({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:y,calculatedHeight:_}=TO(void 0,void 0,{width:o,height:m,aspect:e.aspect,maxHeight:e.maxHeight});return Jt(y)&&Jt(_)?Z.createElement(AO,{width:y,height:_},e.children):Z.createElement(oN,s2({},e,{width:o,height:m,ref:t}))});function fS(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var ub=()=>{var e,t=ao(),i=dr(V5),o=dr(lb),m=(e=dr(sb))===null||e===void 0?void 0:e.padding;return!t||!o||!m?i:{width:o.width-m.left-m.right,height:o.height-m.top-m.bottom,x:m.left,y:m.top}},sN={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},MO=()=>{var e;return(e=dr(io))!==null&&e!==void 0?e:sN},PO=()=>dr(_f),CO=()=>dr(xf),xn=e=>e.layout.layoutType,qd=()=>dr(xn),dS=()=>{var e=qd();if(e==="horizontal"||e==="vertical")return e},DO=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},lN=()=>{var e=qd();return e!==void 0},Xv=e=>{var t=ea(),i=ao(),{width:o,height:m}=e,y=hS(),_=o,c=m;return y&&(_=y.width>0?y.width:o,c=y.height>0?y.height:m),Z.useEffect(()=>{!i&&ah(_)&&ah(c)&&t(d5({width:_,height:c}))},[t,i,_,c]),null},OO=Symbol.for("immer-nothing"),RA=Symbol.for("immer-draftable"),wl=Symbol.for("immer-state");function ic(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var zv=Object.getPrototypeOf;function Fg(e){return!!e&&!!e[wl]}function rm(e){return e?IO(e)||Array.isArray(e)||!!e[RA]||!!e.constructor?.[RA]||Kv(e)||hb(e):!1}var uN=Object.prototype.constructor.toString(),jA=new WeakMap;function IO(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const i=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(i===Object)return!0;if(typeof i!="function")return!1;let o=jA.get(i);return o===void 0&&(o=Function.toString.call(i),jA.set(i,o)),o===uN}function hx(e,t,i=!0){cb(e)===0?(i?Reflect.ownKeys(e):Object.keys(e)).forEach(m=>{t(m,e[m],e)}):e.forEach((o,m)=>t(m,o,e))}function cb(e){const t=e[wl];return t?t.type_:Array.isArray(e)?1:Kv(e)?2:hb(e)?3:0}function l2(e,t){return cb(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function zO(e,t,i){const o=cb(e);o===2?e.set(t,i):o===3?e.add(i):e[t]=i}function cN(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Kv(e){return e instanceof Map}function hb(e){return e instanceof Set}function Fp(e){return e.copy_||e.base_}function u2(e,t){if(Kv(e))return new Map(e);if(hb(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const i=IO(e);if(t===!0||t==="class_only"&&!i){const o=Object.getOwnPropertyDescriptors(e);delete o[wl];let m=Reflect.ownKeys(o);for(let y=0;y<m.length;y++){const _=m[y],c=o[_];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(o[_]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[_]})}return Object.create(zv(e),o)}else{const o=zv(e);if(o!==null&&i)return{...e};const m=Object.create(o);return Object.assign(m,e)}}function pS(e,t=!1){return fb(e)||Fg(e)||!rm(e)||(cb(e)>1&&Object.defineProperties(e,{set:C0,add:C0,clear:C0,delete:C0}),Object.freeze(e),t&&Object.values(e).forEach(i=>pS(i,!0))),e}function hN(){ic(2)}var C0={value:hN};function fb(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var fN={};function nm(e){const t=fN[e];return t||ic(0,e),t}var kv;function kO(){return kv}function dN(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function LA(e,t){t&&(nm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function c2(e){h2(e),e.drafts_.forEach(pN),e.drafts_=null}function h2(e){e===kv&&(kv=e.parent_)}function NA(e){return kv=dN(kv,e)}function pN(e){const t=e[wl];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function BA(e,t){t.unfinalizedDrafts_=t.drafts_.length;const i=t.drafts_[0];return e!==void 0&&e!==i?(i[wl].modified_&&(c2(t),ic(4)),rm(e)&&(e=fx(t,e),t.parent_||dx(t,e)),t.patches_&&nm("Patches").generateReplacementPatches_(i[wl].base_,e,t.patches_,t.inversePatches_)):e=fx(t,i,[]),c2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==OO?e:void 0}function fx(e,t,i){if(fb(t))return t;const o=e.immer_.shouldUseStrictIteration(),m=t[wl];if(!m)return hx(t,(y,_)=>FA(e,m,t,y,_,i),o),t;if(m.scope_!==e)return t;if(!m.modified_)return dx(e,m.base_,!0),m.base_;if(!m.finalized_){m.finalized_=!0,m.scope_.unfinalizedDrafts_--;const y=m.copy_;let _=y,c=!1;m.type_===3&&(_=new Set(y),y.clear(),c=!0),hx(_,(M,C)=>FA(e,m,y,M,C,i,c),o),dx(e,y,!1),i&&e.patches_&&nm("Patches").generatePatches_(m,i,e.patches_,e.inversePatches_)}return m.copy_}function FA(e,t,i,o,m,y,_){if(m==null||typeof m!="object"&&!_)return;const c=fb(m);if(!(c&&!_)){if(Fg(m)){const M=y&&t&&t.type_!==3&&!l2(t.assigned_,o)?y.concat(o):void 0,C=fx(e,m,M);if(zO(i,o,C),Fg(C))e.canAutoFreeze_=!1;else return}else _&&i.add(m);if(rm(m)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[o]===m&&c)return;fx(e,m),(!t||!t.scope_.parent_)&&typeof o!="symbol"&&(Kv(i)?i.has(o):Object.prototype.propertyIsEnumerable.call(i,o))&&dx(e,m)}}}function dx(e,t,i=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&pS(t,i)}function mN(e,t){const i=Array.isArray(e),o={type_:i?1:0,scope_:t?t.scope_:kO(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let m=o,y=mS;i&&(m=[o],y=Rv);const{revoke:_,proxy:c}=Proxy.revocable(m,y);return o.draft_=c,o.revoke_=_,c}var mS={get(e,t){if(t===wl)return e;const i=Fp(e);if(!l2(i,t))return gN(e,i,t);const o=i[t];return e.finalized_||!rm(o)?o:o===uw(e.base_,t)?(cw(e),e.copy_[t]=d2(o,e)):o},has(e,t){return t in Fp(e)},ownKeys(e){return Reflect.ownKeys(Fp(e))},set(e,t,i){const o=RO(Fp(e),t);if(o?.set)return o.set.call(e.draft_,i),!0;if(!e.modified_){const m=uw(Fp(e),t),y=m?.[wl];if(y&&y.base_===i)return e.copy_[t]=i,e.assigned_[t]=!1,!0;if(cN(i,m)&&(i!==void 0||l2(e.base_,t)))return!0;cw(e),f2(e)}return e.copy_[t]===i&&(i!==void 0||t in e.copy_)||Number.isNaN(i)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=i,e.assigned_[t]=!0),!0},deleteProperty(e,t){return uw(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,cw(e),f2(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const i=Fp(e),o=Reflect.getOwnPropertyDescriptor(i,t);return o&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:o.enumerable,value:i[t]}},defineProperty(){ic(11)},getPrototypeOf(e){return zv(e.base_)},setPrototypeOf(){ic(12)}},Rv={};hx(mS,(e,t)=>{Rv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Rv.deleteProperty=function(e,t){return Rv.set.call(this,e,t,void 0)};Rv.set=function(e,t,i){return mS.set.call(this,e[0],t,i,e[0])};function uw(e,t){const i=e[wl];return(i?Fp(i):e)[t]}function gN(e,t,i){const o=RO(t,i);return o?"value"in o?o.value:o.get?.call(e.draft_):void 0}function RO(e,t){if(!(t in e))return;let i=zv(e);for(;i;){const o=Object.getOwnPropertyDescriptor(i,t);if(o)return o;i=zv(i)}}function f2(e){e.modified_||(e.modified_=!0,e.parent_&&f2(e.parent_))}function cw(e){e.copy_||(e.copy_=u2(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var yN=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,i,o)=>{if(typeof t=="function"&&typeof i!="function"){const y=i;i=t;const _=this;return function(M=y,...C){return _.produce(M,D=>i.call(this,D,...C))}}typeof i!="function"&&ic(6),o!==void 0&&typeof o!="function"&&ic(7);let m;if(rm(t)){const y=NA(this),_=d2(t,void 0);let c=!0;try{m=i(_),c=!1}finally{c?c2(y):h2(y)}return LA(y,o),BA(m,y)}else if(!t||typeof t!="object"){if(m=i(t),m===void 0&&(m=t),m===OO&&(m=void 0),this.autoFreeze_&&pS(m,!0),o){const y=[],_=[];nm("Patches").generateReplacementPatches_(t,m,y,_),o(y,_)}return m}else ic(1,t)},this.produceWithPatches=(t,i)=>{if(typeof t=="function")return(_,...c)=>this.produceWithPatches(_,M=>t(M,...c));let o,m;return[this.produce(t,i,(_,c)=>{o=_,m=c}),o,m]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){rm(e)||ic(8),Fg(e)&&(e=vN(e));const t=NA(this),i=d2(e,void 0);return i[wl].isManual_=!0,h2(t),i}finishDraft(e,t){const i=e&&e[wl];(!i||!i.isManual_)&&ic(9);const{scope_:o}=i;return LA(o,t),BA(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let i;for(i=t.length-1;i>=0;i--){const m=t[i];if(m.path.length===0&&m.op==="replace"){e=m.value;break}}i>-1&&(t=t.slice(i+1));const o=nm("Patches").applyPatches_;return Fg(e)?o(e,t):this.produce(e,m=>o(m,t))}};function d2(e,t){const i=Kv(e)?nm("MapSet").proxyMap_(e,t):hb(e)?nm("MapSet").proxySet_(e,t):mN(e,t);return(t?t.scope_:kO()).drafts_.push(i),i}function vN(e){return Fg(e)||ic(10,e),jO(e)}function jO(e){if(!rm(e)||fb(e))return e;const t=e[wl];let i,o=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,i=u2(e,t.scope_.immer_.useStrictShallowCopy_),o=t.scope_.immer_.shouldUseStrictIteration()}else i=u2(e,!0);return hx(i,(m,y)=>{zO(i,m,jO(y))},o),t&&(t.finalized_=!1),i}var _N=new yN;_N.produce;var xN={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},LO=Gs({name:"legend",initialState:xN,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Si()},replaceLegendPayload:{reducer(e,t){var{prev:i,next:o}=t.payload,m=oc(e).payload.indexOf(i);m>-1&&(e.payload[m]=o)},prepare:Si()},removeLegendPayload:{reducer(e,t){var i=oc(e).payload.indexOf(t.payload);i>-1&&e.payload.splice(i,1)},prepare:Si()}}}),{setLegendSize:QW,setLegendSettings:JW,addLegendPayload:bN,replaceLegendPayload:wN,removeLegendPayload:SN}=LO.actions,TN=LO.reducer;function p2(){return p2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},p2.apply(null,arguments)}function UA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function uv(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?UA(Object(i),!0).forEach(function(o){EN(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function EN(e,t,i){return(t=AN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function AN(e){var t=MN(e,"string");return typeof t=="symbol"?t:t+""}function MN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PN(e){return Array.isArray(e)&&ih(e[0])&&ih(e[1])?e.join(" ~ "):e}var Sg={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},CN=e=>{var{separator:t=Sg.separator,contentStyle:i,itemStyle:o,labelStyle:m=Sg.labelStyle,payload:y,formatter:_,itemSorter:c,wrapperClassName:M,labelClassName:C,label:D,labelFormatter:k,accessibilityLayer:F=Sg.accessibilityLayer}=e,G=()=>{if(y&&y.length){var ze={padding:0,margin:0},Ae=(c?Yx(y,c):y).map((Oe,rt)=>{if(Oe.type==="none")return null;var gt=Oe.formatter||_||PN,{value:yt,name:tt}=Oe,Ge=yt,Rt=tt;if(gt){var zt=gt(yt,tt,Oe,rt,y);if(Array.isArray(zt))[Ge,Rt]=zt;else if(zt!=null)Ge=zt;else return null}var kt=uv(uv({},Sg.itemStyle),{},{color:Oe.color||Sg.itemStyle.color},o);return Z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(rt),style:kt},ih(Rt)?Z.createElement("span",{className:"recharts-tooltip-item-name"},Rt):null,ih(Rt)?Z.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Z.createElement("span",{className:"recharts-tooltip-item-value"},Ge),Z.createElement("span",{className:"recharts-tooltip-item-unit"},Oe.unit||""))});return Z.createElement("ul",{className:"recharts-tooltip-item-list",style:ze},Ae)}return null},K=uv(uv({},Sg.contentStyle),i),W=uv({margin:0},m),q=!Ei(D),ue=q?D:"",me=Nn("recharts-default-tooltip",M),ge=Nn("recharts-tooltip-label",C);q&&k&&y!==void 0&&y!==null&&(ue=k(D,y));var be=F?{role:"status","aria-live":"assertive"}:{};return Z.createElement("div",p2({className:me,style:K},be),Z.createElement("p",{className:ge,style:W},Z.isValidElement(ue)?ue:"".concat(ue)),G())},cv="recharts-tooltip-wrapper",DN={visibility:"hidden"};function ON(e){var{coordinate:t,translateX:i,translateY:o}=e;return Nn(cv,{["".concat(cv,"-right")]:Jt(i)&&t&&Jt(t.x)&&i>=t.x,["".concat(cv,"-left")]:Jt(i)&&t&&Jt(t.x)&&i<t.x,["".concat(cv,"-bottom")]:Jt(o)&&t&&Jt(t.y)&&o>=t.y,["".concat(cv,"-top")]:Jt(o)&&t&&Jt(t.y)&&o<t.y})}function VA(e){var{allowEscapeViewBox:t,coordinate:i,key:o,offset:m,position:y,reverseDirection:_,tooltipDimension:c,viewBox:M,viewBoxDimension:C}=e;if(y&&Jt(y[o]))return y[o];var D=i[o]-c-(m>0?m:0),k=i[o]+m;if(t[o])return _[o]?D:k;var F=M[o];if(F==null)return 0;if(_[o]){var G=D,K=F;return G<K?Math.max(k,F):Math.max(D,F)}if(C==null)return 0;var W=k+c,q=F+C;return W>q?Math.max(D,F):Math.max(k,F)}function IN(e){var{translateX:t,translateY:i,useTranslate3d:o}=e;return{transform:o?"translate3d(".concat(t,"px, ").concat(i,"px, 0)"):"translate(".concat(t,"px, ").concat(i,"px)")}}function zN(e){var{allowEscapeViewBox:t,coordinate:i,offsetTop:o,offsetLeft:m,position:y,reverseDirection:_,tooltipBox:c,useTranslate3d:M,viewBox:C}=e,D,k,F;return c.height>0&&c.width>0&&i?(k=VA({allowEscapeViewBox:t,coordinate:i,key:"x",offset:m,position:y,reverseDirection:_,tooltipDimension:c.width,viewBox:C,viewBoxDimension:C.width}),F=VA({allowEscapeViewBox:t,coordinate:i,key:"y",offset:o,position:y,reverseDirection:_,tooltipDimension:c.height,viewBox:C,viewBoxDimension:C.height}),D=IN({translateX:k,translateY:F,useTranslate3d:M})):D=DN,{cssProperties:D,cssClasses:ON({translateX:k,translateY:F,coordinate:i})}}function qA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function D0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?qA(Object(i),!0).forEach(function(o){m2(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function m2(e,t,i){return(t=kN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kN(e){var t=RN(e,"string");return typeof t=="symbol"?t:t+""}function RN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jN extends Z.PureComponent{constructor(){super(...arguments),m2(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),m2(this,"handleKeyDown",t=>{if(t.key==="Escape"){var i,o,m,y;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==null&&i!==void 0?i:0,y:(m=(y=this.props.coordinate)===null||y===void 0?void 0:y.y)!==null&&m!==void 0?m:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,i;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:i,animationDuration:o,animationEasing:m,children:y,coordinate:_,hasPayload:c,isAnimationActive:M,offset:C,position:D,reverseDirection:k,useTranslate3d:F,viewBox:G,wrapperStyle:K,lastBoundingBox:W,innerRef:q,hasPortalFromProps:ue}=this.props,me=typeof C=="number"?C:C.x,ge=typeof C=="number"?C:C.y,{cssClasses:be,cssProperties:ze}=zN({allowEscapeViewBox:i,coordinate:_,offsetLeft:me,offsetTop:ge,position:D,reverseDirection:k,tooltipBox:{height:W.height,width:W.width},useTranslate3d:F,viewBox:G}),Ae=ue?{}:D0(D0({transition:M&&t?"transform ".concat(o,"ms ").concat(m):void 0},ze),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),Oe=D0(D0({},Ae),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},K);return Z.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:be,style:Oe,ref:q},y)}}var NO=()=>{var e;return(e=dr(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function g2(){return g2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},g2.apply(null,arguments)}function $A(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function GA(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?$A(Object(i),!0).forEach(function(o){LN(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$A(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function LN(e,t,i){return(t=NN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function NN(e){var t=BN(e,"string");return typeof t=="symbol"?t:t+""}function BN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZA={curveBasisClosed:B3,curveBasisOpen:F3,curveBasis:N3,curveBumpX:T3,curveBumpY:E3,curveLinearClosed:U3,curveLinear:Hx,curveMonotoneX:V3,curveMonotoneY:q3,curveNatural:$3,curveStep:G3,curveStepAfter:H3,curveStepBefore:Z3},px=e=>$r(e.x)&&$r(e.y),HA=e=>e.base!=null&&px(e.base)&&px(e),hv=e=>e.x,fv=e=>e.y,FN=(e,t)=>{if(typeof e=="function")return e;var i="curve".concat(Zv(e));if((i==="curveMonotone"||i==="curveBump")&&t){var o=ZA["".concat(i).concat(t==="vertical"?"Y":"X")];if(o)return o}return ZA[i]||Hx},WA={connectNulls:!1,type:"linear"},UN=e=>{var{type:t=WA.type,points:i=[],baseLine:o,layout:m,connectNulls:y=WA.connectNulls}=e,_=FN(t,m),c=y?i.filter(px):i;if(Array.isArray(o)){var M,C=i.map((K,W)=>GA(GA({},K),{},{base:o[W]}));m==="vertical"?M=w0().y(fv).x1(hv).x0(K=>K.base.x):M=w0().x(hv).y1(fv).y0(K=>K.base.y);var D=M.defined(HA).curve(_),k=y?C.filter(HA):C;return D(k)}var F;m==="vertical"&&Jt(o)?F=w0().y(fv).x1(hv).x0(o):Jt(o)?F=w0().x(hv).y1(fv).y0(o):F=mD().x(hv).y(fv);var G=F.defined(px).curve(_);return G(c)},Tv=e=>{var{className:t,points:i,path:o,pathRef:m}=e,y=qd();if((!i||!i.length)&&!o)return null;var _={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||y,connectNulls:e.connectNulls},c=i&&i.length?UN(_):o;return Z.createElement("path",g2({},bl(e),J2(e),{className:Nn("recharts-curve",t),d:c===null?void 0:c,ref:m}))},VN=["x","y","top","left","width","height","className"];function y2(){return y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},y2.apply(null,arguments)}function YA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function qN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?YA(Object(i),!0).forEach(function(o){$N(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):YA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function $N(e,t,i){return(t=GN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function GN(e){var t=ZN(e,"string");return typeof t=="symbol"?t:t+""}function ZN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HN(e,t){if(e==null)return{};var i,o,m=WN(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function WN(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var YN=(e,t,i,o,m,y)=>"M".concat(e,",").concat(m,"v").concat(o,"M").concat(y,",").concat(t,"h").concat(i),XN=e=>{var{x:t=0,y:i=0,top:o=0,left:m=0,width:y=0,height:_=0,className:c}=e,M=HN(e,VN),C=qN({x:t,y:i,top:o,left:m,width:y,height:_},M);return!Jt(t)||!Jt(i)||!Jt(y)||!Jt(_)||!Jt(o)||!Jt(m)?null:Z.createElement("path",y2({},Wo(C),{className:Nn("recharts-cross",c),d:YN(t,i,y,_,o,m)}))};function KN(e,t,i,o){var m=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-m:i.left+.5,y:e==="horizontal"?i.top+.5:t.y-m,width:e==="horizontal"?o:i.width-1,height:e==="horizontal"?i.height-1:o}}function XA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function KA(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?XA(Object(i),!0).forEach(function(o){QN(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):XA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function QN(e,t,i){return(t=JN(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function JN(e){var t=e4(e,"string");return typeof t=="symbol"?t:t+""}function e4(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t4=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),BO=(e,t,i)=>e.map(o=>"".concat(t4(o)," ").concat(t,"ms ").concat(i)).join(","),r4=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((i,o)=>i.filter(m=>o.includes(m))),jv=(e,t)=>Object.keys(t).reduce((i,o)=>KA(KA({},i),{},{[o]:e(o,t[o])}),{});function QA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Ca(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?QA(Object(i),!0).forEach(function(o){n4(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):QA(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function n4(e,t,i){return(t=i4(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function i4(e){var t=a4(e,"string");return typeof t=="symbol"?t:t+""}function a4(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mx=(e,t,i)=>e+(t-e)*i,v2=e=>{var{from:t,to:i}=e;return t!==i},FO=(e,t,i)=>{var o=jv((m,y)=>{if(v2(y)){var[_,c]=e(y.from,y.to,y.velocity);return Ca(Ca({},y),{},{from:_,velocity:c})}return y},t);return i<1?jv((m,y)=>v2(y)&&o[m]!=null?Ca(Ca({},y),{},{velocity:mx(y.velocity,o[m].velocity,i),from:mx(y.from,o[m].from,i)}):y,t):FO(e,o,i-1)};function o4(e,t,i,o,m,y){var _,c=o.reduce((F,G)=>Ca(Ca({},F),{},{[G]:{from:e[G],velocity:0,to:t[G]}}),{}),M=()=>jv((F,G)=>G.from,c),C=()=>!Object.values(c).filter(v2).length,D=null,k=F=>{_||(_=F);var G=F-_,K=G/i.dt;c=FO(i,c,K),m(Ca(Ca(Ca({},e),t),M())),_=F,C()||(D=y.setTimeout(k))};return()=>(D=y.setTimeout(k),()=>{var F;(F=D)===null||F===void 0||F()})}function s4(e,t,i,o,m,y,_){var c=null,M=m.reduce((k,F)=>{var G=e[F],K=t[F];return G==null||K==null?k:Ca(Ca({},k),{},{[F]:[G,K]})},{}),C,D=k=>{C||(C=k);var F=(k-C)/o,G=jv((W,q)=>mx(...q,i(F)),M);if(y(Ca(Ca(Ca({},e),t),G)),F<1)c=_.setTimeout(D);else{var K=jv((W,q)=>mx(...q,i(1)),M);y(Ca(Ca(Ca({},e),t),K))}};return()=>(c=_.setTimeout(D),()=>{var k;(k=c)===null||k===void 0||k()})}const l4=(e,t,i,o,m,y)=>{var _=r4(e,t);return i==null?()=>(m(Ca(Ca({},e),t)),()=>{}):i.isStepper===!0?o4(e,t,i,_,m,y):s4(e,t,i,o,_,m,y)};var gx=1e-4,UO=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],VO=(e,t)=>e.map((i,o)=>i*t**o).reduce((i,o)=>i+o),JA=(e,t)=>i=>{var o=UO(e,t);return VO(o,i)},u4=(e,t)=>i=>{var o=UO(e,t),m=[...o.map((y,_)=>y*_).slice(1),0];return VO(m,i)},c4=e=>{var t,i=e.split("(");if(i.length!==2||i[0]!=="cubic-bezier")return null;var o=(t=i[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(o==null||o.length!==4)return null;var m=o.map(y=>parseFloat(y));return[m[0],m[1],m[2],m[3]]},h4=function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var m=c4(i[0]);if(m)return m}}return i.length===4?i:[0,0,1,1]},f4=(e,t,i,o)=>{var m=JA(e,i),y=JA(t,o),_=u4(e,i),c=C=>C>1?1:C<0?0:C,M=C=>{for(var D=C>1?1:C,k=D,F=0;F<8;++F){var G=m(k)-D,K=_(k);if(Math.abs(G-D)<gx||K<gx)return y(k);k=c(k-G/K)}return y(k)};return M.isStepper=!1,M},eM=function(){return f4(...h4(...arguments))},d4=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:i=100,damping:o=8,dt:m=17}=t,y=(_,c,M)=>{var C=-(_-c)*i,D=M*o,k=M+(C-D)*m/1e3,F=M*m/1e3+_;return Math.abs(F-c)<gx&&Math.abs(k)<gx?[c,0]:[F,k]};return y.isStepper=!0,y.dt=m,y},p4=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return eM(e);case"spring":return d4();default:if(e.split("(")[0]==="cubic-bezier")return eM(e)}return typeof e=="function"?e:null};function m4(e){var t,i=()=>null,o=!1,m=null,y=_=>{if(!o){if(Array.isArray(_)){if(!_.length)return;var c=_,[M,...C]=c;if(typeof M=="number"){m=e.setTimeout(y.bind(null,C),M);return}y(M),m=e.setTimeout(y.bind(null,C));return}typeof _=="string"&&(t=_,i(t)),typeof _=="object"&&(t=_,i(t)),typeof _=="function"&&_()}};return{stop:()=>{o=!0},start:_=>{o=!1,m&&(m(),m=null),y(_)},subscribe:_=>(i=_,()=>{i=()=>null}),getTimeoutController:()=>e}}class g4{setTimeout(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=performance.now(),m=null,y=_=>{_-o>=i?t(_):typeof requestAnimationFrame=="function"&&(m=requestAnimationFrame(y))};return m=requestAnimationFrame(y),()=>{m!=null&&cancelAnimationFrame(m)}}}function y4(){return m4(new g4)}var v4=Z.createContext(y4);function _4(e,t){var i=Z.useContext(v4);return Z.useMemo(()=>t??i(e),[e,t,i])}var x4=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Qv={isSsr:x4()},b4={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},tM={t:0},hw={t:1};function Jv(e){var t=Ro(e,b4),{isActive:i,canBegin:o,duration:m,easing:y,begin:_,onAnimationEnd:c,onAnimationStart:M,children:C}=t,D=i==="auto"?!Qv.isSsr:i,k=_4(t.animationId,t.animationManager),[F,G]=Z.useState(D?tM:hw),K=Z.useRef(null);return Z.useEffect(()=>{D||G(hw)},[D]),Z.useEffect(()=>{if(!D||!o)return Vd;var W=l4(tM,hw,p4(y),m,G,k.getTimeoutController()),q=()=>{K.current=W()};return k.start([M,_,q,m,c]),()=>{k.stop(),K.current&&K.current(),c()}},[D,o,m,y,_,M,c,k]),C(F.t)}function e_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",i=Z.useRef(Cv(t)),o=Z.useRef(e);return o.current!==e&&(i.current=Cv(t),o.current=e),i.current}var w4=["radius"],S4=["radius"],rM,nM,iM,aM,oM,sM,lM,uM,cM,hM;function fM(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function dM(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(i),!0).forEach(function(o){T4(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fM(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function T4(e,t,i){return(t=E4(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E4(e){var t=A4(e,"string");return typeof t=="symbol"?t:t+""}function A4(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},yx.apply(null,arguments)}function pM(e,t){if(e==null)return{};var i,o,m=M4(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function M4(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function Kc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var mM=(e,t,i,o,m)=>{var y=Ld(i),_=Ld(o),c=Math.min(Math.abs(y)/2,Math.abs(_)/2),M=_>=0?1:-1,C=y>=0?1:-1,D=_>=0&&y>=0||_<0&&y<0?1:0,k;if(c>0&&Array.isArray(m)){for(var F=[0,0,0,0],G=0,K=4;G<K;G++){var W,q=(W=m[G])!==null&&W!==void 0?W:0;F[G]=q>c?c:q}k=$i(rM||(rM=Kc(["M",",",""])),e,t+M*F[0]),F[0]>0&&(k+=$i(nM||(nM=Kc(["A ",",",",0,0,",",",",",""])),F[0],F[0],D,e+C*F[0],t)),k+=$i(iM||(iM=Kc(["L ",",",""])),e+i-C*F[1],t),F[1]>0&&(k+=$i(aM||(aM=Kc(["A ",",",",0,0,",`,
        `,",",""])),F[1],F[1],D,e+i,t+M*F[1])),k+=$i(oM||(oM=Kc(["L ",",",""])),e+i,t+o-M*F[2]),F[2]>0&&(k+=$i(sM||(sM=Kc(["A ",",",",0,0,",`,
        `,",",""])),F[2],F[2],D,e+i-C*F[2],t+o)),k+=$i(lM||(lM=Kc(["L ",",",""])),e+C*F[3],t+o),F[3]>0&&(k+=$i(uM||(uM=Kc(["A ",",",",0,0,",`,
        `,",",""])),F[3],F[3],D,e,t+o-M*F[3])),k+="Z"}else if(c>0&&m===+m&&m>0){var ue=Math.min(c,m);k=$i(cM||(cM=Kc(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+M*ue,ue,ue,D,e+C*ue,t,e+i-C*ue,t,ue,ue,D,e+i,t+M*ue,e+i,t+o-M*ue,ue,ue,D,e+i-C*ue,t+o,e+C*ue,t+o,ue,ue,D,e,t+o-M*ue)}else k=$i(hM||(hM=Kc(["M ",","," h "," v "," h "," Z"])),e,t,i,o,-i);return k},gM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},qO=e=>{var t=Ro(e,gM),i=Z.useRef(null),[o,m]=Z.useState(-1);Z.useEffect(()=>{if(i.current&&i.current.getTotalLength)try{var at=i.current.getTotalLength();at&&m(at)}catch{}},[]);var{x:y,y:_,width:c,height:M,radius:C,className:D}=t,{animationEasing:k,animationDuration:F,animationBegin:G,isAnimationActive:K,isUpdateAnimationActive:W}=t,q=Z.useRef(c),ue=Z.useRef(M),me=Z.useRef(y),ge=Z.useRef(_),be=Z.useMemo(()=>({x:y,y:_,width:c,height:M,radius:C}),[y,_,c,M,C]),ze=e_(be,"rectangle-");if(y!==+y||_!==+_||c!==+c||M!==+M||c===0||M===0)return null;var Ae=Nn("recharts-rectangle",D);if(!W){var Oe=Wo(t),{radius:rt}=Oe,gt=pM(Oe,w4);return Z.createElement("path",yx({},gt,{x:Ld(y),y:Ld(_),width:Ld(c),height:Ld(M),radius:typeof C=="number"?C:void 0,className:Ae,d:mM(y,_,c,M,C)}))}var yt=q.current,tt=ue.current,Ge=me.current,Rt=ge.current,zt="0px ".concat(o===-1?1:o,"px"),kt="".concat(o,"px 0px"),Ue=BO(["strokeDasharray"],F,typeof k=="string"?k:gM.animationEasing);return Z.createElement(Jv,{animationId:ze,key:ze,canBegin:o>0,duration:F,easing:k,isActive:W,begin:G},at=>{var pt=Gn(yt,c,at),bt=Gn(tt,M,at),Ut=Gn(Ge,y,at),Ce=Gn(Rt,_,at);i.current&&(q.current=pt,ue.current=bt,me.current=Ut,ge.current=Ce);var nt;K?at>0?nt={transition:Ue,strokeDasharray:kt}:nt={strokeDasharray:zt}:nt={strokeDasharray:kt};var Be=Wo(t),{radius:lt}=Be,Ft=pM(Be,S4);return Z.createElement("path",yx({},Ft,{radius:typeof C=="number"?C:void 0,className:Ae,d:mM(Ut,Ce,pt,bt,C),ref:i,style:dM(dM({},nt),t.style)}))})};function yM(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function vM(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?yM(Object(i),!0).forEach(function(o){P4(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yM(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function P4(e,t,i){return(t=C4(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function C4(e){var t=D4(e,"string");return typeof t=="symbol"?t:t+""}function D4(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vx=Math.PI/180,O4=e=>e*180/Math.PI,ko=(e,t,i,o)=>({x:e+Math.cos(-vx*o)*i,y:t+Math.sin(-vx*o)*i}),I4=function(t,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(o.left||0)-(o.right||0)),Math.abs(i-(o.top||0)-(o.bottom||0)))/2},z4=(e,t)=>{var{x:i,y:o}=e,{x:m,y}=t;return Math.sqrt((i-m)**2+(o-y)**2)},k4=(e,t)=>{var{x:i,y:o}=e,{cx:m,cy:y}=t,_=z4({x:i,y:o},{x:m,y});if(_<=0)return{radius:_,angle:0};var c=(i-m)/_,M=Math.acos(c);return o>y&&(M=2*Math.PI-M),{radius:_,angle:O4(M),angleInRadian:M}},R4=e=>{var{startAngle:t,endAngle:i}=e,o=Math.floor(t/360),m=Math.floor(i/360),y=Math.min(o,m);return{startAngle:t-y*360,endAngle:i-y*360}},j4=(e,t)=>{var{startAngle:i,endAngle:o}=t,m=Math.floor(i/360),y=Math.floor(o/360),_=Math.min(m,y);return e+_*360},L4=(e,t)=>{var{chartX:i,chartY:o}=e,{radius:m,angle:y}=k4({x:i,y:o},t),{innerRadius:_,outerRadius:c}=t;if(m<_||m>c||m===0)return null;var{startAngle:M,endAngle:C}=R4(t),D=y,k;if(M<=C){for(;D>C;)D-=360;for(;D<M;)D+=360;k=D>=M&&D<=C}else{for(;D>M;)D-=360;for(;D<C;)D+=360;k=D>=C&&D<=M}return k?vM(vM({},t),{},{radius:m,angle:j4(D,t)}):null};function $O(e){var{cx:t,cy:i,radius:o,startAngle:m,endAngle:y}=e,_=ko(t,i,o,m),c=ko(t,i,o,y);return{points:[_,c],cx:t,cy:i,radius:o,startAngle:m,endAngle:y}}var _M,xM,bM,wM,SM,TM,EM;function _2(){return _2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_2.apply(null,arguments)}function Vp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var N4=(e,t)=>{var i=Vs(t-e),o=Math.min(Math.abs(t-e),359.999);return i*o},O0=e=>{var{cx:t,cy:i,radius:o,angle:m,sign:y,isExternal:_,cornerRadius:c,cornerIsExternal:M}=e,C=c*(_?1:-1)+o,D=Math.asin(c/C)/vx,k=M?m:m+y*D,F=ko(t,i,C,k),G=ko(t,i,o,k),K=M?m-y*D:m,W=ko(t,i,C*Math.cos(D*vx),K);return{center:F,circleTangency:G,lineTangency:W,theta:D}},GO=e=>{var{cx:t,cy:i,innerRadius:o,outerRadius:m,startAngle:y,endAngle:_}=e,c=N4(y,_),M=y+c,C=ko(t,i,m,y),D=ko(t,i,m,M),k=$i(_M||(_M=Vp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),C.x,C.y,m,m,+(Math.abs(c)>180),+(y>M),D.x,D.y);if(o>0){var F=ko(t,i,o,y),G=ko(t,i,o,M);k+=$i(xM||(xM=Vp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),G.x,G.y,o,o,+(Math.abs(c)>180),+(y<=M),F.x,F.y)}else k+=$i(bM||(bM=Vp(["L ",","," Z"])),t,i);return k},B4=e=>{var{cx:t,cy:i,innerRadius:o,outerRadius:m,cornerRadius:y,forceCornerRadius:_,cornerIsExternal:c,startAngle:M,endAngle:C}=e,D=Vs(C-M),{circleTangency:k,lineTangency:F,theta:G}=O0({cx:t,cy:i,radius:m,angle:M,sign:D,cornerRadius:y,cornerIsExternal:c}),{circleTangency:K,lineTangency:W,theta:q}=O0({cx:t,cy:i,radius:m,angle:C,sign:-D,cornerRadius:y,cornerIsExternal:c}),ue=c?Math.abs(M-C):Math.abs(M-C)-G-q;if(ue<0)return _?$i(wM||(wM=Vp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),F.x,F.y,y,y,y*2,y,y,-y*2):GO({cx:t,cy:i,innerRadius:o,outerRadius:m,startAngle:M,endAngle:C});var me=$i(SM||(SM=Vp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),F.x,F.y,y,y,+(D<0),k.x,k.y,m,m,+(ue>180),+(D<0),K.x,K.y,y,y,+(D<0),W.x,W.y);if(o>0){var{circleTangency:ge,lineTangency:be,theta:ze}=O0({cx:t,cy:i,radius:o,angle:M,sign:D,isExternal:!0,cornerRadius:y,cornerIsExternal:c}),{circleTangency:Ae,lineTangency:Oe,theta:rt}=O0({cx:t,cy:i,radius:o,angle:C,sign:-D,isExternal:!0,cornerRadius:y,cornerIsExternal:c}),gt=c?Math.abs(M-C):Math.abs(M-C)-ze-rt;if(gt<0&&y===0)return"".concat(me,"L").concat(t,",").concat(i,"Z");me+=$i(TM||(TM=Vp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),Oe.x,Oe.y,y,y,+(D<0),Ae.x,Ae.y,o,o,+(gt>180),+(D>0),ge.x,ge.y,y,y,+(D<0),be.x,be.y)}else me+=$i(EM||(EM=Vp(["L",",","Z"])),t,i);return me},F4={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},ZO=e=>{var t=Ro(e,F4),{cx:i,cy:o,innerRadius:m,outerRadius:y,cornerRadius:_,forceCornerRadius:c,cornerIsExternal:M,startAngle:C,endAngle:D,className:k}=t;if(y<m||C===D)return null;var F=Nn("recharts-sector",k),G=y-m,K=lc(_,G,0,!0),W;return K>0&&Math.abs(C-D)<360?W=B4({cx:i,cy:o,innerRadius:m,outerRadius:y,cornerRadius:Math.min(K,G/2),forceCornerRadius:c,cornerIsExternal:M,startAngle:C,endAngle:D}):W=GO({cx:i,cy:o,innerRadius:m,outerRadius:y,startAngle:C,endAngle:D}),Z.createElement("path",_2({},Wo(t),{className:F,d:W}))};function U4(e,t,i){if(e==="horizontal")return[{x:t.x,y:i.top},{x:t.x,y:i.top+i.height}];if(e==="vertical")return[{x:i.left,y:t.y},{x:i.left+i.width,y:t.y}];if(OD(t)){if(e==="centric"){var{cx:o,cy:m,innerRadius:y,outerRadius:_,angle:c}=t,M=ko(o,m,y,c),C=ko(o,m,_,c);return[{x:M.x,y:M.y},{x:C.x,y:C.y}]}return $O(t)}}var fw={},dw={},pw={},AM;function V4(){return AM||(AM=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UD();function i(o){return t.isSymbol(o)?NaN:Number(o)}e.toNumber=i})(pw)),pw}var MM;function q4(){return MM||(MM=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V4();function i(o){return o?(o=t.toNumber(o),o===1/0||o===-1/0?(o<0?-1:1)*Number.MAX_VALUE:o===o?o:0):o===0?o:0}e.toFinite=i})(dw)),dw}var PM;function $4(){return PM||(PM=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VD(),i=q4();function o(m,y,_){_&&typeof _!="number"&&t.isIterateeCall(m,y,_)&&(y=_=void 0),m=i.toFinite(m),y===void 0?(y=m,m=0):y=i.toFinite(y),_=_===void 0?m<y?1:-1:i.toFinite(_);const c=Math.max(Math.ceil((y-m)/(_||1)),0),M=new Array(c);for(let C=0;C<c;C++)M[C]=m,m+=_;return M}e.range=o})(fw)),fw}var mw,CM;function G4(){return CM||(CM=1,mw=$4().range),mw}var Z4=G4();const HO=uh(Z4);function Bd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function H4(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function gS(e){let t,i,o;e.length!==2?(t=Bd,i=(c,M)=>Bd(e(c),M),o=(c,M)=>e(c)-M):(t=e===Bd||e===H4?e:W4,i=e,o=e);function m(c,M,C=0,D=c.length){if(C<D){if(t(M,M)!==0)return D;do{const k=C+D>>>1;i(c[k],M)<0?C=k+1:D=k}while(C<D)}return C}function y(c,M,C=0,D=c.length){if(C<D){if(t(M,M)!==0)return D;do{const k=C+D>>>1;i(c[k],M)<=0?C=k+1:D=k}while(C<D)}return C}function _(c,M,C=0,D=c.length){const k=m(c,M,C,D-1);return k>C&&o(c[k-1],M)>-o(c[k],M)?k-1:k}return{left:m,center:_,right:y}}function W4(){return 0}function WO(e){return e===null?NaN:+e}function*Y4(e,t){for(let i of e)i!=null&&(i=+i)>=i&&(yield i)}const X4=gS(Bd),t_=X4.right;gS(WO).center;class DM extends Map{constructor(t,i=J4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(const[o,m]of t)this.set(o,m)}get(t){return super.get(OM(this,t))}has(t){return super.has(OM(this,t))}set(t,i){return super.set(K4(this,t),i)}delete(t){return super.delete(Q4(this,t))}}function OM({_intern:e,_key:t},i){const o=t(i);return e.has(o)?e.get(o):i}function K4({_intern:e,_key:t},i){const o=t(i);return e.has(o)?e.get(o):(e.set(o,i),i)}function Q4({_intern:e,_key:t},i){const o=t(i);return e.has(o)&&(i=e.get(o),e.delete(o)),i}function J4(e){return e!==null&&typeof e=="object"?e.valueOf():e}function eB(e=Bd){if(e===Bd)return YO;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,i)=>{const o=e(t,i);return o||o===0?o:(e(i,i)===0)-(e(t,t)===0)}}function YO(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const tB=Math.sqrt(50),rB=Math.sqrt(10),nB=Math.sqrt(2);function _x(e,t,i){const o=(t-e)/Math.max(0,i),m=Math.floor(Math.log10(o)),y=o/Math.pow(10,m),_=y>=tB?10:y>=rB?5:y>=nB?2:1;let c,M,C;return m<0?(C=Math.pow(10,-m)/_,c=Math.round(e*C),M=Math.round(t*C),c/C<e&&++c,M/C>t&&--M,C=-C):(C=Math.pow(10,m)*_,c=Math.round(e/C),M=Math.round(t/C),c*C<e&&++c,M*C>t&&--M),M<c&&.5<=i&&i<2?_x(e,t,i*2):[c,M,C]}function x2(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];const o=t<e,[m,y,_]=o?_x(t,e,i):_x(e,t,i);if(!(y>=m))return[];const c=y-m+1,M=new Array(c);if(o)if(_<0)for(let C=0;C<c;++C)M[C]=(y-C)/-_;else for(let C=0;C<c;++C)M[C]=(y-C)*_;else if(_<0)for(let C=0;C<c;++C)M[C]=(m+C)/-_;else for(let C=0;C<c;++C)M[C]=(m+C)*_;return M}function b2(e,t,i){return t=+t,e=+e,i=+i,_x(e,t,i)[2]}function w2(e,t,i){t=+t,e=+e,i=+i;const o=t<e,m=o?b2(t,e,i):b2(e,t,i);return(o?-1:1)*(m<0?1/-m:m)}function IM(e,t){let i;for(const o of e)o!=null&&(i<o||i===void 0&&o>=o)&&(i=o);return i}function zM(e,t){let i;for(const o of e)o!=null&&(i>o||i===void 0&&o>=o)&&(i=o);return i}function XO(e,t,i=0,o=1/0,m){if(t=Math.floor(t),i=Math.floor(Math.max(0,i)),o=Math.floor(Math.min(e.length-1,o)),!(i<=t&&t<=o))return e;for(m=m===void 0?YO:eB(m);o>i;){if(o-i>600){const M=o-i+1,C=t-i+1,D=Math.log(M),k=.5*Math.exp(2*D/3),F=.5*Math.sqrt(D*k*(M-k)/M)*(C-M/2<0?-1:1),G=Math.max(i,Math.floor(t-C*k/M+F)),K=Math.min(o,Math.floor(t+(M-C)*k/M+F));XO(e,t,G,K,m)}const y=e[t];let _=i,c=o;for(dv(e,i,t),m(e[o],y)>0&&dv(e,i,o);_<c;){for(dv(e,_,c),++_,--c;m(e[_],y)<0;)++_;for(;m(e[c],y)>0;)--c}m(e[i],y)===0?dv(e,i,c):(++c,dv(e,c,o)),c<=t&&(i=c+1),t<=c&&(o=c-1)}return e}function dv(e,t,i){const o=e[t];e[t]=e[i],e[i]=o}function iB(e,t,i){if(e=Float64Array.from(Y4(e)),!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return zM(e);if(t>=1)return IM(e);var o,m=(o-1)*t,y=Math.floor(m),_=IM(XO(e,y).subarray(0,y+1)),c=zM(e.subarray(y+1));return _+(c-_)*(m-y)}}function aB(e,t,i=WO){if(!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return+i(e[0],0,e);if(t>=1)return+i(e[o-1],o-1,e);var o,m=(o-1)*t,y=Math.floor(m),_=+i(e[y],y,e),c=+i(e[y+1],y+1,e);return _+(c-_)*(m-y)}}function oB(e,t,i){e=+e,t=+t,i=(m=arguments.length)<2?(t=e,e=0,1):m<3?1:+i;for(var o=-1,m=Math.max(0,Math.ceil((t-e)/i))|0,y=new Array(m);++o<m;)y[o]=e+o*i;return y}function fu(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function bf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const S2=Symbol("implicit");function yS(){var e=new DM,t=[],i=[],o=S2;function m(y){let _=e.get(y);if(_===void 0){if(o!==S2)return o;e.set(y,_=t.push(y)-1)}return i[_%i.length]}return m.domain=function(y){if(!arguments.length)return t.slice();t=[],e=new DM;for(const _ of y)e.has(_)||e.set(_,t.push(_)-1);return m},m.range=function(y){return arguments.length?(i=Array.from(y),m):i.slice()},m.unknown=function(y){return arguments.length?(o=y,m):o},m.copy=function(){return yS(t,i).unknown(o)},fu.apply(m,arguments),m}function vS(){var e=yS().unknown(void 0),t=e.domain,i=e.range,o=0,m=1,y,_,c=!1,M=0,C=0,D=.5;delete e.unknown;function k(){var F=t().length,G=m<o,K=G?m:o,W=G?o:m;y=(W-K)/Math.max(1,F-M+C*2),c&&(y=Math.floor(y)),K+=(W-K-y*(F-M))*D,_=y*(1-M),c&&(K=Math.round(K),_=Math.round(_));var q=oB(F).map(function(ue){return K+y*ue});return i(G?q.reverse():q)}return e.domain=function(F){return arguments.length?(t(F),k()):t()},e.range=function(F){return arguments.length?([o,m]=F,o=+o,m=+m,k()):[o,m]},e.rangeRound=function(F){return[o,m]=F,o=+o,m=+m,c=!0,k()},e.bandwidth=function(){return _},e.step=function(){return y},e.round=function(F){return arguments.length?(c=!!F,k()):c},e.padding=function(F){return arguments.length?(M=Math.min(1,C=+F),k()):M},e.paddingInner=function(F){return arguments.length?(M=Math.min(1,F),k()):M},e.paddingOuter=function(F){return arguments.length?(C=+F,k()):C},e.align=function(F){return arguments.length?(D=Math.max(0,Math.min(1,F)),k()):D},e.copy=function(){return vS(t(),[o,m]).round(c).paddingInner(M).paddingOuter(C).align(D)},fu.apply(k(),arguments)}function KO(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return KO(t())},e}function sB(){return KO(vS.apply(null,arguments).paddingInner(1))}function _S(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function QO(e,t){var i=Object.create(e.prototype);for(var o in t)i[o]=t[o];return i}function r_(){}var Lv=.7,xx=1/Lv,Rg="\\s*([+-]?\\d+)\\s*",Nv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lB=/^#([0-9a-f]{3,8})$/,uB=new RegExp(`^rgb\\(${Rg},${Rg},${Rg}\\)$`),cB=new RegExp(`^rgb\\(${nh},${nh},${nh}\\)$`),hB=new RegExp(`^rgba\\(${Rg},${Rg},${Rg},${Nv}\\)$`),fB=new RegExp(`^rgba\\(${nh},${nh},${nh},${Nv}\\)$`),dB=new RegExp(`^hsl\\(${Nv},${nh},${nh}\\)$`),pB=new RegExp(`^hsla\\(${Nv},${nh},${nh},${Nv}\\)$`),kM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_S(r_,Bv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:RM,formatHex:RM,formatHex8:mB,formatHsl:gB,formatRgb:jM,toString:jM});function RM(){return this.rgb().formatHex()}function mB(){return this.rgb().formatHex8()}function gB(){return JO(this).formatHsl()}function jM(){return this.rgb().formatRgb()}function Bv(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=lB.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?LM(t):i===3?new $s(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?I0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?I0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uB.exec(e))?new $s(t[1],t[2],t[3],1):(t=cB.exec(e))?new $s(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hB.exec(e))?I0(t[1],t[2],t[3],t[4]):(t=fB.exec(e))?I0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=dB.exec(e))?FM(t[1],t[2]/100,t[3]/100,1):(t=pB.exec(e))?FM(t[1],t[2]/100,t[3]/100,t[4]):kM.hasOwnProperty(e)?LM(kM[e]):e==="transparent"?new $s(NaN,NaN,NaN,0):null}function LM(e){return new $s(e>>16&255,e>>8&255,e&255,1)}function I0(e,t,i,o){return o<=0&&(e=t=i=NaN),new $s(e,t,i,o)}function yB(e){return e instanceof r_||(e=Bv(e)),e?(e=e.rgb(),new $s(e.r,e.g,e.b,e.opacity)):new $s}function T2(e,t,i,o){return arguments.length===1?yB(e):new $s(e,t,i,o??1)}function $s(e,t,i,o){this.r=+e,this.g=+t,this.b=+i,this.opacity=+o}_S($s,T2,QO(r_,{brighter(e){return e=e==null?xx:Math.pow(xx,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Lv:Math.pow(Lv,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $s(Hp(this.r),Hp(this.g),Hp(this.b),bx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:NM,formatHex:NM,formatHex8:vB,formatRgb:BM,toString:BM}));function NM(){return`#${qp(this.r)}${qp(this.g)}${qp(this.b)}`}function vB(){return`#${qp(this.r)}${qp(this.g)}${qp(this.b)}${qp((isNaN(this.opacity)?1:this.opacity)*255)}`}function BM(){const e=bx(this.opacity);return`${e===1?"rgb(":"rgba("}${Hp(this.r)}, ${Hp(this.g)}, ${Hp(this.b)}${e===1?")":`, ${e})`}`}function bx(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qp(e){return e=Hp(e),(e<16?"0":"")+e.toString(16)}function FM(e,t,i,o){return o<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new ac(e,t,i,o)}function JO(e){if(e instanceof ac)return new ac(e.h,e.s,e.l,e.opacity);if(e instanceof r_||(e=Bv(e)),!e)return new ac;if(e instanceof ac)return e;e=e.rgb();var t=e.r/255,i=e.g/255,o=e.b/255,m=Math.min(t,i,o),y=Math.max(t,i,o),_=NaN,c=y-m,M=(y+m)/2;return c?(t===y?_=(i-o)/c+(i<o)*6:i===y?_=(o-t)/c+2:_=(t-i)/c+4,c/=M<.5?y+m:2-y-m,_*=60):c=M>0&&M<1?0:_,new ac(_,c,M,e.opacity)}function _B(e,t,i,o){return arguments.length===1?JO(e):new ac(e,t,i,o??1)}function ac(e,t,i,o){this.h=+e,this.s=+t,this.l=+i,this.opacity=+o}_S(ac,_B,QO(r_,{brighter(e){return e=e==null?xx:Math.pow(xx,e),new ac(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Lv:Math.pow(Lv,e),new ac(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,o=i+(i<.5?i:1-i)*t,m=2*i-o;return new $s(gw(e>=240?e-240:e+120,m,o),gw(e,m,o),gw(e<120?e+240:e-120,m,o),this.opacity)},clamp(){return new ac(UM(this.h),z0(this.s),z0(this.l),bx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=bx(this.opacity);return`${e===1?"hsl(":"hsla("}${UM(this.h)}, ${z0(this.s)*100}%, ${z0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function UM(e){return e=(e||0)%360,e<0?e+360:e}function z0(e){return Math.max(0,Math.min(1,e||0))}function gw(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const xS=e=>()=>e;function xB(e,t){return function(i){return e+i*t}}function bB(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(o){return Math.pow(e+o*t,i)}}function wB(e){return(e=+e)==1?eI:function(t,i){return i-t?bB(t,i,e):xS(isNaN(t)?i:t)}}function eI(e,t){var i=t-e;return i?xB(e,i):xS(isNaN(e)?t:e)}const VM=(function e(t){var i=wB(t);function o(m,y){var _=i((m=T2(m)).r,(y=T2(y)).r),c=i(m.g,y.g),M=i(m.b,y.b),C=eI(m.opacity,y.opacity);return function(D){return m.r=_(D),m.g=c(D),m.b=M(D),m.opacity=C(D),m+""}}return o.gamma=e,o})(1);function SB(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,o=t.slice(),m;return function(y){for(m=0;m<i;++m)o[m]=e[m]*(1-y)+t[m]*y;return o}}function TB(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function EB(e,t){var i=t?t.length:0,o=e?Math.min(i,e.length):0,m=new Array(o),y=new Array(i),_;for(_=0;_<o;++_)m[_]=Zg(e[_],t[_]);for(;_<i;++_)y[_]=t[_];return function(c){for(_=0;_<o;++_)y[_]=m[_](c);return y}}function AB(e,t){var i=new Date;return e=+e,t=+t,function(o){return i.setTime(e*(1-o)+t*o),i}}function wx(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function MB(e,t){var i={},o={},m;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(m in t)m in e?i[m]=Zg(e[m],t[m]):o[m]=t[m];return function(y){for(m in i)o[m]=i[m](y);return o}}var E2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yw=new RegExp(E2.source,"g");function PB(e){return function(){return e}}function CB(e){return function(t){return e(t)+""}}function DB(e,t){var i=E2.lastIndex=yw.lastIndex=0,o,m,y,_=-1,c=[],M=[];for(e=e+"",t=t+"";(o=E2.exec(e))&&(m=yw.exec(t));)(y=m.index)>i&&(y=t.slice(i,y),c[_]?c[_]+=y:c[++_]=y),(o=o[0])===(m=m[0])?c[_]?c[_]+=m:c[++_]=m:(c[++_]=null,M.push({i:_,x:wx(o,m)})),i=yw.lastIndex;return i<t.length&&(y=t.slice(i),c[_]?c[_]+=y:c[++_]=y),c.length<2?M[0]?CB(M[0].x):PB(t):(t=M.length,function(C){for(var D=0,k;D<t;++D)c[(k=M[D]).i]=k.x(C);return c.join("")})}function Zg(e,t){var i=typeof t,o;return t==null||i==="boolean"?xS(t):(i==="number"?wx:i==="string"?(o=Bv(t))?(t=o,VM):DB:t instanceof Bv?VM:t instanceof Date?AB:TB(t)?SB:Array.isArray(t)?EB:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?MB:wx)(e,t)}function bS(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}function OB(e,t){t===void 0&&(t=e,e=Zg);for(var i=0,o=t.length-1,m=t[0],y=new Array(o<0?0:o);i<o;)y[i]=e(m,m=t[++i]);return function(_){var c=Math.max(0,Math.min(o-1,Math.floor(_*=o)));return y[c](_-c)}}function IB(e){return function(){return e}}function Sx(e){return+e}var qM=[0,1];function vs(e){return e}function A2(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:IB(isNaN(t)?NaN:.5)}function zB(e,t){var i;return e>t&&(i=e,e=t,t=i),function(o){return Math.max(e,Math.min(t,o))}}function kB(e,t,i){var o=e[0],m=e[1],y=t[0],_=t[1];return m<o?(o=A2(m,o),y=i(_,y)):(o=A2(o,m),y=i(y,_)),function(c){return y(o(c))}}function RB(e,t,i){var o=Math.min(e.length,t.length)-1,m=new Array(o),y=new Array(o),_=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++_<o;)m[_]=A2(e[_],e[_+1]),y[_]=i(t[_],t[_+1]);return function(c){var M=t_(e,c,1,o)-1;return y[M](m[M](c))}}function n_(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function db(){var e=qM,t=qM,i=Zg,o,m,y,_=vs,c,M,C;function D(){var F=Math.min(e.length,t.length);return _!==vs&&(_=zB(e[0],e[F-1])),c=F>2?RB:kB,M=C=null,k}function k(F){return F==null||isNaN(F=+F)?y:(M||(M=c(e.map(o),t,i)))(o(_(F)))}return k.invert=function(F){return _(m((C||(C=c(t,e.map(o),wx)))(F)))},k.domain=function(F){return arguments.length?(e=Array.from(F,Sx),D()):e.slice()},k.range=function(F){return arguments.length?(t=Array.from(F),D()):t.slice()},k.rangeRound=function(F){return t=Array.from(F),i=bS,D()},k.clamp=function(F){return arguments.length?(_=F?!0:vs,D()):_!==vs},k.interpolate=function(F){return arguments.length?(i=F,D()):i},k.unknown=function(F){return arguments.length?(y=F,k):y},function(F,G){return o=F,m=G,D()}}function wS(){return db()(vs,vs)}function jB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Tx(e,t){if(!isFinite(e)||e===0)return null;var i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),o=e.slice(0,i);return[o.length>1?o[0]+o.slice(2):o,+e.slice(i+1)]}function Ug(e){return e=Tx(Math.abs(e)),e?e[1]:NaN}function LB(e,t){return function(i,o){for(var m=i.length,y=[],_=0,c=e[0],M=0;m>0&&c>0&&(M+c+1>o&&(c=Math.max(1,o-M)),y.push(i.substring(m-=c,m+c)),!((M+=c+1)>o));)c=e[_=(_+1)%e.length];return y.reverse().join(t)}}function NB(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var BB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fv(e){if(!(t=BB.exec(e)))throw new Error("invalid format: "+e);var t;return new SS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Fv.prototype=SS.prototype;function SS(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}SS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function FB(e){e:for(var t=e.length,i=1,o=-1,m;i<t;++i)switch(e[i]){case".":o=m=i;break;case"0":o===0&&(o=i),m=i;break;default:if(!+e[i])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(m+1):e}var Ex;function UB(e,t){var i=Tx(e,t);if(!i)return Ex=void 0,e.toPrecision(t);var o=i[0],m=i[1],y=m-(Ex=Math.max(-8,Math.min(8,Math.floor(m/3)))*3)+1,_=o.length;return y===_?o:y>_?o+new Array(y-_+1).join("0"):y>0?o.slice(0,y)+"."+o.slice(y):"0."+new Array(1-y).join("0")+Tx(e,Math.max(0,t+y-1))[0]}function $M(e,t){var i=Tx(e,t);if(!i)return e+"";var o=i[0],m=i[1];return m<0?"0."+new Array(-m).join("0")+o:o.length>m+1?o.slice(0,m+1)+"."+o.slice(m+1):o+new Array(m-o.length+2).join("0")}const GM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:jB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$M(e*100,t),r:$M,s:UB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ZM(e){return e}var HM=Array.prototype.map,WM=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function VB(e){var t=e.grouping===void 0||e.thousands===void 0?ZM:LB(HM.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",m=e.decimal===void 0?".":e.decimal+"",y=e.numerals===void 0?ZM:NB(HM.call(e.numerals,String)),_=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",M=e.nan===void 0?"NaN":e.nan+"";function C(k,F){k=Fv(k);var G=k.fill,K=k.align,W=k.sign,q=k.symbol,ue=k.zero,me=k.width,ge=k.comma,be=k.precision,ze=k.trim,Ae=k.type;Ae==="n"?(ge=!0,Ae="g"):GM[Ae]||(be===void 0&&(be=12),ze=!0,Ae="g"),(ue||G==="0"&&K==="=")&&(ue=!0,G="0",K="=");var Oe=(F&&F.prefix!==void 0?F.prefix:"")+(q==="$"?i:q==="#"&&/[boxX]/.test(Ae)?"0"+Ae.toLowerCase():""),rt=(q==="$"?o:/[%p]/.test(Ae)?_:"")+(F&&F.suffix!==void 0?F.suffix:""),gt=GM[Ae],yt=/[defgprs%]/.test(Ae);be=be===void 0?6:/[gprs]/.test(Ae)?Math.max(1,Math.min(21,be)):Math.max(0,Math.min(20,be));function tt(Ge){var Rt=Oe,zt=rt,kt,Ue,at;if(Ae==="c")zt=gt(Ge)+zt,Ge="";else{Ge=+Ge;var pt=Ge<0||1/Ge<0;if(Ge=isNaN(Ge)?M:gt(Math.abs(Ge),be),ze&&(Ge=FB(Ge)),pt&&+Ge==0&&W!=="+"&&(pt=!1),Rt=(pt?W==="("?W:c:W==="-"||W==="("?"":W)+Rt,zt=(Ae==="s"&&!isNaN(Ge)&&Ex!==void 0?WM[8+Ex/3]:"")+zt+(pt&&W==="("?")":""),yt){for(kt=-1,Ue=Ge.length;++kt<Ue;)if(at=Ge.charCodeAt(kt),48>at||at>57){zt=(at===46?m+Ge.slice(kt+1):Ge.slice(kt))+zt,Ge=Ge.slice(0,kt);break}}}ge&&!ue&&(Ge=t(Ge,1/0));var bt=Rt.length+Ge.length+zt.length,Ut=bt<me?new Array(me-bt+1).join(G):"";switch(ge&&ue&&(Ge=t(Ut+Ge,Ut.length?me-zt.length:1/0),Ut=""),K){case"<":Ge=Rt+Ge+zt+Ut;break;case"=":Ge=Rt+Ut+Ge+zt;break;case"^":Ge=Ut.slice(0,bt=Ut.length>>1)+Rt+Ge+zt+Ut.slice(bt);break;default:Ge=Ut+Rt+Ge+zt;break}return y(Ge)}return tt.toString=function(){return k+""},tt}function D(k,F){var G=Math.max(-8,Math.min(8,Math.floor(Ug(F)/3)))*3,K=Math.pow(10,-G),W=C((k=Fv(k),k.type="f",k),{suffix:WM[8+G/3]});return function(q){return W(K*q)}}return{format:C,formatPrefix:D}}var k0,TS,tI;qB({thousands:",",grouping:[3],currency:["$",""]});function qB(e){return k0=VB(e),TS=k0.format,tI=k0.formatPrefix,k0}function $B(e){return Math.max(0,-Ug(Math.abs(e)))}function GB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ug(t)/3)))*3-Ug(Math.abs(e)))}function ZB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ug(t)-Ug(e))+1}function rI(e,t,i,o){var m=w2(e,t,i),y;switch(o=Fv(o??",f"),o.type){case"s":{var _=Math.max(Math.abs(e),Math.abs(t));return o.precision==null&&!isNaN(y=GB(m,_))&&(o.precision=y),tI(o,_)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(y=ZB(m,Math.max(Math.abs(e),Math.abs(t))))&&(o.precision=y-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(y=$B(m))&&(o.precision=y-(o.type==="%")*2);break}}return TS(o)}function $d(e){var t=e.domain;return e.ticks=function(i){var o=t();return x2(o[0],o[o.length-1],i??10)},e.tickFormat=function(i,o){var m=t();return rI(m[0],m[m.length-1],i??10,o)},e.nice=function(i){i==null&&(i=10);var o=t(),m=0,y=o.length-1,_=o[m],c=o[y],M,C,D=10;for(c<_&&(C=_,_=c,c=C,C=m,m=y,y=C);D-- >0;){if(C=b2(_,c,i),C===M)return o[m]=_,o[y]=c,t(o);if(C>0)_=Math.floor(_/C)*C,c=Math.ceil(c/C)*C;else if(C<0)_=Math.ceil(_*C)/C,c=Math.floor(c*C)/C;else break;M=C}return e},e}function nI(){var e=wS();return e.copy=function(){return n_(e,nI())},fu.apply(e,arguments),$d(e)}function iI(e){var t;function i(o){return o==null||isNaN(o=+o)?t:o}return i.invert=i,i.domain=i.range=function(o){return arguments.length?(e=Array.from(o,Sx),i):e.slice()},i.unknown=function(o){return arguments.length?(t=o,i):t},i.copy=function(){return iI(e).unknown(t)},e=arguments.length?Array.from(e,Sx):[0,1],$d(i)}function aI(e,t){e=e.slice();var i=0,o=e.length-1,m=e[i],y=e[o],_;return y<m&&(_=i,i=o,o=_,_=m,m=y,y=_),e[i]=t.floor(m),e[o]=t.ceil(y),e}function YM(e){return Math.log(e)}function XM(e){return Math.exp(e)}function HB(e){return-Math.log(-e)}function WB(e){return-Math.exp(-e)}function YB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function XB(e){return e===10?YB:e===Math.E?Math.exp:t=>Math.pow(e,t)}function KB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function KM(e){return(t,i)=>-e(-t,i)}function ES(e){const t=e(YM,XM),i=t.domain;let o=10,m,y;function _(){return m=KB(o),y=XB(o),i()[0]<0?(m=KM(m),y=KM(y),e(HB,WB)):e(YM,XM),t}return t.base=function(c){return arguments.length?(o=+c,_()):o},t.domain=function(c){return arguments.length?(i(c),_()):i()},t.ticks=c=>{const M=i();let C=M[0],D=M[M.length-1];const k=D<C;k&&([C,D]=[D,C]);let F=m(C),G=m(D),K,W;const q=c==null?10:+c;let ue=[];if(!(o%1)&&G-F<q){if(F=Math.floor(F),G=Math.ceil(G),C>0){for(;F<=G;++F)for(K=1;K<o;++K)if(W=F<0?K/y(-F):K*y(F),!(W<C)){if(W>D)break;ue.push(W)}}else for(;F<=G;++F)for(K=o-1;K>=1;--K)if(W=F>0?K/y(-F):K*y(F),!(W<C)){if(W>D)break;ue.push(W)}ue.length*2<q&&(ue=x2(C,D,q))}else ue=x2(F,G,Math.min(G-F,q)).map(y);return k?ue.reverse():ue},t.tickFormat=(c,M)=>{if(c==null&&(c=10),M==null&&(M=o===10?"s":","),typeof M!="function"&&(!(o%1)&&(M=Fv(M)).precision==null&&(M.trim=!0),M=TS(M)),c===1/0)return M;const C=Math.max(1,o*c/t.ticks().length);return D=>{let k=D/y(Math.round(m(D)));return k*o<o-.5&&(k*=o),k<=C?M(D):""}},t.nice=()=>i(aI(i(),{floor:c=>y(Math.floor(m(c))),ceil:c=>y(Math.ceil(m(c)))})),t}function oI(){const e=ES(db()).domain([1,10]);return e.copy=()=>n_(e,oI()).base(e.base()),fu.apply(e,arguments),e}function QM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function JM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function AS(e){var t=1,i=e(QM(t),JM(t));return i.constant=function(o){return arguments.length?e(QM(t=+o),JM(t)):t},$d(i)}function sI(){var e=AS(db());return e.copy=function(){return n_(e,sI()).constant(e.constant())},fu.apply(e,arguments)}function eP(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function QB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function JB(e){return e<0?-e*e:e*e}function MS(e){var t=e(vs,vs),i=1;function o(){return i===1?e(vs,vs):i===.5?e(QB,JB):e(eP(i),eP(1/i))}return t.exponent=function(m){return arguments.length?(i=+m,o()):i},$d(t)}function PS(){var e=MS(db());return e.copy=function(){return n_(e,PS()).exponent(e.exponent())},fu.apply(e,arguments),e}function e6(){return PS.apply(null,arguments).exponent(.5)}function tP(e){return Math.sign(e)*e*e}function t6(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function lI(){var e=wS(),t=[0,1],i=!1,o;function m(y){var _=t6(e(y));return isNaN(_)?o:i?Math.round(_):_}return m.invert=function(y){return e.invert(tP(y))},m.domain=function(y){return arguments.length?(e.domain(y),m):e.domain()},m.range=function(y){return arguments.length?(e.range((t=Array.from(y,Sx)).map(tP)),m):t.slice()},m.rangeRound=function(y){return m.range(y).round(!0)},m.round=function(y){return arguments.length?(i=!!y,m):i},m.clamp=function(y){return arguments.length?(e.clamp(y),m):e.clamp()},m.unknown=function(y){return arguments.length?(o=y,m):o},m.copy=function(){return lI(e.domain(),t).round(i).clamp(e.clamp()).unknown(o)},fu.apply(m,arguments),$d(m)}function uI(){var e=[],t=[],i=[],o;function m(){var _=0,c=Math.max(1,t.length);for(i=new Array(c-1);++_<c;)i[_-1]=aB(e,_/c);return y}function y(_){return _==null||isNaN(_=+_)?o:t[t_(i,_)]}return y.invertExtent=function(_){var c=t.indexOf(_);return c<0?[NaN,NaN]:[c>0?i[c-1]:e[0],c<i.length?i[c]:e[e.length-1]]},y.domain=function(_){if(!arguments.length)return e.slice();e=[];for(let c of _)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(Bd),m()},y.range=function(_){return arguments.length?(t=Array.from(_),m()):t.slice()},y.unknown=function(_){return arguments.length?(o=_,y):o},y.quantiles=function(){return i.slice()},y.copy=function(){return uI().domain(e).range(t).unknown(o)},fu.apply(y,arguments)}function cI(){var e=0,t=1,i=1,o=[.5],m=[0,1],y;function _(M){return M!=null&&M<=M?m[t_(o,M,0,i)]:y}function c(){var M=-1;for(o=new Array(i);++M<i;)o[M]=((M+1)*t-(M-i)*e)/(i+1);return _}return _.domain=function(M){return arguments.length?([e,t]=M,e=+e,t=+t,c()):[e,t]},_.range=function(M){return arguments.length?(i=(m=Array.from(M)).length-1,c()):m.slice()},_.invertExtent=function(M){var C=m.indexOf(M);return C<0?[NaN,NaN]:C<1?[e,o[0]]:C>=i?[o[i-1],t]:[o[C-1],o[C]]},_.unknown=function(M){return arguments.length&&(y=M),_},_.thresholds=function(){return o.slice()},_.copy=function(){return cI().domain([e,t]).range(m).unknown(y)},fu.apply($d(_),arguments)}function hI(){var e=[.5],t=[0,1],i,o=1;function m(y){return y!=null&&y<=y?t[t_(e,y,0,o)]:i}return m.domain=function(y){return arguments.length?(e=Array.from(y),o=Math.min(e.length,t.length-1),m):e.slice()},m.range=function(y){return arguments.length?(t=Array.from(y),o=Math.min(e.length,t.length-1),m):t.slice()},m.invertExtent=function(y){var _=t.indexOf(y);return[e[_-1],e[_]]},m.unknown=function(y){return arguments.length?(i=y,m):i},m.copy=function(){return hI().domain(e).range(t).unknown(i)},fu.apply(m,arguments)}const vw=new Date,_w=new Date;function Oa(e,t,i,o){function m(y){return e(y=arguments.length===0?new Date:new Date(+y)),y}return m.floor=y=>(e(y=new Date(+y)),y),m.ceil=y=>(e(y=new Date(y-1)),t(y,1),e(y),y),m.round=y=>{const _=m(y),c=m.ceil(y);return y-_<c-y?_:c},m.offset=(y,_)=>(t(y=new Date(+y),_==null?1:Math.floor(_)),y),m.range=(y,_,c)=>{const M=[];if(y=m.ceil(y),c=c==null?1:Math.floor(c),!(y<_)||!(c>0))return M;let C;do M.push(C=new Date(+y)),t(y,c),e(y);while(C<y&&y<_);return M},m.filter=y=>Oa(_=>{if(_>=_)for(;e(_),!y(_);)_.setTime(_-1)},(_,c)=>{if(_>=_)if(c<0)for(;++c<=0;)for(;t(_,-1),!y(_););else for(;--c>=0;)for(;t(_,1),!y(_););}),i&&(m.count=(y,_)=>(vw.setTime(+y),_w.setTime(+_),e(vw),e(_w),Math.floor(i(vw,_w))),m.every=y=>(y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?m.filter(o?_=>o(_)%y===0:_=>m.count(0,_)%y===0):m)),m}const Ax=Oa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ax.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Oa(t=>{t.setTime(Math.floor(t/e)*e)},(t,i)=>{t.setTime(+t+i*e)},(t,i)=>(i-t)/e):Ax);Ax.range;const lf=1e3,uu=lf*60,uf=uu*60,df=uf*24,CS=df*7,rP=df*30,xw=df*365,$p=Oa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*lf)},(e,t)=>(t-e)/lf,e=>e.getUTCSeconds());$p.range;const DS=Oa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*lf)},(e,t)=>{e.setTime(+e+t*uu)},(e,t)=>(t-e)/uu,e=>e.getMinutes());DS.range;const OS=Oa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*uu)},(e,t)=>(t-e)/uu,e=>e.getUTCMinutes());OS.range;const IS=Oa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*lf-e.getMinutes()*uu)},(e,t)=>{e.setTime(+e+t*uf)},(e,t)=>(t-e)/uf,e=>e.getHours());IS.range;const zS=Oa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*uf)},(e,t)=>(t-e)/uf,e=>e.getUTCHours());zS.range;const i_=Oa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uu)/df,e=>e.getDate()-1);i_.range;const pb=Oa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/df,e=>e.getUTCDate()-1);pb.range;const fI=Oa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/df,e=>Math.floor(e/df));fI.range;function sm(e){return Oa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,i)=>{t.setDate(t.getDate()+i*7)},(t,i)=>(i-t-(i.getTimezoneOffset()-t.getTimezoneOffset())*uu)/CS)}const mb=sm(0),Mx=sm(1),r6=sm(2),n6=sm(3),Vg=sm(4),i6=sm(5),a6=sm(6);mb.range;Mx.range;r6.range;n6.range;Vg.range;i6.range;a6.range;function lm(e){return Oa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCDate(t.getUTCDate()+i*7)},(t,i)=>(i-t)/CS)}const gb=lm(0),Px=lm(1),o6=lm(2),s6=lm(3),qg=lm(4),l6=lm(5),u6=lm(6);gb.range;Px.range;o6.range;s6.range;qg.range;l6.range;u6.range;const kS=Oa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kS.range;const RS=Oa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());RS.range;const pf=Oa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());pf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Oa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,i)=>{t.setFullYear(t.getFullYear()+i*e)});pf.range;const mf=Oa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());mf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Oa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCFullYear(t.getUTCFullYear()+i*e)});mf.range;function dI(e,t,i,o,m,y){const _=[[$p,1,lf],[$p,5,5*lf],[$p,15,15*lf],[$p,30,30*lf],[y,1,uu],[y,5,5*uu],[y,15,15*uu],[y,30,30*uu],[m,1,uf],[m,3,3*uf],[m,6,6*uf],[m,12,12*uf],[o,1,df],[o,2,2*df],[i,1,CS],[t,1,rP],[t,3,3*rP],[e,1,xw]];function c(C,D,k){const F=D<C;F&&([C,D]=[D,C]);const G=k&&typeof k.range=="function"?k:M(C,D,k),K=G?G.range(C,+D+1):[];return F?K.reverse():K}function M(C,D,k){const F=Math.abs(D-C)/k,G=gS(([,,q])=>q).right(_,F);if(G===_.length)return e.every(w2(C/xw,D/xw,k));if(G===0)return Ax.every(Math.max(w2(C,D,k),1));const[K,W]=_[F/_[G-1][2]<_[G][2]/F?G-1:G];return K.every(W)}return[c,M]}const[c6,h6]=dI(mf,RS,gb,fI,zS,OS),[f6,d6]=dI(pf,kS,mb,i_,IS,DS);function bw(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ww(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function pv(e,t,i){return{y:e,m:t,d:i,H:0,M:0,S:0,L:0}}function p6(e){var t=e.dateTime,i=e.date,o=e.time,m=e.periods,y=e.days,_=e.shortDays,c=e.months,M=e.shortMonths,C=mv(m),D=gv(m),k=mv(y),F=gv(y),G=mv(_),K=gv(_),W=mv(c),q=gv(c),ue=mv(M),me=gv(M),ge={a:at,A:pt,b:bt,B:Ut,c:null,d:lP,e:lP,f:L6,g:H6,G:Y6,H:k6,I:R6,j:j6,L:pI,m:N6,M:B6,p:Ce,q:nt,Q:hP,s:fP,S:F6,u:U6,U:V6,V:q6,w:$6,W:G6,x:null,X:null,y:Z6,Y:W6,Z:X6,"%":cP},be={a:Be,A:lt,b:Ft,B:Lt,c:null,d:uP,e:uP,f:eF,g:cF,G:fF,H:K6,I:Q6,j:J6,L:gI,m:tF,M:rF,p:Vt,q:yr,Q:hP,s:fP,S:nF,u:iF,U:aF,V:oF,w:sF,W:lF,x:null,X:null,y:uF,Y:hF,Z:dF,"%":cP},ze={a:yt,A:tt,b:Ge,B:Rt,c:zt,d:oP,e:oP,f:D6,g:aP,G:iP,H:sP,I:sP,j:A6,L:C6,m:E6,M:M6,p:gt,q:T6,Q:I6,s:z6,S:P6,u:_6,U:x6,V:b6,w:v6,W:w6,x:kt,X:Ue,y:aP,Y:iP,Z:S6,"%":O6};ge.x=Ae(i,ge),ge.X=Ae(o,ge),ge.c=Ae(t,ge),be.x=Ae(i,be),be.X=Ae(o,be),be.c=Ae(t,be);function Ae(ft,tr){return function(pr){var Tt=[],gn=-1,fr=0,Sr=ft.length,rn,Tr,za;for(pr instanceof Date||(pr=new Date(+pr));++gn<Sr;)ft.charCodeAt(gn)===37&&(Tt.push(ft.slice(fr,gn)),(Tr=nP[rn=ft.charAt(++gn)])!=null?rn=ft.charAt(++gn):Tr=rn==="e"?" ":"0",(za=tr[rn])&&(rn=za(pr,Tr)),Tt.push(rn),fr=gn+1);return Tt.push(ft.slice(fr,gn)),Tt.join("")}}function Oe(ft,tr){return function(pr){var Tt=pv(1900,void 0,1),gn=rt(Tt,ft,pr+="",0),fr,Sr;if(gn!=pr.length)return null;if("Q"in Tt)return new Date(Tt.Q);if("s"in Tt)return new Date(Tt.s*1e3+("L"in Tt?Tt.L:0));if(tr&&!("Z"in Tt)&&(Tt.Z=0),"p"in Tt&&(Tt.H=Tt.H%12+Tt.p*12),Tt.m===void 0&&(Tt.m="q"in Tt?Tt.q:0),"V"in Tt){if(Tt.V<1||Tt.V>53)return null;"w"in Tt||(Tt.w=1),"Z"in Tt?(fr=ww(pv(Tt.y,0,1)),Sr=fr.getUTCDay(),fr=Sr>4||Sr===0?Px.ceil(fr):Px(fr),fr=pb.offset(fr,(Tt.V-1)*7),Tt.y=fr.getUTCFullYear(),Tt.m=fr.getUTCMonth(),Tt.d=fr.getUTCDate()+(Tt.w+6)%7):(fr=bw(pv(Tt.y,0,1)),Sr=fr.getDay(),fr=Sr>4||Sr===0?Mx.ceil(fr):Mx(fr),fr=i_.offset(fr,(Tt.V-1)*7),Tt.y=fr.getFullYear(),Tt.m=fr.getMonth(),Tt.d=fr.getDate()+(Tt.w+6)%7)}else("W"in Tt||"U"in Tt)&&("w"in Tt||(Tt.w="u"in Tt?Tt.u%7:"W"in Tt?1:0),Sr="Z"in Tt?ww(pv(Tt.y,0,1)).getUTCDay():bw(pv(Tt.y,0,1)).getDay(),Tt.m=0,Tt.d="W"in Tt?(Tt.w+6)%7+Tt.W*7-(Sr+5)%7:Tt.w+Tt.U*7-(Sr+6)%7);return"Z"in Tt?(Tt.H+=Tt.Z/100|0,Tt.M+=Tt.Z%100,ww(Tt)):bw(Tt)}}function rt(ft,tr,pr,Tt){for(var gn=0,fr=tr.length,Sr=pr.length,rn,Tr;gn<fr;){if(Tt>=Sr)return-1;if(rn=tr.charCodeAt(gn++),rn===37){if(rn=tr.charAt(gn++),Tr=ze[rn in nP?tr.charAt(gn++):rn],!Tr||(Tt=Tr(ft,pr,Tt))<0)return-1}else if(rn!=pr.charCodeAt(Tt++))return-1}return Tt}function gt(ft,tr,pr){var Tt=C.exec(tr.slice(pr));return Tt?(ft.p=D.get(Tt[0].toLowerCase()),pr+Tt[0].length):-1}function yt(ft,tr,pr){var Tt=G.exec(tr.slice(pr));return Tt?(ft.w=K.get(Tt[0].toLowerCase()),pr+Tt[0].length):-1}function tt(ft,tr,pr){var Tt=k.exec(tr.slice(pr));return Tt?(ft.w=F.get(Tt[0].toLowerCase()),pr+Tt[0].length):-1}function Ge(ft,tr,pr){var Tt=ue.exec(tr.slice(pr));return Tt?(ft.m=me.get(Tt[0].toLowerCase()),pr+Tt[0].length):-1}function Rt(ft,tr,pr){var Tt=W.exec(tr.slice(pr));return Tt?(ft.m=q.get(Tt[0].toLowerCase()),pr+Tt[0].length):-1}function zt(ft,tr,pr){return rt(ft,t,tr,pr)}function kt(ft,tr,pr){return rt(ft,i,tr,pr)}function Ue(ft,tr,pr){return rt(ft,o,tr,pr)}function at(ft){return _[ft.getDay()]}function pt(ft){return y[ft.getDay()]}function bt(ft){return M[ft.getMonth()]}function Ut(ft){return c[ft.getMonth()]}function Ce(ft){return m[+(ft.getHours()>=12)]}function nt(ft){return 1+~~(ft.getMonth()/3)}function Be(ft){return _[ft.getUTCDay()]}function lt(ft){return y[ft.getUTCDay()]}function Ft(ft){return M[ft.getUTCMonth()]}function Lt(ft){return c[ft.getUTCMonth()]}function Vt(ft){return m[+(ft.getUTCHours()>=12)]}function yr(ft){return 1+~~(ft.getUTCMonth()/3)}return{format:function(ft){var tr=Ae(ft+="",ge);return tr.toString=function(){return ft},tr},parse:function(ft){var tr=Oe(ft+="",!1);return tr.toString=function(){return ft},tr},utcFormat:function(ft){var tr=Ae(ft+="",be);return tr.toString=function(){return ft},tr},utcParse:function(ft){var tr=Oe(ft+="",!0);return tr.toString=function(){return ft},tr}}}var nP={"-":"",_:" ",0:"0"},oo=/^\s*\d+/,m6=/^%/,g6=/[\\^$*+?|[\]().{}]/g;function _n(e,t,i){var o=e<0?"-":"",m=(o?-e:e)+"",y=m.length;return o+(y<i?new Array(i-y+1).join(t)+m:m)}function y6(e){return e.replace(g6,"\\$&")}function mv(e){return new RegExp("^(?:"+e.map(y6).join("|")+")","i")}function gv(e){return new Map(e.map((t,i)=>[t.toLowerCase(),i]))}function v6(e,t,i){var o=oo.exec(t.slice(i,i+1));return o?(e.w=+o[0],i+o[0].length):-1}function _6(e,t,i){var o=oo.exec(t.slice(i,i+1));return o?(e.u=+o[0],i+o[0].length):-1}function x6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.U=+o[0],i+o[0].length):-1}function b6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.V=+o[0],i+o[0].length):-1}function w6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.W=+o[0],i+o[0].length):-1}function iP(e,t,i){var o=oo.exec(t.slice(i,i+4));return o?(e.y=+o[0],i+o[0].length):-1}function aP(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),i+o[0].length):-1}function S6(e,t,i){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),i+o[0].length):-1}function T6(e,t,i){var o=oo.exec(t.slice(i,i+1));return o?(e.q=o[0]*3-3,i+o[0].length):-1}function E6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.m=o[0]-1,i+o[0].length):-1}function oP(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.d=+o[0],i+o[0].length):-1}function A6(e,t,i){var o=oo.exec(t.slice(i,i+3));return o?(e.m=0,e.d=+o[0],i+o[0].length):-1}function sP(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.H=+o[0],i+o[0].length):-1}function M6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.M=+o[0],i+o[0].length):-1}function P6(e,t,i){var o=oo.exec(t.slice(i,i+2));return o?(e.S=+o[0],i+o[0].length):-1}function C6(e,t,i){var o=oo.exec(t.slice(i,i+3));return o?(e.L=+o[0],i+o[0].length):-1}function D6(e,t,i){var o=oo.exec(t.slice(i,i+6));return o?(e.L=Math.floor(o[0]/1e3),i+o[0].length):-1}function O6(e,t,i){var o=m6.exec(t.slice(i,i+1));return o?i+o[0].length:-1}function I6(e,t,i){var o=oo.exec(t.slice(i));return o?(e.Q=+o[0],i+o[0].length):-1}function z6(e,t,i){var o=oo.exec(t.slice(i));return o?(e.s=+o[0],i+o[0].length):-1}function lP(e,t){return _n(e.getDate(),t,2)}function k6(e,t){return _n(e.getHours(),t,2)}function R6(e,t){return _n(e.getHours()%12||12,t,2)}function j6(e,t){return _n(1+i_.count(pf(e),e),t,3)}function pI(e,t){return _n(e.getMilliseconds(),t,3)}function L6(e,t){return pI(e,t)+"000"}function N6(e,t){return _n(e.getMonth()+1,t,2)}function B6(e,t){return _n(e.getMinutes(),t,2)}function F6(e,t){return _n(e.getSeconds(),t,2)}function U6(e){var t=e.getDay();return t===0?7:t}function V6(e,t){return _n(mb.count(pf(e)-1,e),t,2)}function mI(e){var t=e.getDay();return t>=4||t===0?Vg(e):Vg.ceil(e)}function q6(e,t){return e=mI(e),_n(Vg.count(pf(e),e)+(pf(e).getDay()===4),t,2)}function $6(e){return e.getDay()}function G6(e,t){return _n(Mx.count(pf(e)-1,e),t,2)}function Z6(e,t){return _n(e.getFullYear()%100,t,2)}function H6(e,t){return e=mI(e),_n(e.getFullYear()%100,t,2)}function W6(e,t){return _n(e.getFullYear()%1e4,t,4)}function Y6(e,t){var i=e.getDay();return e=i>=4||i===0?Vg(e):Vg.ceil(e),_n(e.getFullYear()%1e4,t,4)}function X6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function uP(e,t){return _n(e.getUTCDate(),t,2)}function K6(e,t){return _n(e.getUTCHours(),t,2)}function Q6(e,t){return _n(e.getUTCHours()%12||12,t,2)}function J6(e,t){return _n(1+pb.count(mf(e),e),t,3)}function gI(e,t){return _n(e.getUTCMilliseconds(),t,3)}function eF(e,t){return gI(e,t)+"000"}function tF(e,t){return _n(e.getUTCMonth()+1,t,2)}function rF(e,t){return _n(e.getUTCMinutes(),t,2)}function nF(e,t){return _n(e.getUTCSeconds(),t,2)}function iF(e){var t=e.getUTCDay();return t===0?7:t}function aF(e,t){return _n(gb.count(mf(e)-1,e),t,2)}function yI(e){var t=e.getUTCDay();return t>=4||t===0?qg(e):qg.ceil(e)}function oF(e,t){return e=yI(e),_n(qg.count(mf(e),e)+(mf(e).getUTCDay()===4),t,2)}function sF(e){return e.getUTCDay()}function lF(e,t){return _n(Px.count(mf(e)-1,e),t,2)}function uF(e,t){return _n(e.getUTCFullYear()%100,t,2)}function cF(e,t){return e=yI(e),_n(e.getUTCFullYear()%100,t,2)}function hF(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function fF(e,t){var i=e.getUTCDay();return e=i>=4||i===0?qg(e):qg.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function dF(){return"+0000"}function cP(){return"%"}function hP(e){return+e}function fP(e){return Math.floor(+e/1e3)}var Tg,vI,_I;pF({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function pF(e){return Tg=p6(e),vI=Tg.format,Tg.parse,_I=Tg.utcFormat,Tg.utcParse,Tg}function mF(e){return new Date(e)}function gF(e){return e instanceof Date?+e:+new Date(+e)}function jS(e,t,i,o,m,y,_,c,M,C){var D=wS(),k=D.invert,F=D.domain,G=C(".%L"),K=C(":%S"),W=C("%I:%M"),q=C("%I %p"),ue=C("%a %d"),me=C("%b %d"),ge=C("%B"),be=C("%Y");function ze(Ae){return(M(Ae)<Ae?G:c(Ae)<Ae?K:_(Ae)<Ae?W:y(Ae)<Ae?q:o(Ae)<Ae?m(Ae)<Ae?ue:me:i(Ae)<Ae?ge:be)(Ae)}return D.invert=function(Ae){return new Date(k(Ae))},D.domain=function(Ae){return arguments.length?F(Array.from(Ae,gF)):F().map(mF)},D.ticks=function(Ae){var Oe=F();return e(Oe[0],Oe[Oe.length-1],Ae??10)},D.tickFormat=function(Ae,Oe){return Oe==null?ze:C(Oe)},D.nice=function(Ae){var Oe=F();return(!Ae||typeof Ae.range!="function")&&(Ae=t(Oe[0],Oe[Oe.length-1],Ae??10)),Ae?F(aI(Oe,Ae)):D},D.copy=function(){return n_(D,jS(e,t,i,o,m,y,_,c,M,C))},D}function yF(){return fu.apply(jS(f6,d6,pf,kS,mb,i_,IS,DS,$p,vI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vF(){return fu.apply(jS(c6,h6,mf,RS,gb,pb,zS,OS,$p,_I).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yb(){var e=0,t=1,i,o,m,y,_=vs,c=!1,M;function C(k){return k==null||isNaN(k=+k)?M:_(m===0?.5:(k=(y(k)-i)*m,c?Math.max(0,Math.min(1,k)):k))}C.domain=function(k){return arguments.length?([e,t]=k,i=y(e=+e),o=y(t=+t),m=i===o?0:1/(o-i),C):[e,t]},C.clamp=function(k){return arguments.length?(c=!!k,C):c},C.interpolator=function(k){return arguments.length?(_=k,C):_};function D(k){return function(F){var G,K;return arguments.length?([G,K]=F,_=k(G,K),C):[_(0),_(1)]}}return C.range=D(Zg),C.rangeRound=D(bS),C.unknown=function(k){return arguments.length?(M=k,C):M},function(k){return y=k,i=k(e),o=k(t),m=i===o?0:1/(o-i),C}}function Gd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function xI(){var e=$d(yb()(vs));return e.copy=function(){return Gd(e,xI())},bf.apply(e,arguments)}function bI(){var e=ES(yb()).domain([1,10]);return e.copy=function(){return Gd(e,bI()).base(e.base())},bf.apply(e,arguments)}function wI(){var e=AS(yb());return e.copy=function(){return Gd(e,wI()).constant(e.constant())},bf.apply(e,arguments)}function LS(){var e=MS(yb());return e.copy=function(){return Gd(e,LS()).exponent(e.exponent())},bf.apply(e,arguments)}function _F(){return LS.apply(null,arguments).exponent(.5)}function SI(){var e=[],t=vs;function i(o){if(o!=null&&!isNaN(o=+o))return t((t_(e,o,1)-1)/(e.length-1))}return i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let m of o)m!=null&&!isNaN(m=+m)&&e.push(m);return e.sort(Bd),i},i.interpolator=function(o){return arguments.length?(t=o,i):t},i.range=function(){return e.map((o,m)=>t(m/(e.length-1)))},i.quantiles=function(o){return Array.from({length:o+1},(m,y)=>iB(e,y/o))},i.copy=function(){return SI(t).domain(e)},bf.apply(i,arguments)}function vb(){var e=0,t=.5,i=1,o=1,m,y,_,c,M,C=vs,D,k=!1,F;function G(W){return isNaN(W=+W)?F:(W=.5+((W=+D(W))-y)*(o*W<o*y?c:M),C(k?Math.max(0,Math.min(1,W)):W))}G.domain=function(W){return arguments.length?([e,t,i]=W,m=D(e=+e),y=D(t=+t),_=D(i=+i),c=m===y?0:.5/(y-m),M=y===_?0:.5/(_-y),o=y<m?-1:1,G):[e,t,i]},G.clamp=function(W){return arguments.length?(k=!!W,G):k},G.interpolator=function(W){return arguments.length?(C=W,G):C};function K(W){return function(q){var ue,me,ge;return arguments.length?([ue,me,ge]=q,C=OB(W,[ue,me,ge]),G):[C(0),C(.5),C(1)]}}return G.range=K(Zg),G.rangeRound=K(bS),G.unknown=function(W){return arguments.length?(F=W,G):F},function(W){return D=W,m=W(e),y=W(t),_=W(i),c=m===y?0:.5/(y-m),M=y===_?0:.5/(_-y),o=y<m?-1:1,G}}function TI(){var e=$d(vb()(vs));return e.copy=function(){return Gd(e,TI())},bf.apply(e,arguments)}function EI(){var e=ES(vb()).domain([.1,1,10]);return e.copy=function(){return Gd(e,EI()).base(e.base())},bf.apply(e,arguments)}function AI(){var e=AS(vb());return e.copy=function(){return Gd(e,AI()).constant(e.constant())},bf.apply(e,arguments)}function NS(){var e=MS(vb());return e.copy=function(){return Gd(e,NS()).exponent(e.exponent())},bf.apply(e,arguments)}function xF(){return NS.apply(null,arguments).exponent(.5)}const bv=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:vS,scaleDiverging:TI,scaleDivergingLog:EI,scaleDivergingPow:NS,scaleDivergingSqrt:xF,scaleDivergingSymlog:AI,scaleIdentity:iI,scaleImplicit:S2,scaleLinear:nI,scaleLog:oI,scaleOrdinal:yS,scalePoint:sB,scalePow:PS,scaleQuantile:uI,scaleQuantize:cI,scaleRadial:lI,scaleSequential:xI,scaleSequentialLog:bI,scaleSequentialPow:LS,scaleSequentialQuantile:SI,scaleSequentialSqrt:_F,scaleSequentialSymlog:wI,scaleSqrt:e6,scaleSymlog:sI,scaleThreshold:hI,scaleTime:yF,scaleUtc:vF,tickFormat:rI},Symbol.toStringTag,{value:"Module"}));var wf=e=>e.chartData,MI=st([wf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),BS=(e,t,i,o)=>o?MI(e):wf(e),PI=(e,t,i)=>i?MI(e):wf(e);function gf(e){if(Array.isArray(e)&&e.length===2){var[t,i]=e;if($r(t)&&$r(i))return!0}return!1}function dP(e,t,i){return i?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function CI(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[i,o]=e,m,y;if($r(i))m=i;else if(typeof i=="function")return;if($r(o))y=o;else if(typeof o=="function")return;var _=[m,y];if(gf(_))return _}}function bF(e,t,i){if(!(!i&&t==null)){if(typeof e=="function"&&t!=null)try{var o=e(t,i);if(gf(o))return dP(o,t,i)}catch{}if(Array.isArray(e)&&e.length===2){var[m,y]=e,_,c;if(m==="auto")t!=null&&(_=Math.min(...t));else if(Jt(m))_=m;else if(typeof m=="function")try{t!=null&&(_=m(t?.[0]))}catch{}else if(typeof m=="string"&&EA.test(m)){var M=EA.exec(m);if(M==null||M[1]==null||t==null)_=void 0;else{var C=+M[1];_=t[0]-C}}else _=t?.[0];if(y==="auto")t!=null&&(c=Math.max(...t));else if(Jt(y))c=y;else if(typeof y=="function")try{t!=null&&(c=y(t?.[1]))}catch{}else if(typeof y=="string"&&AA.test(y)){var D=AA.exec(y);if(D==null||D[1]==null||t==null)c=void 0;else{var k=+D[1];c=t[1]+k}}else c=t?.[1];var F=[_,c];if(gf(F))return t==null?F:dP(F,t,i)}}}var Hg=1e9,wF={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},US,Ti=!0,hu="[DecimalError] ",Wp=hu+"Invalid argument: ",FS=hu+"Exponent out of range: ",Wg=Math.floor,Up=Math.pow,SF=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,yl,no=1e7,mi=7,DI=9007199254740991,Cx=Wg(DI/mi),ir={};ir.absoluteValue=ir.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ir.comparedTo=ir.cmp=function(e){var t,i,o,m,y=this;if(e=new y.constructor(e),y.s!==e.s)return y.s||-e.s;if(y.e!==e.e)return y.e>e.e^y.s<0?1:-1;for(o=y.d.length,m=e.d.length,t=0,i=o<m?o:m;t<i;++t)if(y.d[t]!==e.d[t])return y.d[t]>e.d[t]^y.s<0?1:-1;return o===m?0:o>m^y.s<0?1:-1};ir.decimalPlaces=ir.dp=function(){var e=this,t=e.d.length-1,i=(t-e.e)*mi;if(t=e.d[t],t)for(;t%10==0;t/=10)i--;return i<0?0:i};ir.dividedBy=ir.div=function(e){return cf(this,new this.constructor(e))};ir.dividedToIntegerBy=ir.idiv=function(e){var t=this,i=t.constructor;return Jn(cf(t,new i(e),0,1),i.precision)};ir.equals=ir.eq=function(e){return!this.cmp(e)};ir.exponent=function(){return da(this)};ir.greaterThan=ir.gt=function(e){return this.cmp(e)>0};ir.greaterThanOrEqualTo=ir.gte=function(e){return this.cmp(e)>=0};ir.isInteger=ir.isint=function(){return this.e>this.d.length-2};ir.isNegative=ir.isneg=function(){return this.s<0};ir.isPositive=ir.ispos=function(){return this.s>0};ir.isZero=function(){return this.s===0};ir.lessThan=ir.lt=function(e){return this.cmp(e)<0};ir.lessThanOrEqualTo=ir.lte=function(e){return this.cmp(e)<1};ir.logarithm=ir.log=function(e){var t,i=this,o=i.constructor,m=o.precision,y=m+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(yl))throw Error(hu+"NaN");if(i.s<1)throw Error(hu+(i.s?"NaN":"-Infinity"));return i.eq(yl)?new o(0):(Ti=!1,t=cf(Uv(i,y),Uv(e,y),y),Ti=!0,Jn(t,m))};ir.minus=ir.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?zI(t,e):OI(t,(e.s=-e.s,e))};ir.modulo=ir.mod=function(e){var t,i=this,o=i.constructor,m=o.precision;if(e=new o(e),!e.s)throw Error(hu+"NaN");return i.s?(Ti=!1,t=cf(i,e,0,1).times(e),Ti=!0,i.minus(t)):Jn(new o(i),m)};ir.naturalExponential=ir.exp=function(){return II(this)};ir.naturalLogarithm=ir.ln=function(){return Uv(this)};ir.negated=ir.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ir.plus=ir.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OI(t,e):zI(t,(e.s=-e.s,e))};ir.precision=ir.sd=function(e){var t,i,o,m=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Wp+e);if(t=da(m)+1,o=m.d.length-1,i=o*mi+1,o=m.d[o],o){for(;o%10==0;o/=10)i--;for(o=m.d[0];o>=10;o/=10)i++}return e&&t>i?t:i};ir.squareRoot=ir.sqrt=function(){var e,t,i,o,m,y,_,c=this,M=c.constructor;if(c.s<1){if(!c.s)return new M(0);throw Error(hu+"NaN")}for(e=da(c),Ti=!1,m=Math.sqrt(+c),m==0||m==1/0?(t=rh(c.d),(t.length+e)%2==0&&(t+="0"),m=Math.sqrt(t),e=Wg((e+1)/2)-(e<0||e%2),m==1/0?t="5e"+e:(t=m.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),o=new M(t)):o=new M(m.toString()),i=M.precision,m=_=i+3;;)if(y=o,o=y.plus(cf(c,y,_+2)).times(.5),rh(y.d).slice(0,_)===(t=rh(o.d)).slice(0,_)){if(t=t.slice(_-3,_+1),m==_&&t=="4999"){if(Jn(y,i+1,0),y.times(y).eq(c)){o=y;break}}else if(t!="9999")break;_+=4}return Ti=!0,Jn(o,i)};ir.times=ir.mul=function(e){var t,i,o,m,y,_,c,M,C,D=this,k=D.constructor,F=D.d,G=(e=new k(e)).d;if(!D.s||!e.s)return new k(0);for(e.s*=D.s,i=D.e+e.e,M=F.length,C=G.length,M<C&&(y=F,F=G,G=y,_=M,M=C,C=_),y=[],_=M+C,o=_;o--;)y.push(0);for(o=C;--o>=0;){for(t=0,m=M+o;m>o;)c=y[m]+G[o]*F[m-o-1]+t,y[m--]=c%no|0,t=c/no|0;y[m]=(y[m]+t)%no|0}for(;!y[--_];)y.pop();return t?++i:y.shift(),e.d=y,e.e=i,Ti?Jn(e,k.precision):e};ir.toDecimalPlaces=ir.todp=function(e,t){var i=this,o=i.constructor;return i=new o(i),e===void 0?i:(oh(e,0,Hg),t===void 0?t=o.rounding:oh(t,0,8),Jn(i,e+da(i)+1,t))};ir.toExponential=function(e,t){var i,o=this,m=o.constructor;return e===void 0?i=im(o,!0):(oh(e,0,Hg),t===void 0?t=m.rounding:oh(t,0,8),o=Jn(new m(o),e+1,t),i=im(o,!0,e+1)),i};ir.toFixed=function(e,t){var i,o,m=this,y=m.constructor;return e===void 0?im(m):(oh(e,0,Hg),t===void 0?t=y.rounding:oh(t,0,8),o=Jn(new y(m),e+da(m)+1,t),i=im(o.abs(),!1,e+da(o)+1),m.isneg()&&!m.isZero()?"-"+i:i)};ir.toInteger=ir.toint=function(){var e=this,t=e.constructor;return Jn(new t(e),da(e)+1,t.rounding)};ir.toNumber=function(){return+this};ir.toPower=ir.pow=function(e){var t,i,o,m,y,_,c=this,M=c.constructor,C=12,D=+(e=new M(e));if(!e.s)return new M(yl);if(c=new M(c),!c.s){if(e.s<1)throw Error(hu+"Infinity");return c}if(c.eq(yl))return c;if(o=M.precision,e.eq(yl))return Jn(c,o);if(t=e.e,i=e.d.length-1,_=t>=i,y=c.s,_){if((i=D<0?-D:D)<=DI){for(m=new M(yl),t=Math.ceil(o/mi+4),Ti=!1;i%2&&(m=m.times(c),mP(m.d,t)),i=Wg(i/2),i!==0;)c=c.times(c),mP(c.d,t);return Ti=!0,e.s<0?new M(yl).div(m):Jn(m,o)}}else if(y<0)throw Error(hu+"NaN");return y=y<0&&e.d[Math.max(t,i)]&1?-1:1,c.s=1,Ti=!1,m=e.times(Uv(c,o+C)),Ti=!0,m=II(m),m.s=y,m};ir.toPrecision=function(e,t){var i,o,m=this,y=m.constructor;return e===void 0?(i=da(m),o=im(m,i<=y.toExpNeg||i>=y.toExpPos)):(oh(e,1,Hg),t===void 0?t=y.rounding:oh(t,0,8),m=Jn(new y(m),e,t),i=da(m),o=im(m,e<=i||i<=y.toExpNeg,e)),o};ir.toSignificantDigits=ir.tosd=function(e,t){var i=this,o=i.constructor;return e===void 0?(e=o.precision,t=o.rounding):(oh(e,1,Hg),t===void 0?t=o.rounding:oh(t,0,8)),Jn(new o(i),e,t)};ir.toString=ir.valueOf=ir.val=ir.toJSON=ir[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=da(e),i=e.constructor;return im(e,t<=i.toExpNeg||t>=i.toExpPos)};function OI(e,t){var i,o,m,y,_,c,M,C,D=e.constructor,k=D.precision;if(!e.s||!t.s)return t.s||(t=new D(e)),Ti?Jn(t,k):t;if(M=e.d,C=t.d,_=e.e,m=t.e,M=M.slice(),y=_-m,y){for(y<0?(o=M,y=-y,c=C.length):(o=C,m=_,c=M.length),_=Math.ceil(k/mi),c=_>c?_+1:c+1,y>c&&(y=c,o.length=1),o.reverse();y--;)o.push(0);o.reverse()}for(c=M.length,y=C.length,c-y<0&&(y=c,o=C,C=M,M=o),i=0;y;)i=(M[--y]=M[y]+C[y]+i)/no|0,M[y]%=no;for(i&&(M.unshift(i),++m),c=M.length;M[--c]==0;)M.pop();return t.d=M,t.e=m,Ti?Jn(t,k):t}function oh(e,t,i){if(e!==~~e||e<t||e>i)throw Error(Wp+e)}function rh(e){var t,i,o,m=e.length-1,y="",_=e[0];if(m>0){for(y+=_,t=1;t<m;t++)o=e[t]+"",i=mi-o.length,i&&(y+=kd(i)),y+=o;_=e[t],o=_+"",i=mi-o.length,i&&(y+=kd(i))}else if(_===0)return"0";for(;_%10===0;)_/=10;return y+_}var cf=(function(){function e(o,m){var y,_=0,c=o.length;for(o=o.slice();c--;)y=o[c]*m+_,o[c]=y%no|0,_=y/no|0;return _&&o.unshift(_),o}function t(o,m,y,_){var c,M;if(y!=_)M=y>_?1:-1;else for(c=M=0;c<y;c++)if(o[c]!=m[c]){M=o[c]>m[c]?1:-1;break}return M}function i(o,m,y){for(var _=0;y--;)o[y]-=_,_=o[y]<m[y]?1:0,o[y]=_*no+o[y]-m[y];for(;!o[0]&&o.length>1;)o.shift()}return function(o,m,y,_){var c,M,C,D,k,F,G,K,W,q,ue,me,ge,be,ze,Ae,Oe,rt,gt=o.constructor,yt=o.s==m.s?1:-1,tt=o.d,Ge=m.d;if(!o.s)return new gt(o);if(!m.s)throw Error(hu+"Division by zero");for(M=o.e-m.e,Oe=Ge.length,ze=tt.length,G=new gt(yt),K=G.d=[],C=0;Ge[C]==(tt[C]||0);)++C;if(Ge[C]>(tt[C]||0)&&--M,y==null?me=y=gt.precision:_?me=y+(da(o)-da(m))+1:me=y,me<0)return new gt(0);if(me=me/mi+2|0,C=0,Oe==1)for(D=0,Ge=Ge[0],me++;(C<ze||D)&&me--;C++)ge=D*no+(tt[C]||0),K[C]=ge/Ge|0,D=ge%Ge|0;else{for(D=no/(Ge[0]+1)|0,D>1&&(Ge=e(Ge,D),tt=e(tt,D),Oe=Ge.length,ze=tt.length),be=Oe,W=tt.slice(0,Oe),q=W.length;q<Oe;)W[q++]=0;rt=Ge.slice(),rt.unshift(0),Ae=Ge[0],Ge[1]>=no/2&&++Ae;do D=0,c=t(Ge,W,Oe,q),c<0?(ue=W[0],Oe!=q&&(ue=ue*no+(W[1]||0)),D=ue/Ae|0,D>1?(D>=no&&(D=no-1),k=e(Ge,D),F=k.length,q=W.length,c=t(k,W,F,q),c==1&&(D--,i(k,Oe<F?rt:Ge,F))):(D==0&&(c=D=1),k=Ge.slice()),F=k.length,F<q&&k.unshift(0),i(W,k,q),c==-1&&(q=W.length,c=t(Ge,W,Oe,q),c<1&&(D++,i(W,Oe<q?rt:Ge,q))),q=W.length):c===0&&(D++,W=[0]),K[C++]=D,c&&W[0]?W[q++]=tt[be]||0:(W=[tt[be]],q=1);while((be++<ze||W[0]!==void 0)&&me--)}return K[0]||K.shift(),G.e=M,Jn(G,_?y+da(G)+1:y)}})();function II(e,t){var i,o,m,y,_,c,M=0,C=0,D=e.constructor,k=D.precision;if(da(e)>16)throw Error(FS+da(e));if(!e.s)return new D(yl);for(Ti=!1,c=k,_=new D(.03125);e.abs().gte(.1);)e=e.times(_),C+=5;for(o=Math.log(Up(2,C))/Math.LN10*2+5|0,c+=o,i=m=y=new D(yl),D.precision=c;;){if(m=Jn(m.times(e),c),i=i.times(++M),_=y.plus(cf(m,i,c)),rh(_.d).slice(0,c)===rh(y.d).slice(0,c)){for(;C--;)y=Jn(y.times(y),c);return D.precision=k,t==null?(Ti=!0,Jn(y,k)):y}y=_}}function da(e){for(var t=e.e*mi,i=e.d[0];i>=10;i/=10)t++;return t}function Sw(e,t,i){if(t>e.LN10.sd())throw Ti=!0,i&&(e.precision=i),Error(hu+"LN10 precision limit exceeded");return Jn(new e(e.LN10),t)}function kd(e){for(var t="";e--;)t+="0";return t}function Uv(e,t){var i,o,m,y,_,c,M,C,D,k=1,F=10,G=e,K=G.d,W=G.constructor,q=W.precision;if(G.s<1)throw Error(hu+(G.s?"NaN":"-Infinity"));if(G.eq(yl))return new W(0);if(t==null?(Ti=!1,C=q):C=t,G.eq(10))return t==null&&(Ti=!0),Sw(W,C);if(C+=F,W.precision=C,i=rh(K),o=i.charAt(0),y=da(G),Math.abs(y)<15e14){for(;o<7&&o!=1||o==1&&i.charAt(1)>3;)G=G.times(e),i=rh(G.d),o=i.charAt(0),k++;y=da(G),o>1?(G=new W("0."+i),y++):G=new W(o+"."+i.slice(1))}else return M=Sw(W,C+2,q).times(y+""),G=Uv(new W(o+"."+i.slice(1)),C-F).plus(M),W.precision=q,t==null?(Ti=!0,Jn(G,q)):G;for(c=_=G=cf(G.minus(yl),G.plus(yl),C),D=Jn(G.times(G),C),m=3;;){if(_=Jn(_.times(D),C),M=c.plus(cf(_,new W(m),C)),rh(M.d).slice(0,C)===rh(c.d).slice(0,C))return c=c.times(2),y!==0&&(c=c.plus(Sw(W,C+2,q).times(y+""))),c=cf(c,new W(k),C),W.precision=q,t==null?(Ti=!0,Jn(c,q)):c;c=M,m+=2}}function pP(e,t){var i,o,m;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(i<0&&(i=o),i+=+t.slice(o+1),t=t.substring(0,o)):i<0&&(i=t.length),o=0;t.charCodeAt(o)===48;)++o;for(m=t.length;t.charCodeAt(m-1)===48;)--m;if(t=t.slice(o,m),t){if(m-=o,i=i-o-1,e.e=Wg(i/mi),e.d=[],o=(i+1)%mi,i<0&&(o+=mi),o<m){for(o&&e.d.push(+t.slice(0,o)),m-=mi;o<m;)e.d.push(+t.slice(o,o+=mi));t=t.slice(o),o=mi-t.length}else o-=m;for(;o--;)t+="0";if(e.d.push(+t),Ti&&(e.e>Cx||e.e<-Cx))throw Error(FS+i)}else e.s=0,e.e=0,e.d=[0];return e}function Jn(e,t,i){var o,m,y,_,c,M,C,D,k=e.d;for(_=1,y=k[0];y>=10;y/=10)_++;if(o=t-_,o<0)o+=mi,m=t,C=k[D=0];else{if(D=Math.ceil((o+1)/mi),y=k.length,D>=y)return e;for(C=y=k[D],_=1;y>=10;y/=10)_++;o%=mi,m=o-mi+_}if(i!==void 0&&(y=Up(10,_-m-1),c=C/y%10|0,M=t<0||k[D+1]!==void 0||C%y,M=i<4?(c||M)&&(i==0||i==(e.s<0?3:2)):c>5||c==5&&(i==4||M||i==6&&(o>0?m>0?C/Up(10,_-m):0:k[D-1])%10&1||i==(e.s<0?8:7))),t<1||!k[0])return M?(y=da(e),k.length=1,t=t-y-1,k[0]=Up(10,(mi-t%mi)%mi),e.e=Wg(-t/mi)||0):(k.length=1,k[0]=e.e=e.s=0),e;if(o==0?(k.length=D,y=1,D--):(k.length=D+1,y=Up(10,mi-o),k[D]=m>0?(C/Up(10,_-m)%Up(10,m)|0)*y:0),M)for(;;)if(D==0){(k[0]+=y)==no&&(k[0]=1,++e.e);break}else{if(k[D]+=y,k[D]!=no)break;k[D--]=0,y=1}for(o=k.length;k[--o]===0;)k.pop();if(Ti&&(e.e>Cx||e.e<-Cx))throw Error(FS+da(e));return e}function zI(e,t){var i,o,m,y,_,c,M,C,D,k,F=e.constructor,G=F.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new F(e),Ti?Jn(t,G):t;if(M=e.d,k=t.d,o=t.e,C=e.e,M=M.slice(),_=C-o,_){for(D=_<0,D?(i=M,_=-_,c=k.length):(i=k,o=C,c=M.length),m=Math.max(Math.ceil(G/mi),c)+2,_>m&&(_=m,i.length=1),i.reverse(),m=_;m--;)i.push(0);i.reverse()}else{for(m=M.length,c=k.length,D=m<c,D&&(c=m),m=0;m<c;m++)if(M[m]!=k[m]){D=M[m]<k[m];break}_=0}for(D&&(i=M,M=k,k=i,t.s=-t.s),c=M.length,m=k.length-c;m>0;--m)M[c++]=0;for(m=k.length;m>_;){if(M[--m]<k[m]){for(y=m;y&&M[--y]===0;)M[y]=no-1;--M[y],M[m]+=no}M[m]-=k[m]}for(;M[--c]===0;)M.pop();for(;M[0]===0;M.shift())--o;return M[0]?(t.d=M,t.e=o,Ti?Jn(t,G):t):new F(0)}function im(e,t,i){var o,m=da(e),y=rh(e.d),_=y.length;return t?(i&&(o=i-_)>0?y=y.charAt(0)+"."+y.slice(1)+kd(o):_>1&&(y=y.charAt(0)+"."+y.slice(1)),y=y+(m<0?"e":"e+")+m):m<0?(y="0."+kd(-m-1)+y,i&&(o=i-_)>0&&(y+=kd(o))):m>=_?(y+=kd(m+1-_),i&&(o=i-m-1)>0&&(y=y+"."+kd(o))):((o=m+1)<_&&(y=y.slice(0,o)+"."+y.slice(o)),i&&(o=i-_)>0&&(m+1===_&&(y+="."),y+=kd(o))),e.s<0?"-"+y:y}function mP(e,t){if(e.length>t)return e.length=t,!0}function kI(e){var t,i,o;function m(y){var _=this;if(!(_ instanceof m))return new m(y);if(_.constructor=m,y instanceof m){_.s=y.s,_.e=y.e,_.d=(y=y.d)?y.slice():y;return}if(typeof y=="number"){if(y*0!==0)throw Error(Wp+y);if(y>0)_.s=1;else if(y<0)y=-y,_.s=-1;else{_.s=0,_.e=0,_.d=[0];return}if(y===~~y&&y<1e7){_.e=0,_.d=[y];return}return pP(_,y.toString())}else if(typeof y!="string")throw Error(Wp+y);if(y.charCodeAt(0)===45?(y=y.slice(1),_.s=-1):_.s=1,SF.test(y))pP(_,y);else throw Error(Wp+y)}if(m.prototype=ir,m.ROUND_UP=0,m.ROUND_DOWN=1,m.ROUND_CEIL=2,m.ROUND_FLOOR=3,m.ROUND_HALF_UP=4,m.ROUND_HALF_DOWN=5,m.ROUND_HALF_EVEN=6,m.ROUND_HALF_CEIL=7,m.ROUND_HALF_FLOOR=8,m.clone=kI,m.config=m.set=TF,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<o.length;)e.hasOwnProperty(i=o[t++])||(e[i]=this[i]);return m.config(e),m}function TF(e){if(!e||typeof e!="object")throw Error(hu+"Object expected");var t,i,o,m=["precision",1,Hg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<m.length;t+=3)if((o=e[i=m[t]])!==void 0)if(Wg(o)===o&&o>=m[t+1]&&o<=m[t+2])this[i]=o;else throw Error(Wp+i+": "+o);if((o=e[i="LN10"])!==void 0)if(o==Math.LN10)this[i]=new this(o);else throw Error(Wp+i+": "+o);return this}var US=kI(wF);yl=new US(1);const Ln=US;function RI(e){var t;return e===0?t=1:t=Math.floor(new Ln(e).abs().log(10).toNumber())+1,t}function jI(e,t,i){for(var o=new Ln(e),m=0,y=[];o.lt(t)&&m<1e5;)y.push(o.toNumber()),o=o.add(i),m++;return y}var LI=e=>{var[t,i]=e,[o,m]=[t,i];return t>i&&([o,m]=[i,t]),[o,m]},NI=(e,t,i)=>{if(e.lte(0))return new Ln(0);var o=RI(e.toNumber()),m=new Ln(10).pow(o),y=e.div(m),_=o!==1?.05:.1,c=new Ln(Math.ceil(y.div(_).toNumber())).add(i).mul(_),M=c.mul(m);return t?new Ln(M.toNumber()):new Ln(Math.ceil(M.toNumber()))},EF=(e,t,i)=>{var o=new Ln(1),m=new Ln(e);if(!m.isint()&&i){var y=Math.abs(e);y<1?(o=new Ln(10).pow(RI(e)-1),m=new Ln(Math.floor(m.div(o).toNumber())).mul(o)):y>1&&(m=new Ln(Math.floor(e)))}else e===0?m=new Ln(Math.floor((t-1)/2)):i||(m=new Ln(Math.floor(e)));for(var _=Math.floor((t-1)/2),c=[],M=0;M<t;M++)c.push(m.add(new Ln(M-_).mul(o)).toNumber());return c},BI=function(t,i,o,m){var y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((i-t)/(o-1)))return{step:new Ln(0),tickMin:new Ln(0),tickMax:new Ln(0)};var _=NI(new Ln(i).sub(t).div(o-1),m,y),c;t<=0&&i>=0?c=new Ln(0):(c=new Ln(t).add(i).div(2),c=c.sub(new Ln(c).mod(_)));var M=Math.ceil(c.sub(t).div(_).toNumber()),C=Math.ceil(new Ln(i).sub(c).div(_).toNumber()),D=M+C+1;return D>o?BI(t,i,o,m,y+1):(D<o&&(C=i>0?C+(o-D):C,M=i>0?M:M+(o-D)),{step:_,tickMin:c.sub(new Ln(M).mul(_)),tickMax:c.add(new Ln(C).mul(_))})},AF=function(t){var[i,o]=t,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,_=Math.max(m,2),[c,M]=LI([i,o]);if(c===-1/0||M===1/0){var C=M===1/0?[c,...Array(m-1).fill(1/0)]:[...Array(m-1).fill(-1/0),M];return i>o?C.reverse():C}if(c===M)return EF(c,m,y);var{step:D,tickMin:k,tickMax:F}=BI(c,M,_,y,0),G=jI(k,F.add(new Ln(.1).mul(D)),D);return i>o?G.reverse():G},MF=function(t,i){var[o,m]=t,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[_,c]=LI([o,m]);if(_===-1/0||c===1/0)return[o,m];if(_===c)return[_];var M=Math.max(i,2),C=NI(new Ln(c).sub(_).div(M-1),y,0),D=[...jI(new Ln(_),new Ln(c),C),c];return y===!1&&(D=D.map(k=>Math.round(k))),o>m?D.reverse():D},FI=e=>e.rootProps.maxBarSize,PF=e=>e.rootProps.barGap,UI=e=>e.rootProps.barCategoryGap,CF=e=>e.rootProps.barSize,_b=e=>e.rootProps.stackOffset,VI=e=>e.rootProps.reverseStackOrder,VS=e=>e.options.chartName,qS=e=>e.rootProps.syncId,qI=e=>e.rootProps.syncMethod,$S=e=>e.options.eventEmitter,DF=e=>e.rootProps.baseValue,Da={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Np={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Qc={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},xb=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function bb(e,t,i){if(i!=="auto")return i;if(e!=null)return hc(e,t)?"category":"number"}function gP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Dx(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?gP(Object(i),!0).forEach(function(o){OF(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):gP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function OF(e,t,i){return(t=IF(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function IF(e){var t=zF(e,"string");return typeof t=="symbol"?t:t+""}function zF(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yP={allowDataOverflow:Np.allowDataOverflow,allowDecimals:Np.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Np.angleAxisId,includeHidden:!1,name:void 0,reversed:Np.reversed,scale:Np.scale,tick:Np.tick,tickCount:void 0,ticks:void 0,type:Np.type,unit:void 0},vP={allowDataOverflow:Qc.allowDataOverflow,allowDecimals:Qc.allowDecimals,allowDuplicatedCategory:Qc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Qc.radiusAxisId,includeHidden:Qc.includeHidden,name:void 0,reversed:Qc.reversed,scale:Qc.scale,tick:Qc.tick,tickCount:Qc.tickCount,ticks:void 0,type:Qc.type,unit:void 0},kF=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},GS=st([kF,DO],(e,t)=>{var i;if(e!=null)return e;var o=(i=bb(t,"angleAxis",yP.type))!==null&&i!==void 0?i:"category";return Dx(Dx({},yP),{},{type:o})}),RF=(e,t)=>e.polarAxis.radiusAxis[t],ZS=st([RF,DO],(e,t)=>{var i;if(e!=null)return e;var o=(i=bb(t,"radiusAxis",vP.type))!==null&&i!==void 0?i:"category";return Dx(Dx({},vP),{},{type:o})}),wb=e=>e.polarOptions,HS=st([_f,xf,io],I4),$I=st([wb,HS],(e,t)=>{if(e!=null)return lc(e.innerRadius,t,0)}),GI=st([wb,HS],(e,t)=>{if(e!=null)return lc(e.outerRadius,t,t*.8)}),jF=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:i}=e;return[t,i]},ZI=st([wb],jF);st([GS,ZI],xb);var HI=st([HS,$I,GI],(e,t,i)=>{if(!(e==null||t==null||i==null))return[t,i]});st([ZS,HI],xb);var WI=st([xn,wb,$I,GI,_f,xf],(e,t,i,o,m,y)=>{if(!(e!=="centric"&&e!=="radial"||t==null||i==null||o==null)){var{cx:_,cy:c,startAngle:M,endAngle:C}=t;return{cx:lc(_,m,m/2),cy:lc(c,y,y/2),innerRadius:i,outerRadius:o,startAngle:M,endAngle:C,clockWise:!1}}}),so=(e,t)=>t,Sb=(e,t,i)=>i;function Tb(e){return e?.id}function YI(e,t,i){var{chartData:o=[]}=t,{allowDuplicatedCategory:m,dataKey:y}=i,_=new Map;return e.forEach(c=>{var M,C=(M=c.data)!==null&&M!==void 0?M:o;if(!(C==null||C.length===0)){var D=Tb(c);C.forEach((k,F)=>{var G=y==null||m?F:String(Gi(k,y,null)),K=Gi(k,c.dataKey,0),W;_.has(G)?W=_.get(G):W={},Object.assign(W,{[D]:K}),_.set(G,W)})}}),Array.from(_.values())}function Eb(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Ab=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Mb(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function LF(e,t){if(e.length===t.length){for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return!1}var lo=e=>{var t=xn(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Yg=e=>e.tooltip.settings.axisId;function NF(e){if(e in bv)return bv[e]();var t="scale".concat(Zv(e));if(t in bv)return bv[t]()}function _P(e){var t=e.ticks,i=e.bandwidth,o=e.range(),m=[Math.min(...o),Math.max(...o)];return{domain:()=>e.domain(),range:(function(y){function _(){return y.apply(this,arguments)}return _.toString=function(){return y.toString()},_})(()=>m),rangeMin:()=>m[0],rangeMax:()=>m[1],isInRange(y){var _=m[0],c=m[1];return _<=c?y>=_&&y<=c:y>=c&&y<=_},bandwidth:i?()=>i.call(e):void 0,ticks:t?y=>t.call(e,y):void 0,map:(y,_)=>{var c=e(y);if(c!=null){if(e.bandwidth&&_!==null&&_!==void 0&&_.position){var M=e.bandwidth();switch(_.position){case"middle":c+=M/2;break;case"end":c+=M;break}}return c}}}}function xP(e,t,i){if(typeof e=="function")return _P(e.copy().domain(t).range(i));if(e!=null){var o=NF(e);if(o!=null)return o.domain(t).range(i),_P(o)}}var BF=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!gf(t)){for(var i,o,m=0;m<t.length;m++){var y=t[m];$r(y)&&((i===void 0||y<i)&&(i=y),(o===void 0||y>o)&&(o=y))}return i!==void 0&&o!==void 0?[i,o]:void 0}return t}default:return t}};function bP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Ox(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?bP(Object(i),!0).forEach(function(o){FF(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function FF(e,t,i){return(t=UF(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function UF(e){var t=VF(e,"string");return typeof t=="symbol"?t:t+""}function VF(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M2=[0,"auto"],to={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},XI=(e,t)=>e.cartesianAxis.xAxis[t],Sf=(e,t)=>{var i=XI(e,t);return i??to},ro={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:M2,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Yv},KI=(e,t)=>e.cartesianAxis.yAxis[t],Tf=(e,t)=>{var i=KI(e,t);return i??ro},qF={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},WS=(e,t)=>{var i=e.cartesianAxis.zAxis[t];return i??qF},xs=(e,t,i)=>{switch(t){case"xAxis":return Sf(e,i);case"yAxis":return Tf(e,i);case"zAxis":return WS(e,i);case"angleAxis":return GS(e,i);case"radiusAxis":return ZS(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},$F=(e,t,i)=>{switch(t){case"xAxis":return Sf(e,i);case"yAxis":return Tf(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},a_=(e,t,i)=>{switch(t){case"xAxis":return Sf(e,i);case"yAxis":return Tf(e,i);case"angleAxis":return GS(e,i);case"radiusAxis":return ZS(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},QI=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function JI(e,t){return i=>{switch(e){case"xAxis":return"xAxisId"in i&&i.xAxisId===t;case"yAxis":return"yAxisId"in i&&i.yAxisId===t;case"zAxis":return"zAxisId"in i&&i.zAxisId===t;case"angleAxis":return"angleAxisId"in i&&i.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in i&&i.radiusAxisId===t;default:return!1}}}var o_=e=>e.graphicalItems.cartesianItems,GF=st([so,Sb],JI),ez=(e,t,i)=>e.filter(i).filter(o=>t?.includeHidden===!0?!0:!o.hide),s_=st([o_,xs,GF],ez,{memoizeOptions:{resultEqualityCheck:Mb}}),tz=st([s_],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Eb)),rz=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),ZF=st([s_],rz),nz=e=>e.map(t=>t.data).filter(Boolean).flat(1),HF=st([s_],nz,{memoizeOptions:{resultEqualityCheck:Mb}}),iz=(e,t)=>{var{chartData:i=[],dataStartIndex:o,dataEndIndex:m}=t;return e.length>0?e:i.slice(o,m+1)},YS=st([HF,BS],iz),az=(e,t,i)=>t?.dataKey!=null?e.map(o=>({value:Gi(o,t.dataKey)})):i.length>0?i.map(o=>o.dataKey).flatMap(o=>e.map(m=>({value:Gi(m,o)}))):e.map(o=>({value:o})),Pb=st([YS,xs,s_],az);function oz(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function $0(e){if(ih(e)||e instanceof Date){var t=Number(e);if($r(t))return t}}function wP(e){if(Array.isArray(e)){var t=[$0(e[0]),$0(e[1])];return gf(t)?t:void 0}var i=$0(e);if(i!=null)return[i,i]}function yf(e){return e.map($0).filter(qs)}function WF(e,t,i){return!i||typeof t!="number"||sc(t)?[]:i.length?yf(i.flatMap(o=>{var m=Gi(e,o.dataKey),y,_;if(Array.isArray(m)?[y,_]=m:y=_=m,!(!$r(y)||!$r(_)))return[t-y,t+_]})):[]}var Ia=e=>{var t=lo(e),i=Yg(e);return a_(e,t,i)},l_=st([Ia],e=>e?.dataKey),YF=st([tz,BS,Ia],YI),sz=(e,t,i,o)=>{var m={},y=t.reduce((_,c)=>{if(c.stackId==null)return _;var M=_[c.stackId];return M==null&&(M=[]),M.push(c),_[c.stackId]=M,_},m);return Object.fromEntries(Object.entries(y).map(_=>{var[c,M]=_,C=o?[...M].reverse():M,D=C.map(Tb);return[c,{stackedData:T5(e,D,i),graphicalItems:C}]}))},Ix=st([YF,tz,_b,VI],sz),lz=(e,t,i,o)=>{var{dataStartIndex:m,dataEndIndex:y}=t;if(o==null&&i!=="zAxis"){var _=P5(e,m,y);if(!(_!=null&&_[0]===0&&_[1]===0))return _}},XF=st([xs],e=>e.allowDataOverflow),XS=e=>{var t;if(e==null||!("domain"in e))return M2;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var i=yf(e.ticks);return[Math.min(...i),Math.max(...i)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:M2},uz=st([xs],XS),cz=st([uz,XF],CI),KF=st([Ix,wf,so,cz],lz,{memoizeOptions:{resultEqualityCheck:Ab}}),KS=e=>e.errorBars,QF=(e,t,i)=>e.flatMap(o=>t[o.id]).filter(Boolean).filter(o=>oz(i,o)),zx=function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];var m=i.filter(Boolean);if(m.length!==0){var y=m.flat(),_=Math.min(...y),c=Math.max(...y);return[_,c]}},hz=(e,t,i,o,m)=>{var y,_;if(i.length>0&&e.forEach(c=>{i.forEach(M=>{var C,D,k=(C=o[M.id])===null||C===void 0?void 0:C.filter(ue=>oz(m,ue)),F=Gi(c,(D=t.dataKey)!==null&&D!==void 0?D:M.dataKey),G=WF(c,F,k);if(G.length>=2){var K=Math.min(...G),W=Math.max(...G);(y==null||K<y)&&(y=K),(_==null||W>_)&&(_=W)}var q=wP(F);q!=null&&(y=y==null?q[0]:Math.min(y,q[0]),_=_==null?q[1]:Math.max(_,q[1]))})}),t?.dataKey!=null&&e.forEach(c=>{var M=wP(Gi(c,t.dataKey));M!=null&&(y=y==null?M[0]:Math.min(y,M[0]),_=_==null?M[1]:Math.max(_,M[1]))}),$r(y)&&$r(_))return[y,_]},JF=st([YS,xs,ZF,KS,so],hz,{memoizeOptions:{resultEqualityCheck:Ab}});function e8(e){var{value:t}=e;if(ih(t)||t instanceof Date)return t}var t8=(e,t,i)=>{var o=e.map(e8).filter(m=>m!=null);return i&&(t.dataKey==null||t.allowDuplicatedCategory&&MD(o))?HO(0,e.length):t.allowDuplicatedCategory?o:Array.from(new Set(o))},fz=e=>e.referenceElements.dots,Xg=(e,t,i)=>e.filter(o=>o.ifOverflow==="extendDomain").filter(o=>t==="xAxis"?o.xAxisId===i:o.yAxisId===i),r8=st([fz,so,Sb],Xg),dz=e=>e.referenceElements.areas,n8=st([dz,so,Sb],Xg),pz=e=>e.referenceElements.lines,i8=st([pz,so,Sb],Xg),mz=(e,t)=>{if(e!=null){var i=yf(e.map(o=>t==="xAxis"?o.x:o.y));if(i.length!==0)return[Math.min(...i),Math.max(...i)]}},a8=st(r8,so,mz),gz=(e,t)=>{if(e!=null){var i=yf(e.flatMap(o=>[t==="xAxis"?o.x1:o.y1,t==="xAxis"?o.x2:o.y2]));if(i.length!==0)return[Math.min(...i),Math.max(...i)]}},o8=st([n8,so],gz);function s8(e){var t;if(e.x!=null)return yf([e.x]);var i=(t=e.segment)===null||t===void 0?void 0:t.map(o=>o.x);return i==null||i.length===0?[]:yf(i)}function l8(e){var t;if(e.y!=null)return yf([e.y]);var i=(t=e.segment)===null||t===void 0?void 0:t.map(o=>o.y);return i==null||i.length===0?[]:yf(i)}var yz=(e,t)=>{if(e!=null){var i=e.flatMap(o=>t==="xAxis"?s8(o):l8(o));if(i.length!==0)return[Math.min(...i),Math.max(...i)]}},u8=st([i8,so],yz),c8=st(a8,u8,o8,(e,t,i)=>zx(e,i,t)),vz=(e,t,i,o,m,y,_,c)=>{if(i!=null)return i;var M=_==="vertical"&&c==="xAxis"||_==="horizontal"&&c==="yAxis",C=M?zx(o,y,m):zx(y,m);return bF(t,C,e.allowDataOverflow)},h8=st([xs,uz,cz,KF,JF,c8,xn,so],vz,{memoizeOptions:{resultEqualityCheck:Ab}}),f8=[0,1],_z=(e,t,i,o,m,y,_)=>{if(!((e==null||i==null||i.length===0)&&_===void 0)){var{dataKey:c,type:M}=e,C=hc(t,y);if(C&&c==null){var D;return HO(0,(D=i?.length)!==null&&D!==void 0?D:0)}return M==="category"?t8(o,e,C):m==="expand"?f8:_}},QS=st([xs,xn,YS,Pb,_b,so,h8],_z);function d8(e){return e in bv}var xz=(e,t,i)=>{if(e!=null){var{scale:o,type:m}=e;if(o==="auto")return m==="category"&&i&&(i.indexOf("LineChart")>=0||i.indexOf("AreaChart")>=0||i.indexOf("ComposedChart")>=0&&!t)?"point":m==="category"?"band":"linear";if(typeof o=="string"){var y="scale".concat(Zv(o));return d8(y)?y:"point"}}},Kg=st([xs,QI,VS],xz);function JS(e,t,i,o){if(!(i==null||o==null))return typeof e.scale=="function"?xP(e.scale,i,o):xP(t,i,o)}var bz=(e,t,i)=>{var o=XS(t);if(!(i!=="auto"&&i!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(o)&&(o[0]==="auto"||o[1]==="auto")&&gf(e))return AF(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&gf(e))return MF(e,t.tickCount,t.allowDecimals)}},eT=st([QS,a_,Kg],bz),wz=(e,t,i,o)=>{if(o!=="angleAxis"&&e?.type==="number"&&gf(t)&&Array.isArray(i)&&i.length>0){var m,y,_=t[0],c=(m=i[0])!==null&&m!==void 0?m:0,M=t[1],C=(y=i[i.length-1])!==null&&y!==void 0?y:0;return[Math.min(_,c),Math.max(M,C)]}return t},p8=st([xs,QS,eT,so],wz),m8=st(Pb,xs,(e,t)=>{if(!(!t||t.type!=="number")){var i=1/0,o=Array.from(yf(e.map(k=>k.value))).sort((k,F)=>k-F),m=o[0],y=o[o.length-1];if(m==null||y==null)return 1/0;var _=y-m;if(_===0)return 1/0;for(var c=0;c<o.length-1;c++){var M=o[c],C=o[c+1];if(!(M==null||C==null)){var D=C-M;i=Math.min(i,D)}}return i/_}}),Sz=st(m8,xn,UI,io,(e,t,i,o,m)=>m,(e,t,i,o,m)=>{if(!$r(e))return 0;var y=t==="vertical"?o.height:o.width;if(m==="gap")return e*y/2;if(m==="no-gap"){var _=lc(i,e*y),c=e*y/2;return c-_-(c-_)/y*_}return 0}),g8=(e,t,i)=>{var o=Sf(e,t);return o==null||typeof o.padding!="string"?0:Sz(e,"xAxis",t,i,o.padding)},y8=(e,t,i)=>{var o=Tf(e,t);return o==null||typeof o.padding!="string"?0:Sz(e,"yAxis",t,i,o.padding)},v8=st(Sf,g8,(e,t)=>{var i,o;if(e==null)return{left:0,right:0};var{padding:m}=e;return typeof m=="string"?{left:t,right:t}:{left:((i=m.left)!==null&&i!==void 0?i:0)+t,right:((o=m.right)!==null&&o!==void 0?o:0)+t}}),_8=st(Tf,y8,(e,t)=>{var i,o;if(e==null)return{top:0,bottom:0};var{padding:m}=e;return typeof m=="string"?{top:t,bottom:t}:{top:((i=m.top)!==null&&i!==void 0?i:0)+t,bottom:((o=m.bottom)!==null&&o!==void 0?o:0)+t}}),x8=st([io,v8,lb,sb,(e,t,i)=>i],(e,t,i,o,m)=>{var{padding:y}=o;return m?[y.left,i.width-y.right]:[e.left+t.left,e.left+e.width-t.right]}),b8=st([io,xn,_8,lb,sb,(e,t,i)=>i],(e,t,i,o,m,y)=>{var{padding:_}=m;return y?[o.height-_.bottom,_.top]:t==="horizontal"?[e.top+e.height-i.bottom,e.top+i.top]:[e.top+i.top,e.top+e.height-i.bottom]}),u_=(e,t,i,o)=>{var m;switch(t){case"xAxis":return x8(e,i,o);case"yAxis":return b8(e,i,o);case"zAxis":return(m=WS(e,i))===null||m===void 0?void 0:m.range;case"angleAxis":return ZI(e);case"radiusAxis":return HI(e,i);default:return}},Tz=st([xs,u_],xb),w8=st([Kg,p8],BF),Cb=st([xs,Kg,w8,Tz],JS);st([s_,KS,so],QF);function Ez(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Db=(e,t)=>t,Ob=(e,t,i)=>i,S8=st(ab,Db,Ob,(e,t,i)=>e.filter(o=>o.orientation===t).filter(o=>o.mirror===i).sort(Ez)),T8=st(ob,Db,Ob,(e,t,i)=>e.filter(o=>o.orientation===t).filter(o=>o.mirror===i).sort(Ez)),Az=(e,t)=>({width:e.width,height:t.height}),E8=(e,t)=>{var i=typeof t.width=="number"?t.width:Yv;return{width:i,height:e.height}},Mz=st(io,Sf,Az),A8=(e,t,i)=>{switch(t){case"top":return e.top;case"bottom":return i-e.bottom;default:return 0}},M8=(e,t,i)=>{switch(t){case"left":return e.left;case"right":return i-e.right;default:return 0}},P8=st(xf,io,S8,Db,Ob,(e,t,i,o,m)=>{var y={},_;return i.forEach(c=>{var M=Az(t,c);_==null&&(_=A8(t,o,e));var C=o==="top"&&!m||o==="bottom"&&m;y[c.id]=_-Number(C)*M.height,_+=(C?-1:1)*M.height}),y}),C8=st(_f,io,T8,Db,Ob,(e,t,i,o,m)=>{var y={},_;return i.forEach(c=>{var M=E8(t,c);_==null&&(_=M8(t,o,e));var C=o==="left"&&!m||o==="right"&&m;y[c.id]=_-Number(C)*M.width,_+=(C?-1:1)*M.width}),y}),D8=(e,t)=>{var i=Sf(e,t);if(i!=null)return P8(e,i.orientation,i.mirror)},O8=st([io,Sf,D8,(e,t)=>t],(e,t,i,o)=>{if(t!=null){var m=i?.[o];return m==null?{x:e.left,y:0}:{x:e.left,y:m}}}),I8=(e,t)=>{var i=Tf(e,t);if(i!=null)return C8(e,i.orientation,i.mirror)},z8=st([io,Tf,I8,(e,t)=>t],(e,t,i,o)=>{if(t!=null){var m=i?.[o];return m==null?{x:0,y:e.top}:{x:m,y:e.top}}}),Pz=st(io,Tf,(e,t)=>{var i=typeof t.width=="number"?t.width:Yv;return{width:i,height:e.height}}),SP=(e,t,i)=>{switch(t){case"xAxis":return Mz(e,i).width;case"yAxis":return Pz(e,i).height;default:return}},Cz=(e,t,i,o)=>{if(i!=null){var{allowDuplicatedCategory:m,type:y,dataKey:_}=i,c=hc(e,o),M=t.map(C=>C.value);if(_&&c&&y==="category"&&m&&MD(M))return M}},tT=st([xn,Pb,xs,so],Cz),Dz=(e,t,i,o)=>{if(!(i==null||i.dataKey==null)){var{type:m,scale:y}=i,_=hc(e,o);if(_&&(m==="number"||y!=="auto"))return t.map(c=>c.value)}},rT=st([xn,Pb,a_,so],Dz),TP=st([xn,$F,Kg,Cb,tT,rT,u_,eT,so],(e,t,i,o,m,y,_,c,M)=>{if(t!=null){var C=hc(e,M);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:M,categoricalDomain:y,duplicateDomain:m,isCategorical:C,niceTicks:c,range:_,realScaleType:i,scale:o}}}),k8=(e,t,i,o,m,y,_,c,M)=>{if(!(t==null||o==null)){var C=hc(e,M),{type:D,ticks:k,tickCount:F}=t,G=i==="scaleBand"&&typeof o.bandwidth=="function"?o.bandwidth()/2:2,K=D==="category"&&o.bandwidth?o.bandwidth()/G:0;K=M==="angleAxis"&&y!=null&&y.length>=2?Vs(y[0]-y[1])*2*K:K;var W=k||m;return W?W.map((q,ue)=>{var me=_?_.indexOf(q):q,ge=o.map(me);return $r(ge)?{index:ue,coordinate:ge+K,value:q,offset:K}:null}).filter(qs):C&&c?c.map((q,ue)=>{var me=o.map(q);return $r(me)?{coordinate:me+K,value:q,index:ue,offset:K}:null}).filter(qs):o.ticks?o.ticks(F).map((q,ue)=>{var me=o.map(q);return $r(me)?{coordinate:me+K,value:q,index:ue,offset:K}:null}).filter(qs):o.domain().map((q,ue)=>{var me=o.map(q);return $r(me)?{coordinate:me+K,value:_?_[q]:q,index:ue,offset:K}:null}).filter(qs)}},Oz=st([xn,a_,Kg,Cb,eT,u_,tT,rT,so],k8),R8=(e,t,i,o,m,y,_)=>{if(!(t==null||i==null||o==null||o[0]===o[1])){var c=hc(e,_),{tickCount:M}=t,C=0;return C=_==="angleAxis"&&o?.length>=2?Vs(o[0]-o[1])*2*C:C,c&&y?y.map((D,k)=>{var F=i.map(D);return $r(F)?{coordinate:F+C,value:D,index:k,offset:C}:null}).filter(qs):i.ticks?i.ticks(M).map((D,k)=>{var F=i.map(D);return $r(F)?{coordinate:F+C,value:D,index:k,offset:C}:null}).filter(qs):i.domain().map((D,k)=>{var F=i.map(D);return $r(F)?{coordinate:F+C,value:m?m[D]:D,index:k,offset:C}:null}).filter(qs)}},sh=st([xn,a_,Cb,u_,tT,rT,so],R8),lh=st(xs,Cb,(e,t)=>{if(!(e==null||t==null))return Ox(Ox({},e),{},{scale:t})}),j8=st([xs,Kg,QS,Tz],JS);st((e,t,i)=>WS(e,i),j8,(e,t)=>{if(!(e==null||t==null))return Ox(Ox({},e),{},{scale:t})});var L8=st([xn,ab,ob],(e,t,i)=>{switch(e){case"horizontal":return t.some(o=>o.reversed)?"right-to-left":"left-to-right";case"vertical":return i.some(o=>o.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Iz=e=>e.options.defaultTooltipEventType,zz=e=>e.options.validateTooltipEventTypes;function kz(e,t,i){if(e==null)return t;var o=e?"axis":"item";return i==null?t:i.includes(o)?o:t}function nT(e,t){var i=Iz(e),o=zz(e);return kz(t,i,o)}function N8(e){return dr(t=>nT(t,e))}var Rz=(e,t)=>{var i,o=Number(t);if(!(sc(o)||t==null))return o>=0?e==null||(i=e[o])===null||i===void 0?void 0:i.value:void 0},B8=e=>e.tooltip.settings,jd={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},F8={itemInteraction:{click:jd,hover:jd},axisInteraction:{click:jd,hover:jd},keyboardInteraction:jd,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},jz=Gs({name:"tooltip",initialState:F8,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Si()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:i,next:o}=t.payload,m=oc(e).tooltipItemPayloads.indexOf(i);m>-1&&(e.tooltipItemPayloads[m]=o)},prepare:Si()},removeTooltipEntrySettings:{reducer(e,t){var i=oc(e).tooltipItemPayloads.indexOf(t.payload);i>-1&&e.tooltipItemPayloads.splice(i,1)},prepare:Si()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:U8,replaceTooltipEntrySettings:V8,removeTooltipEntrySettings:q8,setTooltipSettingsState:$8,setActiveMouseOverItemIndex:Lz,mouseLeaveItem:G8,mouseLeaveChart:Nz,setActiveClickItemIndex:Z8,setMouseOverAxisIndex:Bz,setMouseClickAxisIndex:H8,setSyncInteraction:P2,setKeyboardInteraction:C2}=jz.actions,W8=jz.reducer;function EP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function R0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?EP(Object(i),!0).forEach(function(o){Y8(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):EP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function Y8(e,t,i){return(t=X8(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function X8(e){var t=K8(e,"string");return typeof t=="symbol"?t:t+""}function K8(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q8(e,t,i){return t==="axis"?i==="click"?e.axisInteraction.click:e.axisInteraction.hover:i==="click"?e.itemInteraction.click:e.itemInteraction.hover}function J8(e){return e.index!=null}var Fz=(e,t,i,o)=>{if(t==null)return jd;var m=Q8(e,t,i);if(m==null)return jd;if(m.active)return m;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var y=e.settings.active===!0;if(J8(m)){if(y)return R0(R0({},m),{},{active:!0})}else if(o!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:o,graphicalItemId:void 0};return R0(R0({},jd),{},{coordinate:m.coordinate})};function eU(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var i=Number(e);return Number.isFinite(i)?i:void 0}function tU(e,t){var i=eU(e),o=t[0],m=t[1];if(i===void 0)return!1;var y=Math.min(o,m),_=Math.max(o,m);return i>=y&&i<=_}function rU(e,t,i){if(i==null||t==null)return!0;var o=Gi(e,t);return o==null||!gf(i)?!0:tU(o,i)}var iT=(e,t,i,o)=>{var m=e?.index;if(m==null)return null;var y=Number(m);if(!$r(y))return m;var _=0,c=1/0;t.length>0&&(c=t.length-1);var M=Math.max(_,Math.min(y,c)),C=t[M];return C==null||rU(C,i,o)?String(M):null},Uz=(e,t,i,o,m,y,_)=>{if(y!=null){var c=_[0],M=c?.getPosition(y);if(M!=null)return M;var C=m?.[Number(y)];if(C)return i==="horizontal"?{x:C.coordinate,y:(o.top+t)/2}:{x:(o.left+e)/2,y:C.coordinate}}},Vz=(e,t,i,o)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var m;if(i==="hover"?m=e.itemInteraction.hover.graphicalItemId:m=e.itemInteraction.click.graphicalItemId,m==null&&o!=null){var y=e.tooltipItemPayloads[0];return y!=null?[y]:[]}return e.tooltipItemPayloads.filter(_=>{var c;return((c=_.settings)===null||c===void 0?void 0:c.graphicalItemId)===m})},qz=e=>e.options.tooltipPayloadSearcher,Qg=e=>e.tooltip;function AP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function MP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?AP(Object(i),!0).forEach(function(o){nU(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):AP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function nU(e,t,i){return(t=iU(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function iU(e){var t=aU(e,"string");return typeof t=="symbol"?t:t+""}function aU(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oU(e,t){return e??t}var $z=(e,t,i,o,m,y,_)=>{if(!(t==null||y==null)){var{chartData:c,computedData:M,dataStartIndex:C,dataEndIndex:D}=i,k=[];return e.reduce((F,G)=>{var K,{dataDefinedOnItem:W,settings:q}=G,ue=oU(W,c),me=Array.isArray(ue)?_O(ue,C,D):ue,ge=(K=q?.dataKey)!==null&&K!==void 0?K:o,be=q?.nameKey,ze;if(o&&Array.isArray(me)&&!Array.isArray(me[0])&&_==="axis"?ze=PD(me,o,m):ze=y(me,t,M,be),Array.isArray(ze))ze.forEach(Oe=>{var rt=MP(MP({},q),{},{name:Oe.name,unit:Oe.unit,color:void 0,fill:void 0});F.push(MA({tooltipEntrySettings:rt,dataKey:Oe.dataKey,payload:Oe.payload,value:Gi(Oe.payload,Oe.dataKey),name:Oe.name}))});else{var Ae;F.push(MA({tooltipEntrySettings:q,dataKey:ge,payload:ze,value:Gi(ze,ge),name:(Ae=Gi(ze,be))!==null&&Ae!==void 0?Ae:q?.name}))}return F},k)}},aT=st([Ia,QI,VS],xz),sU=st([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),lU=st([lo,Yg],JI),Jg=st([sU,Ia,lU],ez,{memoizeOptions:{resultEqualityCheck:Mb}}),uU=st([Jg],e=>e.filter(Eb)),cU=st([Jg],nz,{memoizeOptions:{resultEqualityCheck:Mb}}),ey=st([cU,wf],iz),hU=st([uU,wf,Ia],YI),oT=st([ey,Ia,Jg],az),Gz=st([Ia],XS),fU=st([Ia],e=>e.allowDataOverflow),Zz=st([Gz,fU],CI),dU=st([Jg],e=>e.filter(Eb)),pU=st([hU,dU,_b,VI],sz),mU=st([pU,wf,lo,Zz],lz),gU=st([Jg],rz),yU=st([ey,Ia,gU,KS,lo],hz,{memoizeOptions:{resultEqualityCheck:Ab}}),vU=st([fz,lo,Yg],Xg),_U=st([vU,lo],mz),xU=st([dz,lo,Yg],Xg),bU=st([xU,lo],gz),wU=st([pz,lo,Yg],Xg),SU=st([wU,lo],yz),TU=st([_U,SU,bU],zx),EU=st([Ia,Gz,Zz,mU,yU,TU,xn,lo],vz),c_=st([Ia,xn,ey,oT,_b,lo,EU],_z),AU=st([c_,Ia,aT],bz),MU=st([Ia,c_,AU,lo],wz),Hz=e=>{var t=lo(e),i=Yg(e),o=!1;return u_(e,t,i,o)},Wz=st([Ia,Hz],xb),Yz=st([Ia,aT,MU,Wz],JS),PU=st([xn,oT,Ia,lo],Cz),CU=st([xn,oT,Ia,lo],Dz),DU=(e,t,i,o,m,y,_,c)=>{if(t){var{type:M}=t,C=hc(e,c);if(o){var D=i==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,k=M==="category"&&o.bandwidth?o.bandwidth()/D:0;return k=c==="angleAxis"&&m!=null&&m?.length>=2?Vs(m[0]-m[1])*2*k:k,C&&_?_.map((F,G)=>{var K=o.map(F);return $r(K)?{coordinate:K+k,value:F,index:G,offset:k}:null}).filter(qs):o.domain().map((F,G)=>{var K=o.map(F);return $r(K)?{coordinate:K+k,value:y?y[F]:F,index:G,offset:k}:null}).filter(qs)}}},Ef=st([xn,Ia,aT,Yz,Hz,PU,CU,lo],DU),sT=st([Iz,zz,B8],(e,t,i)=>kz(i.shared,e,t)),Xz=e=>e.tooltip.settings.trigger,lT=e=>e.tooltip.settings.defaultIndex,h_=st([Qg,sT,Xz,lT],Fz),am=st([h_,ey,l_,c_],iT),Kz=st([Ef,am],Rz),Qz=st([h_],e=>{if(e)return e.dataKey});st([h_],e=>{if(e)return e.graphicalItemId});var Jz=st([Qg,sT,Xz,lT],Vz),OU=st([_f,xf,xn,io,Ef,lT,Jz],Uz),IU=st([h_,OU],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),zU=st([h_],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),kU=st([Jz,am,wf,l_,Kz,qz,sT],$z),RU=st([kU],e=>{if(e!=null){var t=e.map(i=>i.payload).filter(i=>i!=null);return Array.from(new Set(t))}});function PP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function CP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?PP(Object(i),!0).forEach(function(o){jU(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):PP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function jU(e,t,i){return(t=LU(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function LU(e){var t=NU(e,"string");return typeof t=="symbol"?t:t+""}function NU(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BU=()=>dr(Ia),FU=()=>{var e=BU(),t=dr(Ef),i=dr(Yz);return Ud(!e||!i?void 0:CP(CP({},e),{},{scale:i}),t)};function DP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Eg(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?DP(Object(i),!0).forEach(function(o){UU(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function UU(e,t,i){return(t=VU(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function VU(e){var t=qU(e,"string");return typeof t=="symbol"?t:t+""}function qU(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $U=(e,t,i,o)=>{var m=t.find(y=>y&&y.index===i);if(m){if(e==="horizontal")return{x:m.coordinate,y:o.chartY};if(e==="vertical")return{x:o.chartX,y:m.coordinate}}return{x:0,y:0}},GU=(e,t,i,o)=>{var m=t.find(C=>C&&C.index===i);if(m){if(e==="centric"){var y=m.coordinate,{radius:_}=o;return Eg(Eg(Eg({},o),ko(o.cx,o.cy,_,y)),{},{angle:y,radius:_})}var c=m.coordinate,{angle:M}=o;return Eg(Eg(Eg({},o),ko(o.cx,o.cy,c,M)),{},{angle:M,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function ZU(e,t){var{chartX:i,chartY:o}=e;return i>=t.left&&i<=t.left+t.width&&o>=t.top&&o<=t.top+t.height}var ek=(e,t,i,o,m)=>{var y,_=(y=t?.length)!==null&&y!==void 0?y:0;if(_<=1||e==null)return 0;if(o==="angleAxis"&&m!=null&&Math.abs(Math.abs(m[1]-m[0])-360)<=1e-6)for(var c=0;c<_;c++){var M,C,D,k,F,G=c>0?(M=i[c-1])===null||M===void 0?void 0:M.coordinate:(C=i[_-1])===null||C===void 0?void 0:C.coordinate,K=(D=i[c])===null||D===void 0?void 0:D.coordinate,W=c>=_-1?(k=i[0])===null||k===void 0?void 0:k.coordinate:(F=i[c+1])===null||F===void 0?void 0:F.coordinate,q=void 0;if(!(G==null||K==null||W==null))if(Vs(K-G)!==Vs(W-K)){var ue=[];if(Vs(W-K)===Vs(m[1]-m[0])){q=W;var me=K+m[1]-m[0];ue[0]=Math.min(me,(me+G)/2),ue[1]=Math.max(me,(me+G)/2)}else{q=G;var ge=W+m[1]-m[0];ue[0]=Math.min(K,(ge+K)/2),ue[1]=Math.max(K,(ge+K)/2)}var be=[Math.min(K,(q+K)/2),Math.max(K,(q+K)/2)];if(e>be[0]&&e<=be[1]||e>=ue[0]&&e<=ue[1]){var ze;return(ze=i[c])===null||ze===void 0?void 0:ze.index}}else{var Ae=Math.min(G,W),Oe=Math.max(G,W);if(e>(Ae+K)/2&&e<=(Oe+K)/2){var rt;return(rt=i[c])===null||rt===void 0?void 0:rt.index}}}else if(t)for(var gt=0;gt<_;gt++){var yt=t[gt];if(yt!=null){var tt=t[gt+1],Ge=t[gt-1];if(gt===0&&tt!=null&&e<=(yt.coordinate+tt.coordinate)/2||gt===_-1&&Ge!=null&&e>(yt.coordinate+Ge.coordinate)/2||gt>0&&gt<_-1&&Ge!=null&&tt!=null&&e>(yt.coordinate+Ge.coordinate)/2&&e<=(yt.coordinate+tt.coordinate)/2)return yt.index}}return-1},tk=()=>dr(VS),uT=(e,t)=>t,rk=(e,t,i)=>i,cT=(e,t,i,o)=>o,HU=st(Ef,e=>Yx(e,t=>t.coordinate)),hT=st([Qg,uT,rk,cT],Fz),fT=st([hT,ey,l_,c_],iT),WU=(e,t,i)=>{if(t!=null){var o=Qg(e);return t==="axis"?i==="hover"?o.axisInteraction.hover.dataKey:o.axisInteraction.click.dataKey:i==="hover"?o.itemInteraction.hover.dataKey:o.itemInteraction.click.dataKey}},nk=st([Qg,uT,rk,cT],Vz),kx=st([_f,xf,xn,io,Ef,cT,nk],Uz),YU=st([hT,kx],(e,t)=>{var i;return(i=e.coordinate)!==null&&i!==void 0?i:t}),ik=st([Ef,fT],Rz),XU=st([nk,fT,wf,l_,ik,qz,uT],$z),KU=st([hT,fT],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),QU=(e,t,i,o,m,y,_)=>{if(!(!e||!i||!o||!m)&&ZU(e,_)){var c=C5(e,t),M=ek(c,y,m,i,o),C=$U(t,m,M,e);return{activeIndex:String(M),activeCoordinate:C}}},JU=(e,t,i,o,m,y,_)=>{if(!(!e||!o||!m||!y||!i)){var c=L4(e,i);if(c){var M=D5(c,t),C=ek(M,_,y,o,m),D=GU(t,y,C,c);return{activeIndex:String(C),activeCoordinate:D}}}},eV=(e,t,i,o,m,y,_,c)=>{if(!(!e||!t||!o||!m||!y))return t==="horizontal"||t==="vertical"?QU(e,t,o,m,y,_,c):JU(e,t,i,o,m,y,_)},tV=st(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,i)=>i,(e,t,i)=>{if(t!=null){var o=e[t];if(o!=null)return i?o.panoramaElement:o.element}}),rV=st(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(o=>parseInt(o,10)).concat(Object.values(Da)),i=Array.from(new Set(t));return i.sort((o,m)=>o-m)},{memoizeOptions:{resultEqualityCheck:LF}});function OP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function IP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?OP(Object(i),!0).forEach(function(o){nV(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):OP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function nV(e,t,i){return(t=iV(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function iV(e){var t=aV(e,"string");return typeof t=="symbol"?t:t+""}function aV(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oV={},sV={zIndexMap:Object.values(Da).reduce((e,t)=>IP(IP({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),oV)},lV=new Set(Object.values(Da));function uV(e){return lV.has(e)}var ak=Gs({name:"zIndex",initialState:sV,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:i}=t.payload;e.zIndexMap[i]?e.zIndexMap[i].consumers+=1:e.zIndexMap[i]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Si()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:i}=t.payload;e.zIndexMap[i]&&(e.zIndexMap[i].consumers-=1,e.zIndexMap[i].consumers<=0&&!uV(i)&&delete e.zIndexMap[i])},prepare:Si()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:i,element:o,isPanorama:m}=t.payload;e.zIndexMap[i]?m?e.zIndexMap[i].panoramaElement=o:e.zIndexMap[i].element=o:e.zIndexMap[i]={consumers:0,element:m?void 0:o,panoramaElement:m?o:void 0}},prepare:Si()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:i}=t.payload;e.zIndexMap[i]&&(t.payload.isPanorama?e.zIndexMap[i].panoramaElement=void 0:e.zIndexMap[i].element=void 0)},prepare:Si()}}}),{registerZIndexPortal:cV,unregisterZIndexPortal:hV,registerZIndexPortalElement:fV,unregisterZIndexPortalElement:dV}=ak.actions,pV=ak.reducer;function Sl(e){var{zIndex:t,children:i}=e,o=lN(),m=o&&t!==void 0&&t!==0,y=ao(),_=ea();Z.useLayoutEffect(()=>m?(_(cV({zIndex:t})),()=>{_(hV({zIndex:t}))}):Vd,[_,t,m]);var c=dr(M=>tV(M,t,y));return m?c?uD.createPortal(i,c):null:i}function D2(){return D2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},D2.apply(null,arguments)}function zP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function j0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?zP(Object(i),!0).forEach(function(o){mV(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function mV(e,t,i){return(t=gV(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function gV(e){var t=yV(e,"string");return typeof t=="symbol"?t:t+""}function yV(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vV(e){var{cursor:t,cursorComp:i,cursorProps:o}=e;return Z.isValidElement(t)?Z.cloneElement(t,o):Z.createElement(i,o)}function _V(e){var t,{coordinate:i,payload:o,index:m,offset:y,tooltipAxisBandSize:_,layout:c,cursor:M,tooltipEventType:C,chartName:D}=e,k=i,F=o,G=m;if(!M||!k||D!=="ScatterChart"&&C!=="axis")return null;var K,W,q;if(D==="ScatterChart")K=k,W=XN,q=Da.cursorLine;else if(D==="BarChart")K=KN(c,k,y,_),W=qO,q=Da.cursorRectangle;else if(c==="radial"&&OD(k)){var{cx:ue,cy:me,radius:ge,startAngle:be,endAngle:ze}=$O(k);K={cx:ue,cy:me,startAngle:be,endAngle:ze,innerRadius:ge,outerRadius:ge},W=ZO,q=Da.cursorLine}else K={points:U4(c,k,y)},W=Tv,q=Da.cursorLine;var Ae=typeof M=="object"&&"className"in M?M.className:void 0,Oe=j0(j0(j0(j0({stroke:"#ccc",pointerEvents:"none"},y),K),Gv(M)),{},{payload:F,payloadIndex:G,className:Nn("recharts-tooltip-cursor",Ae)});return Z.createElement(Sl,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:q},Z.createElement(vV,{cursor:M,cursorComp:W,cursorProps:Oe}))}function xV(e){var t=FU(),i=MO(),o=qd(),m=tk();return t==null||i==null||o==null||m==null?null:Z.createElement(_V,D2({},e,{offset:i,layout:o,tooltipAxisBandSize:t,chartName:m}))}var ok=Z.createContext(null),bV=()=>Z.useContext(ok),Tw={exports:{}},kP;function wV(){return kP||(kP=1,(function(e){var t=Object.prototype.hasOwnProperty,i="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(i=!1));function m(M,C,D){this.fn=M,this.context=C,this.once=D||!1}function y(M,C,D,k,F){if(typeof D!="function")throw new TypeError("The listener must be a function");var G=new m(D,k||M,F),K=i?i+C:C;return M._events[K]?M._events[K].fn?M._events[K]=[M._events[K],G]:M._events[K].push(G):(M._events[K]=G,M._eventsCount++),M}function _(M,C){--M._eventsCount===0?M._events=new o:delete M._events[C]}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var C=[],D,k;if(this._eventsCount===0)return C;for(k in D=this._events)t.call(D,k)&&C.push(i?k.slice(1):k);return Object.getOwnPropertySymbols?C.concat(Object.getOwnPropertySymbols(D)):C},c.prototype.listeners=function(C){var D=i?i+C:C,k=this._events[D];if(!k)return[];if(k.fn)return[k.fn];for(var F=0,G=k.length,K=new Array(G);F<G;F++)K[F]=k[F].fn;return K},c.prototype.listenerCount=function(C){var D=i?i+C:C,k=this._events[D];return k?k.fn?1:k.length:0},c.prototype.emit=function(C,D,k,F,G,K){var W=i?i+C:C;if(!this._events[W])return!1;var q=this._events[W],ue=arguments.length,me,ge;if(q.fn){switch(q.once&&this.removeListener(C,q.fn,void 0,!0),ue){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,D),!0;case 3:return q.fn.call(q.context,D,k),!0;case 4:return q.fn.call(q.context,D,k,F),!0;case 5:return q.fn.call(q.context,D,k,F,G),!0;case 6:return q.fn.call(q.context,D,k,F,G,K),!0}for(ge=1,me=new Array(ue-1);ge<ue;ge++)me[ge-1]=arguments[ge];q.fn.apply(q.context,me)}else{var be=q.length,ze;for(ge=0;ge<be;ge++)switch(q[ge].once&&this.removeListener(C,q[ge].fn,void 0,!0),ue){case 1:q[ge].fn.call(q[ge].context);break;case 2:q[ge].fn.call(q[ge].context,D);break;case 3:q[ge].fn.call(q[ge].context,D,k);break;case 4:q[ge].fn.call(q[ge].context,D,k,F);break;default:if(!me)for(ze=1,me=new Array(ue-1);ze<ue;ze++)me[ze-1]=arguments[ze];q[ge].fn.apply(q[ge].context,me)}}return!0},c.prototype.on=function(C,D,k){return y(this,C,D,k,!1)},c.prototype.once=function(C,D,k){return y(this,C,D,k,!0)},c.prototype.removeListener=function(C,D,k,F){var G=i?i+C:C;if(!this._events[G])return this;if(!D)return _(this,G),this;var K=this._events[G];if(K.fn)K.fn===D&&(!F||K.once)&&(!k||K.context===k)&&_(this,G);else{for(var W=0,q=[],ue=K.length;W<ue;W++)(K[W].fn!==D||F&&!K[W].once||k&&K[W].context!==k)&&q.push(K[W]);q.length?this._events[G]=q.length===1?q[0]:q:_(this,G)}return this},c.prototype.removeAllListeners=function(C){var D;return C?(D=i?i+C:C,this._events[D]&&_(this,D)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,e.exports=c})(Tw)),Tw.exports}var SV=wV();const TV=uh(SV);var Vv=new TV,O2="recharts.syncEvent.tooltip",RP="recharts.syncEvent.brush",Ib=(e,t)=>{if(t&&Array.isArray(e)){var i=Number.parseInt(t,10);if(!sc(i))return e[i]}},EV={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},sk=Gs({name:"options",initialState:EV,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),AV=sk.reducer,{createEventEmitter:MV}=sk.actions;function PV(e){return e.tooltip.syncInteraction}var CV={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},lk=Gs({name:"chartData",initialState:CV,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:i,endIndex:o}=t.payload;i!=null&&(e.dataStartIndex=i),o!=null&&(e.dataEndIndex=o)}}}),{setChartData:jP,setDataStartEndIndexes:DV,setComputedData:eY}=lk.actions,OV=lk.reducer,IV=["x","y"];function LP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Ag(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?LP(Object(i),!0).forEach(function(o){zV(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):LP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function zV(e,t,i){return(t=kV(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kV(e){var t=RV(e,"string");return typeof t=="symbol"?t:t+""}function RV(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jV(e,t){if(e==null)return{};var i,o,m=LV(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function LV(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function NV(){var e=dr(qS),t=dr($S),i=ea(),o=dr(qI),m=dr(Ef),y=qd(),_=ub(),c=dr(M=>M.rootProps.className);Z.useEffect(()=>{if(e==null)return Vd;var M=(C,D,k)=>{if(t!==k&&e===C){if(o==="index"){var F;if(_&&D!==null&&D!==void 0&&(F=D.payload)!==null&&F!==void 0&&F.coordinate&&D.payload.sourceViewBox){var G=D.payload.coordinate,{x:K,y:W}=G,q=jV(G,IV),{x:ue,y:me,width:ge,height:be}=D.payload.sourceViewBox,ze=Ag(Ag({},q),{},{x:_.x+(ge?(K-ue)/ge:0)*_.width,y:_.y+(be?(W-me)/be:0)*_.height});i(Ag(Ag({},D),{},{payload:Ag(Ag({},D.payload),{},{coordinate:ze})}))}else i(D);return}if(m!=null){var Ae;if(typeof o=="function"){var Oe={activeTooltipIndex:D.payload.index==null?void 0:Number(D.payload.index),isTooltipActive:D.payload.active,activeIndex:D.payload.index==null?void 0:Number(D.payload.index),activeLabel:D.payload.label,activeDataKey:D.payload.dataKey,activeCoordinate:D.payload.coordinate},rt=o(m,Oe);Ae=m[rt]}else o==="value"&&(Ae=m.find(Ue=>String(Ue.value)===D.payload.label));var{coordinate:gt}=D.payload;if(Ae==null||D.payload.active===!1||gt==null||_==null){i(P2({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:yt,y:tt}=gt,Ge=Math.min(yt,_.x+_.width),Rt=Math.min(tt,_.y+_.height),zt={x:y==="horizontal"?Ae.coordinate:Ge,y:y==="horizontal"?Rt:Ae.coordinate},kt=P2({active:D.payload.active,coordinate:zt,dataKey:D.payload.dataKey,index:String(Ae.index),label:D.payload.label,sourceViewBox:D.payload.sourceViewBox,graphicalItemId:D.payload.graphicalItemId});i(kt)}}};return Vv.on(O2,M),()=>{Vv.off(O2,M)}},[c,i,t,e,o,m,y,_])}function BV(){var e=dr(qS),t=dr($S),i=ea();Z.useEffect(()=>{if(e==null)return Vd;var o=(m,y,_)=>{t!==_&&e===m&&i(DV(y))};return Vv.on(RP,o),()=>{Vv.off(RP,o)}},[i,t,e])}function FV(){var e=ea();Z.useEffect(()=>{e(MV())},[e]),NV(),BV()}function UV(e,t,i,o,m,y){var _=dr(G=>WU(G,e,t)),c=dr($S),M=dr(qS),C=dr(qI),D=dr(PV),k=D?.active,F=ub();Z.useEffect(()=>{if(!k&&M!=null&&c!=null){var G=P2({active:y,coordinate:i,dataKey:_,index:m,label:typeof o=="number"?String(o):o,sourceViewBox:F,graphicalItemId:void 0});Vv.emit(O2,M,G,c)}},[k,i,_,m,o,c,M,C,y,F])}function NP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function BP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?NP(Object(i),!0).forEach(function(o){VV(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):NP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function VV(e,t,i){return(t=qV(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function qV(e){var t=$V(e,"string");return typeof t=="symbol"?t:t+""}function $V(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GV(e){return e.dataKey}function ZV(e,t){return Z.isValidElement(e)?Z.cloneElement(e,t):typeof e=="function"?Z.createElement(e,t):Z.createElement(CN,t)}var FP=[],HV={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Ev(e){var t,i,o=Ro(e,HV),{active:m,allowEscapeViewBox:y,animationDuration:_,animationEasing:c,content:M,filterNull:C,isAnimationActive:D,offset:k,payloadUniqBy:F,position:G,reverseDirection:K,useTranslate3d:W,wrapperStyle:q,cursor:ue,shared:me,trigger:ge,defaultIndex:be,portal:ze,axisId:Ae}=o,Oe=ea(),rt=typeof be=="number"?String(be):be;Z.useEffect(()=>{Oe($8({shared:me,trigger:ge,axisId:Ae,active:m,defaultIndex:rt}))},[Oe,me,ge,Ae,m,rt]);var gt=ub(),yt=NO(),tt=N8(me),{activeIndex:Ge,isActive:Rt}=(t=dr(Vt=>KU(Vt,tt,ge,rt)))!==null&&t!==void 0?t:{},zt=dr(Vt=>XU(Vt,tt,ge,rt)),kt=dr(Vt=>ik(Vt,tt,ge,rt)),Ue=dr(Vt=>YU(Vt,tt,ge,rt)),at=zt,pt=bV(),bt=(i=m??Rt)!==null&&i!==void 0?i:!1,[Ut,Ce]=mL([at,bt]),nt=tt==="axis"?kt:void 0;UV(tt,ge,Ue,nt,Ge,bt);var Be=ze??pt;if(Be==null||gt==null||tt==null)return null;var lt=at??FP;bt||(lt=FP),C&&lt.length&&(lt=Uj(lt.filter(Vt=>Vt.value!=null&&(Vt.hide!==!0||o.includeHidden)),F,GV));var Ft=lt.length>0,Lt=Z.createElement(jN,{allowEscapeViewBox:y,animationDuration:_,animationEasing:c,isAnimationActive:D,active:bt,coordinate:Ue,hasPayload:Ft,offset:k,position:G,reverseDirection:K,useTranslate3d:W,viewBox:gt,wrapperStyle:q,lastBoundingBox:Ut,innerRef:Ce,hasPortalFromProps:!!ze},ZV(M,BP(BP({},o),{},{payload:lt,label:nt,active:bt,activeIndex:Ge,coordinate:Ue,accessibilityLayer:yt})));return Z.createElement(Z.Fragment,null,uD.createPortal(Lt,Be),bt&&Z.createElement(xV,{cursor:ue,tooltipEventType:tt,coordinate:Ue,payload:lt,index:Ge}))}var uk=e=>null;uk.displayName="Cell";function WV(e,t,i){return(t=YV(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function YV(e){var t=XV(e,"string");return typeof t=="symbol"?t:t+""}function XV(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class KV{constructor(t){WV(this,"cache",new Map),this.maxSize=t}get(t){var i=this.cache.get(t);return i!==void 0&&(this.cache.delete(t),this.cache.set(t,i)),i}set(t,i){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var o=this.cache.keys().next().value;o!=null&&this.cache.delete(o)}this.cache.set(t,i)}clear(){this.cache.clear()}size(){return this.cache.size}}function UP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function QV(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?UP(Object(i),!0).forEach(function(o){JV(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function JV(e,t,i){return(t=eq(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function eq(e){var t=tq(e,"string");return typeof t=="symbol"?t:t+""}function tq(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rq={cacheSize:2e3,enableCache:!0},ck=QV({},rq),VP=new KV(ck.cacheSize),nq={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},qP="recharts_measurement_span";function iq(e,t){var i=t.fontSize||"",o=t.fontFamily||"",m=t.fontWeight||"",y=t.fontStyle||"",_=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(i,"|").concat(o,"|").concat(m,"|").concat(y,"|").concat(_,"|").concat(c)}var $P=(e,t)=>{try{var i=document.getElementById(qP);i||(i=document.createElement("span"),i.setAttribute("id",qP),i.setAttribute("aria-hidden","true"),document.body.appendChild(i)),Object.assign(i.style,nq,t),i.textContent="".concat(e);var o=i.getBoundingClientRect();return{width:o.width,height:o.height}}catch{return{width:0,height:0}}},Av=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Qv.isSsr)return{width:0,height:0};if(!ck.enableCache)return $P(t,i);var o=iq(t,i),m=VP.get(o);if(m)return m;var y=$P(t,i);return VP.set(o,y),y},hk;function aq(e,t,i){return(t=oq(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oq(e){var t=sq(e,"string");return typeof t=="symbol"?t:t+""}function sq(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GP=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ZP=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,lq=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,uq=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,cq={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},hq=["cm","mm","pt","pc","in","Q","px"];function fq(e){return hq.includes(e)}var Og="NaN";function dq(e,t){return e*cq[t]}class Io{static parse(t){var i,[,o,m]=(i=uq.exec(t))!==null&&i!==void 0?i:[];return o==null?Io.NaN:new Io(parseFloat(o),m??"")}constructor(t,i){this.num=t,this.unit=i,this.num=t,this.unit=i,sc(t)&&(this.unit=""),i!==""&&!lq.test(i)&&(this.num=NaN,this.unit=""),fq(i)&&(this.num=dq(t,i),this.unit="px")}add(t){return this.unit!==t.unit?new Io(NaN,""):new Io(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Io(NaN,""):new Io(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Io(NaN,""):new Io(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Io(NaN,""):new Io(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return sc(this.num)}}hk=Io;aq(Io,"NaN",new hk(NaN,""));function fk(e){if(e==null||e.includes(Og))return Og;for(var t=e;t.includes("*")||t.includes("/");){var i,[,o,m,y]=(i=GP.exec(t))!==null&&i!==void 0?i:[],_=Io.parse(o??""),c=Io.parse(y??""),M=m==="*"?_.multiply(c):_.divide(c);if(M.isNaN())return Og;t=t.replace(GP,M.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var C,[,D,k,F]=(C=ZP.exec(t))!==null&&C!==void 0?C:[],G=Io.parse(D??""),K=Io.parse(F??""),W=k==="+"?G.add(K):G.subtract(K);if(W.isNaN())return Og;t=t.replace(ZP,W.toString())}return t}var HP=/\(([^()]*)\)/;function pq(e){for(var t=e,i;(i=HP.exec(t))!=null;){var[,o]=i;t=t.replace(HP,fk(o))}return t}function mq(e){var t=e.replace(/\s+/g,"");return t=pq(t),t=fk(t),t}function gq(e){try{return mq(e)}catch{return Og}}function Ew(e){var t=gq(e.slice(5,-1));return t===Og?"":t}var yq=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],vq=["dx","dy","angle","className","breakAll"];function I2(){return I2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},I2.apply(null,arguments)}function WP(e,t){if(e==null)return{};var i,o,m=_q(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function _q(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var dk=/[ \f\n\r\t\v\u2028\u2029]+/,pk=e=>{var{children:t,breakAll:i,style:o}=e;try{var m=[];Ei(t)||(i?m=t.toString().split(""):m=t.toString().split(dk));var y=m.map(c=>({word:c,width:Av(c,o).width})),_=i?0:Av("",o).width;return{wordsWithComputedWidth:y,spaceWidth:_}}catch{return null}};function xq(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var mk=(e,t,i,o)=>e.reduce((m,y)=>{var{word:_,width:c}=y,M=m[m.length-1];if(M&&c!=null&&(t==null||o||M.width+c+i<Number(t)))M.words.push(_),M.width+=c+i;else{var C={words:[_],width:c};m.push(C)}return m},[]),gk=e=>e.reduce((t,i)=>t.width>i.width?t:i),bq="",YP=(e,t,i,o,m,y,_,c)=>{var M=e.slice(0,t),C=pk({breakAll:i,style:o,children:M+bq});if(!C)return[!1,[]];var D=mk(C.wordsWithComputedWidth,y,_,c),k=D.length>m||gk(D).width>Number(y);return[k,D]},wq=(e,t,i,o,m)=>{var{maxLines:y,children:_,style:c,breakAll:M}=e,C=Jt(y),D=String(_),k=mk(t,o,i,m);if(!C||m)return k;var F=k.length>y||gk(k).width>Number(o);if(!F)return k;for(var G=0,K=D.length-1,W=0,q;G<=K&&W<=D.length-1;){var ue=Math.floor((G+K)/2),me=ue-1,[ge,be]=YP(D,me,M,c,y,o,i,m),[ze]=YP(D,ue,M,c,y,o,i,m);if(!ge&&!ze&&(G=ue+1),ge&&ze&&(K=ue-1),!ge&&ze){q=be;break}W++}return q||k},XP=e=>{var t=Ei(e)?[]:e.toString().split(dk);return[{words:t,width:void 0}]},Sq=e=>{var{width:t,scaleToFit:i,children:o,style:m,breakAll:y,maxLines:_}=e;if((t||i)&&!Qv.isSsr){var c,M,C=pk({breakAll:y,children:o,style:m});if(C){var{wordsWithComputedWidth:D,spaceWidth:k}=C;c=D,M=k}else return XP(o);return wq({breakAll:y,children:o,maxLines:_,style:m},c,M,t,!!i)}return XP(o)},yk="#808080",Tq={angle:0,breakAll:!1,capHeight:"0.71em",fill:yk,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},dT=Z.forwardRef((e,t)=>{var i=Ro(e,Tq),{x:o,y:m,lineHeight:y,capHeight:_,fill:c,scaleToFit:M,textAnchor:C,verticalAnchor:D}=i,k=WP(i,yq),F=Z.useMemo(()=>Sq({breakAll:k.breakAll,children:k.children,maxLines:k.maxLines,scaleToFit:M,style:k.style,width:k.width}),[k.breakAll,k.children,k.maxLines,M,k.style,k.width]),{dx:G,dy:K,angle:W,className:q,breakAll:ue}=k,me=WP(k,vq);if(!ih(o)||!ih(m)||F.length===0)return null;var ge=Number(o)+(Jt(G)?G:0),be=Number(m)+(Jt(K)?K:0);if(!$r(ge)||!$r(be))return null;var ze;switch(D){case"start":ze=Ew("calc(".concat(_,")"));break;case"middle":ze=Ew("calc(".concat((F.length-1)/2," * -").concat(y," + (").concat(_," / 2))"));break;default:ze=Ew("calc(".concat(F.length-1," * -").concat(y,")"));break}var Ae=[],Oe=F[0];if(M&&Oe!=null){var rt=Oe.width,{width:gt}=k;Ae.push("scale(".concat(Jt(gt)&&Jt(rt)?gt/rt:1,")"))}return W&&Ae.push("rotate(".concat(W,", ").concat(ge,", ").concat(be,")")),Ae.length&&(me.transform=Ae.join(" ")),Z.createElement("text",I2({},Wo(me),{ref:t,x:ge,y:be,className:Nn("recharts-text",q),textAnchor:C,fill:c.includes("url")?yk:c}),F.map((yt,tt)=>{var Ge=yt.words.join(ue?"":" ");return Z.createElement("tspan",{x:ge,dy:tt===0?ze:y,key:"".concat(Ge,"-").concat(tt)},Ge)}))});dT.displayName="Text";function KP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Jc(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?KP(Object(i),!0).forEach(function(o){Eq(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):KP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function Eq(e,t,i){return(t=Aq(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Aq(e){var t=Mq(e,"string");return typeof t=="symbol"?t:t+""}function Mq(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pq=e=>{var{viewBox:t,position:i,offset:o=0,parentViewBox:m}=e,{x:y,y:_,height:c,upperWidth:M,lowerWidth:C}=fS(t),D=y,k=y+(M-C)/2,F=(D+k)/2,G=(M+C)/2,K=D+M/2,W=c>=0?1:-1,q=W*o,ue=W>0?"end":"start",me=W>0?"start":"end",ge=M>=0?1:-1,be=ge*o,ze=ge>0?"end":"start",Ae=ge>0?"start":"end",Oe=m;if(i==="top"){var rt={x:D+M/2,y:_-q,horizontalAnchor:"middle",verticalAnchor:ue};return Oe&&(rt.height=Math.max(_-Oe.y,0),rt.width=M),rt}if(i==="bottom"){var gt={x:k+C/2,y:_+c+q,horizontalAnchor:"middle",verticalAnchor:me};return Oe&&(gt.height=Math.max(Oe.y+Oe.height-(_+c),0),gt.width=C),gt}if(i==="left"){var yt={x:F-be,y:_+c/2,horizontalAnchor:ze,verticalAnchor:"middle"};return Oe&&(yt.width=Math.max(yt.x-Oe.x,0),yt.height=c),yt}if(i==="right"){var tt={x:F+G+be,y:_+c/2,horizontalAnchor:Ae,verticalAnchor:"middle"};return Oe&&(tt.width=Math.max(Oe.x+Oe.width-tt.x,0),tt.height=c),tt}var Ge=Oe?{width:G,height:c}:{};return i==="insideLeft"?Jc({x:F+be,y:_+c/2,horizontalAnchor:Ae,verticalAnchor:"middle"},Ge):i==="insideRight"?Jc({x:F+G-be,y:_+c/2,horizontalAnchor:ze,verticalAnchor:"middle"},Ge):i==="insideTop"?Jc({x:D+M/2,y:_+q,horizontalAnchor:"middle",verticalAnchor:me},Ge):i==="insideBottom"?Jc({x:k+C/2,y:_+c-q,horizontalAnchor:"middle",verticalAnchor:ue},Ge):i==="insideTopLeft"?Jc({x:D+be,y:_+q,horizontalAnchor:Ae,verticalAnchor:me},Ge):i==="insideTopRight"?Jc({x:D+M-be,y:_+q,horizontalAnchor:ze,verticalAnchor:me},Ge):i==="insideBottomLeft"?Jc({x:k+be,y:_+c-q,horizontalAnchor:Ae,verticalAnchor:ue},Ge):i==="insideBottomRight"?Jc({x:k+C-be,y:_+c-q,horizontalAnchor:ze,verticalAnchor:ue},Ge):i&&typeof i=="object"&&(Jt(i.x)||em(i.x))&&(Jt(i.y)||em(i.y))?Jc({x:y+lc(i.x,G),y:_+lc(i.y,c),horizontalAnchor:"end",verticalAnchor:"end"},Ge):Jc({x:K,y:_+c/2,horizontalAnchor:"middle",verticalAnchor:"middle"},Ge)},Cq=["labelRef"],Dq=["content"];function QP(e,t){if(e==null)return{};var i,o,m=Oq(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function Oq(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function JP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function wv(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?JP(Object(i),!0).forEach(function(o){Iq(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):JP(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function Iq(e,t,i){return(t=zq(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function zq(e){var t=kq(e,"string");return typeof t=="symbol"?t:t+""}function kq(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sf(){return sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},sf.apply(null,arguments)}var vk=Z.createContext(null),Rq=e=>{var{x:t,y:i,upperWidth:o,lowerWidth:m,width:y,height:_,children:c}=e,M=Z.useMemo(()=>({x:t,y:i,upperWidth:o,lowerWidth:m,width:y,height:_}),[t,i,o,m,y,_]);return Z.createElement(vk.Provider,{value:M},c)},_k=()=>{var e=Z.useContext(vk),t=ub();return e||(t?fS(t):void 0)},jq=Z.createContext(null),Lq=()=>{var e=Z.useContext(jq),t=dr(WI);return e||t},Nq=e=>{var{value:t,formatter:i}=e,o=Ei(e.children)?t:e.children;return typeof i=="function"?i(o):o},pT=e=>e!=null&&typeof e=="function",Bq=(e,t)=>{var i=Vs(t-e),o=Math.min(Math.abs(t-e),360);return i*o},Fq=(e,t,i,o,m)=>{var{offset:y,className:_}=e,{cx:c,cy:M,innerRadius:C,outerRadius:D,startAngle:k,endAngle:F,clockWise:G}=m,K=(C+D)/2,W=Bq(k,F),q=W>=0?1:-1,ue,me;switch(t){case"insideStart":ue=k+q*y,me=G;break;case"insideEnd":ue=F-q*y,me=!G;break;case"end":ue=F+q*y,me=G;break;default:throw new Error("Unsupported position ".concat(t))}me=W<=0?me:!me;var ge=ko(c,M,K,ue),be=ko(c,M,K,ue+(me?1:-1)*359),ze="M".concat(ge.x,",").concat(ge.y,`
    A`).concat(K,",").concat(K,",0,1,").concat(me?0:1,`,
    `).concat(be.x,",").concat(be.y),Ae=Ei(e.id)?Cv("recharts-radial-line-"):e.id;return Z.createElement("text",sf({},o,{dominantBaseline:"central",className:Nn("recharts-radial-bar-label",_)}),Z.createElement("defs",null,Z.createElement("path",{id:Ae,d:ze})),Z.createElement("textPath",{xlinkHref:"#".concat(Ae)},i))},Uq=(e,t,i)=>{var{cx:o,cy:m,innerRadius:y,outerRadius:_,startAngle:c,endAngle:M}=e,C=(c+M)/2;if(i==="outside"){var{x:D,y:k}=ko(o,m,_+t,C);return{x:D,y:k,textAnchor:D>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:m,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:m,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:m,textAnchor:"middle",verticalAnchor:"end"};var F=(y+_)/2,{x:G,y:K}=ko(o,m,F,C);return{x:G,y:K,textAnchor:"middle",verticalAnchor:"middle"}},G0=e=>e!=null&&"cx"in e&&Jt(e.cx),Vq={angle:0,offset:5,zIndex:Da.label,position:"middle",textBreakAll:!1};function qq(e){if(!G0(e))return e;var{cx:t,cy:i,outerRadius:o}=e,m=o*2;return{x:t-o,y:i-o,width:m,upperWidth:m,lowerWidth:m,height:m}}function Rd(e){var t=Ro(e,Vq),{viewBox:i,parentViewBox:o,position:m,value:y,children:_,content:c,className:M="",textBreakAll:C,labelRef:D}=t,k=Lq(),F=_k(),G=m==="center"?F:k??F,K,W,q;i==null?K=G:G0(i)?K=i:K=fS(i);var ue=qq(K);if(!K||Ei(y)&&Ei(_)&&!Z.isValidElement(c)&&typeof c!="function")return null;var me=wv(wv({},t),{},{viewBox:K});if(Z.isValidElement(c)){var{labelRef:ge}=me,be=QP(me,Cq);return Z.cloneElement(c,be)}if(typeof c=="function"){var{content:ze}=me,Ae=QP(me,Dq);if(W=Z.createElement(c,Ae),Z.isValidElement(W))return W}else W=Nq(t);var Oe=Wo(t);if(G0(K)){if(m==="insideStart"||m==="insideEnd"||m==="end")return Fq(t,m,W,Oe,K);q=Uq(K,t.offset,t.position)}else{if(!ue)return null;var rt=Pq({viewBox:ue,position:m,offset:t.offset,parentViewBox:G0(o)?void 0:o});q=wv(wv({x:rt.x,y:rt.y,textAnchor:rt.horizontalAnchor,verticalAnchor:rt.verticalAnchor},rt.width!==void 0?{width:rt.width}:{}),rt.height!==void 0?{height:rt.height}:{})}return Z.createElement(Sl,{zIndex:t.zIndex},Z.createElement(dT,sf({ref:D,className:Nn("recharts-label",M)},Oe,q,{textAnchor:xq(Oe.textAnchor)?Oe.textAnchor:q.textAnchor,breakAll:C}),W))}Rd.displayName="Label";var $q=(e,t,i)=>{if(!e)return null;var o={viewBox:t,labelRef:i};return e===!0?Z.createElement(Rd,sf({key:"label-implicit"},o)):ih(e)?Z.createElement(Rd,sf({key:"label-implicit",value:e},o)):Z.isValidElement(e)?e.type===Rd?Z.cloneElement(e,wv({key:"label-implicit"},o)):Z.createElement(Rd,sf({key:"label-implicit",content:e},o)):pT(e)?Z.createElement(Rd,sf({key:"label-implicit",content:e},o)):e&&typeof e=="object"?Z.createElement(Rd,sf({},e,{key:"label-implicit"},o)):null};function Gq(e){var{label:t,labelRef:i}=e,o=_k();return $q(t,o,i)||null}var Aw={},Mw={},eC;function Zq(){return eC||(eC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i[i.length-1]}e.last=t})(Mw)),Mw}var Pw={},tC;function Hq(){return tC||(tC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Array.isArray(i)?i:Array.from(i)}e.toArray=t})(Pw)),Pw}var rC;function Wq(){return rC||(rC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zq(),i=Hq(),o=tS();function m(y){if(o.isArrayLike(y))return t.last(i.toArray(y))}e.last=m})(Aw)),Aw}var Cw,nC;function Yq(){return nC||(nC=1,Cw=Wq().last),Cw}var Xq=Yq();const Kq=uh(Xq);var Qq=["valueAccessor"],Jq=["dataKey","clockWise","id","textBreakAll","zIndex"];function Rx(){return Rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Rx.apply(null,arguments)}function iC(e,t){if(e==null)return{};var i,o,m=e$(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function e$(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var t$=e=>Array.isArray(e.value)?Kq(e.value):e.value,xk=Z.createContext(void 0),mT=xk.Provider,bk=Z.createContext(void 0);bk.Provider;function r$(){return Z.useContext(xk)}function n$(){return Z.useContext(bk)}function Z0(e){var{valueAccessor:t=t$}=e,i=iC(e,Qq),{dataKey:o,clockWise:m,id:y,textBreakAll:_,zIndex:c}=i,M=iC(i,Jq),C=r$(),D=n$(),k=C||D;return!k||!k.length?null:Z.createElement(Sl,{zIndex:c??Da.label},Z.createElement(Yo,{className:"recharts-label-list"},k.map((F,G)=>{var K,W=Ei(o)?t(F,G):Gi(F.payload,o),q=Ei(y)?{}:{id:"".concat(y,"-").concat(G)};return Z.createElement(Rd,Rx({key:"label-".concat(G)},Wo(F),M,q,{fill:(K=i.fill)!==null&&K!==void 0?K:F.fill,parentViewBox:F.parentViewBox,value:W,textBreakAll:_,viewBox:F.viewBox,index:G,zIndex:0}))})))}Z0.displayName="LabelList";function gT(e){var{label:t}=e;return t?t===!0?Z.createElement(Z0,{key:"labelList-implicit"}):Z.isValidElement(t)||pT(t)?Z.createElement(Z0,{key:"labelList-implicit",content:t}):typeof t=="object"?Z.createElement(Z0,Rx({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function z2(){return z2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},z2.apply(null,arguments)}var wk=e=>{var{cx:t,cy:i,r:o,className:m}=e,y=Nn("recharts-dot",m);return Jt(t)&&Jt(i)&&Jt(o)?Z.createElement("circle",z2({},bl(e),J2(e),{className:y,cx:t,cy:i,r:o})):null},i$={radiusAxis:{},angleAxis:{}},Sk=Gs({name:"polarAxis",initialState:i$,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:tY,removeRadiusAxis:rY,addAngleAxis:nY,removeAngleAxis:iY}=Sk.actions,a$=Sk.reducer;function o$(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Dw={exports:{}},$n={};var aC;function s$(){if(aC)return $n;aC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),_=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),F=Symbol.for("react.view_transition"),G=Symbol.for("react.client.reference");function K(W){if(typeof W=="object"&&W!==null){var q=W.$$typeof;switch(q){case e:switch(W=W.type,W){case i:case m:case o:case M:case C:case F:return W;default:switch(W=W&&W.$$typeof,W){case _:case c:case k:case D:return W;case y:return W;default:return q}}case t:return q}}}return $n.ContextConsumer=y,$n.ContextProvider=_,$n.Element=e,$n.ForwardRef=c,$n.Fragment=i,$n.Lazy=k,$n.Memo=D,$n.Portal=t,$n.Profiler=m,$n.StrictMode=o,$n.Suspense=M,$n.SuspenseList=C,$n.isContextConsumer=function(W){return K(W)===y},$n.isContextProvider=function(W){return K(W)===_},$n.isElement=function(W){return typeof W=="object"&&W!==null&&W.$$typeof===e},$n.isForwardRef=function(W){return K(W)===c},$n.isFragment=function(W){return K(W)===i},$n.isLazy=function(W){return K(W)===k},$n.isMemo=function(W){return K(W)===D},$n.isPortal=function(W){return K(W)===t},$n.isProfiler=function(W){return K(W)===m},$n.isStrictMode=function(W){return K(W)===o},$n.isSuspense=function(W){return K(W)===M},$n.isSuspenseList=function(W){return K(W)===C},$n.isValidElementType=function(W){return typeof W=="string"||typeof W=="function"||W===i||W===m||W===o||W===M||W===C||typeof W=="object"&&W!==null&&(W.$$typeof===k||W.$$typeof===D||W.$$typeof===_||W.$$typeof===y||W.$$typeof===c||W.$$typeof===G||W.getModuleId!==void 0)},$n.typeOf=K,$n}var oC;function l$(){return oC||(oC=1,Dw.exports=s$()),Dw.exports}var u$=l$(),sC=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",lC=null,Ow=null,Tk=e=>{if(e===lC&&Array.isArray(Ow))return Ow;var t=[];return Z.Children.forEach(e,i=>{Ei(i)||(u$.isFragment(i)?t=t.concat(Tk(i.props.children)):t.push(i))}),Ow=t,lC=e,t};function c$(e,t){var i=[],o=[];return Array.isArray(t)?o=t.map(m=>sC(m)):o=[sC(t)],Tk(e).forEach(m=>{var y=Ng(m,"type.displayName")||Ng(m,"type.name");y&&o.indexOf(y)!==-1&&i.push(m)}),i}var yT=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Iw={},uC;function h$(){return uC||(uC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){if(typeof i!="object"||i==null)return!1;if(Object.getPrototypeOf(i)===null)return!0;if(Object.prototype.toString.call(i)!=="[object Object]"){const m=i[Symbol.toStringTag];return m==null||!Object.getOwnPropertyDescriptor(i,Symbol.toStringTag)?.writable?!1:i.toString()===`[object ${m}]`}let o=i;for(;Object.getPrototypeOf(o)!==null;)o=Object.getPrototypeOf(o);return Object.getPrototypeOf(i)===o}e.isPlainObject=t})(Iw)),Iw}var zw,cC;function f$(){return cC||(cC=1,zw=h$().isPlainObject),zw}var d$=f$();const p$=uh(d$);var hC,fC,dC,pC,mC;function gC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function yC(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?gC(Object(i),!0).forEach(function(o){m$(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):gC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function m$(e,t,i){return(t=g$(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g$(e){var t=y$(e,"string");return typeof t=="symbol"?t:t+""}function y$(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jx(){return jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},jx.apply(null,arguments)}function yv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var vC=(e,t,i,o,m)=>{var y=i-o,_;return _=$i(hC||(hC=yv(["M ",",",""])),e,t),_+=$i(fC||(fC=yv(["L ",",",""])),e+i,t),_+=$i(dC||(dC=yv(["L ",",",""])),e+i-y/2,t+m),_+=$i(pC||(pC=yv(["L ",",",""])),e+i-y/2-o,t+m),_+=$i(mC||(mC=yv(["L ",","," Z"])),e,t),_},v$={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_$=e=>{var t=Ro(e,v$),{x:i,y:o,upperWidth:m,lowerWidth:y,height:_,className:c}=t,{animationEasing:M,animationDuration:C,animationBegin:D,isUpdateAnimationActive:k}=t,F=Z.useRef(null),[G,K]=Z.useState(-1),W=Z.useRef(m),q=Z.useRef(y),ue=Z.useRef(_),me=Z.useRef(i),ge=Z.useRef(o),be=e_(e,"trapezoid-");if(Z.useEffect(()=>{if(F.current&&F.current.getTotalLength)try{var zt=F.current.getTotalLength();zt&&K(zt)}catch{}},[]),i!==+i||o!==+o||m!==+m||y!==+y||_!==+_||m===0&&y===0||_===0)return null;var ze=Nn("recharts-trapezoid",c);if(!k)return Z.createElement("g",null,Z.createElement("path",jx({},Wo(t),{className:ze,d:vC(i,o,m,y,_)})));var Ae=W.current,Oe=q.current,rt=ue.current,gt=me.current,yt=ge.current,tt="0px ".concat(G===-1?1:G,"px"),Ge="".concat(G,"px 0px"),Rt=BO(["strokeDasharray"],C,M);return Z.createElement(Jv,{animationId:be,key:be,canBegin:G>0,duration:C,easing:M,isActive:k,begin:D},zt=>{var kt=Gn(Ae,m,zt),Ue=Gn(Oe,y,zt),at=Gn(rt,_,zt),pt=Gn(gt,i,zt),bt=Gn(yt,o,zt);F.current&&(W.current=kt,q.current=Ue,ue.current=at,me.current=pt,ge.current=bt);var Ut=zt>0?{transition:Rt,strokeDasharray:Ge}:{strokeDasharray:tt};return Z.createElement("path",jx({},Wo(t),{className:ze,d:vC(pt,bt,kt,Ue,at),ref:F,style:yC(yC({},Ut),t.style)}))})},x$=["option","shapeType","activeClassName"];function b$(e,t){if(e==null)return{};var i,o,m=w$(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function w$(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function _C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Lx(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_C(Object(i),!0).forEach(function(o){S$(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_C(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function S$(e,t,i){return(t=T$(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function T$(e){var t=E$(e,"string");return typeof t=="symbol"?t:t+""}function E$(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A$(e,t){return Lx(Lx({},t),e)}function M$(e,t){return e==="symbols"}function xC(e){var{shapeType:t,elementProps:i}=e;switch(t){case"rectangle":return Z.createElement(qO,i);case"trapezoid":return Z.createElement(_$,i);case"sector":return Z.createElement(ZO,i);case"symbols":if(M$(t))return Z.createElement(DD,i);break;case"curve":return Z.createElement(Tv,i);default:return null}}function P$(e){return Z.isValidElement(e)?e.props:e}function Ek(e){var{option:t,shapeType:i,activeClassName:o="recharts-active-shape"}=e,m=b$(e,x$),y;if(Z.isValidElement(t))y=Z.cloneElement(t,Lx(Lx({},m),P$(t)));else if(typeof t=="function")y=t(m,m.index);else if(p$(t)&&typeof t!="boolean"){var _=A$(t,m);y=Z.createElement(xC,{shapeType:i,elementProps:_})}else{var c=m;y=Z.createElement(xC,{shapeType:i,elementProps:c})}return m.isActive?Z.createElement(Yo,{className:o},y):y}var Ak=(e,t,i)=>{var o=ea();return(m,y)=>_=>{e?.(m,y,_),o(Lz({activeIndex:String(y),activeDataKey:t,activeCoordinate:m.tooltipPosition,activeGraphicalItemId:i}))}},Mk=e=>{var t=ea();return(i,o)=>m=>{e?.(i,o,m),t(G8())}},Pk=(e,t,i)=>{var o=ea();return(m,y)=>_=>{e?.(m,y,_),o(Z8({activeIndex:String(y),activeDataKey:t,activeCoordinate:m.tooltipPosition,activeGraphicalItemId:i}))}};function vT(e){var{tooltipEntrySettings:t}=e,i=ea(),o=ao(),m=Z.useRef(null);return Z.useLayoutEffect(()=>{o||(m.current===null?i(U8(t)):m.current!==t&&i(V8({prev:m.current,next:t})),m.current=t)},[t,i,o]),Z.useLayoutEffect(()=>()=>{m.current&&(i(q8(m.current)),m.current=null)},[i]),null}function _T(e){var{legendPayload:t}=e,i=ea(),o=ao(),m=Z.useRef(null);return Z.useLayoutEffect(()=>{o||(m.current===null?i(bN(t)):m.current!==t&&i(wN({prev:m.current,next:t})),m.current=t)},[i,o,t]),Z.useLayoutEffect(()=>()=>{m.current&&(i(SN(m.current)),m.current=null)},[i]),null}var kw,C$=()=>{var[e]=Z.useState(()=>Cv("uid-"));return e},D$=(kw=YR.useId)!==null&&kw!==void 0?kw:C$;function O$(e,t){var i=D$();return t||(e?"".concat(e,"-").concat(i):i)}var I$=Z.createContext(void 0),xT=e=>{var{id:t,type:i,children:o}=e,m=O$("recharts-".concat(i),t);return Z.createElement(I$.Provider,{value:m},o(m))},z$={cartesianItems:[],polarItems:[]},Ck=Gs({name:"graphicalItems",initialState:z$,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Si()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:i,next:o}=t.payload,m=oc(e).cartesianItems.indexOf(i);m>-1&&(e.cartesianItems[m]=o)},prepare:Si()},removeCartesianGraphicalItem:{reducer(e,t){var i=oc(e).cartesianItems.indexOf(t.payload);i>-1&&e.cartesianItems.splice(i,1)},prepare:Si()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Si()},removePolarGraphicalItem:{reducer(e,t){var i=oc(e).polarItems.indexOf(t.payload);i>-1&&e.polarItems.splice(i,1)},prepare:Si()}}}),{addCartesianGraphicalItem:k$,replaceCartesianGraphicalItem:R$,removeCartesianGraphicalItem:j$,addPolarGraphicalItem:aY,removePolarGraphicalItem:oY}=Ck.actions,L$=Ck.reducer,N$=e=>{var t=ea(),i=Z.useRef(null);return Z.useLayoutEffect(()=>{i.current===null?t(k$(e)):i.current!==e&&t(R$({prev:i.current,next:e})),i.current=e},[t,e]),Z.useLayoutEffect(()=>()=>{i.current&&(t(j$(i.current)),i.current=null)},[t]),null},bT=Z.memo(N$),B$=["points"];function bC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Rw(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?bC(Object(i),!0).forEach(function(o){F$(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function F$(e,t,i){return(t=U$(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function U$(e){var t=V$(e,"string");return typeof t=="symbol"?t:t+""}function V$(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nx(){return Nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Nx.apply(null,arguments)}function q$(e,t){if(e==null)return{};var i,o,m=$$(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function $$(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function G$(e){var{option:t,dotProps:i,className:o}=e;if(Z.isValidElement(t))return Z.cloneElement(t,i);if(typeof t=="function")return t(i);var m=Nn(o,typeof t!="boolean"?t.className:""),y=i??{},{points:_}=y,c=q$(y,B$);return Z.createElement(wk,Nx({},c,{className:m}))}function Z$(e,t){return e==null?!1:t?!0:e.length===1}function Dk(e){var{points:t,dot:i,className:o,dotClassName:m,dataKey:y,baseProps:_,needClip:c,clipPathId:M,zIndex:C=Da.scatter}=e;if(!Z$(t,i))return null;var D=yT(i),k=d3(i),F=t.map((K,W)=>{var q,ue,me=Rw(Rw(Rw({r:3},_),k),{},{index:W,cx:(q=K.x)!==null&&q!==void 0?q:void 0,cy:(ue=K.y)!==null&&ue!==void 0?ue:void 0,dataKey:y,value:K.value,payload:K.payload,points:t});return Z.createElement(G$,{key:"dot-".concat(W),option:i,dotProps:me,className:m})}),G={};return c&&M!=null&&(G.clipPath="url(#clipPath-".concat(D?"":"dots-").concat(M,")")),Z.createElement(Sl,{zIndex:C},Z.createElement(Yo,Nx({className:o},G),F))}function wC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function SC(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?wC(Object(i),!0).forEach(function(o){H$(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function H$(e,t,i){return(t=W$(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function W$(e){var t=Y$(e,"string");return typeof t=="symbol"?t:t+""}function Y$(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ok=0,X$={xAxis:{},yAxis:{},zAxis:{}},Ik=Gs({name:"cartesianAxis",initialState:X$,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Si()},replaceXAxis:{reducer(e,t){var{prev:i,next:o}=t.payload;e.xAxis[i.id]!==void 0&&(i.id!==o.id&&delete e.xAxis[i.id],e.xAxis[o.id]=o)},prepare:Si()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Si()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Si()},replaceYAxis:{reducer(e,t){var{prev:i,next:o}=t.payload;e.yAxis[i.id]!==void 0&&(i.id!==o.id&&delete e.yAxis[i.id],e.yAxis[o.id]=o)},prepare:Si()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Si()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Si()},replaceZAxis:{reducer(e,t){var{prev:i,next:o}=t.payload;e.zAxis[i.id]!==void 0&&(i.id!==o.id&&delete e.zAxis[i.id],e.zAxis[o.id]=o)},prepare:Si()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Si()},updateYAxisWidth(e,t){var{id:i,width:o}=t.payload,m=e.yAxis[i];if(m){var y,_=m.widthHistory||[];if(_.length===3&&_[0]===_[2]&&o===_[1]&&o!==m.width&&Math.abs(o-((y=_[0])!==null&&y!==void 0?y:0))<=1)return;var c=[..._,o].slice(-3);e.yAxis[i]=SC(SC({},m),{},{width:o,widthHistory:c})}}}}),{addXAxis:K$,replaceXAxis:Q$,removeXAxis:J$,addYAxis:e9,replaceYAxis:t9,removeYAxis:r9,addZAxis:sY,replaceZAxis:lY,removeZAxis:uY,updateYAxisWidth:n9}=Ik.actions,i9=Ik.reducer,a9=st([io],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),o9=st([a9,_f,xf],(e,t,i)=>{if(!(!e||t==null||i==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,i-e.top-e.bottom)}}),zb=()=>dr(o9),s9=()=>dr(RU);function TC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function jw(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?TC(Object(i),!0).forEach(function(o){l9(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):TC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function l9(e,t,i){return(t=u9(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u9(e){var t=c9(e,"string");return typeof t=="symbol"?t:t+""}function c9(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h9=e=>{var{point:t,childIndex:i,mainColor:o,activeDot:m,dataKey:y,clipPath:_}=e;if(m===!1||t.x==null||t.y==null)return null;var c={index:i,dataKey:y,cx:t.x,cy:t.y,r:4,fill:o??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},M=jw(jw(jw({},c),Gv(m)),J2(m)),C;return Z.isValidElement(m)?C=Z.cloneElement(m,M):typeof m=="function"?C=m(M):C=Z.createElement(wk,M),Z.createElement(Yo,{className:"recharts-active-dot",clipPath:_},C)};function k2(e){var{points:t,mainColor:i,activeDot:o,itemDataKey:m,clipPath:y,zIndex:_=Da.activeDot}=e,c=dr(am),M=s9();if(t==null||M==null)return null;var C=t.find(D=>M.includes(D.payload));return Ei(C)?null:Z.createElement(Sl,{zIndex:_},Z.createElement(h9,{point:C,childIndex:Number(c),mainColor:i,dataKey:m,activeDot:o,clipPath:y}))}var EC=(e,t,i)=>{var o=i??e;if(!Ei(o))return lc(o,t,0)},f9=(e,t,i)=>{var o={},m=e.filter(Eb),y=e.filter(C=>C.stackId==null),_=m.reduce((C,D)=>{var k=C[D.stackId];return k==null&&(k=[]),k.push(D),C[D.stackId]=k,C},o),c=Object.entries(_).map(C=>{var D,[k,F]=C,G=F.map(W=>W.dataKey),K=EC(t,i,(D=F[0])===null||D===void 0?void 0:D.barSize);return{stackId:k,dataKeys:G,barSize:K}}),M=y.map(C=>{var D=[C.dataKey].filter(F=>F!=null),k=EC(t,i,C.barSize);return{stackId:void 0,dataKeys:D,barSize:k}});return[...c,...M]};function AC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function L0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?AC(Object(i),!0).forEach(function(o){d9(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):AC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function d9(e,t,i){return(t=p9(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p9(e){var t=m9(e,"string");return typeof t=="symbol"?t:t+""}function m9(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g9(e,t,i,o,m){var y,_=o.length;if(!(_<1)){var c=lc(e,i,0,!0),M,C=[];if($r((y=o[0])===null||y===void 0?void 0:y.barSize)){var D=!1,k=i/_,F=o.reduce((me,ge)=>me+(ge.barSize||0),0);F+=(_-1)*c,F>=i&&(F-=(_-1)*c,c=0),F>=i&&k>0&&(D=!0,k*=.9,F=_*k);var G=(i-F)/2>>0,K={offset:G-c,size:0};M=o.reduce((me,ge)=>{var be,ze={stackId:ge.stackId,dataKeys:ge.dataKeys,position:{offset:K.offset+K.size+c,size:D?k:(be=ge.barSize)!==null&&be!==void 0?be:0}},Ae=[...me,ze];return K=ze.position,Ae},C)}else{var W=lc(t,i,0,!0);i-2*W-(_-1)*c<=0&&(c=0);var q=(i-2*W-(_-1)*c)/_;q>1&&(q>>=0);var ue=$r(m)?Math.min(q,m):q;M=o.reduce((me,ge,be)=>[...me,{stackId:ge.stackId,dataKeys:ge.dataKeys,position:{offset:W+(q+c)*be+(q-ue)/2,size:ue}}],C)}return M}}var y9=(e,t,i,o,m,y,_)=>{var c=Ei(_)?t:_,M=g9(i,o,m!==y?m:y,e,c);return m!==y&&M!=null&&(M=M.map(C=>L0(L0({},C),{},{position:L0(L0({},C.position),{},{offset:C.position.offset-m/2})}))),M},v9=(e,t)=>{var i=Tb(t);if(!(!e||i==null||t==null)){var{stackId:o}=t;if(o!=null){var m=e[o];if(m){var{stackedData:y}=m;if(y)return y.find(_=>_.key===i)}}}},_9=(e,t)=>{if(!(e==null||t==null)){var i=e.find(o=>o.stackId===t.stackId&&t.dataKey!=null&&o.dataKeys.includes(t.dataKey));if(i!=null)return i.position}};function x9(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&$r(e.zIndex)?e.zIndex:t}var b9=e=>{var{chartData:t}=e,i=ea(),o=ao();return Z.useEffect(()=>o?()=>{}:(i(jP(t)),()=>{i(jP(void 0))}),[t,i,o]),null},MC={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},zk=Gs({name:"brush",initialState:MC,reducers:{setBrushSettings(e,t){return t.payload==null?MC:t.payload}}}),{setBrushSettings:cY}=zk.actions,w9=zk.reducer;function S9(e){return(e%180+180)%180}var T9=function(t){var{width:i,height:o}=t,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=S9(m),_=y*Math.PI/180,c=Math.atan(o/i),M=_>c&&_<Math.PI-c?o/Math.sin(_):i/Math.cos(_);return Math.abs(M)},E9={dots:[],areas:[],lines:[]},kk=Gs({name:"referenceElements",initialState:E9,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var i=oc(e).dots.findIndex(o=>o===t.payload);i!==-1&&e.dots.splice(i,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var i=oc(e).areas.findIndex(o=>o===t.payload);i!==-1&&e.areas.splice(i,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var i=oc(e).lines.findIndex(o=>o===t.payload);i!==-1&&e.lines.splice(i,1)}}}),{addDot:hY,removeDot:fY,addArea:dY,removeArea:pY,addLine:mY,removeLine:gY}=kk.actions,A9=kk.reducer,M9=Z.createContext(void 0),P9=e=>{var{children:t}=e,[i]=Z.useState("".concat(Cv("recharts"),"-clip")),o=zb();if(o==null)return null;var{x:m,y,width:_,height:c}=o;return Z.createElement(M9.Provider,{value:i},Z.createElement("defs",null,Z.createElement("clipPath",{id:i},Z.createElement("rect",{x:m,y,height:c,width:_}))),t)};function Rk(e,t){if(t<1)return[];if(t===1)return e;for(var i=[],o=0;o<e.length;o+=t){var m=e[o];m!==void 0&&i.push(m)}return i}function C9(e,t,i){var o={width:e.width+t.width,height:e.height+t.height};return T9(o,i)}function D9(e,t,i){var o=i==="width",{x:m,y,width:_,height:c}=e;return t===1?{start:o?m:y,end:o?m+_:y+c}:{start:o?m+_:y+c,end:o?m:y}}function qv(e,t,i,o,m){if(e*t<e*o||e*t>e*m)return!1;var y=i();return e*(t-e*y/2-o)>=0&&e*(t+e*y/2-m)<=0}function O9(e,t){return Rk(e,t+1)}function I9(e,t,i,o,m){for(var y=(o||[]).slice(),{start:_,end:c}=t,M=0,C=1,D=_,k=function(){var K=o?.[M];if(K===void 0)return{v:Rk(o,C)};var W=M,q,ue=()=>(q===void 0&&(q=i(K,W)),q),me=K.coordinate,ge=M===0||qv(e,me,ue,D,c);ge||(M=0,D=_,C+=1),ge&&(D=me+e*(ue()/2+m),M+=C)},F;C<=y.length;)if(F=k(),F)return F.v;return[]}function z9(e,t,i,o,m){var y=(o||[]).slice(),_=y.length;if(_===0)return[];for(var{start:c,end:M}=t,C=1;C<=_;C++){for(var D=(_-1)%C,k=c,F=!0,G=function(){var be=o[W];if(be==null)return 0;var ze=W,Ae,Oe=()=>(Ae===void 0&&(Ae=i(be,ze)),Ae),rt=be.coordinate,gt=W===D||qv(e,rt,Oe,k,M);if(!gt)return F=!1,1;gt&&(k=rt+e*(Oe()/2+m))},K,W=D;W<_&&(K=G(),!(K!==0&&K===1));W+=C);if(F){for(var q=[],ue=D;ue<_;ue+=C){var me=o[ue];me!=null&&q.push(me)}return q}}return[]}function PC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Zo(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?PC(Object(i),!0).forEach(function(o){k9(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):PC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function k9(e,t,i){return(t=R9(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function R9(e){var t=j9(e,"string");return typeof t=="symbol"?t:t+""}function j9(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L9(e,t,i,o,m){for(var y=(o||[]).slice(),_=y.length,{start:c}=t,{end:M}=t,C=function(F){var G=y[F];if(G==null)return 1;var K=G,W,q=()=>(W===void 0&&(W=i(G,F)),W);if(F===_-1){var ue=e*(K.coordinate+e*q()/2-M);y[F]=K=Zo(Zo({},K),{},{tickCoord:ue>0?K.coordinate-ue*e:K.coordinate})}else y[F]=K=Zo(Zo({},K),{},{tickCoord:K.coordinate});if(K.tickCoord!=null){var me=qv(e,K.tickCoord,q,c,M);me&&(M=K.tickCoord-e*(q()/2+m),y[F]=Zo(Zo({},K),{},{isShow:!0}))}},D=_-1;D>=0;D--)C(D);return y}function N9(e,t,i,o,m,y){var _=(o||[]).slice(),c=_.length,{start:M,end:C}=t;if(y){var D=o[c-1];if(D!=null){var k=i(D,c-1),F=e*(D.coordinate+e*k/2-C);if(_[c-1]=D=Zo(Zo({},D),{},{tickCoord:F>0?D.coordinate-F*e:D.coordinate}),D.tickCoord!=null){var G=qv(e,D.tickCoord,()=>k,M,C);G&&(C=D.tickCoord-e*(k/2+m),_[c-1]=Zo(Zo({},D),{},{isShow:!0}))}}}for(var K=y?c-1:c,W=function(me){var ge=_[me];if(ge==null)return 1;var be=ge,ze,Ae=()=>(ze===void 0&&(ze=i(ge,me)),ze);if(me===0){var Oe=e*(be.coordinate-e*Ae()/2-M);_[me]=be=Zo(Zo({},be),{},{tickCoord:Oe<0?be.coordinate-Oe*e:be.coordinate})}else _[me]=be=Zo(Zo({},be),{},{tickCoord:be.coordinate});if(be.tickCoord!=null){var rt=qv(e,be.tickCoord,Ae,M,C);rt&&(M=be.tickCoord+e*(Ae()/2+m),_[me]=Zo(Zo({},be),{},{isShow:!0}))}},q=0;q<K;q++)W(q);return _}function wT(e,t,i){var{tick:o,ticks:m,viewBox:y,minTickGap:_,orientation:c,interval:M,tickFormatter:C,unit:D,angle:k}=e;if(!m||!m.length||!o)return[];if(Jt(M)||Qv.isSsr){var F;return(F=O9(m,Jt(M)?M:0))!==null&&F!==void 0?F:[]}var G=[],K=c==="top"||c==="bottom"?"width":"height",W=D&&K==="width"?Av(D,{fontSize:t,letterSpacing:i}):{width:0,height:0},q=(ze,Ae)=>{var Oe=typeof C=="function"?C(ze.value,Ae):ze.value;return K==="width"?C9(Av(Oe,{fontSize:t,letterSpacing:i}),W,k):Av(Oe,{fontSize:t,letterSpacing:i})[K]},ue=m[0],me=m[1],ge=m.length>=2&&ue!=null&&me!=null?Vs(me.coordinate-ue.coordinate):1,be=D9(y,ge,K);return M==="equidistantPreserveStart"?I9(ge,be,q,m,_):M==="equidistantPreserveEnd"?z9(ge,be,q,m,_):(M==="preserveStart"||M==="preserveStartEnd"?G=N9(ge,be,q,m,_,M==="preserveStartEnd"):G=L9(ge,be,q,m,_),G.filter(ze=>ze.isShow))}var B9=e=>{var{ticks:t,label:i,labelGapWithTick:o=5,tickSize:m=0,tickMargin:y=0}=e,_=0;if(t){Array.from(t).forEach(D=>{if(D){var k=D.getBoundingClientRect();k.width>_&&(_=k.width)}});var c=i?i.getBoundingClientRect().width:0,M=m+y,C=_+M+c+(i?o:0);return Math.round(C)}return 0},F9=["axisLine","width","height","className","hide","ticks","axisType"];function U9(e,t){if(e==null)return{};var i,o,m=V9(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function V9(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function om(){return om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},om.apply(null,arguments)}function CC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function qi(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?CC(Object(i),!0).forEach(function(o){q9(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):CC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function q9(e,t,i){return(t=$9(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $9(e){var t=G9(e,"string");return typeof t=="symbol"?t:t+""}function G9(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hf={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Da.axis};function Z9(e){var{x:t,y:i,width:o,height:m,orientation:y,mirror:_,axisLine:c,otherSvgProps:M}=e;if(!c)return null;var C=qi(qi(qi({},M),bl(c)),{},{fill:"none"});if(y==="top"||y==="bottom"){var D=+(y==="top"&&!_||y==="bottom"&&_);C=qi(qi({},C),{},{x1:t,y1:i+D*m,x2:t+o,y2:i+D*m})}else{var k=+(y==="left"&&!_||y==="right"&&_);C=qi(qi({},C),{},{x1:t+k*o,y1:i,x2:t+k*o,y2:i+m})}return Z.createElement("line",om({},C,{className:Nn("recharts-cartesian-axis-line",Ng(c,"className"))}))}function H9(e,t,i,o,m,y,_,c,M){var C,D,k,F,G,K,W=c?-1:1,q=e.tickSize||_,ue=Jt(e.tickCoord)?e.tickCoord:e.coordinate;switch(y){case"top":C=D=e.coordinate,F=i+ +!c*m,k=F-W*q,K=k-W*M,G=ue;break;case"left":k=F=e.coordinate,D=t+ +!c*o,C=D-W*q,G=C-W*M,K=ue;break;case"right":k=F=e.coordinate,D=t+ +c*o,C=D+W*q,G=C+W*M,K=ue;break;default:C=D=e.coordinate,F=i+ +c*m,k=F+W*q,K=k+W*M,G=ue;break}return{line:{x1:C,y1:k,x2:D,y2:F},tick:{x:G,y:K}}}function W9(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Y9(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function X9(e){var{option:t,tickProps:i,value:o}=e,m,y=Nn(i.className,"recharts-cartesian-axis-tick-value");if(Z.isValidElement(t))m=Z.cloneElement(t,qi(qi({},i),{},{className:y}));else if(typeof t=="function")m=t(qi(qi({},i),{},{className:y}));else{var _="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(_=Nn(_,o$(t))),m=Z.createElement(dT,om({},i,{className:_}),o)}return m}var K9=Z.forwardRef((e,t)=>{var{ticks:i=[],tick:o,tickLine:m,stroke:y,tickFormatter:_,unit:c,padding:M,tickTextProps:C,orientation:D,mirror:k,x:F,y:G,width:K,height:W,tickSize:q,tickMargin:ue,fontSize:me,letterSpacing:ge,getTicksConfig:be,events:ze,axisType:Ae}=e,Oe=wT(qi(qi({},be),{},{ticks:i}),me,ge),rt=W9(D,k),gt=Y9(D,k),yt=bl(be),tt=Gv(o),Ge={};typeof m=="object"&&(Ge=m);var Rt=qi(qi({},yt),{},{fill:"none"},Ge),zt=Oe.map(at=>qi({entry:at},H9(at,F,G,K,W,D,q,k,ue))),kt=zt.map(at=>{var{entry:pt,line:bt}=at;return Z.createElement(Yo,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(pt.value,"-").concat(pt.coordinate,"-").concat(pt.tickCoord)},m&&Z.createElement("line",om({},Rt,bt,{className:Nn("recharts-cartesian-axis-tick-line",Ng(m,"className"))})))}),Ue=zt.map((at,pt)=>{var bt,Ut,{entry:Ce,tick:nt}=at,Be=qi(qi(qi(qi({verticalAnchor:gt},yt),{},{textAnchor:rt,stroke:"none",fill:y},nt),{},{index:pt,payload:Ce,visibleTicksCount:Oe.length,tickFormatter:_,padding:M},C),{},{angle:(bt=(Ut=C?.angle)!==null&&Ut!==void 0?Ut:yt.angle)!==null&&bt!==void 0?bt:0}),lt=qi(qi({},Be),tt);return Z.createElement(Yo,om({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(Ce.value,"-").concat(Ce.coordinate,"-").concat(Ce.tickCoord)},eS(ze,Ce,pt)),o&&Z.createElement(X9,{option:o,tickProps:lt,value:"".concat(typeof _=="function"?_(Ce.value,pt):Ce.value).concat(c||"")}))});return Z.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(Ae,"-ticks")},Ue.length>0&&Z.createElement(Sl,{zIndex:Da.label},Z.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(Ae,"-tick-labels"),ref:t},Ue)),kt.length>0&&Z.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(Ae,"-tick-lines")},kt))}),Q9=Z.forwardRef((e,t)=>{var{axisLine:i,width:o,height:m,className:y,hide:_,ticks:c,axisType:M}=e,C=U9(e,F9),[D,k]=Z.useState(""),[F,G]=Z.useState(""),K=Z.useRef(null);Z.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var q;return B9({ticks:K.current,label:(q=e.labelRef)===null||q===void 0?void 0:q.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var W=Z.useCallback(q=>{if(q){var ue=q.getElementsByClassName("recharts-cartesian-axis-tick-value");K.current=ue;var me=ue[0];if(me){var ge=window.getComputedStyle(me),be=ge.fontSize,ze=ge.letterSpacing;(be!==D||ze!==F)&&(k(be),G(ze))}}},[D,F]);return _||o!=null&&o<=0||m!=null&&m<=0?null:Z.createElement(Sl,{zIndex:e.zIndex},Z.createElement(Yo,{className:Nn("recharts-cartesian-axis",y)},Z.createElement(Z9,{x:e.x,y:e.y,width:o,height:m,orientation:e.orientation,mirror:e.mirror,axisLine:i,otherSvgProps:bl(e)}),Z.createElement(K9,{ref:W,axisType:M,events:C,fontSize:D,getTicksConfig:e,height:e.height,letterSpacing:F,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),Z.createElement(Rq,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},Z.createElement(Gq,{label:e.label,labelRef:e.labelRef}),e.children)))}),ST=Z.forwardRef((e,t)=>{var i=Ro(e,hf);return Z.createElement(Q9,om({},i,{ref:t}))});ST.displayName="CartesianAxis";var J9=["x1","y1","x2","y2","key"],eG=["offset"],tG=["xAxisId","yAxisId"],rG=["xAxisId","yAxisId"];function DC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Ho(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?DC(Object(i),!0).forEach(function(o){nG(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function nG(e,t,i){return(t=iG(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function iG(e){var t=aG(e,"string");return typeof t=="symbol"?t:t+""}function aG(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Gp.apply(null,arguments)}function Bx(e,t){if(e==null)return{};var i,o,m=oG(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function oG(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var sG=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:i,x:o,y:m,width:y,height:_,ry:c}=e;return Z.createElement("rect",{x:o,y:m,ry:c,width:y,height:_,stroke:"none",fill:t,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function jk(e){var{option:t,lineItemProps:i}=e,o;if(Z.isValidElement(t))o=Z.cloneElement(t,i);else if(typeof t=="function")o=t(i);else{var m,{x1:y,y1:_,x2:c,y2:M,key:C}=i,D=Bx(i,J9),k=(m=bl(D))!==null&&m!==void 0?m:{},{offset:F}=k,G=Bx(k,eG);o=Z.createElement("line",Gp({},G,{x1:y,y1:_,x2:c,y2:M,fill:"none",key:C}))}return o}function lG(e){var{x:t,width:i,horizontal:o=!0,horizontalPoints:m}=e;if(!o||!m||!m.length)return null;var{xAxisId:y,yAxisId:_}=e,c=Bx(e,tG),M=m.map((C,D)=>{var k=Ho(Ho({},c),{},{x1:t,y1:C,x2:t+i,y2:C,key:"line-".concat(D),index:D});return Z.createElement(jk,{key:"line-".concat(D),option:o,lineItemProps:k})});return Z.createElement("g",{className:"recharts-cartesian-grid-horizontal"},M)}function uG(e){var{y:t,height:i,vertical:o=!0,verticalPoints:m}=e;if(!o||!m||!m.length)return null;var{xAxisId:y,yAxisId:_}=e,c=Bx(e,rG),M=m.map((C,D)=>{var k=Ho(Ho({},c),{},{x1:C,y1:t,x2:C,y2:t+i,key:"line-".concat(D),index:D});return Z.createElement(jk,{option:o,lineItemProps:k,key:"line-".concat(D)})});return Z.createElement("g",{className:"recharts-cartesian-grid-vertical"},M)}function cG(e){var{horizontalFill:t,fillOpacity:i,x:o,y:m,width:y,height:_,horizontalPoints:c,horizontal:M=!0}=e;if(!M||!t||!t.length||c==null)return null;var C=c.map(k=>Math.round(k+m-m)).sort((k,F)=>k-F);m!==C[0]&&C.unshift(0);var D=C.map((k,F)=>{var G=C[F+1],K=G==null,W=K?m+_-k:G-k;if(W<=0)return null;var q=F%t.length;return Z.createElement("rect",{key:"react-".concat(F),y:k,x:o,height:W,width:y,stroke:"none",fill:t[q],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},D)}function hG(e){var{vertical:t=!0,verticalFill:i,fillOpacity:o,x:m,y,width:_,height:c,verticalPoints:M}=e;if(!t||!i||!i.length)return null;var C=M.map(k=>Math.round(k+m-m)).sort((k,F)=>k-F);m!==C[0]&&C.unshift(0);var D=C.map((k,F)=>{var G=C[F+1],K=G==null,W=K?m+_-k:G-k;if(W<=0)return null;var q=F%i.length;return Z.createElement("rect",{key:"react-".concat(F),x:k,y,width:W,height:c,stroke:"none",fill:i[q],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},D)}var fG=(e,t)=>{var{xAxis:i,width:o,height:m,offset:y}=e;return xO(wT(Ho(Ho(Ho({},hf),i),{},{ticks:bO(i),viewBox:{x:0,y:0,width:o,height:m}})),y.left,y.left+y.width,t)},dG=(e,t)=>{var{yAxis:i,width:o,height:m,offset:y}=e;return xO(wT(Ho(Ho(Ho({},hf),i),{},{ticks:bO(i),viewBox:{x:0,y:0,width:o,height:m}})),y.top,y.top+y.height,t)},pG={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Da.grid};function jg(e){var t=PO(),i=CO(),o=MO(),m=Ho(Ho({},Ro(e,pG)),{},{x:Jt(e.x)?e.x:o.left,y:Jt(e.y)?e.y:o.top,width:Jt(e.width)?e.width:o.width,height:Jt(e.height)?e.height:o.height}),{xAxisId:y,yAxisId:_,x:c,y:M,width:C,height:D,syncWithTicks:k,horizontalValues:F,verticalValues:G}=m,K=ao(),W=dr(gt=>TP(gt,"xAxis",y,K)),q=dr(gt=>TP(gt,"yAxis",_,K));if(!ah(C)||!ah(D)||!Jt(c)||!Jt(M))return null;var ue=m.verticalCoordinatesGenerator||fG,me=m.horizontalCoordinatesGenerator||dG,{horizontalPoints:ge,verticalPoints:be}=m;if((!ge||!ge.length)&&typeof me=="function"){var ze=F&&F.length,Ae=me({yAxis:q?Ho(Ho({},q),{},{ticks:ze?F:q.ticks}):void 0,width:t??C,height:i??D,offset:o},ze?!0:k);cx(Array.isArray(Ae),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof Ae,"]")),Array.isArray(Ae)&&(ge=Ae)}if((!be||!be.length)&&typeof ue=="function"){var Oe=G&&G.length,rt=ue({xAxis:W?Ho(Ho({},W),{},{ticks:Oe?G:W.ticks}):void 0,width:t??C,height:i??D,offset:o},Oe?!0:k);cx(Array.isArray(rt),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof rt,"]")),Array.isArray(rt)&&(be=rt)}return Z.createElement(Sl,{zIndex:m.zIndex},Z.createElement("g",{className:"recharts-cartesian-grid"},Z.createElement(sG,{fill:m.fill,fillOpacity:m.fillOpacity,x:m.x,y:m.y,width:m.width,height:m.height,ry:m.ry}),Z.createElement(cG,Gp({},m,{horizontalPoints:ge})),Z.createElement(hG,Gp({},m,{verticalPoints:be})),Z.createElement(lG,Gp({},m,{offset:o,horizontalPoints:ge,xAxis:W,yAxis:q})),Z.createElement(uG,Gp({},m,{offset:o,verticalPoints:be,xAxis:W,yAxis:q}))))}jg.displayName="CartesianGrid";var mG={},Lk=Gs({name:"errorBars",initialState:mG,reducers:{addErrorBar:(e,t)=>{var{itemId:i,errorBar:o}=t.payload;e[i]||(e[i]=[]),e[i].push(o)},replaceErrorBar:(e,t)=>{var{itemId:i,prev:o,next:m}=t.payload;e[i]&&(e[i]=e[i].map(y=>y.dataKey===o.dataKey&&y.direction===o.direction?m:y))},removeErrorBar:(e,t)=>{var{itemId:i,errorBar:o}=t.payload;e[i]&&(e[i]=e[i].filter(m=>m.dataKey!==o.dataKey||m.direction!==o.direction))}}}),{addErrorBar:yY,replaceErrorBar:vY,removeErrorBar:_Y}=Lk.actions,gG=Lk.reducer,yG=["children"];function vG(e,t){if(e==null)return{};var i,o,m=_G(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function _G(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var xG={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},bG=Z.createContext(xG);function Nk(e){var{children:t}=e,i=vG(e,yG);return Z.createElement(bG.Provider,{value:i},t)}function kb(e,t){var i,o,m=dr(C=>Sf(C,e)),y=dr(C=>Tf(C,t)),_=(i=m?.allowDataOverflow)!==null&&i!==void 0?i:to.allowDataOverflow,c=(o=y?.allowDataOverflow)!==null&&o!==void 0?o:ro.allowDataOverflow,M=_||c;return{needClip:M,needClipX:_,needClipY:c}}function TT(e){var{xAxisId:t,yAxisId:i,clipPathId:o}=e,m=zb(),{needClipX:y,needClipY:_,needClip:c}=kb(t,i);if(!c||!m)return null;var{x:M,y:C,width:D,height:k}=m;return Z.createElement("clipPath",{id:"clipPath-".concat(o)},Z.createElement("rect",{x:y?M:M-D/2,y:_?C:C-k/2,width:y?D:D*2,height:_?k:k*2}))}var Bk=(e,t,i,o)=>lh(e,"xAxis",t,o),Fk=(e,t,i,o)=>sh(e,"xAxis",t,o),Uk=(e,t,i,o)=>lh(e,"yAxis",i,o),Vk=(e,t,i,o)=>sh(e,"yAxis",i,o),wG=st([xn,Bk,Uk,Fk,Vk],(e,t,i,o,m)=>hc(e,"xAxis")?Ud(t,o,!1):Ud(i,m,!1)),SG=(e,t,i,o,m)=>m;function TG(e){return e.type==="line"}var EG=st([o_,SG],(e,t)=>e.filter(TG).find(i=>i.id===t)),AG=st([xn,Bk,Uk,Fk,Vk,EG,wG,BS],(e,t,i,o,m,y,_,c)=>{var{chartData:M,dataStartIndex:C,dataEndIndex:D}=c;if(!(y==null||t==null||i==null||o==null||m==null||o.length===0||m.length===0||_==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:k,data:F}=y,G;if(F!=null&&F.length>0?G=F:G=M?.slice(C,D+1),G!=null)return f7({layout:e,xAxis:t,yAxis:i,xAxisTicks:o,yAxisTicks:m,dataKey:k,bandSize:_,displayedData:G})}});function qk(e){var t=Gv(e),i=3,o=2;if(t!=null){var{r:m,strokeWidth:y}=t,_=Number(m),c=Number(y);return(Number.isNaN(_)||_<0)&&(_=i),(Number.isNaN(c)||c<0)&&(c=o),{r:_,strokeWidth:c}}return{r:i,strokeWidth:o}}var Lw={exports:{}},Nw={};var OC;function MG(){if(OC)return Nw;OC=1;var e=$g();function t(M,C){return M===C&&(M!==0||1/M===1/C)||M!==M&&C!==C}var i=typeof Object.is=="function"?Object.is:t,o=e.useSyncExternalStore,m=e.useRef,y=e.useEffect,_=e.useMemo,c=e.useDebugValue;return Nw.useSyncExternalStoreWithSelector=function(M,C,D,k,F){var G=m(null);if(G.current===null){var K={hasValue:!1,value:null};G.current=K}else K=G.current;G=_(function(){function q(ze){if(!ue){if(ue=!0,me=ze,ze=k(ze),F!==void 0&&K.hasValue){var Ae=K.value;if(F(Ae,ze))return ge=Ae}return ge=ze}if(Ae=ge,i(me,ze))return Ae;var Oe=k(ze);return F!==void 0&&F(Ae,Oe)?(me=ze,Ae):(me=ze,ge=Oe)}var ue=!1,me,ge,be=D===void 0?null:D;return[function(){return q(C())},be===null?void 0:function(){return q(be())}]},[C,D,k,F]);var W=o(M,G[0],G[1]);return y(function(){K.hasValue=!0,K.value=W},[W]),c(W),W},Nw}var IC;function PG(){return IC||(IC=1,Lw.exports=MG()),Lw.exports}PG();function CG(e){e()}function DG(){let e=null,t=null;return{clear(){e=null,t=null},notify(){CG(()=>{let i=e;for(;i;)i.callback(),i=i.next})},get(){const i=[];let o=e;for(;o;)i.push(o),o=o.next;return i},subscribe(i){let o=!0;const m=t={callback:i,next:null,prev:t};return m.prev?m.prev.next=m:e=m,function(){!o||e===null||(o=!1,m.next?m.next.prev=m.prev:t=m.prev,m.prev?m.prev.next=m.next:e=m.next)}}}}var zC={notify(){},get:()=>[]};function OG(e,t){let i,o=zC,m=0,y=!1;function _(W){D();const q=o.subscribe(W);let ue=!1;return()=>{ue||(ue=!0,q(),k())}}function c(){o.notify()}function M(){K.onStateChange&&K.onStateChange()}function C(){return y}function D(){m++,i||(i=e.subscribe(M),o=DG())}function k(){m--,i&&m===0&&(i(),i=void 0,o.clear(),o=zC)}function F(){y||(y=!0,D())}function G(){y&&(y=!1,k())}const K={addNestedSub:_,notifyNestedSubs:c,handleChangeWrapper:M,isSubscribed:C,trySubscribe:F,tryUnsubscribe:G,getListeners:()=>o};return K}var IG=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zG=IG(),kG=()=>typeof navigator<"u"&&navigator.product==="ReactNative",RG=kG(),jG=()=>zG||RG?Z.useLayoutEffect:Z.useEffect,LG=jG();function kC(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function NG(e,t){if(kC(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(let m=0;m<i.length;m++)if(!Object.prototype.hasOwnProperty.call(t,i[m])||!kC(e[i[m]],t[i[m]]))return!1;return!0}var BG=Symbol.for("react-redux-context"),FG=typeof globalThis<"u"?globalThis:{};function UG(){if(!Z.createContext)return{};const e=FG[BG]??=new Map;let t=e.get(Z.createContext);return t||(t=Z.createContext(null),e.set(Z.createContext,t)),t}var VG=UG();function qG(e){const{children:t,context:i,serverState:o,store:m}=e,y=Z.useMemo(()=>{const M=OG(m);return{store:m,subscription:M,getServerState:o?()=>o:void 0}},[m,o]),_=Z.useMemo(()=>m.getState(),[m]);LG(()=>{const{subscription:M}=y;return M.onStateChange=M.notifyNestedSubs,M.trySubscribe(),_!==m.getState()&&M.notifyNestedSubs(),()=>{M.tryUnsubscribe(),M.onStateChange=void 0}},[y,_]);const c=i||VG;return Z.createElement(c.Provider,{value:y},t)}var $G=qG,GG=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function ZG(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function f_(e,t){var i=new Set([...Object.keys(e),...Object.keys(t)]);for(var o of i)if(GG.has(o)){if(e[o]==null&&t[o]==null)continue;if(!NG(e[o],t[o]))return!1}else if(!ZG(e[o],t[o]))return!1;return!0}var HG=["id"],WG=["type","layout","connectNulls","needClip","shape"],YG=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},$v.apply(null,arguments)}function RC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function eh(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?RC(Object(i),!0).forEach(function(o){XG(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):RC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function XG(e,t,i){return(t=KG(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function KG(e){var t=QG(e,"string");return typeof t=="symbol"?t:t+""}function QG(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ET(e,t){if(e==null)return{};var i,o,m=JG(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function JG(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var e7=e=>{var{dataKey:t,name:i,stroke:o,legendType:m,hide:y}=e;return[{inactive:y,dataKey:t,type:m,color:o,value:Gg(i,t),payload:e}]},t7=Z.memo(e=>{var{dataKey:t,data:i,stroke:o,strokeWidth:m,fill:y,name:_,hide:c,unit:M,tooltipType:C,id:D}=e,k={dataDefinedOnItem:i,getPosition:Vd,settings:{stroke:o,strokeWidth:m,fill:y,dataKey:t,nameKey:void 0,name:Gg(_,t),hide:c,type:C,color:o,unit:M,graphicalItemId:D}};return Z.createElement(vT,{tooltipEntrySettings:k})}),$k=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function r7(e,t){for(var i=e.length%2!==0?[...e,0]:e,o=[],m=0;m<t;++m)o=[...o,...i];return o}var n7=(e,t,i)=>{var o=i.reduce((G,K)=>G+K);if(!o)return $k(t,e);for(var m=Math.floor(e/o),y=e%o,_=t-e,c=[],M=0,C=0;M<i.length;C+=(D=i[M])!==null&&D!==void 0?D:0,++M){var D,k=i[M];if(k!=null&&C+k>y){c=[...i.slice(0,M),y-C];break}}var F=c.length%2===0?[0,_]:[_];return[...r7(i,m),...c,...F].map(G=>"".concat(G,"px")).join(", ")};function i7(e){var{clipPathId:t,points:i,props:o}=e,{dot:m,dataKey:y,needClip:_}=o,{id:c}=o,M=ET(o,HG),C=bl(M);return Z.createElement(Dk,{points:i,dot:m,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:y,baseProps:C,needClip:_,clipPathId:t})}function a7(e){var{showLabels:t,children:i,points:o}=e,m=Z.useMemo(()=>o?.map(y=>{var _,c,M={x:(_=y.x)!==null&&_!==void 0?_:0,y:(c=y.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return eh(eh({},M),{},{value:y.value,payload:y.payload,viewBox:M,parentViewBox:void 0,fill:void 0})}),[o]);return Z.createElement(mT,{value:t?m:void 0},i)}function jC(e){var{clipPathId:t,pathRef:i,points:o,strokeDasharray:m,props:y}=e,{type:_,layout:c,connectNulls:M,needClip:C,shape:D}=y,k=ET(y,WG),F=eh(eh({},Wo(k)),{},{fill:"none",className:"recharts-line-curve",clipPath:C?"url(#clipPath-".concat(t,")"):void 0,points:o,type:_,layout:c,connectNulls:M,strokeDasharray:m??y.strokeDasharray});return Z.createElement(Z.Fragment,null,o?.length>1&&Z.createElement(Ek,$v({shapeType:"curve",option:D},F,{pathRef:i})),Z.createElement(i7,{points:o,clipPathId:t,props:y}))}function o7(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function s7(e){var{clipPathId:t,props:i,pathRef:o,previousPointsRef:m,longestAnimatedLengthRef:y}=e,{points:_,strokeDasharray:c,isAnimationActive:M,animationBegin:C,animationDuration:D,animationEasing:k,animateNewValues:F,width:G,height:K,onAnimationEnd:W,onAnimationStart:q}=i,ue=m.current,me=e_(_,"recharts-line-"),ge=Z.useRef(me),[be,ze]=Z.useState(!1),Ae=!be,Oe=Z.useCallback(()=>{typeof W=="function"&&W(),ze(!1)},[W]),rt=Z.useCallback(()=>{typeof q=="function"&&q(),ze(!0)},[q]),gt=o7(o.current),yt=Z.useRef(0);ge.current!==me&&(yt.current=y.current,ge.current=me);var tt=yt.current;return Z.createElement(a7,{points:_,showLabels:Ae},i.children,Z.createElement(Jv,{animationId:me,begin:C,duration:D,isActive:M,easing:k,onAnimationEnd:Oe,onAnimationStart:rt,key:me},Ge=>{var Rt=Gn(tt,gt+tt,Ge),zt=Math.min(Rt,gt),kt;if(M)if(c){var Ue="".concat(c).split(/[,\s]+/gim).map(bt=>parseFloat(bt));kt=n7(zt,gt,Ue)}else kt=$k(gt,zt);else kt=c==null?void 0:String(c);if(Ge>0&&gt>0&&(m.current=_,y.current=Math.max(y.current,zt)),ue){var at=ue.length/_.length,pt=Ge===1?_:_.map((bt,Ut)=>{var Ce=Math.floor(Ut*at);if(ue[Ce]){var nt=ue[Ce];return eh(eh({},bt),{},{x:Gn(nt.x,bt.x,Ge),y:Gn(nt.y,bt.y,Ge)})}return F?eh(eh({},bt),{},{x:Gn(G*2,bt.x,Ge),y:Gn(K/2,bt.y,Ge)}):eh(eh({},bt),{},{x:bt.x,y:bt.y})});return m.current=pt,Z.createElement(jC,{props:i,points:pt,clipPathId:t,pathRef:o,strokeDasharray:kt})}return Z.createElement(jC,{props:i,points:_,clipPathId:t,pathRef:o,strokeDasharray:kt})}),Z.createElement(gT,{label:i.label}))}function l7(e){var{clipPathId:t,props:i}=e,o=Z.useRef(null),m=Z.useRef(0),y=Z.useRef(null);return Z.createElement(s7,{props:i,clipPathId:t,previousPointsRef:o,longestAnimatedLengthRef:m,pathRef:y})}var u7=(e,t)=>{var i,o;return{x:(i=e.x)!==null&&i!==void 0?i:void 0,y:(o=e.y)!==null&&o!==void 0?o:void 0,value:e.value,errorVal:Gi(e.payload,t)}};class c7 extends Z.Component{render(){var{hide:t,dot:i,points:o,className:m,xAxisId:y,yAxisId:_,top:c,left:M,width:C,height:D,id:k,needClip:F,zIndex:G}=this.props;if(t)return null;var K=Nn("recharts-line",m),W=k,{r:q,strokeWidth:ue}=qk(i),me=yT(i),ge=q*2+ue,be=F?"url(#clipPath-".concat(me?"":"dots-").concat(W,")"):void 0;return Z.createElement(Sl,{zIndex:G},Z.createElement(Yo,{className:K},F&&Z.createElement("defs",null,Z.createElement(TT,{clipPathId:W,xAxisId:y,yAxisId:_}),!me&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(W)},Z.createElement("rect",{x:M-ge/2,y:c-ge/2,width:C+ge,height:D+ge}))),Z.createElement(Nk,{xAxisId:y,yAxisId:_,data:o,dataPointFormatter:u7,errorBarOffset:0},Z.createElement(l7,{props:this.props,clipPathId:W}))),Z.createElement(k2,{activeDot:this.props.activeDot,points:o,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:be}))}}var Gk={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Da.line,type:"linear"};function h7(e){var t=Ro(e,Gk),{activeDot:i,animateNewValues:o,animationBegin:m,animationDuration:y,animationEasing:_,connectNulls:c,dot:M,hide:C,isAnimationActive:D,label:k,legendType:F,xAxisId:G,yAxisId:K,id:W}=t,q=ET(t,YG),{needClip:ue}=kb(G,K),me=zb(),ge=qd(),be=ao(),ze=dr(yt=>AG(yt,G,K,be,W));if(ge!=="horizontal"&&ge!=="vertical"||ze==null||me==null)return null;var{height:Ae,width:Oe,x:rt,y:gt}=me;return Z.createElement(c7,$v({},q,{id:W,connectNulls:c,dot:M,activeDot:i,animateNewValues:o,animationBegin:m,animationDuration:y,animationEasing:_,isAnimationActive:D,hide:C,label:k,legendType:F,xAxisId:G,yAxisId:K,points:ze,layout:ge,height:Ae,width:Oe,left:rt,top:gt,needClip:ue}))}function f7(e){var{layout:t,xAxis:i,yAxis:o,xAxisTicks:m,yAxisTicks:y,dataKey:_,bandSize:c,displayedData:M}=e;return M.map((C,D)=>{var k=Gi(C,_);if(t==="horizontal"){var F=ux({axis:i,ticks:m,bandSize:c,entry:C,index:D}),G=Ei(k)?null:o.scale.map(k);return{x:F,y:G??null,value:k,payload:C}}var K=Ei(k)?null:i.scale.map(k),W=ux({axis:o,ticks:y,bandSize:c,entry:C,index:D});return K==null||W==null?null:{x:K,y:W,value:k,payload:C}}).filter(Boolean)}function d7(e){var t=Ro(e,Gk),i=ao();return Z.createElement(xT,{id:t.id,type:"line"},o=>Z.createElement(Z.Fragment,null,Z.createElement(_T,{legendPayload:e7(t)}),Z.createElement(t7,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:o}),Z.createElement(bT,{type:"line",id:o,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:i}),Z.createElement(h7,$v({},t,{id:o}))))}var H0=Z.memo(d7,f_);H0.displayName="Line";function ch(e,t){var i,o;return(i=(o=e.graphicalItems.cartesianItems.find(m=>m.id===t))===null||o===void 0?void 0:o.xAxisId)!==null&&i!==void 0?i:Ok}function hh(e,t){var i,o;return(i=(o=e.graphicalItems.cartesianItems.find(m=>m.id===t))===null||o===void 0?void 0:o.yAxisId)!==null&&i!==void 0?i:Ok}var Zk=(e,t,i)=>lh(e,"xAxis",ch(e,t),i),Hk=(e,t,i)=>sh(e,"xAxis",ch(e,t),i),Wk=(e,t,i)=>lh(e,"yAxis",hh(e,t),i),Yk=(e,t,i)=>sh(e,"yAxis",hh(e,t),i),p7=st([xn,Zk,Wk,Hk,Yk],(e,t,i,o,m)=>hc(e,"xAxis")?Ud(t,o,!1):Ud(i,m,!1)),m7=(e,t)=>t,Xk=st([o_,m7],(e,t)=>e.filter(i=>i.type==="area").find(i=>i.id===t)),Kk=e=>{var t=xn(e),i=hc(t,"xAxis");return i?"yAxis":"xAxis"},g7=(e,t)=>{var i=Kk(e);return i==="yAxis"?hh(e,t):ch(e,t)},y7=(e,t,i)=>Ix(e,Kk(e),g7(e,t),i),v7=st([Xk,y7],(e,t)=>{var i;if(!(e==null||t==null)){var{stackId:o}=e,m=Tb(e);if(!(o==null||m==null)){var y=(i=t[o])===null||i===void 0?void 0:i.stackedData,_=y?.find(c=>c.key===m);if(_!=null)return _.map(c=>[c[0],c[1]])}}}),_7=st([xn,Zk,Wk,Hk,Yk,v7,PI,p7,Xk,DF],(e,t,i,o,m,y,_,c,M,C)=>{var{chartData:D,dataStartIndex:k,dataEndIndex:F}=_;if(!(M==null||e!=="horizontal"&&e!=="vertical"||t==null||i==null||o==null||m==null||o.length===0||m.length===0||c==null)){var{data:G}=M,K;if(G&&G.length>0?K=G:K=D?.slice(k,F+1),K!=null)return N7({layout:e,xAxis:t,yAxis:i,xAxisTicks:o,yAxisTicks:m,dataStartIndex:k,areaSettings:M,stackedData:y,displayedData:K,chartBaseValue:C,bandSize:c})}}),x7=["id"],b7=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function Yp(){return Yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Yp.apply(null,arguments)}function Qk(e,t){if(e==null)return{};var i,o,m=w7(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function w7(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function LC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function Ig(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?LC(Object(i),!0).forEach(function(o){S7(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):LC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function S7(e,t,i){return(t=T7(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function T7(e){var t=E7(e,"string");return typeof t=="symbol"?t:t+""}function E7(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fx(e,t){return e&&e!=="none"?e:t}var A7=e=>{var{dataKey:t,name:i,stroke:o,fill:m,legendType:y,hide:_}=e;return[{inactive:_,dataKey:t,type:y,color:Fx(o,m),value:Gg(i,t),payload:e}]},M7=Z.memo(e=>{var{dataKey:t,data:i,stroke:o,strokeWidth:m,fill:y,name:_,hide:c,unit:M,tooltipType:C,id:D}=e,k={dataDefinedOnItem:i,getPosition:Vd,settings:{stroke:o,strokeWidth:m,fill:y,dataKey:t,nameKey:void 0,name:Gg(_,t),hide:c,type:C,color:Fx(o,y),unit:M,graphicalItemId:D}};return Z.createElement(vT,{tooltipEntrySettings:k})});function P7(e){var{clipPathId:t,points:i,props:o}=e,{needClip:m,dot:y,dataKey:_}=o,c=bl(o);return Z.createElement(Dk,{points:i,dot:y,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:_,baseProps:c,needClip:m,clipPathId:t})}function C7(e){var{showLabels:t,children:i,points:o}=e,m=o.map(y=>{var _,c,M={x:(_=y.x)!==null&&_!==void 0?_:0,y:(c=y.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Ig(Ig({},M),{},{value:y.value,payload:y.payload,parentViewBox:void 0,viewBox:M,fill:void 0})});return Z.createElement(mT,{value:t?m:void 0},i)}function NC(e){var{points:t,baseLine:i,needClip:o,clipPathId:m,props:y}=e,{layout:_,type:c,stroke:M,connectNulls:C,isRange:D}=y,{id:k}=y,F=Qk(y,x7),G=bl(F),K=Wo(F);return Z.createElement(Z.Fragment,null,t?.length>1&&Z.createElement(Yo,{clipPath:o?"url(#clipPath-".concat(m,")"):void 0},Z.createElement(Tv,Yp({},K,{id:k,points:t,connectNulls:C,type:c,baseLine:i,layout:_,stroke:"none",className:"recharts-area-area"})),M!=="none"&&Z.createElement(Tv,Yp({},G,{className:"recharts-area-curve",layout:_,type:c,connectNulls:C,fill:"none",points:t})),M!=="none"&&D&&Z.createElement(Tv,Yp({},G,{className:"recharts-area-curve",layout:_,type:c,connectNulls:C,fill:"none",points:i}))),Z.createElement(P7,{points:t,props:F,clipPathId:m}))}function D7(e){var t,i,{alpha:o,baseLine:m,points:y,strokeWidth:_}=e,c=(t=y[0])===null||t===void 0?void 0:t.y,M=(i=y[y.length-1])===null||i===void 0?void 0:i.y;if(!$r(c)||!$r(M))return null;var C=o*Math.abs(c-M),D=Math.max(...y.map(k=>k.x||0));return Jt(m)?D=Math.max(m,D):m&&Array.isArray(m)&&m.length&&(D=Math.max(...m.map(k=>k.x||0),D)),Jt(D)?Z.createElement("rect",{x:0,y:c<M?c:c-C,width:D+(_?parseInt("".concat(_),10):1),height:Math.floor(C)}):null}function O7(e){var t,i,{alpha:o,baseLine:m,points:y,strokeWidth:_}=e,c=(t=y[0])===null||t===void 0?void 0:t.x,M=(i=y[y.length-1])===null||i===void 0?void 0:i.x;if(!$r(c)||!$r(M))return null;var C=o*Math.abs(c-M),D=Math.max(...y.map(k=>k.y||0));return Jt(m)?D=Math.max(m,D):m&&Array.isArray(m)&&m.length&&(D=Math.max(...m.map(k=>k.y||0),D)),Jt(D)?Z.createElement("rect",{x:c<M?c:c-C,y:0,width:C,height:Math.floor(D+(_?parseInt("".concat(_),10):1))}):null}function I7(e){var{alpha:t,layout:i,points:o,baseLine:m,strokeWidth:y}=e;return i==="vertical"?Z.createElement(D7,{alpha:t,points:o,baseLine:m,strokeWidth:y}):Z.createElement(O7,{alpha:t,points:o,baseLine:m,strokeWidth:y})}function z7(e){var{needClip:t,clipPathId:i,props:o,previousPointsRef:m,previousBaselineRef:y}=e,{points:_,baseLine:c,isAnimationActive:M,animationBegin:C,animationDuration:D,animationEasing:k,onAnimationStart:F,onAnimationEnd:G}=o,K=Z.useMemo(()=>({points:_,baseLine:c}),[_,c]),W=e_(K,"recharts-area-"),q=dS(),[ue,me]=Z.useState(!1),ge=!ue,be=Z.useCallback(()=>{typeof G=="function"&&G(),me(!1)},[G]),ze=Z.useCallback(()=>{typeof F=="function"&&F(),me(!0)},[F]);if(q==null)return null;var Ae=m.current,Oe=y.current;return Z.createElement(C7,{showLabels:ge,points:_},o.children,Z.createElement(Jv,{animationId:W,begin:C,duration:D,isActive:M,easing:k,onAnimationEnd:be,onAnimationStart:ze,key:W},rt=>{if(Ae){var gt=Ae.length/_.length,yt=rt===1?_:_.map((Ge,Rt)=>{var zt=Math.floor(Rt*gt);if(Ae[zt]){var kt=Ae[zt];return Ig(Ig({},Ge),{},{x:Gn(kt.x,Ge.x,rt),y:Gn(kt.y,Ge.y,rt)})}return Ge}),tt;return Jt(c)?tt=Gn(Oe,c,rt):Ei(c)||sc(c)?tt=Gn(Oe,0,rt):tt=c.map((Ge,Rt)=>{var zt=Math.floor(Rt*gt);if(Array.isArray(Oe)&&Oe[zt]){var kt=Oe[zt];return Ig(Ig({},Ge),{},{x:Gn(kt.x,Ge.x,rt),y:Gn(kt.y,Ge.y,rt)})}return Ge}),rt>0&&(m.current=yt,y.current=tt),Z.createElement(NC,{points:yt,baseLine:tt,needClip:t,clipPathId:i,props:o})}return rt>0&&(m.current=_,y.current=c),Z.createElement(Yo,null,M&&Z.createElement("defs",null,Z.createElement("clipPath",{id:"animationClipPath-".concat(i)},Z.createElement(I7,{alpha:rt,points:_,baseLine:c,layout:q,strokeWidth:o.strokeWidth}))),Z.createElement(Yo,{clipPath:"url(#animationClipPath-".concat(i,")")},Z.createElement(NC,{points:_,baseLine:c,needClip:t,clipPathId:i,props:o})))}),Z.createElement(gT,{label:o.label}))}function k7(e){var{needClip:t,clipPathId:i,props:o}=e,m=Z.useRef(null),y=Z.useRef();return Z.createElement(z7,{needClip:t,clipPathId:i,props:o,previousPointsRef:m,previousBaselineRef:y})}class R7 extends Z.PureComponent{render(){var{hide:t,dot:i,points:o,className:m,top:y,left:_,needClip:c,xAxisId:M,yAxisId:C,width:D,height:k,id:F,baseLine:G,zIndex:K}=this.props;if(t)return null;var W=Nn("recharts-area",m),q=F,{r:ue,strokeWidth:me}=qk(i),ge=yT(i),be=ue*2+me,ze=c?"url(#clipPath-".concat(ge?"":"dots-").concat(q,")"):void 0;return Z.createElement(Sl,{zIndex:K},Z.createElement(Yo,{className:W},c&&Z.createElement("defs",null,Z.createElement(TT,{clipPathId:q,xAxisId:M,yAxisId:C}),!ge&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(q)},Z.createElement("rect",{x:_-be/2,y:y-be/2,width:D+be,height:k+be}))),Z.createElement(k7,{needClip:c,clipPathId:q,props:this.props})),Z.createElement(k2,{points:o,mainColor:Fx(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:ze}),this.props.isRange&&Array.isArray(G)&&Z.createElement(k2,{points:G,mainColor:Fx(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:ze}))}}var Jk={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:"auto",legendType:"line",stroke:"#3182bd",strokeWidth:1,type:"linear",label:!1,xAxisId:0,yAxisId:0,zIndex:Da.area};function j7(e){var t,i=Ro(e,Jk),{activeDot:o,animationBegin:m,animationDuration:y,animationEasing:_,connectNulls:c,dot:M,fill:C,fillOpacity:D,hide:k,isAnimationActive:F,legendType:G,stroke:K,xAxisId:W,yAxisId:q}=i,ue=Qk(i,b7),me=qd(),ge=tk(),{needClip:be}=kb(W,q),ze=ao(),{points:Ae,isRange:Oe,baseLine:rt}=(t=dr(zt=>_7(zt,e.id,ze)))!==null&&t!==void 0?t:{},gt=zb();if(me!=="horizontal"&&me!=="vertical"||gt==null||ge!=="AreaChart"&&ge!=="ComposedChart")return null;var{height:yt,width:tt,x:Ge,y:Rt}=gt;return!Ae||!Ae.length?null:Z.createElement(R7,Yp({},ue,{activeDot:o,animationBegin:m,animationDuration:y,animationEasing:_,baseLine:rt,connectNulls:c,dot:M,fill:C,fillOpacity:D,height:yt,hide:k,layout:me,isAnimationActive:F==="auto"?!Qv.isSsr:F,isRange:Oe,legendType:G,needClip:be,points:Ae,stroke:K,width:tt,left:Ge,top:Rt,xAxisId:W,yAxisId:q}))}var L7=(e,t,i,o,m)=>{var y=i??t;if(Jt(y))return y;var _=e==="horizontal"?m:o,c=_.scale.domain();if(_.type==="number"){var M=Math.max(c[0],c[1]),C=Math.min(c[0],c[1]);return y==="dataMin"?C:y==="dataMax"||M<0?M:Math.max(Math.min(c[0],c[1]),0)}return y==="dataMin"?c[0]:y==="dataMax"?c[1]:c[0]};function N7(e){var{areaSettings:{connectNulls:t,baseValue:i,dataKey:o},stackedData:m,layout:y,chartBaseValue:_,xAxis:c,yAxis:M,displayedData:C,dataStartIndex:D,xAxisTicks:k,yAxisTicks:F,bandSize:G}=e,K=m&&m.length,W=L7(y,_,i,c,M),q=y==="horizontal",ue=!1,me=C.map((be,ze)=>{var Ae,Oe,rt,gt;if(K)gt=m[D+ze];else{var yt=Gi(be,o);Array.isArray(yt)?(gt=yt,ue=!0):gt=[W,yt]}var tt=(Ae=(Oe=gt)===null||Oe===void 0?void 0:Oe[1])!==null&&Ae!==void 0?Ae:null,Ge=tt==null||K&&!t&&Gi(be,o)==null;if(q){var Rt;return{x:ux({axis:c,ticks:k,bandSize:G,entry:be,index:ze}),y:Ge?null:(Rt=M.scale.map(tt))!==null&&Rt!==void 0?Rt:null,value:gt,payload:be}}return{x:Ge?null:(rt=c.scale.map(tt))!==null&&rt!==void 0?rt:null,y:ux({axis:M,ticks:F,bandSize:G,entry:be,index:ze}),value:gt,payload:be}}),ge;return K||ue?ge=me.map(be=>{var ze,Ae=Array.isArray(be.value)?be.value[0]:null;if(q){var Oe;return{x:be.x,y:Ae!=null&&be.y!=null&&(Oe=M.scale.map(Ae))!==null&&Oe!==void 0?Oe:null,payload:be.payload}}return{x:Ae!=null&&(ze=c.scale.map(Ae))!==null&&ze!==void 0?ze:null,y:be.y,payload:be.payload}}):ge=q?M.scale.map(W):c.scale.map(W),{points:me,baseLine:ge??0,isRange:ue}}function B7(e){var t=Ro(e,Jk),i=ao();return Z.createElement(xT,{id:t.id,type:"area"},o=>Z.createElement(Z.Fragment,null,Z.createElement(_T,{legendPayload:A7(t)}),Z.createElement(M7,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:o}),Z.createElement(bT,{type:"area",id:o,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:wO(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:i,connectNulls:t.connectNulls}),Z.createElement(j7,Yp({},t,{id:o}))))}var Xp=Z.memo(B7,f_);Xp.displayName="Area";var F7="Invariant failed";function U7(e,t){throw new Error(F7)}function R2(){return R2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},R2.apply(null,arguments)}function Ux(e){return Z.createElement(Ek,R2({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var V7=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(o,m)=>{if(Jt(t))return t;var y=Jt(o)||Ei(o);return y?t(o,m):(y||U7(),i)}},q7=(e,t,i)=>i,$7=(e,t)=>t,d_=st([o_,$7],(e,t)=>e.filter(i=>i.type==="bar").find(i=>i.id===t)),G7=st([d_],e=>e?.maxBarSize),Z7=(e,t,i,o)=>o,H7=st([xn,o_,ch,hh,q7],(e,t,i,o,m)=>t.filter(y=>e==="horizontal"?y.xAxisId===i:y.yAxisId===o).filter(y=>y.isPanorama===m).filter(y=>y.hide===!1).filter(y=>y.type==="bar")),W7=(e,t,i)=>{var o=xn(e),m=ch(e,t),y=hh(e,t);if(!(m==null||y==null))return o==="horizontal"?Ix(e,"yAxis",y,i):Ix(e,"xAxis",m,i)},Y7=(e,t)=>{var i=xn(e),o=ch(e,t),m=hh(e,t);if(!(o==null||m==null))return i==="horizontal"?SP(e,"xAxis",o):SP(e,"yAxis",m)},X7=st([H7,CF,Y7],f9),K7=(e,t,i)=>{var o,m,y=d_(e,t);if(y==null)return 0;var _=ch(e,t),c=hh(e,t);if(_==null||c==null)return 0;var M=xn(e),C=FI(e),{maxBarSize:D}=y,k=Ei(D)?C:D,F,G;return M==="horizontal"?(F=lh(e,"xAxis",_,i),G=sh(e,"xAxis",_,i)):(F=lh(e,"yAxis",c,i),G=sh(e,"yAxis",c,i)),(o=(m=Ud(F,G,!0))!==null&&m!==void 0?m:k)!==null&&o!==void 0?o:0},eR=(e,t,i)=>{var o=xn(e),m=ch(e,t),y=hh(e,t);if(!(m==null||y==null)){var _,c;return o==="horizontal"?(_=lh(e,"xAxis",m,i),c=sh(e,"xAxis",m,i)):(_=lh(e,"yAxis",y,i),c=sh(e,"yAxis",y,i)),Ud(_,c)}},Q7=st([X7,FI,PF,UI,K7,eR,G7],y9),J7=(e,t,i)=>{var o=ch(e,t);if(o!=null)return lh(e,"xAxis",o,i)},eZ=(e,t,i)=>{var o=hh(e,t);if(o!=null)return lh(e,"yAxis",o,i)},tZ=(e,t,i)=>{var o=ch(e,t);if(o!=null)return sh(e,"xAxis",o,i)},rZ=(e,t,i)=>{var o=hh(e,t);if(o!=null)return sh(e,"yAxis",o,i)},nZ=st([Q7,d_],_9),iZ=st([W7,d_],v9),aZ=st([io,cS,J7,eZ,tZ,rZ,nZ,xn,PI,eR,iZ,d_,Z7],(e,t,i,o,m,y,_,c,M,C,D,k,F)=>{var{chartData:G,dataStartIndex:K,dataEndIndex:W}=M;if(!(k==null||_==null||t==null||c!=="horizontal"&&c!=="vertical"||i==null||o==null||m==null||y==null||C==null)){var{data:q}=k,ue;if(q!=null&&q.length>0?ue=q:ue=G?.slice(K,W+1),ue!=null)return zZ({layout:c,barSettings:k,pos:_,parentViewBox:t,bandSize:C,xAxis:i,yAxis:o,xAxisTicks:m,yAxisTicks:y,stackedData:D,displayedData:ue,offset:e,cells:F,dataStartIndex:K})}}),oZ=["index"];function j2(){return j2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},j2.apply(null,arguments)}function sZ(e,t){if(e==null)return{};var i,o,m=lZ(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function lZ(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var tR=Z.createContext(void 0),uZ=e=>{var t=Z.useContext(tR);if(t!=null)return t.stackId;if(e!=null)return wO(e)},cZ=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),hZ=e=>{var t=Z.useContext(tR);if(t!=null){var{stackId:i}=t;return"url(#".concat(cZ(i,e),")")}},rR=e=>{var{index:t}=e,i=sZ(e,oZ),o=hZ(t);return Z.createElement(Yo,j2({className:"recharts-bar-stack-layer",clipPath:o},i))},fZ=["onMouseEnter","onMouseLeave","onClick"],dZ=["value","background","tooltipPosition"],pZ=["id"],mZ=["onMouseEnter","onClick","onMouseLeave"];function vf(){return vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},vf.apply(null,arguments)}function BC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function ys(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?BC(Object(i),!0).forEach(function(o){gZ(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):BC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function gZ(e,t,i){return(t=yZ(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yZ(e){var t=vZ(e,"string");return typeof t=="symbol"?t:t+""}function vZ(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vx(e,t){if(e==null)return{};var i,o,m=_Z(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function _Z(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var xZ=e=>{var{dataKey:t,name:i,fill:o,legendType:m,hide:y}=e;return[{inactive:y,dataKey:t,type:m,color:o,value:Gg(i,t),payload:e}]},bZ=Z.memo(e=>{var{dataKey:t,stroke:i,strokeWidth:o,fill:m,name:y,hide:_,unit:c,tooltipType:M,id:C}=e,D={dataDefinedOnItem:void 0,getPosition:Vd,settings:{stroke:i,strokeWidth:o,fill:m,dataKey:t,nameKey:void 0,name:Gg(y,t),hide:_,type:M,color:m,unit:c,graphicalItemId:C}};return Z.createElement(vT,{tooltipEntrySettings:D})});function wZ(e){var t=dr(am),{data:i,dataKey:o,background:m,allOtherBarProps:y}=e,{onMouseEnter:_,onMouseLeave:c,onClick:M}=y,C=Vx(y,fZ),D=Ak(_,o,y.id),k=Mk(c),F=Pk(M,o,y.id);if(!m||i==null)return null;var G=Gv(m);return Z.createElement(Sl,{zIndex:x9(m,Da.barBackground)},i.map((K,W)=>{var{value:q,background:ue,tooltipPosition:me}=K,ge=Vx(K,dZ);if(!ue)return null;var be=D(K,W),ze=k(K,W),Ae=F(K,W),Oe=ys(ys(ys(ys(ys({option:m,isActive:String(W)===t},ge),{},{fill:"#eee"},ue),G),eS(C,K,W)),{},{onMouseEnter:be,onMouseLeave:ze,onClick:Ae,dataKey:o,index:W,className:"recharts-bar-background-rectangle"});return Z.createElement(Ux,vf({key:"background-bar-".concat(W)},Oe))}))}function SZ(e){var{showLabels:t,children:i,rects:o}=e,m=o?.map(y=>{var _={x:y.x,y:y.y,width:y.width,lowerWidth:y.width,upperWidth:y.width,height:y.height};return ys(ys({},_),{},{value:y.value,payload:y.payload,parentViewBox:y.parentViewBox,viewBox:_,fill:y.fill})});return Z.createElement(mT,{value:t?m:void 0},i)}function TZ(e){var{shape:t,activeBar:i,baseProps:o,entry:m,index:y,dataKey:_}=e,c=dr(am),M=dr(Qz),C=i&&String(y)===c&&(M==null||_===M),D=C?i:t;return C?Z.createElement(Sl,{zIndex:Da.activeBar},Z.createElement(rR,{index:y},Z.createElement(Ux,vf({},o,{name:String(o.name)},m,{isActive:C,option:D,index:y,dataKey:_})))):Z.createElement(Ux,vf({},o,{name:String(o.name)},m,{isActive:C,option:D,index:y,dataKey:_}))}function EZ(e){var{shape:t,baseProps:i,entry:o,index:m,dataKey:y}=e;return Z.createElement(Ux,vf({},i,{name:String(i.name)},o,{isActive:!1,option:t,index:m,dataKey:y}))}function AZ(e){var t,{data:i,props:o}=e,m=(t=bl(o))!==null&&t!==void 0?t:{},{id:y}=m,_=Vx(m,pZ),{shape:c,dataKey:M,activeBar:C}=o,{onMouseEnter:D,onClick:k,onMouseLeave:F}=o,G=Vx(o,mZ),K=Ak(D,M,y),W=Mk(F),q=Pk(k,M,y);return i?Z.createElement(Z.Fragment,null,i.map((ue,me)=>Z.createElement(rR,vf({index:me,key:"rectangle-".concat(ue?.x,"-").concat(ue?.y,"-").concat(ue?.value,"-").concat(me),className:"recharts-bar-rectangle"},eS(G,ue,me),{onMouseEnter:K(ue,me),onMouseLeave:W(ue,me),onClick:q(ue,me)}),C?Z.createElement(TZ,{shape:c,activeBar:C,baseProps:_,entry:ue,index:me,dataKey:M}):Z.createElement(EZ,{shape:c,baseProps:_,entry:ue,index:me,dataKey:M})))):null}function MZ(e){var{props:t,previousRectanglesRef:i}=e,{data:o,layout:m,isAnimationActive:y,animationBegin:_,animationDuration:c,animationEasing:M,onAnimationEnd:C,onAnimationStart:D}=t,k=i.current,F=e_(t,"recharts-bar-"),[G,K]=Z.useState(!1),W=!G,q=Z.useCallback(()=>{typeof C=="function"&&C(),K(!1)},[C]),ue=Z.useCallback(()=>{typeof D=="function"&&D(),K(!0)},[D]);return Z.createElement(SZ,{showLabels:W,rects:o},Z.createElement(Jv,{animationId:F,begin:_,duration:c,isActive:y,easing:M,onAnimationEnd:q,onAnimationStart:ue,key:F},me=>{var ge=me===1?o:o?.map((be,ze)=>{var Ae=k&&k[ze];if(Ae)return ys(ys({},be),{},{x:Gn(Ae.x,be.x,me),y:Gn(Ae.y,be.y,me),width:Gn(Ae.width,be.width,me),height:Gn(Ae.height,be.height,me)});if(m==="horizontal"){var Oe=Gn(0,be.height,me),rt=Gn(be.stackedBarStart,be.y,me);return ys(ys({},be),{},{y:rt,height:Oe})}var gt=Gn(0,be.width,me),yt=Gn(be.stackedBarStart,be.x,me);return ys(ys({},be),{},{width:gt,x:yt})});return me>0&&(i.current=ge??null),ge==null?null:Z.createElement(Yo,null,Z.createElement(AZ,{props:t,data:ge}))}),Z.createElement(gT,{label:t.label}),t.children)}function PZ(e){var t=Z.useRef(null);return Z.createElement(MZ,{previousRectanglesRef:t,props:e})}var nR=0,CZ=(e,t)=>{var i=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:i,errorVal:Gi(e,t)}};class DZ extends Z.PureComponent{render(){var{hide:t,data:i,dataKey:o,className:m,xAxisId:y,yAxisId:_,needClip:c,background:M,id:C}=this.props;if(t||i==null)return null;var D=Nn("recharts-bar",m),k=C;return Z.createElement(Yo,{className:D,id:C},c&&Z.createElement("defs",null,Z.createElement(TT,{clipPathId:k,xAxisId:y,yAxisId:_})),Z.createElement(Yo,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(k,")"):void 0},Z.createElement(wZ,{data:i,dataKey:o,background:M,allOtherBarProps:this.props}),Z.createElement(PZ,this.props)))}}var OZ={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:nR,xAxisId:0,yAxisId:0,zIndex:Da.bar};function IZ(e){var{xAxisId:t,yAxisId:i,hide:o,legendType:m,minPointSize:y,activeBar:_,animationBegin:c,animationDuration:M,animationEasing:C,isAnimationActive:D}=e,{needClip:k}=kb(t,i),F=qd(),G=ao(),K=c$(e.children,uk),W=dr(me=>aZ(me,e.id,G,K));if(F!=="vertical"&&F!=="horizontal")return null;var q,ue=W?.[0];return ue==null||ue.height==null||ue.width==null?q=0:q=F==="vertical"?ue.height/2:ue.width/2,Z.createElement(Nk,{xAxisId:t,yAxisId:i,data:W,dataPointFormatter:CZ,errorBarOffset:q},Z.createElement(DZ,vf({},e,{layout:F,needClip:k,data:W,xAxisId:t,yAxisId:i,hide:o,legendType:m,minPointSize:y,activeBar:_,animationBegin:c,animationDuration:M,animationEasing:C,isAnimationActive:D})))}function zZ(e){var{layout:t,barSettings:{dataKey:i,minPointSize:o},pos:m,bandSize:y,xAxis:_,yAxis:c,xAxisTicks:M,yAxisTicks:C,stackedData:D,displayedData:k,offset:F,cells:G,parentViewBox:K,dataStartIndex:W}=e,q=t==="horizontal"?c:_,ue=D?q.scale.domain():null,me=E5({numericAxis:q}),ge=q.scale.map(me);return k.map((be,ze)=>{var Ae,Oe,rt,gt,yt,tt;if(D){var Ge=D[ze+W];if(Ge==null)return null;Ae=x5(Ge,ue)}else Ae=Gi(be,i),Array.isArray(Ae)||(Ae=[me,Ae]);var Rt=V7(o,nR)(Ae[1],ze);if(t==="horizontal"){var zt,kt=c.scale.map(Ae[0]),Ue=c.scale.map(Ae[1]);if(kt==null||Ue==null)return null;Oe=TA({axis:_,ticks:M,bandSize:y,offset:m.offset,entry:be,index:ze}),rt=(zt=Ue??kt)!==null&&zt!==void 0?zt:void 0,gt=m.size;var at=kt-Ue;if(yt=sc(at)?0:at,tt={x:Oe,y:F.top,width:gt,height:F.height},Math.abs(Rt)>0&&Math.abs(yt)<Math.abs(Rt)){var pt=Vs(yt||Rt)*(Math.abs(Rt)-Math.abs(yt));rt-=pt,yt+=pt}}else{var bt=_.scale.map(Ae[0]),Ut=_.scale.map(Ae[1]);if(bt==null||Ut==null)return null;if(Oe=bt,rt=TA({axis:c,ticks:C,bandSize:y,offset:m.offset,entry:be,index:ze}),gt=Ut-bt,yt=m.size,tt={x:F.left,y:rt,width:F.width,height:yt},Math.abs(Rt)>0&&Math.abs(gt)<Math.abs(Rt)){var Ce=Vs(gt||Rt)*(Math.abs(Rt)-Math.abs(gt));gt+=Ce}}if(Oe==null||rt==null||gt==null||yt==null)return null;var nt=ys(ys({},be),{},{stackedBarStart:ge,x:Oe,y:rt,width:gt,height:yt,value:D?Ae:Ae[1],payload:be,background:tt,tooltipPosition:{x:Oe+gt/2,y:rt+yt/2},parentViewBox:K},G&&G[ze]&&G[ze].props);return nt}).filter(Boolean)}function kZ(e){var t=Ro(e,OZ),i=uZ(t.stackId),o=ao();return Z.createElement(xT,{id:t.id,type:"bar"},m=>Z.createElement(Z.Fragment,null,Z.createElement(_T,{legendPayload:xZ(t)}),Z.createElement(bZ,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:m}),Z.createElement(bT,{type:"bar",id:m,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:i,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:o}),Z.createElement(Sl,{zIndex:t.zIndex},Z.createElement(IZ,vf({},t,{id:m})))))}var AT=Z.memo(kZ,f_);AT.displayName="Bar";var RZ=["domain","range"],jZ=["domain","range"];function FC(e,t){if(e==null)return{};var i,o,m=LZ(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function LZ(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function UC(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function iR(e,t){if(e===t)return!0;var{domain:i,range:o}=e,m=FC(e,RZ),{domain:y,range:_}=t,c=FC(t,jZ);return!UC(i,y)||!UC(o,_)?!1:f_(m,c)}var NZ=["type"],BZ=["dangerouslySetInnerHTML","ticks","scale"],FZ=["id","scale"];function L2(){return L2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},L2.apply(null,arguments)}function VC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function qC(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?VC(Object(i),!0).forEach(function(o){UZ(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):VC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function UZ(e,t,i){return(t=VZ(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function VZ(e){var t=qZ(e,"string");return typeof t=="symbol"?t:t+""}function qZ(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N2(e,t){if(e==null)return{};var i,o,m=$Z(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function $Z(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function GZ(e){var t=ea(),i=Z.useRef(null),o=dS(),{type:m}=e,y=N2(e,NZ),_=bb(o,"xAxis",m),c=Z.useMemo(()=>{if(_!=null)return qC(qC({},y),{},{type:_})},[y,_]);return Z.useLayoutEffect(()=>{c!=null&&(i.current===null?t(K$(c)):i.current!==c&&t(Q$({prev:i.current,next:c})),i.current=c)},[c,t]),Z.useLayoutEffect(()=>()=>{i.current&&(t(J$(i.current)),i.current=null)},[t]),null}var ZZ=e=>{var{xAxisId:t,className:i}=e,o=dr(cS),m=ao(),y="xAxis",_=dr(ue=>Oz(ue,y,t,m)),c=dr(ue=>Mz(ue,t)),M=dr(ue=>O8(ue,t)),C=dr(ue=>XI(ue,t));if(c==null||M==null||C==null)return null;var{dangerouslySetInnerHTML:D,ticks:k,scale:F}=e,G=N2(e,BZ),{id:K,scale:W}=C,q=N2(C,FZ);return Z.createElement(ST,L2({},G,q,{x:M.x,y:M.y,width:c.width,height:c.height,className:Nn("recharts-".concat(y," ").concat(y),i),viewBox:o,ticks:_,axisType:y}))},HZ={allowDataOverflow:to.allowDataOverflow,allowDecimals:to.allowDecimals,allowDuplicatedCategory:to.allowDuplicatedCategory,angle:to.angle,axisLine:hf.axisLine,height:to.height,hide:!1,includeHidden:to.includeHidden,interval:to.interval,label:!1,minTickGap:to.minTickGap,mirror:to.mirror,orientation:to.orientation,padding:to.padding,reversed:to.reversed,scale:to.scale,tick:to.tick,tickCount:to.tickCount,tickLine:hf.tickLine,tickSize:hf.tickSize,type:to.type,xAxisId:0},WZ=e=>{var t=Ro(e,HZ);return Z.createElement(Z.Fragment,null,Z.createElement(GZ,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),Z.createElement(ZZ,t))},Kp=Z.memo(WZ,iR);Kp.displayName="XAxis";var YZ=["type"],XZ=["dangerouslySetInnerHTML","ticks","scale"],KZ=["id","scale"];function B2(){return B2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},B2.apply(null,arguments)}function $C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function GC(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?$C(Object(i),!0).forEach(function(o){QZ(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$C(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function QZ(e,t,i){return(t=JZ(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function JZ(e){var t=eH(e,"string");return typeof t=="symbol"?t:t+""}function eH(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F2(e,t){if(e==null)return{};var i,o,m=tH(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function tH(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function rH(e){var t=ea(),i=Z.useRef(null),o=dS(),{type:m}=e,y=F2(e,YZ),_=bb(o,"yAxis",m),c=Z.useMemo(()=>{if(_!=null)return GC(GC({},y),{},{type:_})},[_,y]);return Z.useLayoutEffect(()=>{c!=null&&(i.current===null?t(e9(c)):i.current!==c&&t(t9({prev:i.current,next:c})),i.current=c)},[c,t]),Z.useLayoutEffect(()=>()=>{i.current&&(t(r9(i.current)),i.current=null)},[t]),null}function nH(e){var{yAxisId:t,className:i,width:o,label:m}=e,y=Z.useRef(null),_=Z.useRef(null),c=dr(cS),M=ao(),C=ea(),D="yAxis",k=dr(Ae=>Pz(Ae,t)),F=dr(Ae=>z8(Ae,t)),G=dr(Ae=>Oz(Ae,D,t,M)),K=dr(Ae=>KI(Ae,t));if(Z.useLayoutEffect(()=>{if(!(o!=="auto"||!k||pT(m)||Z.isValidElement(m)||K==null)){var Ae=y.current;if(Ae){var Oe=Ae.getCalculatedWidth();Math.round(k.width)!==Math.round(Oe)&&C(n9({id:t,width:Oe}))}}},[G,k,C,m,t,o,K]),k==null||F==null||K==null)return null;var{dangerouslySetInnerHTML:W,ticks:q,scale:ue}=e,me=F2(e,XZ),{id:ge,scale:be}=K,ze=F2(K,KZ);return Z.createElement(ST,B2({},me,ze,{ref:y,labelRef:_,x:F.x,y:F.y,tickTextProps:o==="auto"?{width:void 0}:{width:o},width:k.width,height:k.height,className:Nn("recharts-".concat(D," ").concat(D),i),viewBox:c,ticks:G,axisType:D}))}var iH={allowDataOverflow:ro.allowDataOverflow,allowDecimals:ro.allowDecimals,allowDuplicatedCategory:ro.allowDuplicatedCategory,angle:ro.angle,axisLine:hf.axisLine,hide:!1,includeHidden:ro.includeHidden,interval:ro.interval,label:!1,minTickGap:ro.minTickGap,mirror:ro.mirror,orientation:ro.orientation,padding:ro.padding,reversed:ro.reversed,scale:ro.scale,tick:ro.tick,tickCount:ro.tickCount,tickLine:hf.tickLine,tickSize:hf.tickSize,type:ro.type,width:ro.width,yAxisId:0},aH=e=>{var t=Ro(e,iH);return Z.createElement(Z.Fragment,null,Z.createElement(rH,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),Z.createElement(nH,t))},Qp=Z.memo(aH,iR);Qp.displayName="YAxis";var oH=(e,t)=>t,MT=st([oH,xn,WI,lo,Wz,Ef,HU,io],eV),PT=e=>{var t=e.currentTarget.getBoundingClientRect(),i=t.width/e.currentTarget.offsetWidth,o=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/i),chartY:Math.round((e.clientY-t.top)/o)}},aR=cu("mouseClick"),oR=Wv();oR.startListening({actionCreator:aR,effect:(e,t)=>{var i=e.payload,o=MT(t.getState(),PT(i));o?.activeIndex!=null&&t.dispatch(H8({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}});var U2=cu("mouseMove"),sR=Wv(),N0=null;sR.startListening({actionCreator:U2,effect:(e,t)=>{var i=e.payload;N0!==null&&cancelAnimationFrame(N0);var o=PT(i);N0=requestAnimationFrame(()=>{var m=t.getState(),y=nT(m,m.tooltip.settings.shared);if(y==="axis"){var _=MT(m,o);_?.activeIndex!=null?t.dispatch(Bz({activeIndex:_.activeIndex,activeDataKey:void 0,activeCoordinate:_.activeCoordinate})):t.dispatch(Nz())}N0=null})}});function sH(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var ZC={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},lR=Gs({name:"rootProps",initialState:ZC,reducers:{updateOptions:(e,t)=>{var i;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(i=t.payload.barGap)!==null&&i!==void 0?i:ZC.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),lH=lR.reducer,{updateOptions:uH}=lR.actions,cH=null,hH={updatePolarOptions:(e,t)=>t.payload},uR=Gs({name:"polarOptions",initialState:cH,reducers:hH}),{updatePolarOptions:xY}=uR.actions,fH=uR.reducer,cR=cu("keyDown"),hR=cu("focus"),CT=Wv();CT.startListening({actionCreator:cR,effect:(e,t)=>{var i=t.getState(),o=i.rootProps.accessibilityLayer!==!1;if(o){var{keyboardInteraction:m}=i.tooltip,y=e.payload;if(!(y!=="ArrowRight"&&y!=="ArrowLeft"&&y!=="Enter")){var _=iT(m,ey(i),l_(i),c_(i)),c=_==null?-1:Number(_);if(!(!Number.isFinite(c)||c<0)){var M=Ef(i);if(y==="Enter"){var C=kx(i,"axis","hover",String(m.index));t.dispatch(C2({active:!m.active,activeIndex:m.index,activeCoordinate:C}));return}var D=L8(i),k=D==="left-to-right"?1:-1,F=y==="ArrowRight"?1:-1,G=c+F*k;if(!(M==null||G>=M.length||G<0)){var K=kx(i,"axis","hover",String(G));t.dispatch(C2({active:!0,activeIndex:G.toString(),activeCoordinate:K}))}}}}}});CT.startListening({actionCreator:hR,effect:(e,t)=>{var i=t.getState(),o=i.rootProps.accessibilityLayer!==!1;if(o){var{keyboardInteraction:m}=i.tooltip;if(!m.active&&m.index==null){var y="0",_=kx(i,"axis","hover",String(y));t.dispatch(C2({active:!0,activeIndex:y,activeCoordinate:_}))}}}});var lu=cu("externalEvent"),fR=Wv(),Bw=new Map;fR.startListening({actionCreator:lu,effect:(e,t)=>{var{handler:i,reactEvent:o}=e.payload;if(i!=null){o.persist();var m=o.type,y=Bw.get(m);y!==void 0&&cancelAnimationFrame(y);var _=requestAnimationFrame(()=>{try{var c=t.getState(),M={activeCoordinate:IU(c),activeDataKey:Qz(c),activeIndex:am(c),activeLabel:Kz(c),activeTooltipIndex:am(c),isTooltipActive:zU(c)};i(M,o)}finally{Bw.delete(m)}});Bw.set(m,_)}}});var dH=st([Qg],e=>e.tooltipItemPayloads),pH=st([dH,(e,t)=>t,(e,t,i)=>i],(e,t,i)=>{if(t!=null){var o=e.find(y=>y.settings.graphicalItemId===i);if(o!=null){var{getPosition:m}=o;if(m!=null)return m(t)}}}),dR=cu("touchMove"),pR=Wv();pR.startListening({actionCreator:dR,effect:(e,t)=>{var i=e.payload;if(!(i.touches==null||i.touches.length===0)){var o=t.getState(),m=nT(o,o.tooltip.settings.shared);if(m==="axis"){var y=i.touches[0];if(y==null)return;var _=MT(o,PT({clientX:y.clientX,clientY:y.clientY,currentTarget:i.currentTarget}));_?.activeIndex!=null&&t.dispatch(Bz({activeIndex:_.activeIndex,activeDataKey:void 0,activeCoordinate:_.activeCoordinate}))}else if(m==="item"){var c,M=i.touches[0];if(document.elementFromPoint==null||M==null)return;var C=document.elementFromPoint(M.clientX,M.clientY);if(!C||!C.getAttribute)return;var D=C.getAttribute(I5),k=(c=C.getAttribute(z5))!==null&&c!==void 0?c:void 0,F=Jg(o).find(W=>W.id===k);if(D==null||F==null||k==null)return;var{dataKey:G}=F,K=pH(o,D,k);t.dispatch(Lz({activeDataKey:G,activeIndex:D,activeCoordinate:K,activeGraphicalItemId:k}))}}}});var mH=GD({brush:w9,cartesianAxis:i9,chartData:OV,errorBars:gG,graphicalItems:L$,layout:m5,legend:TN,options:AV,polarAxis:a$,polarOptions:fH,referenceElements:A9,rootProps:lH,tooltip:W8,zIndex:pV}),gH=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return FL({reducer:mH,preloadedState:t,middleware:o=>{var m;return o({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((m="es6")!==null&&m!==void 0?m:"")}).concat([oR.middleware,sR.middleware,CT.middleware,fR.middleware,pR.middleware])},enhancers:o=>{var m=o;return typeof o=="function"&&(m=o()),m.concat(oO({type:"raf"}))},devTools:{serialize:{replacer:sH},name:"recharts-".concat(i)}})};function yH(e){var{preloadedState:t,children:i,reduxStoreName:o}=e,m=ao(),y=Z.useRef(null);if(m)return i;y.current==null&&(y.current=gH(t,o));var _=nS;return Z.createElement($G,{context:_,store:y.current},i)}function vH(e){var{layout:t,margin:i}=e,o=ea(),m=ao();return Z.useEffect(()=>{m||(o(f5(t)),o(h5(i)))},[o,m,t,i]),null}var _H=Z.memo(vH,f_);function xH(e){var t=ea();return Z.useEffect(()=>{t(uH(e))},[t,e]),null}function HC(e){var{zIndex:t,isPanorama:i}=e,o=Z.useRef(null),m=ea();return Z.useLayoutEffect(()=>(o.current&&m(fV({zIndex:t,element:o.current,isPanorama:i})),()=>{m(dV({zIndex:t,isPanorama:i}))}),[m,t,i]),Z.createElement("g",{tabIndex:-1,ref:o})}function WC(e){var{children:t,isPanorama:i}=e,o=dr(rV);if(!o||o.length===0)return t;var m=o.filter(_=>_<0),y=o.filter(_=>_>0);return Z.createElement(Z.Fragment,null,m.map(_=>Z.createElement(HC,{key:_,zIndex:_,isPanorama:i})),t,y.map(_=>Z.createElement(HC,{key:_,zIndex:_,isPanorama:i})))}var bH=["children"];function wH(e,t){if(e==null)return{};var i,o,m=SH(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function SH(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}function qx(){return qx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},qx.apply(null,arguments)}var TH={width:"100%",height:"100%",display:"block"},EH=Z.forwardRef((e,t)=>{var i=PO(),o=CO(),m=NO();if(!ah(i)||!ah(o))return null;var{children:y,otherAttributes:_,title:c,desc:M}=e,C,D;return _!=null&&(typeof _.tabIndex=="number"?C=_.tabIndex:C=m?0:void 0,typeof _.role=="string"?D=_.role:D=m?"application":void 0),Z.createElement(lD,qx({},_,{title:c,desc:M,role:D,tabIndex:C,width:i,height:o,style:TH,ref:t}),y)}),AH=e=>{var{children:t}=e,i=dr(lb);if(!i)return null;var{width:o,height:m,y,x:_}=i;return Z.createElement(lD,{width:o,height:m,x:_,y},t)},YC=Z.forwardRef((e,t)=>{var{children:i}=e,o=wH(e,bH),m=ao();return m?Z.createElement(AH,null,Z.createElement(WC,{isPanorama:!0},i)):Z.createElement(EH,qx({ref:t},o),Z.createElement(WC,{isPanorama:!1},i))});function MH(){var e=ea(),[t,i]=Z.useState(null),o=dr(O5);return Z.useEffect(()=>{if(t!=null){var m=t.getBoundingClientRect(),y=m.width/t.offsetWidth;$r(y)&&y!==o&&e(p5(y))}},[t,e,o]),i}function XC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),i.push.apply(i,o)}return i}function PH(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?XC(Object(i),!0).forEach(function(o){CH(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):XC(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function CH(e,t,i){return(t=DH(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function DH(e){var t=OH(e,"string");return typeof t=="symbol"?t:t+""}function OH(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var o=i.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fd(){return Fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Fd.apply(null,arguments)}var IH=()=>(FV(),null);function $x(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var zH=Z.forwardRef((e,t)=>{var i,o,m=Z.useRef(null),[y,_]=Z.useState({containerWidth:$x((i=e.style)===null||i===void 0?void 0:i.width),containerHeight:$x((o=e.style)===null||o===void 0?void 0:o.height)}),c=Z.useCallback((C,D)=>{_(k=>{var F=Math.round(C),G=Math.round(D);return k.containerWidth===F&&k.containerHeight===G?k:{containerWidth:F,containerHeight:G}})},[]),M=Z.useCallback(C=>{if(typeof t=="function"&&t(C),C!=null&&typeof ResizeObserver<"u"){var{width:D,height:k}=C.getBoundingClientRect();c(D,k);var F=K=>{var W=K[0];if(W!=null){var{width:q,height:ue}=W.contentRect;c(q,ue)}},G=new ResizeObserver(F);G.observe(C),m.current=G}},[t,c]);return Z.useEffect(()=>()=>{var C=m.current;C?.disconnect()},[c]),Z.createElement(Z.Fragment,null,Z.createElement(Xv,{width:y.containerWidth,height:y.containerHeight}),Z.createElement("div",Fd({ref:M},e)))}),kH=Z.forwardRef((e,t)=>{var{width:i,height:o}=e,[m,y]=Z.useState({containerWidth:$x(i),containerHeight:$x(o)}),_=Z.useCallback((M,C)=>{y(D=>{var k=Math.round(M),F=Math.round(C);return D.containerWidth===k&&D.containerHeight===F?D:{containerWidth:k,containerHeight:F}})},[]),c=Z.useCallback(M=>{if(typeof t=="function"&&t(M),M!=null){var{width:C,height:D}=M.getBoundingClientRect();_(C,D)}},[t,_]);return Z.createElement(Z.Fragment,null,Z.createElement(Xv,{width:m.containerWidth,height:m.containerHeight}),Z.createElement("div",Fd({ref:c},e)))}),RH=Z.forwardRef((e,t)=>{var{width:i,height:o}=e;return Z.createElement(Z.Fragment,null,Z.createElement(Xv,{width:i,height:o}),Z.createElement("div",Fd({ref:t},e)))}),jH=Z.forwardRef((e,t)=>{var{width:i,height:o}=e;return typeof i=="string"||typeof o=="string"?Z.createElement(kH,Fd({},e,{ref:t})):typeof i=="number"&&typeof o=="number"?Z.createElement(RH,Fd({},e,{width:i,height:o,ref:t})):Z.createElement(Z.Fragment,null,Z.createElement(Xv,{width:i,height:o}),Z.createElement("div",Fd({ref:t},e)))});function LH(e){return e?zH:jH}var NH=Z.forwardRef((e,t)=>{var{children:i,className:o,height:m,onClick:y,onContextMenu:_,onDoubleClick:c,onMouseDown:M,onMouseEnter:C,onMouseLeave:D,onMouseMove:k,onMouseUp:F,onTouchEnd:G,onTouchMove:K,onTouchStart:W,style:q,width:ue,responsive:me,dispatchTouchEvents:ge=!0}=e,be=Z.useRef(null),ze=ea(),[Ae,Oe]=Z.useState(null),[rt,gt]=Z.useState(null),yt=MH(),tt=hS(),Ge=tt?.width>0?tt.width:ue,Rt=tt?.height>0?tt.height:m,zt=Z.useCallback(ft=>{yt(ft),typeof t=="function"&&t(ft),Oe(ft),gt(ft),ft!=null&&(be.current=ft)},[yt,t,Oe,gt]),kt=Z.useCallback(ft=>{ze(aR(ft)),ze(lu({handler:y,reactEvent:ft}))},[ze,y]),Ue=Z.useCallback(ft=>{ze(U2(ft)),ze(lu({handler:C,reactEvent:ft}))},[ze,C]),at=Z.useCallback(ft=>{ze(Nz()),ze(lu({handler:D,reactEvent:ft}))},[ze,D]),pt=Z.useCallback(ft=>{ze(U2(ft)),ze(lu({handler:k,reactEvent:ft}))},[ze,k]),bt=Z.useCallback(()=>{ze(hR())},[ze]),Ut=Z.useCallback(ft=>{ze(cR(ft.key))},[ze]),Ce=Z.useCallback(ft=>{ze(lu({handler:_,reactEvent:ft}))},[ze,_]),nt=Z.useCallback(ft=>{ze(lu({handler:c,reactEvent:ft}))},[ze,c]),Be=Z.useCallback(ft=>{ze(lu({handler:M,reactEvent:ft}))},[ze,M]),lt=Z.useCallback(ft=>{ze(lu({handler:F,reactEvent:ft}))},[ze,F]),Ft=Z.useCallback(ft=>{ze(lu({handler:W,reactEvent:ft}))},[ze,W]),Lt=Z.useCallback(ft=>{ge&&ze(dR(ft)),ze(lu({handler:K,reactEvent:ft}))},[ze,ge,K]),Vt=Z.useCallback(ft=>{ze(lu({handler:G,reactEvent:ft}))},[ze,G]),yr=LH(me);return Z.createElement(ok.Provider,{value:Ae},Z.createElement(x3.Provider,{value:rt},Z.createElement(yr,{width:Ge??q?.width,height:Rt??q?.height,className:Nn("recharts-wrapper",o),style:PH({position:"relative",cursor:"default",width:Ge,height:Rt},q),onClick:kt,onContextMenu:Ce,onDoubleClick:nt,onFocus:bt,onKeyDown:Ut,onMouseDown:Be,onMouseEnter:Ue,onMouseLeave:at,onMouseMove:pt,onMouseUp:lt,onTouchEnd:Vt,onTouchMove:Lt,onTouchStart:Ft,ref:zt},Z.createElement(IH,null),i)))}),BH=["width","height","responsive","children","className","style","compact","title","desc"];function FH(e,t){if(e==null)return{};var i,o,m=UH(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(o=0;o<y.length;o++)i=y[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(m[i]=e[i])}return m}function UH(e,t){if(e==null)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;i[o]=e[o]}return i}var VH=Z.forwardRef((e,t)=>{var{width:i,height:o,responsive:m,children:y,className:_,style:c,compact:M,title:C,desc:D}=e,k=FH(e,BH),F=bl(k);return M?Z.createElement(Z.Fragment,null,Z.createElement(Xv,{width:i,height:o}),Z.createElement(YC,{otherAttributes:F,title:C,desc:D},y)):Z.createElement(NH,{className:_,style:c,width:i,height:o,responsive:m??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},Z.createElement(YC,{otherAttributes:F,title:C,desc:D,ref:t},Z.createElement(P9,null,y)))});function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},V2.apply(null,arguments)}var qH={top:5,right:5,bottom:5,left:5},$H={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:qH,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Rb=Z.forwardRef(function(t,i){var o,m=Ro(t.categoricalChartProps,$H),{chartName:y,defaultTooltipEventType:_,validateTooltipEventTypes:c,tooltipPayloadSearcher:M,categoricalChartProps:C}=t,D={chartName:y,defaultTooltipEventType:_,validateTooltipEventTypes:c,tooltipPayloadSearcher:M,eventEmitter:void 0};return Z.createElement(yH,{preloadedState:{options:D},reduxStoreName:(o=C.id)!==null&&o!==void 0?o:y},Z.createElement(b9,{chartData:C.data}),Z.createElement(_H,{layout:m.layout,margin:m.margin}),Z.createElement(xH,{baseValue:m.baseValue,accessibilityLayer:m.accessibilityLayer,barCategoryGap:m.barCategoryGap,maxBarSize:m.maxBarSize,stackOffset:m.stackOffset,barGap:m.barGap,barSize:m.barSize,syncId:m.syncId,syncMethod:m.syncMethod,className:m.className,reverseStackOrder:m.reverseStackOrder}),Z.createElement(VH,V2({},m,{ref:i})))}),GH=["axis"],ZH=Z.forwardRef((e,t)=>Z.createElement(Rb,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:GH,tooltipPayloadSearcher:Ib,categoricalChartProps:e,ref:t})),HH=["axis","item"],WH=Z.forwardRef((e,t)=>Z.createElement(Rb,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:HH,tooltipPayloadSearcher:Ib,categoricalChartProps:e,ref:t})),YH=["axis"],q2=Z.forwardRef((e,t)=>Z.createElement(Rb,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:YH,tooltipPayloadSearcher:Ib,categoricalChartProps:e,ref:t})),XH=["axis"],KH=Z.forwardRef((e,t)=>Z.createElement(Rb,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:XH,tooltipPayloadSearcher:Ib,categoricalChartProps:e,ref:t})),Lg=Math.pow,zo=(e,t,i)=>new Promise((o,m)=>{var y=M=>{try{c(i.next(M))}catch(C){m(C)}},_=M=>{try{c(i.throw(M))}catch(C){m(C)}},c=M=>M.done?o(M.value):Promise.resolve(M.value).then(y,_);c((i=i.apply(e,t)).next())}),vl=Uint8Array,Mv=Uint16Array,QH=Int32Array,mR=new vl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gR=new vl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),JH=new vl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yR=function(e,t){for(var i=new Mv(31),o=0;o<31;++o)i[o]=t+=1<<e[o-1];for(var m=new QH(i[30]),o=1;o<30;++o)for(var y=i[o];y<i[o+1];++y)m[y]=y-i[o]<<5|o;return{b:i,r:m}},vR=yR(mR,2),_R=vR.b,eW=vR.r;_R[28]=258,eW[258]=28;var tW=yR(gR,0),rW=tW.b,xR=new Mv(32768);for(Pn=0;Pn<32768;++Pn)nf=(Pn&43690)>>1|(Pn&21845)<<1,nf=(nf&52428)>>2|(nf&13107)<<2,nf=(nf&61680)>>4|(nf&3855)<<4,xR[Pn]=((nf&65280)>>8|(nf&255)<<8)>>1;var nf,Pn,Pv=function(e,t,i){for(var o=e.length,m=0,y=new Mv(t);m<o;++m)e[m]&&++y[e[m]-1];var _=new Mv(t);for(m=1;m<t;++m)_[m]=_[m-1]+y[m-1]<<1;var c;{c=new Mv(1<<t);var M=15-t;for(m=0;m<o;++m)if(e[m])for(var C=m<<4|e[m],D=t-e[m],k=_[e[m]-1]++<<D,F=k|(1<<D)-1;k<=F;++k)c[xR[k]>>M]=C}return c},p_=new vl(288);for(Pn=0;Pn<144;++Pn)p_[Pn]=8;var Pn;for(Pn=144;Pn<256;++Pn)p_[Pn]=9;var Pn;for(Pn=256;Pn<280;++Pn)p_[Pn]=7;var Pn;for(Pn=280;Pn<288;++Pn)p_[Pn]=8;var Pn,bR=new vl(32);for(Pn=0;Pn<32;++Pn)bR[Pn]=5;var Pn,nW=Pv(p_,9),iW=Pv(bR,5),Fw=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},tc=function(e,t,i){var o=t/8|0;return(e[o]|e[o+1]<<8)>>(t&7)&i},Uw=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(t&7)},aW=function(e){return(e+7)/8|0},oW=function(e,t,i){(i==null||i>e.length)&&(i=e.length);var o=new vl(i-t);return o.set(e.subarray(t,i)),o},sW=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],gl=function(e,t,i){var o=new Error(t||sW[e]);if(o.code=e,Error.captureStackTrace&&Error.captureStackTrace(o,gl),!i)throw o;return o},DT=function(e,t,i,o){var m=e.length,y=0;if(!m||t.f&&!t.l)return i||new vl(0);var _=!i||t.i!=2,c=t.i;i||(i=new vl(m*3));var M=function(tr){var pr=i.length;if(tr>pr){var Tt=new vl(Math.max(pr*2,tr));Tt.set(i),i=Tt}},C=t.f||0,D=t.p||0,k=t.b||0,F=t.l,G=t.d,K=t.m,W=t.n,q=m*8;do{if(!F){C=tc(e,D,1);var ue=tc(e,D+1,3);if(D+=3,ue)if(ue==1)F=nW,G=iW,K=9,W=5;else if(ue==2){var ze=tc(e,D,31)+257,Ae=tc(e,D+10,15)+4,Oe=ze+tc(e,D+5,31)+1;D+=14;for(var rt=new vl(Oe),gt=new vl(19),yt=0;yt<Ae;++yt)gt[JH[yt]]=tc(e,D+yt*3,7);D+=Ae*3;for(var tt=Fw(gt),Ge=(1<<tt)-1,Rt=Pv(gt,tt),yt=0;yt<Oe;){var zt=Rt[tc(e,D,Ge)];D+=zt&15;var me=zt>>4;if(me<16)rt[yt++]=me;else{var kt=0,Ue=0;for(me==16?(Ue=3+tc(e,D,3),D+=2,kt=rt[yt-1]):me==17?(Ue=3+tc(e,D,7),D+=3):me==18&&(Ue=11+tc(e,D,127),D+=7);Ue--;)rt[yt++]=kt}}var at=rt.subarray(0,ze),pt=rt.subarray(ze);K=Fw(at),W=Fw(pt),F=Pv(at,K),G=Pv(pt,W)}else gl(1);else{var me=aW(D)+4,ge=e[me-4]|e[me-3]<<8,be=me+ge;if(be>m){c&&gl(0);break}_&&M(k+ge),i.set(e.subarray(me,be),k),t.b=k+=ge,t.p=D=be*8,t.f=C;continue}if(D>q){c&&gl(0);break}}_&&M(k+131072);for(var bt=(1<<K)-1,Ut=(1<<W)-1,Ce=D;;Ce=D){var kt=F[Uw(e,D)&bt],nt=kt>>4;if(D+=kt&15,D>q){c&&gl(0);break}if(kt||gl(2),nt<256)i[k++]=nt;else if(nt==256){Ce=D,F=null;break}else{var Be=nt-254;if(nt>264){var yt=nt-257,lt=mR[yt];Be=tc(e,D,(1<<lt)-1)+_R[yt],D+=lt}var Ft=G[Uw(e,D)&Ut],Lt=Ft>>4;Ft||gl(3),D+=Ft&15;var pt=rW[Lt];if(Lt>3){var lt=gR[Lt];pt+=Uw(e,D)&(1<<lt)-1,D+=lt}if(D>q){c&&gl(0);break}_&&M(k+131072);var Vt=k+Be;if(k<pt){var yr=y-pt,ft=Math.min(pt,Vt);for(yr+k<0&&gl(3);k<ft;++k)i[k]=o[yr+k]}for(;k<Vt;k+=4)i[k]=i[k-pt],i[k+1]=i[k+1-pt],i[k+2]=i[k+2-pt],i[k+3]=i[k+3-pt];k=Vt}}t.l=F,t.p=Ce,t.b=k,t.f=C,F&&(C=1,t.m=K,t.d=G,t.n=W)}while(!C);return k==i.length?i:oW(i,0,k)},lW=new vl(0),uW=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&gl(6,"invalid gzip data");var t=e[3],i=10;t&4&&(i+=(e[10]|e[11]<<8)+2);for(var o=(t>>3&1)+(t>>4&1);o>0;o-=!e[i++]);return i+(t&2)},cW=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},hW=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&gl(6,"invalid zlib data"),(e[1]>>5&1)==1&&gl(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function fW(e,t){return DT(e,{i:2},t,t)}function dW(e,t){var i=uW(e);return i+8>e.length&&gl(6,"invalid gzip data"),DT(e.subarray(i,-8),{i:2},new vl(cW(e)),t)}function pW(e,t){return DT(e.subarray(hW(e),-4),{i:2},t,t)}function $2(e,t){return e[0]==31&&e[1]==139&&e[2]==8?dW(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?fW(e,t):pW(e,t)}var mW=typeof TextDecoder<"u"&&new TextDecoder,gW=0;try{mW.decode(lW,{stream:!0}),gW=1}catch{}var wR=(e,t)=>e*Lg(2,t),vv=(e,t)=>Math.floor(e/Lg(2,t)),Gx=(e,t)=>wR(e.getUint16(t+1,!0),8)+e.getUint8(t),SR=(e,t)=>wR(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),yW=(e,t,i,o,m)=>{if(e!==o.getUint8(m))return e-o.getUint8(m);const y=Gx(o,m+1);if(t!==y)return t-y;const _=Gx(o,m+4);return i!==_?i-_:0},vW=(e,t,i,o)=>{const m=TR(e,t|128,i,o);return m?{z:t,x:i,y:o,offset:m[0],length:m[1],isDir:!0}:null},KC=(e,t,i,o)=>{const m=TR(e,t,i,o);return m?{z:t,x:i,y:o,offset:m[0],length:m[1],isDir:!1}:null},TR=(e,t,i,o)=>{let m=0,y=e.byteLength/17-1;for(;m<=y;){const _=y+m>>1,c=yW(t,i,o,e,_*17);if(c>0)m=_+1;else if(c<0)y=_-1;else return[SR(e,_*17+7),e.getUint32(_*17+13,!0)]}return null},_W=(e,t)=>e.isDir&&!t.isDir?1:!e.isDir&&t.isDir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,ER=(e,t)=>{const i=e.getUint8(t*17);return{z:i&127,x:Gx(e,t*17+1),y:Gx(e,t*17+4),offset:SR(e,t*17+7),length:e.getUint32(t*17+13,!0),isDir:i>>7===1}},QC=e=>{const t=[],i=new DataView(e);for(let o=0;o<i.byteLength/17;o++)t.push(ER(i,o));return xW(t)},xW=e=>{e.sort(_W);const t=new ArrayBuffer(17*e.length),i=new Uint8Array(t);for(let o=0;o<e.length;o++){const m=e[o];let y=m.z;m.isDir&&(y=y|128),i[o*17]=y,i[o*17+1]=m.x&255,i[o*17+2]=m.x>>8&255,i[o*17+3]=m.x>>16&255,i[o*17+4]=m.y&255,i[o*17+5]=m.y>>8&255,i[o*17+6]=m.y>>16&255,i[o*17+7]=m.offset&255,i[o*17+8]=vv(m.offset,8)&255,i[o*17+9]=vv(m.offset,16)&255,i[o*17+10]=vv(m.offset,24)&255,i[o*17+11]=vv(m.offset,32)&255,i[o*17+12]=vv(m.offset,48)&255,i[o*17+13]=m.length&255,i[o*17+14]=m.length>>8&255,i[o*17+15]=m.length>>16&255,i[o*17+16]=m.length>>24&255}return t},bW=(e,t)=>{if(e.byteLength<17)return null;const i=e.byteLength/17,o=ER(e,i-1);if(o.isDir){const m=o.z,y=t.z-m,_=Math.trunc(t.x/(1<<y)),c=Math.trunc(t.y/(1<<y));return{z:m,x:_,y:c}}return null};function wW(e){return zo(this,null,function*(){const t=yield e.getBytes(0,512e3),i=new DataView(t.data),o=i.getUint32(4,!0),m=i.getUint16(8,!0),y=new TextDecoder("utf-8"),_=JSON.parse(y.decode(new DataView(t.data,10,o)));let c=0;_.compression==="gzip"&&(c=2);let M=0;"minzoom"in _&&(M=+_.minzoom);let C=0;"maxzoom"in _&&(C=+_.maxzoom);let D=0,k=0,F=0,G=-180,K=-85,W=180,q=85;if(_.bounds){const me=_.bounds.split(",");G=+me[0],K=+me[1],W=+me[2],q=+me[3]}if(_.center){const me=_.center.split(",");D=+me[0],k=+me[1],F=+me[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+o,rootDirectoryLength:m*17,jsonMetadataOffset:10,jsonMetadataLength:o,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:c,tileType:1,minZoom:M,maxZoom:C,minLon:G,minLat:K,maxLon:W,maxLat:q,centerZoom:F,centerLon:D,centerLat:k,etag:t.etag}})}function SW(e,t,i,o,m,y,_){return zo(this,null,function*(){let c=yield i.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(c=QC(c));const M=KC(new DataView(c),o,m,y);if(M){let k=(yield t.getBytes(M.offset,M.length,_)).data;const F=new DataView(k);return F.getUint8(0)===31&&F.getUint8(1)===139&&(k=$2(new Uint8Array(k))),{data:k}}const C=bW(new DataView(c),{z:o,x:m,y});if(C){const D=vW(new DataView(c),C.z,C.x,C.y);if(D){let k=yield i.getArrayBuffer(t,D.offset,D.length,e);e.specVersion===1&&(k=QC(k));const F=KC(new DataView(k),o,m,y);if(F){let K=(yield t.getBytes(F.offset,F.length,_)).data;const W=new DataView(K);return W.getUint8(0)===31&&W.getUint8(1)===139&&(K=$2(new Uint8Array(K))),{data:K}}}}})}var AR={getHeader:wW,getZxy:SW},TW=e=>(t,i)=>{if(i instanceof AbortController)return e(t,i);const o=new AbortController;return e(t,o).then(m=>i(void 0,m.data,m.cacheControl||"",m.expires||""),m=>i(m)).catch(m=>i(m)),{cancel:()=>o.abort()}},EW=class{constructor(e){this.tilev4=(t,i)=>zo(this,null,function*(){if(t.type==="json"){const F=t.url.substr(10);let G=this.tiles.get(F);if(G||(G=new JC(F),this.tiles.set(F,G)),this.metadata)return{data:yield G.getTileJson(t.url)};const K=yield G.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:K.minZoom,maxzoom:K.maxZoom,bounds:[K.minLon,K.minLat,K.maxLon,K.maxLat]}}}const o=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),m=t.url.match(o);if(!m)throw new Error("Invalid PMTiles protocol URL");const y=m[1];let _=this.tiles.get(y);_||(_=new JC(y),this.tiles.set(y,_));const c=m[2],M=m[3],C=m[4],D=yield _.getHeader(),k=yield _?.getZxy(+c,+M,+C,i.signal);return k?{data:new Uint8Array(k.data),cacheControl:k.cacheControl,expires:k.expires}:D.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=TW(this.tilev4),this.tiles=new Map,this.metadata=e?.metadata||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function Mg(e,t){return(t>>>0)*4294967296+(e>>>0)}function AW(e,t){const i=t.buf;let o=i[t.pos++],m=(o&112)>>4;if(o<128||(o=i[t.pos++],m|=(o&127)<<3,o<128)||(o=i[t.pos++],m|=(o&127)<<10,o<128)||(o=i[t.pos++],m|=(o&127)<<17,o<128)||(o=i[t.pos++],m|=(o&127)<<24,o<128)||(o=i[t.pos++],m|=(o&1)<<31,o<128))return Mg(e,m);throw new Error("Expected varint not more than 10 bytes")}function _v(e){const t=e.buf;let i=t[e.pos++],o=i&127;return i<128||(i=t[e.pos++],o|=(i&127)<<7,i<128)||(i=t[e.pos++],o|=(i&127)<<14,i<128)||(i=t[e.pos++],o|=(i&127)<<21,i<128)?o:(i=t[e.pos],o|=(i&15)<<28,AW(o,e))}function MW(e,t,i,o){if(o===0){i===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const m=t[0];t[0]=t[1],t[1]=m}}var PW=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function CW(e,t,i){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Lg(2,e)-1||i>Lg(2,e)-1)throw Error("tile x/y outside zoom level bounds");const o=PW[e],m=Lg(2,e);let y=0,_=0,c=0;const M=[t,i];let C=m/2;for(;C>0;)y=(M[0]&C)>0?1:0,_=(M[1]&C)>0?1:0,c+=C*C*(3*y^_),MW(C,M,y,_),C=C/2;return o+c}function MR(e,t){return zo(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return $2(new Uint8Array(e));const i=new Response(e).body;if(!i)throw Error("Failed to read response stream");const o=i.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(o).arrayBuffer()}throw Error("Compression method not supported")})}function DW(e){return e===1?".mvt":e===2?".png":e===3?".jpg":e===4?".webp":e===5?".avif":""}var OW=127;function IW(e,t){let i=0,o=e.length-1;for(;i<=o;){const m=o+i>>1,y=t-e[m].tileId;if(y>0)i=m+1;else if(y<0)o=m-1;else return e[m]}return o>=0&&(e[o].runLength===0||t-e[o].tileId<e[o].runLength)?e[o]:null}var zW=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let i="";"navigator"in globalThis&&(i=globalThis.navigator.userAgent||"");const o=i.indexOf("Windows")>-1,m=/Chrome|Chromium|Edg|OPR|Brave/.test(i);this.chromeWindowsNoCache=!1,o&&m&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,i,o){return zo(this,null,function*(){let m,y;i?y=i:(m=new AbortController,y=m.signal);const _=new Headers(this.customHeaders);_.set("range",`bytes=${e}-${e+t-1}`);let c;this.mustReload?c="reload":this.chromeWindowsNoCache&&(c="no-store");let M=yield fetch(this.url,{signal:y,cache:c,headers:_});if(e===0&&M.status===416){const F=M.headers.get("Content-Range");if(!F||!F.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const G=+F.substr(8);M=yield fetch(this.url,{signal:y,cache:"reload",headers:{range:`bytes=0-${G-1}`}})}let C=M.headers.get("Etag");if(C?.startsWith("W/")&&(C=null),M.status===416||o&&C&&C!==o)throw this.mustReload=!0,new G2(`Server returned non-matching ETag ${o} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(M.status>=300)throw Error(`Bad response code: ${M.status}`);const D=M.headers.get("Content-Length");if(M.status===200&&(!D||+D>t))throw m&&m.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield M.arrayBuffer(),etag:C||void 0,cacheControl:M.headers.get("Cache-Control")||void 0,expires:M.headers.get("Expires")||void 0}})}};function rc(e,t){const i=e.getUint32(t+4,!0),o=e.getUint32(t+0,!0);return i*Lg(2,32)+o}function kW(e,t){const i=new DataView(e),o=i.getUint8(7);if(o>3)throw Error(`Archive is spec version ${o} but this library supports up to spec version 3`);return{specVersion:o,rootDirectoryOffset:rc(i,8),rootDirectoryLength:rc(i,16),jsonMetadataOffset:rc(i,24),jsonMetadataLength:rc(i,32),leafDirectoryOffset:rc(i,40),leafDirectoryLength:rc(i,48),tileDataOffset:rc(i,56),tileDataLength:rc(i,64),numAddressedTiles:rc(i,72),numTileEntries:rc(i,80),numTileContents:rc(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:t}}function PR(e){const t={buf:new Uint8Array(e),pos:0},i=_v(t),o=[];let m=0;for(let y=0;y<i;y++){const _=_v(t);o.push({tileId:m+_,offset:0,length:0,runLength:1}),m+=_}for(let y=0;y<i;y++)o[y].runLength=_v(t);for(let y=0;y<i;y++)o[y].length=_v(t);for(let y=0;y<i;y++){const _=_v(t);_===0&&y>0?o[y].offset=o[y-1].offset+o[y-1].length:o[y].offset=_-1}return o}function RW(e){const t=new DataView(e);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var G2=class extends Error{};function jW(e,t){return zo(this,null,function*(){const i=yield e.getBytes(0,16384);if(new DataView(i.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(RW(i.data)<3)return[yield AR.getHeader(e)];const m=i.data.slice(0,OW),y=kW(m,i.etag),_=i.data.slice(y.rootDirectoryOffset,y.rootDirectoryOffset+y.rootDirectoryLength),c=`${e.getKey()}|${y.etag||""}|${y.rootDirectoryOffset}|${y.rootDirectoryLength}`,M=PR(yield t(_,y.internalCompression));return[y,[c,M.length,M]]})}function LW(e,t,i,o,m){return zo(this,null,function*(){const y=yield e.getBytes(i,o,void 0,m.etag),_=yield t(y.data,m.internalCompression),c=PR(_);if(c.length===0)throw new Error("Empty directory is invalid");return c})}var NW=class{constructor(e=100,t=!0,i=MR){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=i}getHeader(e){return zo(this,null,function*(){const t=e.getKey(),i=this.cache.get(t);if(i)return i.lastUsed=this.counter++,yield i.data;const o=new Promise((m,y)=>{jW(e,this.decompress).then(_=>{_[1]&&this.cache.set(_[1][0],{lastUsed:this.counter++,data:Promise.resolve(_[1][2])}),m(_[0]),this.prune()}).catch(_=>{y(_)})});return this.cache.set(t,{lastUsed:this.counter++,data:o}),o})}getDirectory(e,t,i,o){return zo(this,null,function*(){const m=`${e.getKey()}|${o.etag||""}|${t}|${i}`,y=this.cache.get(m);if(y)return y.lastUsed=this.counter++,yield y.data;const _=new Promise((c,M)=>{LW(e,this.decompress,t,i,o).then(C=>{c(C),this.prune()}).catch(C=>{M(C)})});return this.cache.set(m,{lastUsed:this.counter++,data:_}),_})}getArrayBuffer(e,t,i,o){return zo(this,null,function*(){const m=`${e.getKey()}|${o.etag||""}|${t}|${i}`,y=this.cache.get(m);if(y)return y.lastUsed=this.counter++,yield y.data;const _=new Promise((c,M)=>{e.getBytes(t,i,void 0,o.etag).then(C=>{c(C.data),this.cache.has(m),this.prune()}).catch(C=>{M(C)})});return this.cache.set(m,{lastUsed:this.counter++,data:_}),_})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((i,o)=>{i.lastUsed<e&&(e=i.lastUsed,t=o)}),t&&this.cache.delete(t)}}invalidate(e){return zo(this,null,function*(){const t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());const i=new Promise((o,m)=>{this.getHeader(e).then(y=>{o(),this.invalidations.delete(t)}).catch(y=>{m(y)})});this.invalidations.set(t,i)})}},JC=class{constructor(e,t,i){typeof e=="string"?this.source=new zW(e):this.source=e,i?this.decompress=i:this.decompress=MR,t?this.cache=t:this.cache=new NW}getHeader(){return zo(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,i,o){return zo(this,null,function*(){const m=CW(e,t,i),y=yield this.cache.getHeader(this.source);if(y.specVersion<3)return AR.getZxy(y,this.source,this.cache,e,t,i,o);if(e<y.minZoom||e>y.maxZoom)return;let _=y.rootDirectoryOffset,c=y.rootDirectoryLength;for(let M=0;M<=3;M++){const C=yield this.cache.getDirectory(this.source,_,c,y),D=IW(C,m);if(D){if(D.runLength>0){const k=yield this.source.getBytes(y.tileDataOffset+D.offset,D.length,o,y.etag);return{data:yield this.decompress(k.data,y.tileCompression),cacheControl:k.cacheControl,expires:k.expires}}_=y.leafDirectoryOffset+D.offset,c=D.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,i,o){return zo(this,null,function*(){try{return yield this.getZxyAttempt(e,t,i,o)}catch(m){if(m instanceof G2)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,i,o);throw m}})}getMetadataAttempt(){return zo(this,null,function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),i=yield this.decompress(t.data,e.internalCompression),o=new TextDecoder("utf-8");return JSON.parse(o.decode(i))})}getMetadata(){return zo(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof G2)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return zo(this,null,function*(){const t=yield this.getHeader(),i=yield this.getMetadata(),o=DW(t.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${o}`],vector_layers:i.vector_layers,attribution:i.attribution,description:i.description,name:i.name,version:i.version,bounds:[t.minLon,t.minLat,t.maxLon,t.maxLat],center:[t.centerLon,t.centerLat,t.centerZoom],minzoom:t.minZoom,maxzoom:t.maxZoom}})}};const BW=new EW;of.addProtocol("pmtiles",BW.tile);const gs="https://gee-proxy-787413290356.us-east1.run.app",CR=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],FW=`${gs}/api/snow/snotel/stations`,UW=[{key:"where",question:"Where does it snow?",icon:"",lenses:[{key:"us",label:"US Detail",icon:""},{key:"global",label:"Global",icon:""},{key:"mountain",label:"Station",icon:""}]},{key:"changing",question:"Is snowfall changing?",icon:"",lenses:[{key:"us",label:"US Trends",icon:""},{key:"global",label:"Global Trends",icon:""},{key:"mountain",label:"Station Trends",icon:""}]},{key:"shifting",question:"Is winter shifting?",icon:"",lenses:[{key:"global",label:"Season Map",icon:""},{key:"mountain",label:"Station Compare",icon:""}]},{key:"season",question:"How is this season?",icon:"",lenses:[{key:"us",label:"Current Map",icon:""},{key:"mountain",label:"Station Check",icon:""}]},{key:"explorer",question:"Explorer",icon:"",lenses:[{key:"us",label:"US",icon:""},{key:"global",label:"Global",icon:""},{key:"mountain",label:"Station",icon:""}]}],VW={"where-global":"Average snowfall patterns at 9 km resolution  ERA5-Land reanalysis","where-us":"US snowfall detail at 1 km  Daymet / SNODAS","where-mountain":"Pick a station to see its snowfall profile","changing-global":"How global snowfall has shifted over decades","changing-us":"US snowfall trends at 1 km resolution","changing-mountain":"Annual peak SWE trends at individual stations","shifting-global":"When does winter arrive and depart?  MODIS snow phenology","shifting-mountain":"How snow season timing is changing at your station","season-us":"Live snow depth across the US  SNODAS daily","season-mountain":"Current SWE vs. historical median at your station","explorer-global":"Free exploration  switch datasets, layers, and color ramps","explorer-us":"Free exploration  switch datasets, layers, and color ramps","explorer-mountain":"Free exploration  pick any station, any analysis"},qW={"Sierra Nevada":["CA","NV"],Rockies:["CO","WY","MT","ID","UT"],Cascades:["WA","OR"],Northeast:["VT","NH","ME","NY"],Southwest:["AZ","NM"]};function Nd(e){return e===null?"#94a3b8":e<50?"#ef4444":e<80?"#f97316":e<100?"#eab308":e<=120?"#22c55e":"#3b82f6"}function Cg(e){const t=new Date(e+"T00:00:00"),i=t.getMonth()>=9?t.getFullYear():t.getFullYear()-1,o=new Date(i,9,1);return Math.floor((t.getTime()-o.getTime())/864e5)+1}function eD(e){return["Oct","Nov","Dec","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep"][Math.min(11,Math.floor((e-1)/30.4))]}function tD(e,t){const i=new Date(t,9,1);return i.setDate(i.getDate()+e-1),`${CR[i.getMonth()]} ${i.getDate()}`}const B0={snowfall:{era5Band:"snowfall_sum",snodasBand:"SWE",label:"Snowfall",unit:"mm"},snow_depth:{era5Band:"snow_depth",snodasBand:"Snow_Depth",label:"Snow Depth",unit:"m"},snow_cover:{era5Band:"snow_cover",snodasBand:"SWE",label:"Snow Cover",unit:"%"}};function Vw(e){return e.split(`
`).filter(t=>t.trim()&&!t.startsWith("#")).map(t=>t.split(",").map(i=>i.trim()))}function OT(){const e=new Date,t=e.getMonth()>=9?e.getFullYear():e.getFullYear()-1;return{start:`${t}-10-01`,end:`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,wyYear:t}}function $W(e){const t=new Date(e+"T00:00:00");return t.getMonth()>=9?t.getFullYear()+1:t.getFullYear()}function Sv(e,t){const i=e.length;if(i<2)return{slope:0,intercept:0,r2:0};const o=e.reduce((K,W)=>K+W,0),m=t.reduce((K,W)=>K+W,0),y=e.reduce((K,W)=>K+W*W,0),_=e.reduce((K,W,q)=>K+W*t[q],0),c=i*y-o*o;if(c===0)return{slope:0,intercept:m/i,r2:0};const M=(i*_-o*m)/c,C=(m-M*o)/i,D=m/i,k=t.reduce((K,W,q)=>K+(W-(M*e[q]+C))**2,0),F=t.reduce((K,W)=>K+(W-D)**2,0),G=F>0?1-k/F:0;return{slope:M,intercept:C,r2:G}}function rD(e,t,i,o){const m={};for(const Be of e){if(Be.swe===null)continue;const lt=$W(Be.date);m[lt]||(m[lt]=[]),m[lt].push(Be)}const y=Object.entries(m).filter(([Be,lt])=>lt.length>60).map(([Be,lt])=>{const Ft=parseInt(Be),Lt=[...lt].sort((Sr,rn)=>Sr.date.localeCompare(rn.date));let Vt=0,yr=Lt[0].date;for(const Sr of Lt)Sr.swe!==null&&Sr.swe>Vt&&(Vt=Sr.swe,yr=Sr.date);const tr=Lt.find(Sr=>Sr.swe!==null&&Sr.swe>1)?.date||null,gn=[...Lt.filter(Sr=>Sr.date>=yr)].reverse().find(Sr=>Sr.swe!==null&&Sr.swe>1)?.date||null,fr=tr&&gn?Math.round((new Date(gn).getTime()-new Date(tr).getTime())/864e5):0;return{wy:Ft,peakSWE:Vt,peakDate:yr,onsetDate:tr,meltOutDate:gn,seasonDays:fr}}).sort((Be,lt)=>Be.wy-lt.wy),_=y.map(Be=>Be.wy),c=y.map(Be=>Be.peakSWE),M=Sv(_,c),C=M.slope*10,D=y.length>1?y[y.length-1].wy-y[0].wy:1,k=c.length>0?c.reduce((Be,lt)=>Be+lt,0)/c.length:1,F=k>0?M.slope*D/k*100:0,G=y.filter(Be=>Be.onsetDate).map(Be=>({wy:Be.wy,dowy:Cg(Be.onsetDate)})),K=G.length>5?Sv(G.map(Be=>Be.wy),G.map(Be=>Be.dowy)):{slope:0},W=G.length>0?Math.round(G.reduce((Be,lt)=>Be+lt.dowy,0)/G.length):0,q=y.filter(Be=>Be.meltOutDate).map(Be=>({wy:Be.wy,dowy:Cg(Be.meltOutDate)})),ue=q.length>5?Sv(q.map(Be=>Be.wy),q.map(Be=>Be.dowy)):{slope:0},me=q.length>0?Math.round(q.reduce((Be,lt)=>Be+lt.dowy,0)/q.length):0,ge=y.filter(Be=>Be.seasonDays>0),be=ge.length>0?Math.round(ge.reduce((Be,lt)=>Be+lt.seasonDays,0)/ge.length):0,ze=ge.length>5?Sv(ge.map(Be=>Be.wy),ge.map(Be=>Be.seasonDays)):{slope:0},{wyYear:Ae}=OT(),Oe=y.find(Be=>Be.wy===Ae),rt=Oe?.onsetDate?Cg(Oe.onsetDate):null,gt=Cg(new Date().toISOString().slice(0,10)),yt=t.swe??0,tt=[];for(const[Be,lt]of Object.entries(m)){const Ft=lt.find(Lt=>{const Vt=Cg(Lt.date);return Math.abs(Vt-gt)<=3});Ft?.swe!==null&&Ft?.swe!==void 0&&tt.push(Ft.swe)}tt.sort((Be,lt)=>Be-lt);const Ge=tt.filter(Be=>Be<yt).length+1,Rt=y.slice(-10),zt=c.length>0?[...c].sort((Be,lt)=>Be-lt)[Math.floor(c.length/2)]:0,kt=Rt.filter(Be=>Be.peakSWE<zt).length;let Ue=null;if(o.length>5){const Be=o[o.length-1],lt=Be.median,Ft=Be.swe;if(lt&&Ft&&lt>0){const Lt=Ft/lt,Vt=Math.max(...o.filter(yr=>yr.median!==null).map(yr=>yr.median));Vt>lt&&(Ue=Math.round(Lt*Vt*10)/10)}}const at={};for(const Be of e){if(Be.swe===null)continue;const lt=new Date(Be.date+"T00:00:00").getMonth();at[lt]||(at[lt]=[]),at[lt].push(Be.swe)}const pt=[9,10,11,0,1,2,3,4,5].map(Be=>{const lt=at[Be]||[],Ft=lt.length>0?lt.reduce((yr,ft)=>yr+ft,0)/lt.length:0,Lt=lt.length>0?Math.min(...lt):0,Vt=lt.length>0?Math.max(...lt):0;return{month:CR[Be],avg:Math.round(Ft*10)/10,min:Math.round(Lt*10)/10,max:Math.round(Vt*10)/10}}),bt=i.filter(Be=>Be.id!==t.id&&Math.abs(Be.lat-t.lat)<1&&Math.abs(Be.lon-t.lon)<1&&Be.pctMedian!==null).sort((Be,lt)=>{const Ft=Math.abs(Be.lat-t.lat)+Math.abs(Be.lon-t.lon),Lt=Math.abs(lt.lat-t.lat)+Math.abs(lt.lon-t.lon);return Ft-Lt}).slice(0,3).map(Be=>({name:Be.name,pctMedian:Be.pctMedian}));let Ut="Region",Ce=[];for(const[Be,lt]of Object.entries(qW))if(lt.includes(t.state)){Ut=Be,Ce=i.filter(Ft=>lt.includes(Ft.state)&&Ft.pctMedian!==null);break}const nt=Ce.length>0?Math.round(Ce.reduce((Be,lt)=>Be+lt.pctMedian,0)/Ce.length):0;return{waterYears:y,peakTrendSlope:C,peakTrendPct:F,peakTrendSignificant:M.r2>.15&&y.length>10,avgOnsetDOWY:W,currentOnsetDOWY:rt,onsetTrendDays:K.slope*10,avgMeltOutDOWY:me,meltOutTrendDays:ue.slope*10,avgSeasonLength:be,seasonLengthChange:ze.slope*D,currentRank:Ge,totalYears:tt.length,belowMedianCount10yr:kt,projectedPeak:Ue,monthlyClim:pt,nearbyComparison:bt,regionName:Ut,regionAvgPct:nt}}const GW=`
/*  Clean Design System  NO glass, NO blur, NO transparency  */
.snow-panel { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.snow-panel-dark { background: #0f172a; border: 1px solid #1e293b; border-radius: 12px; }
.snow-btn { background: #ffffff; border: 1px solid #cbd5e1; border-radius: 8px; color: #334155; font-size: 13px; padding: 8px 16px; cursor: pointer; transition: all 0.15s; }
.snow-btn:hover { background: #f1f5f9; border-color: #94a3b8; }
.snow-btn-active { background: #0369a1; border-color: #0369a1; color: #ffffff; }
.snow-next { background: #0369a1; color: white; border: none; border-radius: 12px; padding: 16px 48px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.15s; }
.snow-next:hover { background: #075985; }

.slide-up { animation: slideUp 0.4s cubic-bezier(0.16,1,0.3,1) forwards; }
@keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
.fade-in { animation: fadeIn 0.4s ease forwards; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.insight-card { border-left: 3px solid; padding: 8px 12px; border-radius: 0 8px 8px 0; margin-bottom: 6px; background: #f8fafc; }
.insight-card p { color: #475569; }
.insight-card strong { color: #0f172a; }

.hero-overlay { position: absolute; inset: 0; z-index: 3000; display: flex; align-items: center; justify-content: center; }
.hero-bg { position: absolute; inset: 0; background: linear-gradient(180deg, #f8fafc, #e0f2fe, #f8fafc); }
.hero-enter { animation: heroFadeIn 1s ease forwards; }
@keyframes heroFadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.hero-exit { animation: heroFadeOut 0.6s ease forwards; }
@keyframes heroFadeOut { from { opacity: 1; } to { opacity: 0; pointer-events: none; } }

.tab-active { background: #0369a1; color: #fff; border: none; }
.tab-inactive { color: #475569; }
.tab-inactive:hover { color: #0f172a; background: #f1f5f9; }

/* Force dark bg on map container */
.maplibregl-map { background: #0f172a !important; width: 100% !important; height: 100% !important; }
.maplibregl-canvas { outline: none; }

/*  Mobile Responsive  */
@media (max-width: 640px) {
  .snow-next { padding: 14px 24px; font-size: 14px; border-radius: 10px; }
  .snow-panel { padding: 6px !important; }
}
`;function ZW({station:e,hydroData:t,hydroLoading:i,analytics:o,analyticsLoading:m,activeTab:y}){const{wyYear:_}=OT(),c=Z.useMemo(()=>{if(!o)return[];const M=o.waterYears;if(M.length===0)return[];const C=M.map(F=>F.wy),D=M.map(F=>F.peakSWE),k=Sv(C,D);return M.map(F=>({wy:F.wy,peak:Math.round(F.peakSWE*10)/10,trend:Math.round((k.slope*F.wy+k.intercept)*10)/10}))},[o]);return U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[U.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"rgba(3,105,161,0.06)",border:"1px solid rgba(3,105,161,0.1)"},children:[U.jsx("div",{className:"text-2xl font-bold",style:{color:"#0891b2"},children:e.swe!==null?`${e.swe}"`:"N/A"}),U.jsx("div",{className:"text-[10px] mt-0.5",style:{color:"#64748b"},children:"Current SWE"})]}),U.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"rgba(3,105,161,0.06)",border:"1px solid rgba(3,105,161,0.1)"},children:[U.jsx("div",{className:"text-2xl font-bold",style:{color:Nd(e.pctMedian)},children:e.pctMedian!==null?`${e.pctMedian}%`:"N/A"}),U.jsx("div",{className:"text-[10px] mt-0.5",style:{color:"#64748b"},children:"of median"})]})]}),m?U.jsxs("div",{className:"flex items-center gap-2 py-3",children:[U.jsx("div",{className:"w-3 h-3 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#0369a1",borderTopColor:"transparent"}}),U.jsx("span",{className:"text-xs",style:{color:"#64748b"},children:"Computing historical analysis..."})]}):o?U.jsxs("div",{className:"space-y-1.5",children:[(y==="season"||y==="where")&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"insight-card",style:{borderColor:Nd(e.pctMedian)},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:[e.pctMedian!==null?e.pctMedian>=120?`${e.name} is running well above normal at ${e.pctMedian}% of median.`:e.pctMedian>=90?`${e.name} is near normal at ${e.pctMedian}% of median.`:e.pctMedian>=50?`${e.name} is below normal at ${e.pctMedian}% of median  a moderate deficit.`:`${e.name} is critically low at ${e.pctMedian}% of median.`:"No median comparison available.",o.currentRank>0&&o.totalYears>5&&U.jsxs(U.Fragment,{children:[" This is the ",U.jsxs("strong",{children:[HW(o.currentRank)," ",o.currentRank<=3?"lowest":o.currentRank>=o.totalYears-2?"highest":""]})," SWE on record for this date (",o.totalYears," years)."]})]})}),o.projectedPeak!==null&&U.jsx("div",{className:"insight-card",style:{borderColor:"#6366f1"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:["At the current pace, peak SWE will reach approximately ",U.jsxs("strong",{children:[o.projectedPeak,'"']})," vs. a typical peak of ",o.waterYears.length>0?Math.round([...o.waterYears].sort((M,C)=>M.peakSWE-C.peakSWE)[Math.floor(o.waterYears.length/2)].peakSWE*10)/10:"?",'".']})}),o.belowMedianCount10yr>0&&U.jsx("div",{className:"insight-card",style:{borderColor:"#f59e0b"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:[U.jsxs("strong",{children:[o.belowMedianCount10yr," of the last 10 years"]})," were below median at this point in the season."]})})]}),(y==="changing"||y==="where")&&o.waterYears.length>5&&U.jsx(U.Fragment,{children:U.jsx("div",{className:"insight-card",style:{borderColor:o.peakTrendSlope>0?"#22c55e":"#ef4444"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:["Peak SWE has ",U.jsx("strong",{children:o.peakTrendSlope>0?"increased":"decreased"})," by ",Math.abs(Math.round(o.peakTrendSlope*10)/10),'" per decade (',Math.abs(Math.round(o.peakTrendPct)),"% over the ",o.waterYears.length,"-year record).",!o.peakTrendSignificant&&U.jsx("span",{className:"text-slate-400",children:" (weak trend  high variability)"})]})})}),(y==="shifting"||y==="changing")&&o.avgOnsetDOWY>0&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"insight-card",style:{borderColor:"#0891b2"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:["Snow typically arrives around ",U.jsx("strong",{children:tD(o.avgOnsetDOWY,_-1)}),".",o.currentOnsetDOWY!==null&&U.jsxs(U.Fragment,{children:[" This year it arrived ",tD(o.currentOnsetDOWY,_-1),"  ",U.jsxs("strong",{children:[Math.abs(o.currentOnsetDOWY-o.avgOnsetDOWY)," days ",o.currentOnsetDOWY<o.avgOnsetDOWY?"earlier":"later"]})," than average."]})]})}),Math.abs(o.onsetTrendDays)>.5&&U.jsx("div",{className:"insight-card",style:{borderColor:"#7c3aed"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:["Snow onset has shifted ",U.jsxs("strong",{children:[Math.abs(Math.round(o.onsetTrendDays))," days ",o.onsetTrendDays>0?"later":"earlier"]})," per decade. Melt-out has shifted ",U.jsxs("strong",{children:[Math.abs(Math.round(o.meltOutTrendDays))," days ",o.meltOutTrendDays>0?"later":"earlier"]})," per decade.",o.avgSeasonLength>0&&U.jsxs(U.Fragment,{children:[" The snow season is now approximately ",U.jsxs("strong",{children:[Math.abs(Math.round(o.seasonLengthChange))," days ",o.seasonLengthChange>0?"longer":"shorter"]})," than the historical average of ",o.avgSeasonLength," days."]})]})})]}),o.nearbyComparison.length>0&&U.jsx("div",{className:"insight-card",style:{borderColor:"#64748b"},children:U.jsxs("p",{className:"text-xs leading-relaxed",children:[U.jsx("strong",{children:"Nearby:"})," ",o.nearbyComparison.map((M,C)=>U.jsxs("span",{children:[M.name," ",U.jsxs("span",{style:{color:Nd(M.pctMedian)},className:"font-semibold",children:[M.pctMedian,"%"]}),C<o.nearbyComparison.length-1?"  ":""]},C)),o.regionAvgPct>0&&U.jsxs(U.Fragment,{children:[". The ",U.jsx("strong",{children:o.regionName})," average is ",U.jsxs("span",{className:"font-semibold",style:{color:Nd(o.regionAvgPct)},children:[o.regionAvgPct,"%"]}),"."]})]})})]}):null,U.jsxs("div",{children:[U.jsx("div",{style:{color:"#64748b"},className:"text-[10px] uppercase tracking-wider mb-1.5 font-medium",children:"Water Year Hydrograph"}),i?U.jsx("div",{className:"flex items-center justify-center py-6",children:U.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):t.length>0?U.jsxs(U.Fragment,{children:[U.jsx("div",{style:{height:200},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(ZH,{data:t,children:[U.jsx(jg,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),U.jsx(Kp,{dataKey:"dowy",tickFormatter:eD,tick:{fontSize:9,fill:"#94a3b8"},interval:29}),U.jsx(Qp,{tick:{fontSize:9,fill:"#94a3b8"},width:32}),U.jsx(Ev,{contentStyle:{background:"rgba(255,255,255,0.95)",backdropFilter:"blur(10px)",border:"1px solid #e2e8f0",borderRadius:12,fontSize:11},formatter:(M,C)=>[M!==null?`${M}"`:"N/A",C],labelFormatter:M=>`Day ${M} (${eD(M)})`}),U.jsx(H0,{type:"monotone",dataKey:"median",stroke:"#94a3b8",strokeWidth:2,strokeDasharray:"5 5",dot:!1,name:"Median"}),U.jsx(H0,{type:"monotone",dataKey:"swe",stroke:"#3b82f6",strokeWidth:2.5,dot:!1,name:"Current WY"})]})})}),U.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[10px] text-slate-400",children:[U.jsxs("span",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-5 border-t-2 border-blue-500 inline-block"})," Current"]}),U.jsxs("span",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-5 border-t-2 border-dashed border-slate-400 inline-block"})," Median"]})]})]}):U.jsx("div",{className:"text-center text-xs text-slate-400 py-4",children:"No hydrograph data"})]}),c.length>3&&U.jsxs("div",{children:[U.jsx("div",{style:{color:"#64748b"},className:"text-[10px] uppercase tracking-wider mb-1.5 font-medium",children:"Annual Peak SWE"}),U.jsx("div",{style:{height:150},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(KH,{data:c,children:[U.jsx(jg,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),U.jsx(Kp,{dataKey:"wy",tick:{fontSize:8,fill:"#94a3b8"},interval:Math.max(1,Math.floor(c.length/8))}),U.jsx(Qp,{tick:{fontSize:9,fill:"#94a3b8"},width:30}),U.jsx(Ev,{contentStyle:{background:"rgba(255,255,255,0.95)",backdropFilter:"blur(10px)",border:"1px solid #e2e8f0",borderRadius:12,fontSize:11},formatter:(M,C)=>[`${M}"`,C]}),U.jsx(AT,{dataKey:"peak",fill:"#818cf8",radius:[2,2,0,0],name:"Peak SWE",opacity:.7}),U.jsx(H0,{type:"monotone",dataKey:"trend",stroke:o&&o.peakTrendSlope>0?"#22c55e":"#ef4444",strokeWidth:2,dot:!1,name:"Trend",strokeDasharray:"6 3"})]})})})]}),o&&o.monthlyClim.some(M=>M.avg>0)&&U.jsxs("div",{children:[U.jsx("div",{style:{color:"#64748b"},className:"text-[10px] uppercase tracking-wider mb-1.5 font-medium",children:"Monthly SWE Climatology"}),U.jsx("div",{style:{height:120},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(q2,{data:o.monthlyClim,children:[U.jsx("defs",{children:U.jsxs("linearGradient",{id:"climGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[U.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.25}),U.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:.02})]})}),U.jsx(jg,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),U.jsx(Kp,{dataKey:"month",tick:{fontSize:9,fill:"#94a3b8"}}),U.jsx(Qp,{tick:{fontSize:9,fill:"#94a3b8"},width:28}),U.jsx(Ev,{contentStyle:{background:"rgba(255,255,255,0.95)",border:"1px solid #e2e8f0",borderRadius:12,fontSize:11},formatter:(M,C)=>[`${M}"`,C]}),U.jsx(Xp,{type:"monotone",dataKey:"max",stroke:"none",fill:"#e2e8f0",fillOpacity:.5,name:"Max"}),U.jsx(Xp,{type:"monotone",dataKey:"avg",stroke:"#6366f1",fill:"url(#climGrad)",strokeWidth:2,name:"Average"}),U.jsx(Xp,{type:"monotone",dataKey:"min",stroke:"none",fill:"transparent",name:"Min"})]})})})]})]})}function HW(e){const t=["th","st","nd","rd"],i=e%100;return e+(t[(i-20)%10]||t[i]||t[0])}function WW(e,t){const i=`${e}-${t}`,o={"where-global":{source:"ERA5-Land Monthly Aggregated via Google Earth Engine",resolution:"~9 km global, 1950present",method:"Monthly snowfall totals computed from ECMWF ERA5-Land reanalysis. Tiles served via GEE proxy to Cloud Run.",collection:"ECMWF/ERA5_LAND/MONTHLY_AGGR"},"where-us":{source:"SNODAS Daily via GEE Community Catalog",resolution:"~1 km, CONUS, 2003present",method:"Daily snow depth from NOAA SNODAS model assimilation. Tiles served via GEE proxy.",collection:"projects/climate-engine/snodas/daily"},"where-mountain":{source:"SNOTEL via USDA NRCS AWDB Report Generator",resolution:"~900 point stations, 1978present",method:"Automated snow telemetry stations measuring SWE, snow depth, and temperature. Proxied through GEE Cloud Run.",collection:"USDA NRCS SNOTEL Network"},"changing-global":{source:"ERA5-Land Linear Regression",resolution:"~9 km global, 1950present",method:"Pixel-wise linear regression of snowfall_sum over selected period. Slope represents change per decade.",collection:"ECMWF/ERA5_LAND/MONTHLY_AGGR"},"changing-us":{source:"ERA5-Land Trends (Daymet when available)",resolution:"~9 km (ERA5) or ~1 km (Daymet)",method:"Linear trend analysis on monthly snowfall aggregates over the US.",collection:"ECMWF/ERA5_LAND/MONTHLY_AGGR"},"changing-mountain":{source:"SNOTEL Period-of-Record Analysis",resolution:"Point stations, variable record length",method:"Linear regression on annual peak SWE at each SNOTEL station over its period of record.",collection:"USDA NRCS SNOTEL Network"},"shifting-global":{source:"MODIS MOD10A1 Snow Cover",resolution:"500 m, 2001present",method:"Day-of-year trends for snow cover onset and melt computed from MODIS daily snow cover.",collection:"MODIS/061/MOD10A1"},"shifting-us":{source:"MODIS MOD10A1 Snow Cover",resolution:"500 m, 2001present",method:"Day-of-year trends for snow cover onset and melt computed from MODIS daily snow cover.",collection:"MODIS/061/MOD10A1"},"shifting-mountain":{source:"SNOTEL Period-of-Record Analysis",resolution:"Point stations, variable record length",method:"Snow onset / melt-out DOY trends from SNOTEL daily SWE records, split by decade.",collection:"USDA NRCS SNOTEL Network"},"season-global":{source:"SNODAS Current Conditions",resolution:"~1 km, CONUS",method:"Latest SNODAS snow depth model output.",collection:"projects/climate-engine/snodas/daily"},"season-us":{source:"SNODAS Current Conditions",resolution:"~1 km, CONUS",method:"Latest SNODAS snow depth model output showing current snow conditions.",collection:"projects/climate-engine/snodas/daily"},"season-mountain":{source:"SNOTEL Current SWE vs 1991-2020 Median",resolution:"~900 point stations",method:"Current SWE readings compared to 1991-2020 historical median for each station.",collection:"USDA NRCS SNOTEL Network"}};return o[i]||o["where-global"]}const wi={cool_blues:"linear-gradient(to right, #1e1b4b, #312e81, #4338ca, #818cf8, #a78bfa, #e9d5ff, #faf5ff)",arctic:"linear-gradient(to right, #042f2e, #0d9488, #5eead4, #ccfbf1, #f0fdfa)",warm_snow:"linear-gradient(to right, #3b0764, #7c3aed, #a78bfa, #c4b5fd, #ede9fe, #faf5ff)",viridis:"linear-gradient(to right, #440154, #31688e, #35b779, #fde725)",plasma:"linear-gradient(to right, #0d0887, #7e03a8, #cc4778, #f89540, #f0f921)",deep_purple:"linear-gradient(to right, #0c0a23, #2e1065, #6d28d9, #a78bfa, #ddd6fe)",red_blue:"linear-gradient(to right, #dc2626, #fca5a5, #e5e7eb, #93c5fd, #1d4ed8)",brown_green:"linear-gradient(to right, #92400e, #d97706, #fde68a, #e5e7eb, #86efac, #16a34a, #14532d)",spectral:"linear-gradient(to right, #d53e4f, #fc8d59, #fee08b, #e6f598, #99d594, #3288bd)",coolwarm:"linear-gradient(to right, #b2182b, #ef8a62, #fddbc7, #d1e5f0, #67a9cf, #2166ac)",orange_teal:"linear-gradient(to right, #ea580c, #fed7aa, #e5e7eb, #a5f3fc, #0891b2)",piyg:"linear-gradient(to right, #c51b7d, #e9a3c9, #fde0ef, #e6f5d0, #a1d76a, #4d9221)"};function qw(e,t){return t==="where"||t==="season"?wi[e]||wi.cool_blues:t==="changing"?wi[e]||wi.red_blue:t==="shifting"?wi[e]||wi.orange_teal:wi[e]||wi.cool_blues}function YW(e){return e==="where"||e==="season"?[{key:"cool_blues",label:"Cool Blues",gradient:wi.cool_blues},{key:"arctic",label:"Arctic",gradient:wi.arctic},{key:"warm_snow",label:"Warm Snow",gradient:wi.warm_snow},{key:"viridis",label:"Viridis",gradient:wi.viridis},{key:"plasma",label:"Plasma",gradient:wi.plasma},{key:"deep_purple",label:"Deep Purple",gradient:wi.deep_purple}]:e==="changing"?[{key:"red_blue",label:"Red  Blue",gradient:wi.red_blue},{key:"brown_green",label:"Brown  Green",gradient:wi.brown_green},{key:"spectral",label:"Spectral",gradient:wi.spectral},{key:"coolwarm",label:"Cool Warm",gradient:wi.coolwarm},{key:"piyg",label:"PiYG",gradient:wi.piyg}]:e==="shifting"?[{key:"orange_teal",label:"Orange  Teal",gradient:wi.orange_teal},{key:"red_blue",label:"Red  Blue",gradient:wi.red_blue},{key:"spectral",label:"Spectral",gradient:wi.spectral},{key:"coolwarm",label:"Cool Warm",gradient:wi.coolwarm}]:[{key:"cool_blues",label:"Cool Blues",gradient:wi.cool_blues}]}function XW(){const e=typeof window<"u"&&window.innerWidth<640,[t,i]=Z.useState(!1),[o,m]=Z.useState("where"),[y,_]=Z.useState("us"),[c,M]=Z.useState("20"),[C,D]=Z.useState("snowfall"),k=Z.useRef(null),F=Z.useRef(null),[G,K]=Z.useState(!1),W=Z.useRef(null),q=Z.useRef(0),[ue,me]=Z.useState(!1),[ge,be]=Z.useState(null),[ze,Ae]=Z.useState(3),Oe=Z.useRef(null),[rt,gt]=Z.useState(!1),[yt,tt]=Z.useState(null),[Ge,Rt]=Z.useState([]),[zt,kt]=Z.useState(!1),[Ue,at]=Z.useState(null),[pt,bt]=Z.useState(!1),[Ut,Ce]=Z.useState(""),[nt,Be]=Z.useState(!1),[lt,Ft]=Z.useState(1),[Lt,Vt]=Z.useState([]),[yr,ft]=Z.useState(0),[tr,pr]=Z.useState(!1),[Tt,gn]=Z.useState(!1),fr=Z.useRef(!1),[Sr,rn]=Z.useState(!1),[Tr,za]=Z.useState([]),[bs,ka]=Z.useState(!1),[pa,uo]=Z.useState(!1),[bn,kn]=Z.useState(null),[ma,co]=Z.useState(""),[ta,ga]=Z.useState([]),[du,ws]=Z.useState(!1),[je,ee]=Z.useState(!1),ne=Z.useRef({}),[ae,_e]=Z.useState(null),[Te,qe]=Z.useState(!1),[Ze,Ne]=Z.useState(!1),[Ve,_t]=Z.useState(!1),[Xe,Me]=Z.useState("cool_blues"),[qt,hr]=Z.useState(!1),[Yt,lr]=Z.useState("auto"),[rr,mr]=Z.useState(null),[Bn,nn]=Z.useState(""),[hn,ui]=Z.useState(!1),[an,Et]=Z.useState(!0),[jr,fn]=Z.useState(!1),[ya,Cn]=Z.useState(!1),xt=Z.useRef(null),ur=Z.useRef(y);Z.useEffect(()=>{ur.current=y},[y]);const[sr,Ra]=Z.useState("20"),[Zs,Ss]=Z.useState([]),[gr,Ts]=Z.useState(""),[ja,Xo]=Z.useState("where"),va=o==="explorer",Ir=va?ja:o,Dn=UW.find(Fe=>Fe.key===o),Tl=VW[`${Ir}-${y}`]||"",Gr=y==="mountain";Z.useEffect(()=>{fetch("/snow-tracker/data/snow/grid_stats.json").then(Fe=>Fe.json()).then(Fe=>{Oe.current=Fe,gt(!0)}).catch(()=>{})},[]),Z.useEffect(()=>{if(!Gr||pa)return;ka(!0);const Fe="/snow-tracker/";Promise.all([fetch(Fe+"data/snow/snotel_stations.json").then(Pt=>Pt.json()),fetch(Fe+"data/snow/snotel_current.json").then(Pt=>Pt.json())]).then(([Pt,Nt])=>{const Qt=Nt.stations||{},Ot=Pt.filter(nr=>nr.lat&&nr.lon&&nr.triplet).map(nr=>{const Gt=Qt[nr.triplet]||{};return{id:nr.triplet.split(":")[0],name:nr.name,state:nr.state,elevation:nr.elevation||0,lat:nr.lat,lon:nr.lon,swe:Gt.swe??null,pctMedian:Gt.pctMedian??null}});za(Ot),uo(!0),ka(!1)}).catch(()=>{fetch(FW).then(Pt=>Pt.text()).then(Pt=>{const Nt=Vw(Pt),Qt=Nt.findIndex(Gt=>Gt[0]?.toLowerCase().includes("station id")),nr=(Qt>=0?Nt.slice(Qt+1):Nt.slice(1)).filter(Gt=>Gt.length>=8&&Gt[4]&&Gt[5]).map(Gt=>({id:Gt[0]?.trim(),name:Gt[1]?.trim(),state:Gt[2]?.trim(),elevation:parseFloat(Gt[3])||0,lat:parseFloat(Gt[4])||0,lon:parseFloat(Gt[5])||0,swe:Gt[6]?.trim()?parseFloat(Gt[6]):null,pctMedian:Gt[7]?.trim()?parseFloat(Gt[7]):null})).filter(Gt=>Gt.lat!==0&&Gt.lon!==0&&Gt.id);za(nr),uo(!0),ka(!1)}).catch(()=>ka(!1))})},[Gr,pa]);const Ur=Z.useMemo(()=>{if(!ma||ma.length<2)return Tr.slice(0,20);const Fe=ma.toLowerCase();return Tr.filter(Pt=>Pt.name.toLowerCase().includes(Fe)||Pt.state.toLowerCase().includes(Fe)||Pt.id.includes(Fe)).slice(0,30)},[Tr,ma]),zi=Z.useMemo(()=>{const Fe=Tr.filter(Ot=>Ot.pctMedian!==null),Pt=Fe.length>0?Math.round(Fe.reduce((Ot,nr)=>Ot+nr.pctMedian,0)/Fe.length):0,Nt=Fe.filter(Ot=>Ot.pctMedian>=100).length,Qt=Fe.filter(Ot=>Ot.pctMedian<100).length;return{avg:Pt,above:Nt,below:Qt,total:Fe.length}},[Tr]);Z.useEffect(()=>{if(!k.current||F.current)return;const Fe=new of.Map({container:k.current,style:{version:8,sources:{carto:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png","https://b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png","https://c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"],tileSize:256,maxzoom:18}},layers:[{id:"carto",type:"raster",source:"carto"}]},center:e?[-98,39]:[-30,40],zoom:e?4:3,attributionControl:!1});return Fe.addControl(new of.NavigationControl({showCompass:!1}),"bottom-right"),Fe.on("click",Pt=>{if(Fe.queryRenderedFeatures(Pt.point,{layers:["snotel-circles"]}).length>0||ur.current==="mountain")return;const{lat:Qt,lng:Ot}=Pt.lngLat;tt({lat:Math.round(Qt*100)/100,lon:Math.round(Ot*100)/100}),bt(!0)}),Fe.on("zoomend",()=>Ae(Math.round(Fe.getZoom()))),Fe.on("load",()=>{F.current=Fe,window.__map=Fe,K(!0)}),()=>{Fe.remove()}},[]),Z.useEffect(()=>{const Fe=F.current;if(!Fe||!Fe.getSource("carto"))return;const Nt=Ir==="where"||Ir==="season"||o==="explorer"?"dark_all":"light_all",Qt=[`https://a.basemaps.cartocdn.com/${Nt}/{z}/{x}/{y}{r}.png`,`https://b.basemaps.cartocdn.com/${Nt}/{z}/{x}/{y}{r}.png`,`https://c.basemaps.cartocdn.com/${Nt}/{z}/{x}/{y}{r}.png`],Ot=Fe.getSource("carto");Ot.setTiles&&Ot.setTiles(Qt)},[o,Ir]);const Ko=Z.useCallback(Fe=>{const Pt=F.current;if(!(!Pt||!Fe)){try{Pt.getLayer(Fe)&&Pt.removeLayer(Fe)}catch{}try{Pt.getSource(Fe)&&Pt.removeSource(Fe)}catch{}}},[]),El=Z.useCallback(()=>{Ko(W.current),W.current=null},[]),ho=Z.useCallback((Fe,Pt)=>{const Nt=F.current;if(!Nt)return;El();const Qt=`snow-tile-${++q.current}`,Ot=Pt?.maxNativeZoom??Pt?.maxZoom??12;if(Fe.startsWith("pmtiles://")){const Gt=Fe.replace(/\/{z}\/{x}\/{y}$/,"");Nt.addSource(Qt,{type:"raster",url:Gt,tileSize:256})}else Nt.addSource(Qt,{type:"raster",tiles:[Fe],tileSize:256,maxzoom:Ot,scheme:Pt?.scheme||"xyz"});Nt.addLayer({id:Qt,type:"raster",source:Qt,paint:{"raster-opacity":Pt?.opacity??.75}}),W.current=Qt},[]),Qo=Z.useCallback(()=>{const Fe=F.current;if(Fe){try{Fe.getLayer("snotel-circles")&&Fe.removeLayer("snotel-circles")}catch{}try{Fe.getSource("snotel")&&Fe.removeSource("snotel")}catch{}Jo.current?.remove()}},[]),Jo=Z.useRef(null),Al=Z.useRef([]),Zi=Z.useCallback(Fe=>{const Pt=F.current;if(!Pt)return;Qo(),Al.current=Fe;const Nt=["match",["get","colorKey"]],Qt=Fe.map(Gt=>{const Yr=Nd(Gt.pctMedian);return{type:"Feature",geometry:{type:"Point",coordinates:[Gt.lon,Gt.lat]},properties:{id:Gt.id,name:Gt.name,state:Gt.state,elevation:Gt.elevation,swe:Gt.swe,pctMedian:Gt.pctMedian,colorKey:Yr}}}),Ot=[...new Set(Qt.map(Gt=>Gt.properties.colorKey))];for(const Gt of Ot)Nt.push(Gt,Gt);Nt.push("#94a3b8"),Pt.addSource("snotel",{type:"geojson",data:{type:"FeatureCollection",features:Qt}}),Pt.addLayer({id:"snotel-circles",type:"circle",source:"snotel",paint:{"circle-radius":6,"circle-color":Nt,"circle-stroke-width":1.5,"circle-stroke-color":"#fff","circle-opacity":.85}});const nr=new of.Popup({closeButton:!1,closeOnClick:!1,offset:[0,-8]});Jo.current=nr,Pt.on("mouseenter","snotel-circles",Gt=>{if(Pt.getCanvas().style.cursor="pointer",Gt.features&&Gt.features[0]){const Yr=Gt.features[0].properties,xr=Gt.features[0].geometry.coordinates.slice();nr.setLngLat(xr).setHTML(`<b>${Yr.name}</b><br/>${Yr.swe!==null&&Yr.swe!=="null"?Yr.swe+" SWE":""} ${Yr.pctMedian!==null&&Yr.pctMedian!=="null"?" "+Yr.pctMedian+"% of median":""}`).addTo(Pt)}}),Pt.on("mouseleave","snotel-circles",()=>{Pt.getCanvas().style.cursor="",nr.remove()}),Pt.on("click","snotel-circles",Gt=>{if(Gt.features&&Gt.features[0]){const Yr=Gt.features[0].properties,xr=Al.current.find(on=>on.id===Yr.id);xr&&(Gt.originalEvent.stopPropagation(),ei(xr))}})},[]),ei=Z.useCallback(Fe=>{kn(Fe),ee(!1),co(""),bt(!0),_e(null),F.current?.flyTo({center:[Fe.lon,Fe.lat],zoom:10,duration:1500}),ti(Fe),Zd(Fe)},[Tr]),ti=Z.useCallback(async Fe=>{ws(!0);try{const{start:Pt,end:Nt}=OT(),Qt=`${Fe.id}:${Fe.state}:SNTL`,Ot=`${gs}/api/snow/snotel/station/${encodeURIComponent(Qt)}?start=${Pt}&end=${Nt}&elements=WTEQ::value,WTEQ::median_1991,WTEQ::pctOfMedian_1991`,Gt=await(await fetch(Ot)).text(),Yr=Vw(Gt).filter(xr=>xr[0]?.match(/^\d{4}-\d{2}-\d{2}$/));ga(Yr.map(xr=>({date:xr[0],dowy:Cg(xr[0]),swe:xr[1]?.trim()?parseFloat(xr[1]):null,median:xr[2]?.trim()?parseFloat(xr[2]):null,pctMedian:xr[3]?.trim()?parseFloat(xr[3]):null})))}catch{ga([])}ws(!1)},[]),Zd=Z.useCallback(async Fe=>{qe(!0);try{const Pt=`${Fe.id}:${Fe.state}`;let Nt=ne.current[Pt];if(!Nt){const Qt=`${Fe.id}:${Fe.state}:SNTL`,Ot=`${gs}/api/snow/snotel/por/${encodeURIComponent(Qt)}`,Gt=await(await fetch(Ot)).text();Nt=Vw(Gt).filter(xr=>xr[0]?.match(/^\d{4}-\d{2}-\d{2}$/)).map(xr=>({date:xr[0],swe:xr[1]?.trim()?parseFloat(xr[1]):null})),ne.current[Pt]=Nt}setTimeout(()=>{const Qt=rD(Nt,Fe,Tr,ta);_e(Qt),qe(!1)},500)}catch{qe(!1)}},[Tr,ta]);Z.useEffect(()=>{if(!bn||ta.length===0||Te)return;const Fe=`${bn.id}:${bn.state}`,Pt=ne.current[Fe];if(Pt){const Nt=rD(Pt,bn,Tr,ta);_e(Nt)}},[ta]);const pu=Z.useCallback(async()=>{if(!F.current)return;if(El(),Qo(),xt.current&&(Ko(xt.current),xt.current=null),be(null),Gr){Tr.length>0&&(Zi(Tr),F.current.flyTo({center:[-110,42],zoom:5,duration:1500}));return}me(!0);const Fe=new Date().getMonth()+1,Pt=B0[C],Nt="pmtiles://https://storage.googleapis.com/snow-tracker-cogs/pmtiles",Qt={"where-us-snowfall":`${Nt}/daymet_avg_max_swe.pmtiles/{z}/{x}/{y}`,"where-us-snow_depth":`${Nt}/daymet_avg_max_swe.pmtiles/{z}/{x}/{y}`,"where-global-snowfall":`${Nt}/era5_avg_snowfall.pmtiles/{z}/{x}/{y}`,"where-global-snow_depth":`${Nt}/era5_avg_snowfall.pmtiles/{z}/{x}/{y}`,"changing-us-snowfall":`${Nt}/daymet_snowfall_trend.pmtiles/{z}/{x}/{y}`,"changing-us-snow_depth":`${Nt}/daymet_swe_trend.pmtiles/{z}/{x}/{y}`,"changing-global-snowfall":`${Nt}/era5_trend.pmtiles/{z}/{x}/{y}`,"changing-global-snow_depth":`${Nt}/era5_trend.pmtiles/{z}/{x}/{y}`,"shifting-us-snowfall":`${Nt}/modis_avg_snow_days.pmtiles/{z}/{x}/{y}`,"shifting-global-snowfall":`${Nt}/modis_snow_onset_trend.pmtiles/{z}/{x}/{y}`,"season-us-snowfall":`${Nt}/modis_avg_snow_days.pmtiles/{z}/{x}/{y}`},Ot=performance.now();try{let nr=null,Gt="";const Yr=`${Ir}-${y}-${C}`;if(Qt[Yr]&&(Yt==="auto"||Yt==="gcs")&&!(Yt==="gee-era5"||Yt==="gee-snodas"||Yt==="gee-daymet")){Gt=`PMTiles (${Yr.includes("era5")?"ERA5 11km":Yr.includes("modis")?"MODIS 500m":"Daymet 1km"})`,ho(Qt[Yr],{maxNativeZoom:7,maxZoom:12}),y==="us"&&F.current.flyTo({center:[-98,39],zoom:4,duration:1500}),mr(Math.round(performance.now()-Ot)),nn(Gt),me(!1);return}if(Ir==="where")if(y==="global")nr=`${gs}/api/snow/tiles/era5?year=2024&month=${String(Fe).padStart(2,"0")}&band=${Pt.era5Band}&palette=${Xe}`,Gt="GEE Proxy  ERA5-Land 9km (live)";else if(Yt==="gee-snodas"){const Mr=new Date;Mr.setDate(Mr.getDate()-1),nr=`${gs}/api/snow/tiles/snodas?date=${Mr.toISOString().slice(0,10)}&band=${Pt.snodasBand}&palette=${Xe}`,Gt="GEE Proxy  SNODAS 1km (live, current day)",F.current.flyTo({center:[-98,39],zoom:4,duration:1500})}else if(Yt==="gee-era5")nr=`${gs}/api/snow/tiles/era5?year=2024&month=${String(Fe).padStart(2,"0")}&band=${Pt.era5Band}&palette=${Xe}`,Gt="GEE Proxy  ERA5-Land 9km (live)",F.current.flyTo({center:[-98,39],zoom:4,duration:1500});else{const Mr=new Date;Mr.setDate(Mr.getDate()-1),nr=`${gs}/api/snow/tiles/snodas?date=${Mr.toISOString().slice(0,10)}&band=${Pt.snodasBand}&palette=${Xe}`,Gt="GEE Proxy  SNODAS 1km (live, current day)",F.current.flyTo({center:[-98,39],zoom:4,duration:1500})}else if(Ir==="changing"){const Mr=c==="5"?2019:c==="10"?2014:c==="20"?2004:1980;y==="global"?(nr=`${gs}/api/snow/trends/era5?band=${Pt.era5Band}&startYear=${Mr}&endYear=2024&month=${Fe}&metric=trend&palette=${Xe}`,Gt=`GEE Proxy  ERA5-Land trend (${Mr}2024)`):(nr=`${gs}/api/snow/trends/era5?band=${Pt.era5Band}&startYear=${Mr}&endYear=2024&month=${Fe}&metric=trend&palette=${Xe}`,Gt=`GEE Proxy  ERA5-Land US trend (${Mr}2024)`,F.current.flyTo({center:[-98,39],zoom:4,duration:1500}))}else if(Ir==="shifting"){if(y==="global"||y==="us"){if(Oe.current?.points?.length){const Mr=sr==="10"?2019:2018,Lr=Oe.current.points.filter(Wt=>Wt.lat>30);if(Lr.length>0){const Wt=[9,10,11,0,1,2,3,4,5],Zn=["Oct","Nov","Dec","Jan","Feb","Mar","Apr","May","Jun"],Nr=new Array(9).fill(0),ki=new Array(9).fill(0);let ni=0,La=0;for(const wn of Lr){if(!wn.annualTotals||!wn.monthlyClim)continue;const Zr=Object.keys(wn.annualTotals).map(Number).sort(),Na=Zr.filter(ci=>ci>=2015&&ci<=Mr),gi=Zr.filter(ci=>ci>Mr&&ci<=2024);if(Na.length>0&&gi.length>0){const ci=wn.monthlyClim.reduce((kr,Ri)=>kr+Ri,0);if(ci<=0)continue;const Ai=Na.reduce((kr,Ri)=>kr+(wn.annualTotals[Ri]||0),0)/Na.length,Jr=gi.reduce((kr,Ri)=>kr+(wn.annualTotals[Ri]||0),0)/gi.length;Wt.forEach((kr,Ri)=>{const Es=wn.monthlyClim[kr]/ci;Nr[Ri]+=Es*Ai,ki[Ri]+=Es*Jr}),ni++,La++}}if(ni>0){const wn=Zn.map((Jr,kr)=>({month:Jr,early:Math.round(Nr[kr]/ni*1e4)/1e4,recent:Math.round(ki[kr]/La*1e4)/1e4}));Ss(wn);const Zr=wn.reduce((Jr,kr,Ri)=>kr.early>wn[Jr].early?Ri:Jr,0),Na=wn.reduce((Jr,kr,Ri)=>kr.recent>wn[Jr].recent?Ri:Jr,0),gi=wn.reduce((Jr,kr)=>Jr+kr.early,0),ci=wn.reduce((Jr,kr)=>Jr+kr.recent,0),Ai=gi>0?((ci-gi)/gi*100).toFixed(1):"0";Ts(Zr!==Na?`Peak snowfall shifted from ${Zn[Zr]} to ${Zn[Na]}. Total snowfall ${Number(Ai)>0?"increased":"decreased"} by ${Math.abs(Number(Ai))}%.`:`Peak snowfall remains in ${Zn[Zr]}. Total snowfall ${Number(Ai)>0?"increased":"decreased"} by ${Math.abs(Number(Ai))}%.`)}}}nr=`${gs}/api/snow/trends/modis?metric=onset_trend&startYear=2001&endYear=2024&palette=${Xe}`,y==="us"&&F.current.flyTo({center:[-98,39],zoom:4,duration:1500})}}else if(Ir==="season"){const Mr=new Date;Mr.setDate(Mr.getDate()-1),nr=`${gs}/api/snow/tiles/snodas?date=${Mr.toISOString().slice(0,10)}&band=${Pt.snodasBand}&palette=${Xe}`,F.current.flyTo({center:[-98,39],zoom:4,duration:1500})}if(nr){const Mr=Ir==="shifting";let Lr=0,Wt="";for(;Lr<2;){try{const Zn=await fetch(nr);if(!Zn.ok){Wt=`HTTP ${Zn.status}`,Lr++;continue}const Nr=await Zn.json();if(Nr.tileUrl){ho(Nr.tileUrl),Wt="";break}else Wt=Nr.error||"No tile URL returned",Lr++}catch(Zn){Wt=Zn.message,Lr++}Lr<2&&await new Promise(Zn=>setTimeout(Zn,2e3))}Wt&&!Mr&&be(Wt)}}catch(nr){be(nr.message)}mr(Math.round(performance.now()-Ot)),nn("GEE Proxy"),me(!1)},[Ir,y,c,Gr,Tr,Xe,sr,rt,C,Yt]);Z.useEffect(()=>{G&&!tr&&pu()},[G,Ir,y,c,pa,Xe,sr,rt,C]);const Ml=Z.useCallback((Fe,Pt)=>{if(!Oe.current?.points?.length)return null;let Nt=null,Qt=1/0;for(const Ot of Oe.current.points){const nr=Math.abs(Ot.lat-Fe)+Math.abs(Ot.lon-Pt);nr<Qt&&(Qt=nr,Nt=Ot)}return Qt<=7?Nt:null},[]),Hs=Z.useCallback((Fe,Pt,Nt,Qt)=>{const Ot=[];if(Fe){const Gt=Object.keys(Fe.annualTotals||{}).sort().slice(-5),Yr=Gt.length>0?Gt.reduce((xr,on)=>xr+(Fe.annualTotals[on]||0),0)/Gt.length:0;Yr>0&&Ot.push(`This location receives approximately ${(Yr*1e3).toFixed(0)} mm of annual snowfall (water equivalent).`),Fe.trend!==void 0&&Ot.push(`Snowfall here has ${Fe.trend>0?"increased":"decreased"} by ${Math.abs(Fe.trend*1e4).toFixed(1)} mm per decade.`),Fe.variability!==void 0&&Ot.push(`Year-to-year variability: ${(Fe.variability*100).toFixed(0)}%.`)}else Pt.length>0&&Ot.push(`Peak value this period: ${Math.max(...Pt.map(nr=>nr.value)).toFixed(3)}.`);Ot.length===0&&Ot.push("Click other locations to compare snowfall data."),Ce(Ot.join(" "))},[]);Z.useEffect(()=>{if(!yt||Gr)return;if(Oe.current){const Qt=Ml(yt.lat,yt.lon);if(Qt){at(Qt);const Ot=[];for(const[nr,Gt]of Object.entries(Qt.annualTotals||{})){const Yr=Qt.monthlyClim.reduce((xr,on)=>xr+on,0);Qt.monthlyClim.forEach((xr,on)=>{const Mr=Yr>0?xr/Yr*Gt:0;Ot.push({date:`${nr}-${String(on+1).padStart(2,"0")}`,value:Math.round(Mr*1e4)/1e4})})}Rt(Ot),kt(!1),Hs(Qt,Ot,yt.lat,yt.lon);return}}at(null),kt(!0);const Fe=B0[C],Pt=Ir==="season"||y==="us";let Nt;if(Pt){const Qt=new Date;Qt.setDate(Qt.getDate()-1);const Ot=Qt.getFullYear(),nr=Qt.getMonth(),Gt=nr>=9?`${Ot}-10-01`:`${Ot-1}-10-01`,Yr=nr>=9?`${Ot+1}-04-30`:`${Ot}-04-30`;Nt=`${gs}/api/snow/stats/snodas?lat=${yt.lat}&lon=${yt.lon}&start=${Gt}&end=${Yr}&band=${Fe.snodasBand}`}else Nt=`${gs}/api/snow/stats/era5?lat=${yt.lat}&lon=${yt.lon}&start=2015-01&end=2024-12&band=${Fe.era5Band}`;fetch(Nt).then(Qt=>Qt.json()).then(Qt=>{const Ot=Qt.series||[];Rt(Ot),kt(!1),Hs(null,Ot,yt.lat,yt.lon)}).catch(()=>kt(!1))},[yt,Ir,y]);const Af=Z.useCallback(async()=>{pr(!0),ft(0),Be(!1),gn(!0);try{const Fe=B0[C],Pt=new Date().getMonth()+1;let Nt;y==="us"?(Nt=`${gs}/api/snow/animation/snodas?startYear=2015&endYear=2024&band=${Fe.snodasBand}`,F.current?.flyTo({center:[-98,39],zoom:4,duration:1500})):Nt=`${gs}/api/snow/animation/era5?startYear=2015&endYear=2024&month=${String(Pt).padStart(2,"0")}&band=${Fe.era5Band}`;const Ot=await(await fetch(Nt)).json();Vt(Ot.frames||[]),gn(!1),(Ot.frames||[]).length>0&&Be(!0)}catch{Vt([]),gn(!1)}},[y]);Z.useEffect(()=>{if(!tr||!Lt.length||!F.current)return;const Fe=Lt[yr];if(!Fe?.tileUrl)return;const Pt=F.current,Nt=`anim-tile-${++q.current}`;Pt.addSource(Nt,{type:"raster",tiles:[Fe.tileUrl],tileSize:256,maxzoom:12}),Pt.addLayer({id:Nt,type:"raster",source:Nt,paint:{"raster-opacity":.75}});const Qt=xt.current;if(Qt){try{Pt.getLayer(Qt)&&Pt.removeLayer(Qt)}catch{}try{Pt.getSource(Qt)&&Pt.removeSource(Qt)}catch{}}xt.current=Nt},[yr,tr,Lt]),Z.useEffect(()=>{fr.current=nt},[nt]),Z.useEffect(()=>{if(!nt||!Lt.length)return;let Fe=!1;const Pt=Math.round(1500/lt),Nt=()=>{Fe||!fr.current||(ft(Qt=>Qt<Lt.length-1?Qt+1:0),setTimeout(Nt,Pt))};return setTimeout(Nt,Pt),()=>{Fe=!0}},[nt,Lt.length,lt]);const Hi=Z.useMemo(()=>{const Fe={};return Ge.forEach(Pt=>{const Nt=Pt.date.slice(0,4);Fe[Nt]=(Fe[Nt]||0)+Pt.value}),Object.entries(Fe).map(([Pt,Nt])=>({year:Pt,total:Math.round(Nt*1e4)/1e4}))},[Ge]),Pl=Fe=>{_(Fe),bt(!1),tt(null),kn(null),ga([]),_e(null)},es=[{tab:"where",lens:"us",label:"US Snowfall"},{tab:"where",lens:"global",label:"Global Snowfall"},{tab:"where",lens:"mountain",label:"Pick a Station"},{tab:"changing",lens:"us",label:"US Trends"},{tab:"changing",lens:"global",label:"Global Trends"},{tab:"changing",lens:"mountain",label:"Station Trends"},{tab:"shifting",lens:"global",label:"Season Timing"},{tab:"shifting",lens:"mountain",label:"Station Timing"},{tab:"season",lens:"us",label:"Current Snow"},{tab:"season",lens:"mountain",label:"Station Check"}],jo=!va&&!an,ri=jo?es.findIndex(Fe=>Fe.tab===o&&Fe.lens===y):-1,fh=ri>=0&&ri<es.length-1,Cl=ri>0,fo=Fe=>{if(Fe<0||Fe>=es.length)return;const Pt=es[Fe];Pt.tab!==o&&(m(Pt.tab),bt(!1),tt(null),kn(null),pr(!1),Be(!1),ga([]),_e(null)),_(Pt.lens)},Mf=()=>{m("explorer"),_("us"),bt(!1),tt(null),kn(null),pr(!1),Be(!1),ga([]),_e(null)},Ws=()=>{fn(!0),setTimeout(()=>{Et(!1),fn(!1)},600)};return U.jsxs("div",{className:"relative w-full h-screen overflow-hidden",style:{background:"#0f172a"},children:[U.jsx("style",{children:GW}),t&&U.jsx(u3,{onClose:()=>i(!1)}),an&&U.jsxs("div",{className:`hero-overlay ${jr?"hero-exit":""}`,children:[U.jsx("div",{className:"hero-bg"}),U.jsxs("div",{className:"relative z-10 text-center max-w-2xl px-8 hero-enter",children:[U.jsx("h1",{className:"text-5xl font-bold tracking-tight mb-4",style:{fontFamily:"'Inter', system-ui, sans-serif",color:"#0f172a"},children:"Snow Tracker"}),U.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:"#475569"},children:"Where does it snow most? Is snowfall changing? Is winter shifting?"}),U.jsx("p",{className:"text-sm leading-relaxed max-w-lg mx-auto mb-10",style:{color:"#94a3b8"},children:"Snow feeds rivers that supply water to billions. It regulates climate, reflects sunlight, and shapes ecosystems. As the planet warms, understanding how snowfall is changing matters more than ever."}),U.jsx("button",{onClick:Ws,className:"snow-next hover:scale-105",style:{transition:"all 0.15s"},children:"Begin Exploring"})]})]}),U.jsx("div",{className:"absolute inset-0 z-0",children:U.jsx("div",{ref:k,style:{width:"100%",height:"100%"}})}),!an&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute top-0 left-0 right-0 z-[1000] pointer-events-none",children:U.jsxs("div",{className:"flex items-start justify-between p-2 sm:p-4 pointer-events-auto",children:[U.jsx("div",{children:window.location.port==="3000"&&U.jsx("a",{href:"/",className:"snow-panel rounded-xl px-3 py-2 text-sm inline-flex items-center gap-1.5",style:{color:"#0369a1"},children:"Hub"})}),U.jsxs("div",{className:"snow-panel rounded-2xl px-4 sm:px-6 py-2 sm:py-3 text-center max-w-xl mx-auto",children:[va?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"text-[10px] uppercase tracking-widest mb-0.5",style:{color:"#94a3b8"},children:"Explorer Mode"}),U.jsx("div",{className:"text-base sm:text-lg font-semibold",style:{color:"#0f172a"},children:"Free Exploration"})]}):U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"text-[10px] uppercase tracking-widest mb-0.5",style:{color:"#94a3b8"},children:["Step ",ri+1," of ",es.length]}),U.jsx("div",{className:"text-base sm:text-lg font-semibold",style:{color:"#0f172a"},children:Dn.question}),U.jsx("div",{className:"text-xs sm:text-sm mt-0.5 hidden sm:block",style:{color:"#475569"},children:Tl})]}),ue&&U.jsxs("div",{className:"mt-1 flex items-center justify-center gap-2",children:[U.jsx("div",{className:"w-1.5 h-1.5 rounded-full animate-pulse",style:{background:"#0369a1"}}),U.jsx("span",{className:"text-xs",style:{color:"#0369a1"},children:"Loading..."})]}),ge&&U.jsx("div",{className:"mt-1 text-xs",style:{color:"#dc2626"},children:ge})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{onClick:()=>Ne(!0),className:"snow-panel rounded-full w-9 h-9 flex items-center justify-center text-xs font-bold hover:scale-110 transition-transform cursor-pointer",title:"Data source info",style:{color:"#0369a1"},children:"i"}),U.jsx("button",{onClick:()=>i(!0),className:"snow-panel rounded-xl px-3 h-9 flex items-center justify-center text-xs font-semibold hover:scale-105 transition-transform cursor-pointer",title:"Data methodology",style:{color:"#0369a1"},children:"Data Methods"}),U.jsx("button",{onClick:()=>_t(!0),className:"snow-panel rounded-xl px-3 h-9 flex items-center justify-center text-xs font-semibold hover:scale-105 transition-transform cursor-pointer",title:"About this project",style:{color:"#0369a1"},children:"About"})]})]})}),!an&&U.jsxs("div",{className:"hidden sm:block",style:{position:"fixed",right:16,top:120,zIndex:1100},children:[U.jsx("button",{onClick:()=>hr(!qt),style:{background:qt?"#0369a1":"#fff",color:qt?"#fff":"#0369a1",border:"1px solid #0369a1",borderRadius:8,padding:"6px 14px",fontSize:12,fontWeight:600,cursor:"pointer"},children:qt?"Close Eval":"Eval Mode"}),qt&&U.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginTop:8,width:320,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[U.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#0f172a",marginBottom:12},children:"Data Source Evaluation"}),U.jsxs("div",{style:{background:"#f8fafc",borderRadius:8,padding:10,marginBottom:12,fontSize:11},children:[U.jsx("div",{style:{color:"#64748b",marginBottom:4},children:"Currently showing:"}),U.jsx("div",{style:{color:"#0f172a",fontWeight:600},children:Bn||"None"}),rr!==null&&U.jsxs("div",{style:{color:rr<500?"#16a34a":rr<2e3?"#d97706":"#dc2626",marginTop:4,fontWeight:600},children:["Load time: ",rr,"ms"]})]}),U.jsx("div",{style:{fontSize:11,color:"#64748b",marginBottom:6,fontWeight:600,textTransform:"uppercase",letterSpacing:1},children:"Switch source:"}),[{key:"auto",label:"Auto (best available)",desc:"GCS tiles when available, GEE proxy fallback"},{key:"gcs",label:"GCS Pre-rendered Tiles",desc:"Daymet 1km / MODIS 500m, static color ramp, instant load. Only US views for snowfall variable."},{key:"gee-era5",label:"GEE Proxy  ERA5-Land",desc:"9km global reanalysis, live computation, custom color ramps. Slower but flexible."},{key:"gee-snodas",label:"GEE Proxy  SNODAS",desc:"1km US model assimilation, current day only, live computation."}].map(Fe=>U.jsxs("button",{onClick:()=>lr(Fe.key),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 10px",marginBottom:4,background:Yt===Fe.key?"#e0f2fe":"#fff",border:`1px solid ${Yt===Fe.key?"#0369a1":"#e2e8f0"}`,borderRadius:8,cursor:"pointer",transition:"all 0.15s"},children:[U.jsx("div",{style:{fontSize:12,fontWeight:600,color:Yt===Fe.key?"#0369a1":"#334155"},children:Fe.label}),U.jsx("div",{style:{fontSize:10,color:"#64748b",marginTop:2,lineHeight:1.3},children:Fe.desc})]},Fe.key)),U.jsxs("div",{style:{marginTop:12,padding:10,background:"#f0f9ff",borderRadius:8,fontSize:10,lineHeight:1.5,color:"#334155"},children:[U.jsx("div",{style:{fontWeight:700,marginBottom:4,fontSize:11},children:"What to compare:"}),U.jsxs("div",{children:[U.jsx("b",{children:"GCS tiles"})," = pre-rendered PNGs on Google Cloud Storage. Fast (no server computation), but fixed color ramp and only available for US snowfall views."]}),U.jsxs("div",{style:{marginTop:4},children:[U.jsx("b",{children:"GEE Proxy"})," = live computation via Google Earth Engine. Slower first load, but supports any band, time range, color ramp, and click-for-time-series."]}),U.jsxs("div",{style:{marginTop:4},children:[U.jsx("b",{children:"ERA5 vs SNODAS vs Daymet:"})," ERA5 = 9km global reanalysis (coarser, global). SNODAS = 1km US model (current conditions). Daymet = 1km US 45yr record (best for long-term US trends)."]})]})]})]}),jo&&U.jsxs("div",{className:"hidden sm:flex",style:{position:"fixed",left:16,top:"50%",transform:"translateY(-50%)",zIndex:1e3,flexDirection:"column",gap:8,alignItems:"center"},children:[U.jsx("div",{style:{position:"absolute",top:6,bottom:6,left:"50%",transform:"translateX(-50%)",width:2,background:"#e2e8f0",borderRadius:1}}),es.map((Fe,Pt)=>U.jsx("div",{style:{position:"relative",zIndex:1,width:Pt===ri?14:8,height:Pt===ri?14:8,borderRadius:"50%",background:Pt<ri?"#0369a1":Pt===ri?"#0284c7":"#cbd5e1",border:Pt===ri?"2px solid #0369a1":"none",transition:"all 0.3s",cursor:"pointer",boxShadow:Pt===ri?"0 0 0 3px rgba(3,105,161,0.2)":"none"},onClick:()=>fo(Pt),title:Fe.label},Pt))]}),va&&U.jsx("div",{className:"absolute top-16 sm:top-24 left-1/2 -translate-x-1/2 z-[900] fade-in w-[calc(100%-24px)] sm:w-auto",children:U.jsxs("div",{className:"flex flex-col items-center gap-1 sm:gap-1.5",children:[U.jsx("div",{className:"snow-panel rounded-xl p-1 flex items-center gap-0.5",children:["where","changing","shifting","season"].map(Fe=>U.jsx("button",{onClick:()=>Xo(Fe),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 ${ja===Fe?"tab-active":"tab-inactive"}`,children:Fe==="where"?"Where":Fe==="changing"?"Changing":Fe==="shifting"?"Shifting":"This Season"},Fe))}),U.jsx("div",{className:"snow-panel rounded-xl p-1 flex items-center gap-0.5",children:Dn.lenses.map(Fe=>U.jsx("button",{onClick:()=>Pl(Fe.key),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 ${y===Fe.key?"tab-active":"tab-inactive"}`,children:Fe.label},Fe.key))}),!Gr&&(Ir==="where"||Ir==="changing"||Ir==="season")&&U.jsx("div",{className:"snow-panel rounded-xl p-1 flex items-center gap-0.5",children:[["snowfall","Snowfall"],["snow_depth","Snow Depth"],["snow_cover","Snow Cover"]].map(([Fe,Pt])=>U.jsx("button",{onClick:()=>D(Fe),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 ${C===Fe?"tab-active":"tab-inactive"}`,children:Pt},Fe))}),Ir==="changing"&&!Gr&&U.jsxs("div",{className:"snow-panel rounded-xl p-1 flex items-center gap-0.5",children:[U.jsx("span",{className:"text-[10px] px-2",style:{color:"#64748b"},children:"Range:"}),["5","10","20","all"].map(Fe=>U.jsx("button",{onClick:()=>M(Fe),className:`px-2.5 py-1 rounded-lg text-xs font-medium transition-all ${c===Fe?"tab-active":"tab-inactive"}`,children:Fe==="all"?"All":`${Fe}yr`},Fe))]})]})}),Gr&&U.jsx("div",{className:"absolute z-[950] fade-in w-[calc(100%-32px)] sm:w-auto",style:{top:va?200:80,left:"50%",transform:"translateX(-50%)"},children:U.jsx("div",{className:"snow-panel rounded-xl px-3 sm:px-4 py-2 sm:py-2.5 w-full sm:w-80",children:bs?U.jsxs("div",{className:"flex items-center gap-2 text-sm",style:{color:"#64748b"},children:[U.jsx("div",{className:"w-3 h-3 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#0369a1",borderTopColor:"transparent"}}),"Loading stations..."]}):U.jsxs("div",{className:"relative",children:[U.jsx("input",{type:"text",value:ma,onChange:Fe=>{co(Fe.target.value),ee(!0)},onFocus:()=>ee(!0),placeholder:"Search SNOTEL stations...",className:"w-full rounded-xl px-3 py-2 text-sm outline-none transition-colors",style:{background:"rgba(255,255,255,0.6)",color:"#0f172a",border:"1px solid rgba(3,105,161,0.15)"}}),bn&&!je&&U.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[U.jsxs("span",{className:"font-medium",style:{color:"#0f172a"},children:[bn.name," (",bn.state,")"]}),U.jsx("span",{className:"font-bold",style:{color:Nd(bn.pctMedian)},children:bn.pctMedian!==null?`${bn.pctMedian}%`:"--"})]}),je&&U.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 rounded-xl max-h-64 overflow-y-auto z-50",style:{background:"rgba(255,255,255,0.97)",border:"1px solid rgba(3,105,161,0.12)",boxShadow:"0 8px 30px rgba(3,105,161,0.08)"},children:[Ur.map(Fe=>U.jsx("button",{onClick:()=>ei(Fe),className:"w-full text-left px-3 py-2 transition-colors last:border-0 hover:bg-sky-50",style:{borderBottom:"1px solid #e2e8f0"},children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsx("div",{className:"text-sm font-medium",style:{color:"#0f172a"},children:Fe.name}),U.jsxs("div",{className:"text-[10px]",style:{color:"#64748b"},children:[Fe.state,"  ",Fe.elevation.toLocaleString(),"'  ",Fe.swe!==null?Fe.swe+'"':"N/A"]})]}),U.jsx("div",{className:"text-sm font-bold",style:{color:Nd(Fe.pctMedian)},children:Fe.pctMedian!==null?`${Fe.pctMedian}%`:"--"})]})},Fe.id)),Ur.length===0&&U.jsx("div",{className:"px-3 py-4 text-center text-sm",style:{color:"#94a3b8"},children:"No stations found"})]})]})})}),je&&U.jsx("div",{className:"absolute inset-0 z-[940]",onClick:()=>ee(!1)}),tr&&Lt.length>0&&U.jsx("div",{className:"absolute top-32 left-1/2 -translate-x-1/2 z-[100] pointer-events-none",children:U.jsx("div",{className:"text-8xl font-bold tracking-wider",style:{color:"rgba(3,105,161,0.15)",textShadow:"0 0 60px rgba(3,105,161,0.08)"},children:Lt[yr]?.year||""})}),U.jsx("div",{className:"absolute bottom-16 sm:bottom-24 left-2 sm:left-4 z-[800] flex flex-col gap-2 sm:gap-2.5",children:!Gr&&U.jsx("div",{className:"snow-panel rounded-xl px-2 sm:px-4 py-2 sm:py-3",onMouseEnter:()=>rn(!0),onMouseLeave:()=>rn(!1),children:tr?U.jsx("div",{className:"space-y-2",children:Tt?U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"rgba(3,105,161,0.08)"},children:U.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#0369a1",borderTopColor:"transparent"}})}),U.jsx("span",{className:"text-xs",style:{color:"#0369a1"},children:"Loading..."})]}):U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{onClick:()=>Be(!nt),className:"w-10 h-10 rounded-full flex items-center justify-center transition-colors",style:{background:"#0369a1",boxShadow:"0 2px 12px rgba(3,105,161,0.2)"},children:U.jsx("span",{className:"text-sm font-semibold text-white",children:nt?"Pause":"Play"})}),U.jsxs("div",{className:"text-xs font-medium",style:{color:"#0f172a"},children:[yr+1," / ",Lt.length]}),U.jsx("button",{onClick:()=>{pr(!1),Be(!1),pu()},className:"ml-auto text-sm",style:{color:"#94a3b8"},children:"x"})]}),U.jsx("input",{type:"range",min:0,max:Lt.length-1,value:yr,onChange:Fe=>{ft(Number(Fe.target.value)),Be(!1)},className:"w-full h-1.5 appearance-none rounded-lg",style:{background:"rgba(3,105,161,0.12)"}}),Sr&&U.jsxs("div",{className:"flex items-center gap-2 fade-in",children:[U.jsx("span",{className:"text-[10px]",style:{color:"#64748b"},children:"Speed"}),U.jsx("input",{type:"range",min:.5,max:3,step:.25,value:lt,onChange:Fe=>Ft(Number(Fe.target.value)),className:"flex-1 h-1 appearance-none rounded",style:{background:"rgba(3,105,161,0.12)"}}),U.jsxs("span",{className:"text-[10px] min-w-[2rem]",style:{color:"#64748b"},children:[lt,"x"]})]})]})}):U.jsxs("button",{onClick:Af,disabled:Tt||Ir==="shifting",className:"flex items-center gap-1.5 sm:gap-2 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",style:{color:"#334155"},children:[U.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center transition-colors",style:{background:"#0369a1",boxShadow:"0 2px 12px rgba(3,105,161,0.2)"},children:U.jsx("span",{className:"text-xs sm:text-sm font-semibold text-white",children:"Play"})}),U.jsxs("div",{className:"hidden sm:block",children:[U.jsx("div",{className:"text-xs font-medium",style:{color:"#0f172a"},children:"Animate"}),U.jsx("div",{className:"text-[10px]",style:{color:"#64748b"},children:"2015 - 2024"})]})]})})}),U.jsx("div",{className:"absolute bottom-16 sm:bottom-24 right-2 sm:right-4 z-[800]",children:U.jsxs("div",{className:"snow-panel rounded-2xl w-40 sm:w-52 overflow-hidden transition-all duration-300",children:[U.jsx("button",{onClick:()=>ui(!hn),className:"w-full px-3 sm:px-4 py-2 sm:py-3 text-left cursor-pointer transition-colors hover:bg-slate-50",children:(Ir==="where"||Ir==="season")&&!Gr?U.jsxs("div",{className:"text-xs",children:[U.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[U.jsx("span",{className:"font-medium",style:{color:"#334155"},children:B0[C].label}),U.jsx("span",{className:"text-[10px]",style:{color:"#0369a1"},children:hn?"Collapse":"Ramps"})]}),U.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:qw(Xe,"where")}}),U.jsxs("div",{className:"flex justify-between mt-1 text-[10px]",style:{color:"#94a3b8"},children:[U.jsx("span",{children:"None"}),U.jsx("span",{children:"Deep"})]})]}):Ir==="changing"&&!Gr?U.jsxs("div",{className:"text-xs",children:[U.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[U.jsx("span",{className:"font-medium",style:{color:"#334155"},children:"Snowfall Trend"}),U.jsx("span",{className:"text-[10px]",style:{color:"#0369a1"},children:hn?"Collapse":"Ramps"})]}),U.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:qw(Xe,"changing")}}),U.jsxs("div",{className:"flex justify-between mt-1 text-[10px]",style:{color:"#94a3b8"},children:[U.jsx("span",{children:"Declining"}),U.jsx("span",{children:"Increasing"})]})]}):Ir==="shifting"&&!Gr?U.jsxs("div",{className:"text-xs",children:[U.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[U.jsx("span",{className:"font-medium",style:{color:"#334155"},children:"Season Shift"}),U.jsx("span",{className:"text-[10px]",style:{color:"#0369a1"},children:hn?"Collapse":"Ramps"})]}),U.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:qw(Xe,"shifting")}}),U.jsxs("div",{className:"flex justify-between mt-1 text-[10px]",style:{color:"#94a3b8"},children:[U.jsx("span",{children:"Earlier"}),U.jsx("span",{children:"Later"})]})]}):Gr?U.jsxs("div",{className:"text-xs",children:[U.jsx("div",{className:"flex items-center justify-between mb-1.5",children:U.jsx("span",{className:"font-medium",style:{color:"#334155"},children:"% of Median SWE"})}),U.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:[{color:"#ef4444",label:"<50%"},{color:"#f97316",label:"50-80%"},{color:"#eab308",label:"80-100%"},{color:"#22c55e",label:"100-120%"},{color:"#3b82f6",label:">120%"}].map(Fe=>U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:Fe.color}}),U.jsx("span",{className:"text-[10px]",style:{color:"#94a3b8"},children:Fe.label})]},Fe.label))})]}):null}),hn&&!Gr&&U.jsxs("div",{className:"px-4 pb-3 pt-2 fade-in",style:{borderTop:"1px solid #e2e8f0"},children:[U.jsx("div",{className:"text-[10px] uppercase tracking-wider mb-2 font-medium",style:{color:"#0369a1"},children:"Color Ramp"}),U.jsx("div",{className:"space-y-1",children:YW(Ir).map(({key:Fe,label:Pt,gradient:Nt})=>U.jsxs("button",{onClick:()=>{Me(Fe),ui(!1)},className:"w-full flex items-center gap-2 px-2 py-1.5 rounded-lg text-xs transition-all hover:bg-slate-50",style:{background:Xe===Fe?"rgba(3,105,161,0.08)":"transparent",border:Xe===Fe?"1px solid #0369a1":"1px solid transparent"},children:[U.jsx("div",{className:"h-3 flex-1 rounded-full overflow-hidden",style:{background:Nt}}),U.jsx("span",{className:"text-[10px] min-w-[60px] text-right",style:{color:"#64748b"},children:Pt})]},Fe))})]})]})}),pt&&(Gr?bn:yt)&&U.jsx("div",{className:"absolute top-16 sm:top-20 right-2 sm:right-4 left-2 sm:left-auto z-[850] sm:w-[400px] slide-up",style:{maxHeight:"calc(100vh - 100px)"},children:U.jsx("div",{className:"snow-panel rounded-2xl overflow-hidden overflow-y-auto",style:{maxHeight:"calc(100vh - 120px)",boxShadow:"0 8px 40px rgba(3,105,161,0.08)"},children:Gr&&bn?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"px-5 py-4",style:{borderBottom:"1px solid #e2e8f0"},children:U.jsxs("div",{className:"flex items-start justify-between",children:[U.jsxs("div",{children:[U.jsx("div",{className:"text-lg font-semibold",style:{color:"#0f172a"},children:bn.name}),U.jsxs("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:[bn.state,"  ",bn.elevation.toLocaleString(),"'  ID ",bn.id]})]}),U.jsx("button",{onClick:()=>{bt(!1),kn(null),_e(null)},className:"w-9 h-9 sm:w-8 sm:h-8 rounded-full flex items-center justify-center transition-colors hover:bg-sky-100 text-base sm:text-sm font-bold",style:{background:"rgba(3,105,161,0.08)",color:"#64748b"},children:""})]})}),U.jsx("div",{className:"px-5 py-3",children:U.jsx(ZW,{station:bn,hydroData:ta,hydroLoading:du,analytics:ae,analyticsLoading:Te,activeTab:Ir})})]}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"px-5 py-4",style:{borderBottom:"1px solid #e2e8f0"},children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsxs("div",{className:"text-lg font-semibold",style:{color:"#0f172a"},children:[yt.lat,"N, ",Math.abs(yt.lon),yt.lon<0?"W":"E"]}),U.jsx("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:Ue?"Pre-computed":"Live query"})]}),U.jsx("button",{onClick:()=>{bt(!1),tt(null)},className:"w-9 h-9 sm:w-8 sm:h-8 rounded-full flex items-center justify-center transition-colors hover:bg-sky-100 text-base sm:text-sm font-bold",style:{background:"rgba(3,105,161,0.08)",color:"#64748b"},children:""})]})}),U.jsx("div",{className:"px-5 py-3",children:zt?U.jsxs("div",{className:"flex items-center gap-2 py-4",children:[U.jsx("div",{className:"w-3 h-3 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#0369a1",borderTopColor:"transparent"}}),U.jsx("span",{className:"text-sm",style:{color:"#64748b"},children:"Querying snow data..."})]}):U.jsxs(U.Fragment,{children:[U.jsx("p",{className:"text-sm leading-relaxed",style:{color:"#475569"},children:Ut}),Ue&&U.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[U.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"rgba(3,105,161,0.06)",border:"1px solid rgba(3,105,161,0.1)"},children:[U.jsxs("div",{className:"text-2xl font-bold",style:{color:Ue.trend>0?"#0891b2":"#dc2626"},children:[Ue.trend>0?"+":"",(Ue.trend*1e4).toFixed(1)]}),U.jsx("div",{className:"text-[10px] mt-1",style:{color:"#64748b"},children:"mm/decade"})]}),U.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"rgba(3,105,161,0.06)",border:"1px solid rgba(3,105,161,0.1)"},children:[U.jsxs("div",{className:"text-2xl font-bold",style:{color:"#7c3aed"},children:[(Ue.variability*100).toFixed(0),"%"]}),U.jsx("div",{className:"text-[10px] mt-1",style:{color:"#64748b"},children:"variability"})]})]}),Ge.length>0&&U.jsx("div",{className:"mt-3",style:{height:150},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(q2,{data:Ge,children:[U.jsx("defs",{children:U.jsxs("linearGradient",{id:"snowGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[U.jsx("stop",{offset:"5%",stopColor:"#0ea5e9",stopOpacity:.25}),U.jsx("stop",{offset:"95%",stopColor:"#0ea5e9",stopOpacity:.02})]})}),U.jsx(jg,{strokeDasharray:"3 3",stroke:"rgba(3,105,161,0.08)"}),U.jsx(Kp,{dataKey:"date",tick:{fill:"#94a3b8",fontSize:8},interval:Math.max(1,Math.floor(Ge.length/6))}),U.jsx(Qp,{tick:{fill:"#94a3b8",fontSize:9},width:40}),U.jsx(Ev,{contentStyle:{background:"rgba(255,255,255,0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(3,105,161,0.12)",borderRadius:12,fontSize:11,color:"#0f172a"}}),U.jsx(Xp,{type:"monotone",dataKey:"value",stroke:"#0ea5e9",fill:"url(#snowGrad)",strokeWidth:1.5,name:"Snow"})]})})}),Hi.length>2&&U.jsxs("div",{className:"mt-2",children:[U.jsx("div",{className:"text-[10px] mb-1 font-medium uppercase tracking-wider",style:{color:"#0369a1"},children:"Annual Totals"}),U.jsx("div",{style:{height:90},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(WH,{data:Hi,children:[U.jsx(Kp,{dataKey:"year",tick:{fill:"#94a3b8",fontSize:8}}),U.jsx(Qp,{tick:{fill:"#94a3b8",fontSize:8},width:35}),U.jsx(AT,{dataKey:"total",fill:"#0ea5e9",radius:[3,3,0,0],name:"Total"})]})})})]}),Ge.length===0&&!zt&&U.jsx("div",{className:"text-center py-4 text-sm",style:{color:"#94a3b8"},children:"No data at this location"})]})})]})})}),Ze&&(()=>{const Fe=WW(Ir,y);return U.jsxs("div",{className:"absolute inset-0 z-[2000] flex items-center justify-center",onClick:()=>Ne(!1),children:[U.jsx("div",{className:"absolute inset-0",style:{background:"rgba(0,0,0,0.25)"}}),U.jsxs("div",{className:"relative snow-panel rounded-3xl px-5 sm:px-8 py-5 sm:py-6 mx-4 sm:mx-0 max-w-md",style:{boxShadow:"0 8px 40px rgba(3,105,161,0.12)"},onClick:Pt=>Pt.stopPropagation(),children:[U.jsx("button",{onClick:()=>Ne(!1),className:"absolute top-3 right-4 w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold hover:bg-slate-100 transition-colors",style:{color:"#64748b"},children:""}),U.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"#0f172a"},children:"Data Source"}),U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{children:[U.jsx("div",{className:"text-[10px] uppercase tracking-wider",style:{color:"#0369a1"},children:"Source"}),U.jsx("div",{className:"text-sm",style:{color:"#0f172a"},children:Fe.source})]}),U.jsxs("div",{children:[U.jsx("div",{className:"text-[10px] uppercase tracking-wider",style:{color:"#0369a1"},children:"Resolution"}),U.jsx("div",{className:"text-sm",style:{color:"#0f172a"},children:Fe.resolution})]}),U.jsxs("div",{children:[U.jsx("div",{className:"text-[10px] uppercase tracking-wider",style:{color:"#0369a1"},children:"Method"}),U.jsx("div",{className:"text-sm leading-relaxed",style:{color:"#475569"},children:Fe.method})]}),U.jsxs("div",{children:[U.jsx("div",{className:"text-[10px] uppercase tracking-wider",style:{color:"#0369a1"},children:"Collection ID"}),U.jsx("div",{className:"text-xs font-mono",style:{color:"#0891b2"},children:Fe.collection})]})]})]})]})})(),Ir==="shifting"&&!Gr&&Zs.length>0&&U.jsx("div",{className:"absolute bottom-16 sm:bottom-24 left-1/2 -translate-x-1/2 z-[700] fade-in",style:{width:"min(600px, calc(100vw - 16px))"},children:U.jsxs("div",{className:"snow-panel rounded-2xl px-6 py-5",style:{boxShadow:"0 8px 40px rgba(3,105,161,0.08)"},children:[U.jsxs("div",{className:"flex items-center justify-between mb-3",children:[U.jsxs("div",{children:[U.jsx("div",{className:"text-sm font-semibold",style:{color:"#0f172a"},children:"Seasonal Snowfall Distribution"}),U.jsx("div",{className:"text-[10px]",style:{color:"#64748b"},children:"Northern Hemisphere average"})]}),U.jsx("div",{className:"flex gap-1",children:["10","20"].map(Fe=>U.jsxs("button",{onClick:()=>Ra(Fe),className:`px-2.5 py-1 rounded-lg text-xs font-medium transition-all ${sr===Fe?"tab-active":"tab-inactive"}`,children:[Fe," yr"]},Fe))})]}),U.jsx("div",{style:{height:200},children:U.jsx(kg,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:U.jsxs(q2,{data:Zs,children:[U.jsxs("defs",{children:[U.jsxs("linearGradient",{id:"earlyGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[U.jsx("stop",{offset:"5%",stopColor:"#0ea5e9",stopOpacity:.25}),U.jsx("stop",{offset:"95%",stopColor:"#0ea5e9",stopOpacity:.02})]}),U.jsxs("linearGradient",{id:"recentGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[U.jsx("stop",{offset:"5%",stopColor:"#7c3aed",stopOpacity:.2}),U.jsx("stop",{offset:"95%",stopColor:"#7c3aed",stopOpacity:.02})]})]}),U.jsx(jg,{strokeDasharray:"3 3",stroke:"rgba(3,105,161,0.08)"}),U.jsx(Kp,{dataKey:"month",tick:{fontSize:11,fill:"#64748b"}}),U.jsx(Qp,{tick:{fontSize:10,fill:"#94a3b8"},width:45}),U.jsx(Ev,{contentStyle:{background:"rgba(255,255,255,0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(3,105,161,0.12)",borderRadius:12,fontSize:11,color:"#0f172a"}}),U.jsx(Xp,{type:"monotone",dataKey:"early",stroke:"#0ea5e9",fill:"url(#earlyGrad)",strokeWidth:2,name:`2015-${sr==="10"?"2019":"2018"}`}),U.jsx(Xp,{type:"monotone",dataKey:"recent",stroke:"#7c3aed",fill:"url(#recentGrad)",strokeWidth:2,name:`${sr==="10"?"2020":"2019"}-2024`})]})})}),U.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[U.jsxs("span",{className:"flex items-center gap-1.5 text-xs",style:{color:"#64748b"},children:[U.jsx("span",{className:"w-3 h-0.5 inline-block rounded",style:{background:"#0369a1"}})," Early period"]}),U.jsxs("span",{className:"flex items-center gap-1.5 text-xs",style:{color:"#64748b"},children:[U.jsx("span",{className:"w-3 h-0.5 inline-block rounded",style:{background:"#7c3aed"}})," Recent period"]}),gr&&U.jsx("span",{className:"text-xs font-medium ml-auto",style:{color:"#0891b2"},children:gr})]})]})}),Ir==="season"&&Gr&&!bn&&pa&&U.jsx("div",{className:"absolute top-32 left-1/2 -translate-x-1/2 z-[600] fade-in",children:U.jsxs("div",{className:"snow-panel rounded-2xl px-8 py-6 text-center max-w-sm",style:{boxShadow:"0 8px 40px rgba(3,105,161,0.08)"},children:[U.jsxs("div",{className:"text-5xl font-bold",style:{color:Nd(zi.avg)},children:[zi.avg,"%"]}),U.jsxs("div",{className:"text-sm mt-1",style:{color:"#475569"},children:["average of median across ",zi.total," stations"]}),U.jsxs("div",{className:"flex items-center justify-center gap-6 mt-3 text-sm",children:[U.jsxs("span",{className:"font-semibold",style:{color:"#16a34a"},children:[zi.above," above"]}),U.jsxs("span",{className:"font-semibold",style:{color:"#dc2626"},children:[zi.below," below"]})]}),U.jsx("div",{className:"text-xs mt-2",style:{color:"#94a3b8"},children:"Select a station to see full analysis"})]})}),!pt&&!tr&&U.jsxs("div",{className:"absolute bottom-4 sm:bottom-6 left-1/2 -translate-x-1/2 z-[900] flex items-center gap-2 sm:gap-3 w-[calc(100%-32px)] sm:w-auto justify-center",children:[jo&&Cl&&U.jsx("button",{onClick:()=>fo(ri-1),className:"snow-btn rounded-xl px-3 sm:px-4 py-3 sm:py-4 transition-all hover:scale-105",style:{color:"#475569"},children:""}),jo&&fh&&U.jsxs("button",{onClick:()=>fo(ri+1),className:"snow-next flex items-center gap-2 sm:gap-3 transition-all hover:scale-105 group whitespace-nowrap",children:[U.jsxs("span",{children:["Next: ",es[ri+1]?.label]}),U.jsx("span",{className:"transition-transform group-hover:translate-x-1",children:""})]}),jo&&!fh&&U.jsxs("button",{onClick:Mf,className:"snow-next flex items-center gap-2 sm:gap-3 transition-all hover:scale-105 group whitespace-nowrap",children:[U.jsx("span",{children:"Enter Explorer Mode"}),U.jsx("span",{className:"transition-transform group-hover:translate-x-1",children:""})]})]})]}),Ve&&U.jsx("div",{className:"absolute inset-0 z-[3000] overflow-y-auto",style:{background:"#ffffff"},children:U.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-10",children:[U.jsxs("div",{className:"flex items-center justify-between mb-8",children:[U.jsx("h1",{className:"text-2xl font-bold",style:{color:"#0f172a"},children:"About Snow Tracker"}),U.jsx("button",{onClick:()=>_t(!1),className:"w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold hover:bg-slate-100 transition-colors",style:{color:"#64748b"},children:""})]}),U.jsx("p",{className:"text-sm leading-relaxed mb-8",style:{color:"#475569"},children:"Snow Tracker is a story-driven dashboard for understanding global and US snowfall patterns, trends, and season shifts. It combines satellite-derived datasets with ground-truth SNOTEL station measurements to answer three questions: Where does it snow most? Is snowfall changing? Are snow seasons shifting?"}),U.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"#0f172a"},children:"Current Datasets"}),U.jsxs("div",{className:"mb-6 p-5 rounded-2xl",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:[U.jsx("h3",{className:"text-sm font-bold mb-2",style:{color:"#0369a1"},children:"Daymet V4 (US Detail)"}),U.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Provider:"})," NASA ORNL DAAC"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Resolution:"})," 1 km daily"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Coverage:"})," CONUS, 1980-present"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Collection:"})," NASA/ORNL/DAYMET_V4"]})]}),U.jsx("p",{className:"text-xs mt-3 leading-relaxed",style:{color:"#64748b"},children:"High-resolution daily surface weather data interpolated from ground stations. Used here for average annual maximum SWE (snow water equivalent) and long-term snowfall trend analysis (2004-2024). Pre-rendered as XYZ tiles on Google Cloud Storage at zoom levels 0-7."}),U.jsxs("div",{className:"mt-3 text-xs",style:{color:"#94a3b8"},children:[U.jsx("span",{className:"font-semibold",children:"Bands used:"})," SWE (kg/m), prcp + tmin for snowfall estimation |",U.jsx("span",{className:"font-semibold",children:" Tile format:"})," GCS XYZ PNGs (pre-computed from COGs via gdal2tiles)"]})]}),U.jsxs("div",{className:"mb-6 p-5 rounded-2xl",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:[U.jsx("h3",{className:"text-sm font-bold mb-2",style:{color:"#0369a1"},children:"ERA5-Land (Global)"}),U.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Provider:"})," ECMWF / Copernicus"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Resolution:"})," 9 km (~0.1)"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Coverage:"})," Global, 1950-present"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Collection:"})," ECMWF/ERA5_LAND/MONTHLY_AGGR"]})]}),U.jsx("p",{className:"text-xs mt-3 leading-relaxed",style:{color:"#64748b"},children:"Reanalysis dataset combining model data with global observations. Provides the global snowfall view and long-term global trend analysis. Served via live GEE proxy (Cloud Run) for dynamic tile generation with configurable color ramps and time ranges."}),U.jsxs("div",{className:"mt-3 text-xs",style:{color:"#94a3b8"},children:[U.jsx("span",{className:"font-semibold",children:"Bands used:"})," snowfall_sum (m of water equivalent), snow_depth (m) |",U.jsx("span",{className:"font-semibold",children:" Delivery:"})," Live GEE tile proxy (Cloud Run)"]})]}),U.jsxs("div",{className:"mb-6 p-5 rounded-2xl",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:[U.jsx("h3",{className:"text-sm font-bold mb-2",style:{color:"#0369a1"},children:"MODIS Snow Cover (Season Timing)"}),U.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Provider:"})," NASA LP DAAC"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Resolution:"})," 500 m daily"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Coverage:"})," Global, 2000-present"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Collection:"})," MODIS/061/MOD10A1"]})]}),U.jsx("p",{className:"text-xs mt-3 leading-relaxed",style:{color:"#64748b"},children:'Daily fractional snow cover from Terra satellite. Used to compute average snow days per year and detect shifts in season timing (earlier melt-out, later onset). Pre-rendered tiles for the "Is the season shifting?" question.'}),U.jsxs("div",{className:"mt-3 text-xs",style:{color:"#94a3b8"},children:[U.jsx("span",{className:"font-semibold",children:"Bands used:"})," NDSI_Snow_Cover (0-100%) |",U.jsx("span",{className:"font-semibold",children:" Tile format:"})," GCS XYZ PNGs"]})]}),U.jsxs("div",{className:"mb-6 p-5 rounded-2xl",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:[U.jsx("h3",{className:"text-sm font-bold mb-2",style:{color:"#0369a1"},children:"SNODAS (US Near-Real-Time)"}),U.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Provider:"})," NOHRSC / NWS"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Resolution:"})," 1 km daily"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Coverage:"})," CONUS, 2003-present"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Collection:"})," projects/climate-engine/snodas/daily"]})]}),U.jsx("p",{className:"text-xs mt-3 leading-relaxed",style:{color:"#64748b"},children:"Snow Data Assimilation System  modeled + observed snow analysis. Available as an alternative data source in Explorer Mode for current-condition US snow views. Served via live GEE proxy."}),U.jsxs("div",{className:"mt-3 text-xs",style:{color:"#94a3b8"},children:[U.jsx("span",{className:"font-semibold",children:"Bands used:"})," SWE, Snow_Depth |",U.jsx("span",{className:"font-semibold",children:" Delivery:"})," Live GEE tile proxy"]})]}),U.jsxs("div",{className:"mb-6 p-5 rounded-2xl",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:[U.jsx("h3",{className:"text-sm font-bold mb-2",style:{color:"#0369a1"},children:"SNOTEL Stations (Ground Truth)"}),U.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Provider:"})," USDA NRCS"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Resolution:"})," Point stations"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Coverage:"})," Western US, ~900 stations"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Source:"})," wcc.sc.egov.usda.gov"]})]}),U.jsx("p",{className:"text-xs mt-3 leading-relaxed",style:{color:"#64748b"},children:'Automated snow measurement stations in mountain watersheds. Provides daily SWE, snow depth, and temperature. Used as ground truth in the "My Mountain" lens for each question  showing hydrographs, period-of-record trend analysis, peak SWE trends, season onset/melt timing shifts, and comparison to nearby stations. Data accessed via Cloud Run proxy (USDA API lacks CORS).'}),U.jsxs("div",{className:"mt-3 text-xs",style:{color:"#94a3b8"},children:[U.jsx("span",{className:"font-semibold",children:"Metrics derived:"})," Peak SWE trend (in/decade), onset/melt-out DOWY, season length change, percentile ranking |",U.jsx("span",{className:"font-semibold",children:" Period of record:"})," Station-dependent (typically 20-40+ years)"]})]}),U.jsx("h2",{className:"text-lg font-semibold mb-4 mt-10",style:{color:"#0f172a"},children:"Future Data (Planned)"}),U.jsxs("div",{className:"space-y-4 mb-8",children:[U.jsxs("div",{className:"p-4 rounded-xl",style:{background:"#f8fafc",border:"1px dashed #cbd5e1"},children:[U.jsx("h4",{className:"text-sm font-semibold mb-1",style:{color:"#0f172a"},children:"VIIRS Snow Cover (NOAA-20/21)"}),U.jsx("p",{className:"text-xs",style:{color:"#64748b"},children:"Next-generation snow cover at 375m resolution, successor to MODIS. Would improve season timing accuracy."})]}),U.jsxs("div",{className:"p-4 rounded-xl",style:{background:"#f8fafc",border:"1px dashed #cbd5e1"},children:[U.jsx("h4",{className:"text-sm font-semibold mb-1",style:{color:"#0f172a"},children:"Sentinel-1 SAR Snow Wetness"}),U.jsx("p",{className:"text-xs",style:{color:"#64748b"},children:"C-band radar penetrates clouds to detect wet vs dry snow  valuable for melt-onset detection independent of optical conditions."})]}),U.jsxs("div",{className:"p-4 rounded-xl",style:{background:"#f8fafc",border:"1px dashed #cbd5e1"},children:[U.jsx("h4",{className:"text-sm font-semibold mb-1",style:{color:"#0f172a"},children:"UA SWE (University of Arizona)"}),U.jsx("p",{className:"text-xs",style:{color:"#64748b"},children:"4km gridded SWE product combining SNOTEL + PRISM + physiographic predictors. Best available gridded SWE for CONUS  would bridge the gap between point SNOTEL and coarser model data."})]}),U.jsxs("div",{className:"p-4 rounded-xl",style:{background:"#f8fafc",border:"1px dashed #cbd5e1"},children:[U.jsx("h4",{className:"text-sm font-semibold mb-1",style:{color:"#0f172a"},children:"CMIP6 Climate Projections"}),U.jsx("p",{className:"text-xs",style:{color:"#64748b"},children:"Future snowfall projections under SSP scenarios (2030-2100). Would add a forward-looking dimension to the trend analysis."})]}),U.jsxs("div",{className:"p-4 rounded-xl",style:{background:"#f8fafc",border:"1px dashed #cbd5e1"},children:[U.jsx("h4",{className:"text-sm font-semibold mb-1",style:{color:"#0f172a"},children:"PMTiles Migration"}),U.jsx("p",{className:"text-xs",style:{color:"#64748b"},children:"Converting existing XYZ tile pyramids to single-file PMTiles archives for faster loading and simpler hosting. Protocol already registered  awaiting full pipeline completion."})]})]}),U.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"#0f172a"},children:"Pipeline Architecture"}),U.jsx("div",{className:"p-5 rounded-2xl mb-8",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},children:U.jsxs("div",{className:"text-xs font-mono leading-loose",style:{color:"#475569"},children:[U.jsx("div",{className:"mb-2",children:U.jsx("span",{className:"font-bold",style:{color:"#0369a1"},children:"Static tiles (fast):"})}),U.jsx("div",{className:"ml-4",children:"GEE ImageCollection  ee.Image.getThumbURL()  COG export  gdalwarp (EPSG:3857)  gdal2tiles (z0-7)  GCS bucket  MapLibre raster source"}),U.jsx("div",{className:"mt-4 mb-2",children:U.jsx("span",{className:"font-bold",style:{color:"#0369a1"},children:"Live tiles (dynamic):"})}),U.jsx("div",{className:"ml-4",children:"Client request  Cloud Run (Flask + earthengine-api)  ee.Image.getMapId()  GEE tile server  MapLibre raster source"}),U.jsx("div",{className:"mt-4 mb-2",children:U.jsx("span",{className:"font-bold",style:{color:"#0369a1"},children:"SNOTEL data:"})}),U.jsx("div",{className:"ml-4",children:"Pre-computed JSON (bulk stations) + Cloud Run proxy (individual station POR)  USDA NRCS Report Generator API  Client-side trend analysis"})]})}),U.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"#0f172a"},children:"Technical Stack"}),U.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8 text-xs",style:{color:"#475569"},children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Frontend:"})," React + TypeScript + Vite"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Maps:"})," MapLibre GL JS"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Charts:"})," Recharts"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Tiles:"})," GCS + PMTiles protocol"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Backend:"})," Cloud Run (Flask + GEE)"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Data engine:"})," Google Earth Engine"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Hosting:"})," GitHub Pages"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-semibold",style:{color:"#0f172a"},children:"Basemap:"})," CARTO Dark Matter"]})]}),U.jsx("div",{className:"text-center pt-4 pb-8",style:{borderTop:"1px solid #e2e8f0"},children:U.jsxs("p",{className:"text-xs",style:{color:"#94a3b8"},children:["Built by Quintin Tyree | ",U.jsx("a",{href:"https://tyreespatial.com",target:"_blank",rel:"noopener",className:"underline",style:{color:"#0369a1"},children:"tyreespatial.com"})]})})]})})]})}t3.createRoot(document.getElementById("root")).render(U.jsx(Z.StrictMode,{children:U.jsx(XW,{})}));
